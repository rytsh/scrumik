const np=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};np();function W(){}function ku(t,e){for(const n in e)t[n]=e[n];return t}function Tu(t){return t()}function pl(){return Object.create(null)}function rt(t){t.forEach(Tu)}function Uo(t){return typeof t=="function"}function je(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ss;function gl(t,e){return ss||(ss=document.createElement("a")),ss.href=e,t===ss.href}function rp(t){return Object.keys(t).length===0}function Iu(t,...e){if(t==null)return W;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Rr(t,e,n){t.$$.on_destroy.push(Iu(e,n))}function or(t){return t==null?"":t}function Cu(t){return t&&Uo(t.destroy)?t.destroy:W}function T(t,e){t.appendChild(e)}function q(t,e,n){t.insertBefore(e,n||null)}function $(t){t.parentNode.removeChild(t)}function S(t){return document.createElement(t)}function ml(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ce(t){return document.createTextNode(t)}function F(){return ce(" ")}function pn(){return ce("")}function ne(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function $n(t){return function(e){return e.preventDefault(),t.call(this,e)}}function gn(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function I(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function sp(t){return Array.from(t.childNodes)}function pe(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Dn(t,e){t.value=e==null?"":e}function Rn(t,e,n){t.classList[n?"add":"remove"](e)}function ip(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}let wr;function hr(t){wr=t}function Gs(){if(!wr)throw new Error("Function called outside component initialization");return wr}function Nr(t){Gs().$$.on_mount.push(t)}function op(t){Gs().$$.after_update.push(t)}function xr(t){Gs().$$.on_destroy.push(t)}function Su(){const t=Gs();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const i=ip(e,n,{cancelable:r});return s.slice().forEach(o=>{o.call(t,i)}),!i.defaultPrevented}return!0}}function yl(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const ar=[],Nn=[],vs=[],vl=[],Au=Promise.resolve();let lo=!1;function Du(){lo||(lo=!0,Au.then(Nu))}function Ru(){return Du(),Au}function co(t){vs.push(t)}const Vi=new Set;let is=0;function Nu(){const t=wr;do{for(;is<ar.length;){const e=ar[is];is++,hr(e),ap(e.$$)}for(hr(null),ar.length=0,is=0;Nn.length;)Nn.pop()();for(let e=0;e<vs.length;e+=1){const n=vs[e];Vi.has(n)||(Vi.add(n),n())}vs.length=0}while(ar.length);for(;vl.length;)vl.pop()();lo=!1,Vi.clear(),hr(t)}function ap(t){if(t.fragment!==null){t.update(),rt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(co)}}const ws=new Set;let Xt;function Dt(){Xt={r:0,c:[],p:Xt}}function Rt(){Xt.r||rt(Xt.c),Xt=Xt.p}function J(t,e){t&&t.i&&(ws.delete(t),t.i(e))}function ee(t,e,n,r){if(t&&t.o){if(ws.has(t))return;ws.add(t),Xt.c.push(()=>{ws.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function xu(t,e){t.d(1),e.delete(t.key)}function Mu(t,e){ee(t,1,1,()=>{e.delete(t.key)})}function Ks(t,e,n,r,s,i,o,a,l,c,u,f){let p=t.length,d=i.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const v=[],g=new Map,w=new Map;for(h=d;h--;){const b=f(s,i,h),C=n(b);let k=o.get(C);k?r&&k.p(b,e):(k=c(C,b),k.c()),g.set(C,v[h]=k),C in m&&w.set(C,Math.abs(h-m[C]))}const E=new Set,_=new Set;function y(b){J(b,1),b.m(a,u),o.set(b.key,b),u=b.first,d--}for(;p&&d;){const b=v[d-1],C=t[p-1],k=b.key,D=C.key;b===C?(u=b.first,p--,d--):g.has(D)?!o.has(k)||E.has(k)?y(b):_.has(D)?p--:w.get(k)>w.get(D)?(_.add(k),y(b)):(E.add(D),p--):(l(C,o),p--)}for(;p--;){const b=t[p];g.has(b.key)||l(b,o)}for(;d;)y(v[d-1]);return v}function Lu(t,e){const n={},r={},s={$$scope:1};let i=t.length;for(;i--;){const o=t[i],a=e[i];if(a){for(const l in o)l in a||(r[l]=1);for(const l in a)s[l]||(n[l]=a[l],s[l]=1);t[i]=a}else for(const l in o)s[l]=1}for(const o in r)o in n||(n[o]=void 0);return n}function Ou(t){return typeof t=="object"&&t!==null?t:{}}function Ie(t){t&&t.c()}function be(t,e,n,r){const{fragment:s,on_mount:i,on_destroy:o,after_update:a}=t.$$;s&&s.m(e,n),r||co(()=>{const l=i.map(Tu).filter(Uo);o?o.push(...l):rt(l),t.$$.on_mount=[]}),a.forEach(co)}function _e(t,e){const n=t.$$;n.fragment!==null&&(rt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function lp(t,e){t.$$.dirty[0]===-1&&(ar.push(t),Du(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function qe(t,e,n,r,s,i,o,a=[-1]){const l=wr;hr(t);const c=t.$$={fragment:null,ctx:null,props:i,update:W,not_equal:s,bound:pl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:pl(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(f,p,...d)=>{const h=d.length?d[0]:p;return c.ctx&&s(c.ctx[f],c.ctx[f]=h)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](h),u&&lp(t,f)),p}):[],c.update(),u=!0,rt(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const f=sp(e.target);c.fragment&&c.fragment.l(f),f.forEach($)}else c.fragment&&c.fragment.c();e.intro&&J(t.$$.fragment),be(t,e.target,e.anchor,e.customElement),Nu()}hr(l)}class ze{$destroy(){_e(this,1),this.$destroy=W}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!rp(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const En=[];function Pu(t,e){return{subscribe:Qs(t,e).subscribe}}function Qs(t,e=W){let n;const r=new Set;function s(a){if(je(t,a)&&(t=a,n)){const l=!En.length;for(const c of r)c[1](),En.push(c,t);if(l){for(let c=0;c<En.length;c+=2)En[c][0](En[c+1]);En.length=0}}}function i(a){s(a(t))}function o(a,l=W){const c=[a,l];return r.add(c),r.size===1&&(n=e(s)||W),a(t),()=>{r.delete(c),r.size===0&&(n(),n=null)}}return{set:s,update:i,subscribe:o}}function Fu(t,e,n){const r=!Array.isArray(t),s=r?[t]:t,i=e.length<2;return Pu(n,o=>{let a=!1;const l=[];let c=0,u=W;const f=()=>{if(c)return;u();const d=e(r?l[0]:l,o);i?o(d):u=Uo(d)?d:W},p=s.map((d,h)=>Iu(d,m=>{l[h]=m,c&=~(1<<h),a&&f()},()=>{c|=1<<h}));return a=!0,f(),function(){rt(p),u()}})}function cp(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,r,s,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();s=l.shift();)n=s[0],n==="*"?(o.push("wild"),a+="/(.*)"):n===":"?(r=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~r?r:~i?i:s.length)),a+=!!~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~r?"?":"")+"\\"+s.substring(i))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}function up(t){let e,n,r;const s=[t[2]];var i=t[0];function o(a){let l={};for(let c=0;c<s.length;c+=1)l=ku(l,s[c]);return{props:l}}return i&&(e=new i(o()),e.$on("routeEvent",t[7])),{c(){e&&Ie(e.$$.fragment),n=pn()},m(a,l){e&&be(e,a,l),q(a,n,l),r=!0},p(a,l){const c=l&4?Lu(s,[Ou(a[2])]):{};if(i!==(i=a[0])){if(e){Dt();const u=e;ee(u.$$.fragment,1,0,()=>{_e(u,1)}),Rt()}i?(e=new i(o()),e.$on("routeEvent",a[7]),Ie(e.$$.fragment),J(e.$$.fragment,1),be(e,n.parentNode,n)):e=null}else i&&e.$set(c)},i(a){r||(e&&J(e.$$.fragment,a),r=!0)},o(a){e&&ee(e.$$.fragment,a),r=!1},d(a){a&&$(n),e&&_e(e,a)}}}function hp(t){let e,n,r;const s=[{params:t[1]},t[2]];var i=t[0];function o(a){let l={};for(let c=0;c<s.length;c+=1)l=ku(l,s[c]);return{props:l}}return i&&(e=new i(o()),e.$on("routeEvent",t[6])),{c(){e&&Ie(e.$$.fragment),n=pn()},m(a,l){e&&be(e,a,l),q(a,n,l),r=!0},p(a,l){const c=l&6?Lu(s,[l&2&&{params:a[1]},l&4&&Ou(a[2])]):{};if(i!==(i=a[0])){if(e){Dt();const u=e;ee(u.$$.fragment,1,0,()=>{_e(u,1)}),Rt()}i?(e=new i(o()),e.$on("routeEvent",a[6]),Ie(e.$$.fragment),J(e.$$.fragment,1),be(e,n.parentNode,n)):e=null}else i&&e.$set(c)},i(a){r||(e&&J(e.$$.fragment,a),r=!0)},o(a){e&&ee(e.$$.fragment,a),r=!1},d(a){a&&$(n),e&&_e(e,a)}}}function fp(t){let e,n,r,s;const i=[hp,up],o=[];function a(l,c){return l[1]?0:1}return e=a(t),n=o[e]=i[e](t),{c(){n.c(),r=pn()},m(l,c){o[e].m(l,c),q(l,r,c),s=!0},p(l,[c]){let u=e;e=a(l),e===u?o[e].p(l,c):(Dt(),ee(o[u],1,1,()=>{o[u]=null}),Rt(),n=o[e],n?n.p(l,c):(n=o[e]=i[e](l),n.c()),J(n,1),n.m(r.parentNode,r))},i(l){s||(J(n),s=!0)},o(l){ee(n),s=!1},d(l){o[e].d(l),l&&$(r)}}}function wl(){const t=window.location.href.indexOf("#/");let e=t>-1?window.location.href.substr(t+1):"/";const n=e.indexOf("?");let r="";return n>-1&&(r=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:r}}const $o=Pu(null,function(e){e(wl());const n=()=>{e(wl())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});Fu($o,t=>t.location);const Bu=Fu($o,t=>t.querystring),bl=Qs(void 0);async function qo(t){if(!t||t.length<1||t.charAt(0)!="/"&&t.indexOf("#/")!==0)throw Error("Invalid parameter location");await Ru(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0,void 0),window.location.hash=(t.charAt(0)=="#"?"":"#")+t}function ju(t,e){if(e=El(e),!t||!t.tagName||t.tagName.toLowerCase()!="a")throw Error('Action "link" can only be used with <a> tags');return _l(t,e),{update(n){n=El(n),_l(t,n)}}}function _l(t,e){let n=e.href||t.getAttribute("href");if(n&&n.charAt(0)=="/")n="#"+n;else if(!n||n.length<2||n.slice(0,2)!="#/")throw Error('Invalid value for "href" attribute: '+n);t.setAttribute("href",n),t.addEventListener("click",r=>{r.preventDefault(),e.disabled||dp(r.currentTarget.getAttribute("href"))})}function El(t){return t&&typeof t=="string"?{href:t}:t||{}}function dp(t){history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0,void 0),window.location.hash=t}function pp(t,e,n){let{routes:r={}}=e,{prefix:s=""}=e,{restoreScrollState:i=!1}=e;class o{constructor(y,b){if(!b||typeof b!="function"&&(typeof b!="object"||b._sveltesparouter!==!0))throw Error("Invalid component object");if(!y||typeof y=="string"&&(y.length<1||y.charAt(0)!="/"&&y.charAt(0)!="*")||typeof y=="object"&&!(y instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:C,keys:k}=cp(y);this.path=y,typeof b=="object"&&b._sveltesparouter===!0?(this.component=b.component,this.conditions=b.conditions||[],this.userData=b.userData,this.props=b.props||{}):(this.component=()=>Promise.resolve(b),this.conditions=[],this.props={}),this._pattern=C,this._keys=k}match(y){if(s){if(typeof s=="string")if(y.startsWith(s))y=y.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const D=y.match(s);if(D&&D[0])y=y.substr(D[0].length)||"/";else return null}}const b=this._pattern.exec(y);if(b===null)return null;if(this._keys===!1)return b;const C={};let k=0;for(;k<this._keys.length;){try{C[this._keys[k]]=decodeURIComponent(b[k+1]||"")||null}catch{C[this._keys[k]]=null}k++}return C}async checkConditions(y){for(let b=0;b<this.conditions.length;b++)if(!await this.conditions[b](y))return!1;return!0}}const a=[];r instanceof Map?r.forEach((_,y)=>{a.push(new o(y,_))}):Object.keys(r).forEach(_=>{a.push(new o(_,r[_]))});let l=null,c=null,u={};const f=Su();async function p(_,y){await Ru(),f(_,y)}let d=null,h=null;i&&(h=_=>{_.state&&_.state.__svelte_spa_router_scrollY?d=_.state:d=null},window.addEventListener("popstate",h),op(()=>{d?window.scrollTo(d.__svelte_spa_router_scrollX,d.__svelte_spa_router_scrollY):window.scrollTo(0,0)}));let m=null,v=null;const g=$o.subscribe(async _=>{m=_;let y=0;for(;y<a.length;){const b=a[y].match(_.location);if(!b){y++;continue}const C={route:a[y].path,location:_.location,querystring:_.querystring,userData:a[y].userData,params:b&&typeof b=="object"&&Object.keys(b).length?b:null};if(!await a[y].checkConditions(C)){n(0,l=null),v=null,p("conditionsFailed",C);return}p("routeLoading",Object.assign({},C));const k=a[y].component;if(v!=k){k.loading?(n(0,l=k.loading),v=k,n(1,c=k.loadingParams),n(2,u={}),p("routeLoaded",Object.assign({},C,{component:l,name:l.name,params:c}))):(n(0,l=null),v=null);const D=await k();if(_!=m)return;n(0,l=D&&D.default||D),v=k}b&&typeof b=="object"&&Object.keys(b).length?n(1,c=b):n(1,c=null),n(2,u=a[y].props),p("routeLoaded",Object.assign({},C,{component:l,name:l.name,params:c})).then(()=>{bl.set(c)});return}n(0,l=null),v=null,bl.set(void 0)});xr(()=>{g(),h&&window.removeEventListener("popstate",h)});function w(_){yl.call(this,t,_)}function E(_){yl.call(this,t,_)}return t.$$set=_=>{"routes"in _&&n(3,r=_.routes),"prefix"in _&&n(4,s=_.prefix),"restoreScrollState"in _&&n(5,i=_.restoreScrollState)},t.$$.update=()=>{t.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[l,c,u,r,s,i,w,E]}class gp extends ze{constructor(e){super(),qe(this,e,pp,fp,je,{routes:3,prefix:4,restoreScrollState:5})}}function mp(t){let e,n,r,s,i,o,a,l,c,u,f;return{c(){e=S("div"),n=S("a"),r=ce(t[0]),s=F(),i=S("span"),o=ce(t[1]),a=F(),l=S("div"),l.innerHTML='<a href="https://github.com/rytsh/scrumik" target="_blank" class="hover:text-nl border-l border-white pl-4 pr-2">github</a>',I(n,"href","/"),I(n,"class","appearance-none text-xl font-bold mr-4 hover:text-nl"),I(l,"class","flex-grow text-right"),I(e,"class",c=`${t[2]} bg-black text-white flex items-center`)},m(p,d){q(p,e,d),T(e,n),T(n,r),T(e,s),T(e,i),T(i,o),T(e,a),T(e,l),u||(f=Cu(ju.call(null,n)),u=!0)},p(p,[d]){d&1&&pe(r,p[0]),d&2&&pe(o,p[1]),d&4&&c!==(c=`${p[2]} bg-black text-white flex items-center`)&&I(e,"class",c)},i:W,o:W,d(p){p&&$(e),u=!1,f()}}}function yp(t,e,n){let{title:r="scrumik"}=e,{message:s="scrum poker tool"}=e,{class:i=""}=e;return t.$$set=o=>{"title"in o&&n(0,r=o.title),"message"in o&&n(1,s=o.message),"class"in o&&n(2,i=o.class)},[r,s,i]}class vp extends ze{constructor(e){super(),qe(this,e,yp,mp,je,{title:0,message:1,class:2})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vu=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},wp=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},bp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,f=(i&3)<<4|a>>4;let p=(a&15)<<2|c>>6,d=c&63;l||(d=64,o||(p=64)),r.push(n[u],n[f],n[p],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Vu(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):wp(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw Error();const p=i<<2|a>>4;if(r.push(p),c!==64){const d=a<<4&240|c>>2;if(r.push(d),f!==64){const h=c<<6&192|f;r.push(h)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},_p=function(t){const e=Vu(t);return bp.encodeByteArray(e,!0)},Uu=function(t){return _p(t).replace(/\./g,"")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ws())}function $u(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Tp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ip(){return Ws().indexOf("Electron/")>=0}function Cp(){const t=Ws();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Sp(){return Ws().indexOf("MSAppHost/")>=0}function qu(){return typeof indexedDB=="object"}function zu(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function Ap(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp="FirebaseError";class qn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Dp,Object.setPrototypeOf(this,qn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xs.prototype.create)}}class Xs{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Rp(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new qn(s,a,r)}}function Rp(t,e){return t.replace(Np,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Np=/\{\$([^}]+)}/g;function Ts(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(kl(i)&&kl(o)){if(!Ts(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function kl(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp=1e3,Mp=2,Lp=4*60*60*1e3,Op=.5;function Tl(t,e=xp,n=Mp){const r=e*Math.pow(n,t),s=Math.round(Op*r*(Math.random()-.5)*2);return Math.min(Lp,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t){return t&&t._delegate?t._delegate:t}class Ct{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ep;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Bp(e))try{this.getOrInitializeService({instanceIdentifier:Wt})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Wt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wt){return this.instances.has(e)}getOptions(e=Wt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Fp(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Wt){return this.component?this.component.multipleInstances?e:Wt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Fp(t){return t===Wt?void 0:t}function Bp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Pp(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var re;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(re||(re={}));const Vp={debug:re.DEBUG,verbose:re.VERBOSE,info:re.INFO,warn:re.WARN,error:re.ERROR,silent:re.SILENT},Up=re.INFO,$p={[re.DEBUG]:"log",[re.VERBOSE]:"log",[re.INFO]:"info",[re.WARN]:"warn",[re.ERROR]:"error"},qp=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=$p[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zo{constructor(e){this.name=e,this._logLevel=Up,this._logHandler=qp,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Vp[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,re.DEBUG,...e),this._logHandler(this,re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,re.VERBOSE,...e),this._logHandler(this,re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,re.INFO,...e),this._logHandler(this,re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,re.WARN,...e),this._logHandler(this,re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,re.ERROR,...e),this._logHandler(this,re.ERROR,...e)}}const zp=(t,e)=>e.some(n=>t instanceof n);let Il,Cl;function Hp(){return Il||(Il=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Gp(){return Cl||(Cl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Hu=new WeakMap,uo=new WeakMap,Gu=new WeakMap,Ui=new WeakMap,Ho=new WeakMap;function Kp(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Pt(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Hu.set(n,t)}).catch(()=>{}),Ho.set(e,t),e}function Qp(t){if(uo.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});uo.set(t,e)}let ho={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return uo.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Gu.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Wp(t){ho=t(ho)}function Xp(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($i(this),e,...n);return Gu.set(r,e.sort?e.sort():[e]),Pt(r)}:Gp().includes(t)?function(...e){return t.apply($i(this),e),Pt(Hu.get(this))}:function(...e){return Pt(t.apply($i(this),e))}}function Yp(t){return typeof t=="function"?Xp(t):(t instanceof IDBTransaction&&Qp(t),zp(t,Hp())?new Proxy(t,ho):t)}function Pt(t){if(t instanceof IDBRequest)return Kp(t);if(Ui.has(t))return Ui.get(t);const e=Yp(t);return e!==t&&(Ui.set(t,e),Ho.set(e,t)),e}const $i=t=>Ho.get(t);function Ku(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Pt(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Pt(o.result),l.oldVersion,l.newVersion,Pt(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const Jp=["get","getKey","getAll","getAllKeys","count"],Zp=["put","add","delete","clear"],qi=new Map;function Sl(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qi.get(e))return qi.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Zp.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Jp.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return qi.set(e,i),i}Wp(t=>({...t,get:(e,n,r)=>Sl(e,n)||t.get(e,n,r),has:(e,n)=>!!Sl(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(tg(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function tg(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const fo="@firebase/app",Al="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go=new zo("@firebase/app"),ng="@firebase/app-compat",rg="@firebase/analytics-compat",sg="@firebase/analytics",ig="@firebase/app-check-compat",og="@firebase/app-check",ag="@firebase/auth",lg="@firebase/auth-compat",cg="@firebase/database",ug="@firebase/database-compat",hg="@firebase/functions",fg="@firebase/functions-compat",dg="@firebase/installations",pg="@firebase/installations-compat",gg="@firebase/messaging",mg="@firebase/messaging-compat",yg="@firebase/performance",vg="@firebase/performance-compat",wg="@firebase/remote-config",bg="@firebase/remote-config-compat",_g="@firebase/storage",Eg="@firebase/storage-compat",kg="@firebase/firestore",Tg="@firebase/firestore-compat",Ig="firebase",Cg="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu="[DEFAULT]",Sg={[fo]:"fire-core",[ng]:"fire-core-compat",[sg]:"fire-analytics",[rg]:"fire-analytics-compat",[og]:"fire-app-check",[ig]:"fire-app-check-compat",[ag]:"fire-auth",[lg]:"fire-auth-compat",[cg]:"fire-rtdb",[ug]:"fire-rtdb-compat",[hg]:"fire-fn",[fg]:"fire-fn-compat",[dg]:"fire-iid",[pg]:"fire-iid-compat",[gg]:"fire-fcm",[mg]:"fire-fcm-compat",[yg]:"fire-perf",[vg]:"fire-perf-compat",[wg]:"fire-rc",[bg]:"fire-rc-compat",[_g]:"fire-gcs",[Eg]:"fire-gcs-compat",[kg]:"fire-fst",[Tg]:"fire-fst-compat","fire-js":"fire-js",[Ig]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=new Map,po=new Map;function Ag(t,e){try{t.container.addComponent(e)}catch(n){Go.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function jt(t){const e=t.name;if(po.has(e))return Go.debug(`There were multiple attempts to register component ${e}.`),!1;po.set(e,t);for(const n of Is.values())Ag(n,t);return!0}function Mr(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dg={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},sn=new Xs("app","Firebase",Dg);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ct("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ng=Cg;function xg(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:Qu,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw sn.create("bad-app-name",{appName:String(r)});const s=Is.get(r);if(s){if(Ts(t,s.options)&&Ts(n,s.config))return s;throw sn.create("duplicate-app",{appName:r})}const i=new jp(r);for(const a of po.values())i.addComponent(a);const o=new Rg(t,n,i);return Is.set(r,o),o}function Wu(t=Qu){const e=Is.get(t);if(!e)throw sn.create("no-app",{appName:t});return e}function vt(t,e,n){var r;let s=(r=Sg[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Go.warn(a.join(" "));return}jt(new Ct(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg="firebase-heartbeat-database",Lg=1,br="firebase-heartbeat-store";let zi=null;function Xu(){return zi||(zi=Ku(Mg,Lg,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(br)}}}).catch(t=>{throw sn.create("storage-open",{originalErrorMessage:t.message})})),zi}async function Og(t){var e;try{return(await Xu()).transaction(br).objectStore(br).get(Yu(t))}catch(n){throw sn.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function Dl(t,e){var n;try{const s=(await Xu()).transaction(br,"readwrite");return await s.objectStore(br).put(e,Yu(t)),s.done}catch(r){throw sn.create("storage-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message})}}function Yu(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pg=1024,Fg=30*24*60*60*1e3;class Bg{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Vg(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Rl();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Fg}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Rl(),{heartbeatsToSend:n,unsentEntries:r}=jg(this._heartbeatsCache.heartbeats),s=Uu(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Rl(){return new Date().toISOString().substring(0,10)}function jg(t,e=Pg){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Nl(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Nl(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Vg{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return qu()?zu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Og(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dl(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Dl(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Nl(t){return Uu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(t){jt(new Ct("platform-logger",e=>new eg(e),"PRIVATE")),jt(new Ct("heartbeat",e=>new Bg(e),"PRIVATE")),vt(fo,Al,t),vt(fo,Al,"esm2017"),vt("fire-js","")}Ug("");var $g="firebase",qg="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vt($g,qg,"app");const Ju="@firebase/installations",Ko="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu=1e4,eh=`w:${Ko}`,th="FIS_v2",zg="https://firebaseinstallations.googleapis.com/v1",Hg=60*60*1e3,Gg="installations",Kg="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},on=new Xs(Gg,Kg,Qg);function nh(t){return t instanceof qn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh({projectId:t}){return`${zg}/projects/${t}/installations`}function sh(t){return{token:t.token,requestStatus:2,expiresIn:Xg(t.expiresIn),creationTime:Date.now()}}async function ih(t,e){const r=(await e.json()).error;return on.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function oh({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Wg(t,{refreshToken:e}){const n=oh(t);return n.append("Authorization",Yg(e)),n}async function ah(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Xg(t){return Number(t.replace("s","000"))}function Yg(t){return`${th} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jg({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=rh(t),s=oh(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:n,authVersion:th,appId:t.appId,sdkVersion:eh},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await ah(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:sh(c.authToken)}}else throw await ih("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lh(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const em=/^[cdef][\w-]{21}$/,go="";function tm(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=nm(t);return em.test(n)?n:go}catch{return go}}function nm(t){return Zg(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch=new Map;function uh(t,e){const n=Ys(t);hh(n,e),rm(n,e)}function hh(t,e){const n=ch.get(t);if(!!n)for(const r of n)r(e)}function rm(t,e){const n=sm();n&&n.postMessage({key:t,fid:e}),im()}let Yt=null;function sm(){return!Yt&&"BroadcastChannel"in self&&(Yt=new BroadcastChannel("[Firebase] FID Change"),Yt.onmessage=t=>{hh(t.data.key,t.data.fid)}),Yt}function im(){ch.size===0&&Yt&&(Yt.close(),Yt=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="firebase-installations-database",am=1,an="firebase-installations-store";let Hi=null;function Qo(){return Hi||(Hi=Ku(om,am,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(an)}}})),Hi}async function Cs(t,e){const n=Ys(t),s=(await Qo()).transaction(an,"readwrite"),i=s.objectStore(an),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&uh(t,e.fid),e}async function fh(t){const e=Ys(t),r=(await Qo()).transaction(an,"readwrite");await r.objectStore(an).delete(e),await r.done}async function Js(t,e){const n=Ys(t),s=(await Qo()).transaction(an,"readwrite"),i=s.objectStore(an),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&uh(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(t){let e;const n=await Js(t.appConfig,r=>{const s=lm(r),i=cm(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===go?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function lm(t){const e=t||{fid:tm(),registrationStatus:0};return dh(e)}function cm(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(on.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=um(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:hm(t)}:{installationEntry:e}}async function um(t,e){try{const n=await Jg(t,e);return Cs(t.appConfig,n)}catch(n){throw nh(n)&&n.customData.serverCode===409?await fh(t.appConfig):await Cs(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function hm(t){let e=await xl(t.appConfig);for(;e.registrationStatus===1;)await lh(100),e=await xl(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Wo(t);return r||n}return e}function xl(t){return Js(t,e=>{if(!e)throw on.create("installation-not-found");return dh(e)})}function dh(t){return fm(t)?{fid:t.fid,registrationStatus:0}:t}function fm(t){return t.registrationStatus===1&&t.registrationTime+Zu<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dm({appConfig:t,heartbeatServiceProvider:e},n){const r=pm(t,n),s=Wg(t,n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:eh,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await ah(()=>fetch(r,a));if(l.ok){const c=await l.json();return sh(c)}else throw await ih("Generate Auth Token",l)}function pm(t,{fid:e}){return`${rh(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xo(t,e=!1){let n;const r=await Js(t.appConfig,i=>{if(!ph(i))throw on.create("not-registered");const o=i.authToken;if(!e&&ym(o))return i;if(o.requestStatus===1)return n=gm(t,e),i;{if(!navigator.onLine)throw on.create("app-offline");const a=wm(i);return n=mm(t,a),a}});return n?await n:r.authToken}async function gm(t,e){let n=await Ml(t.appConfig);for(;n.authToken.requestStatus===1;)await lh(100),n=await Ml(t.appConfig);const r=n.authToken;return r.requestStatus===0?Xo(t,e):r}function Ml(t){return Js(t,e=>{if(!ph(e))throw on.create("not-registered");const n=e.authToken;return bm(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function mm(t,e){try{const n=await dm(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Cs(t.appConfig,r),n}catch(n){if(nh(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await fh(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Cs(t.appConfig,r)}throw n}}function ph(t){return t!==void 0&&t.registrationStatus===2}function ym(t){return t.requestStatus===2&&!vm(t)}function vm(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Hg}function wm(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function bm(t){return t.requestStatus===1&&t.requestTime+Zu<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _m(t){const e=t,{installationEntry:n,registrationPromise:r}=await Wo(e);return r?r.catch(console.error):Xo(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Em(t,e=!1){const n=t;return await km(n),(await Xo(n,e)).token}async function km(t){const{registrationPromise:e}=await Wo(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(t){if(!t||!t.options)throw Gi("App Configuration");if(!t.name)throw Gi("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Gi(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Gi(t){return on.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh="installations",Im="installations-internal",Cm=t=>{const e=t.getProvider("app").getImmediate(),n=Tm(e),r=Mr(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Sm=t=>{const e=t.getProvider("app").getImmediate(),n=Mr(e,gh).getImmediate();return{getId:()=>_m(n),getToken:s=>Em(n,s)}};function Am(){jt(new Ct(gh,Cm,"PUBLIC")),jt(new Ct(Im,Sm,"PRIVATE"))}Am();vt(Ju,Ko);vt(Ju,Ko,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="analytics",Dm="firebase_id",Rm="origin",Nm=60*1e3,xm="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",mh="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const at=new zo("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yh(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function Mm(t,e){const n=document.createElement("script");n.src=`${mh}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function Lm(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Om(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await yh(n)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(a){at.error(a)}t("config",s,i)}async function Pm(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await yh(n);for(const l of o){const c=a.find(f=>f.measurementId===l),u=c&&e[c.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){at.error(i)}}function Fm(t,e,n,r){async function s(i,o,a){try{i==="event"?await Pm(t,e,n,o,a):i==="config"?await Om(t,e,n,r,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(l){at.error(l)}}return s}function Bm(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=Fm(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function jm(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(mh))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},ht=new Xs("analytics","Analytics",Vm);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um=30,$m=1e3;class qm{constructor(e={},n=$m){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const vh=new qm;function zm(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Hm(t){var e;const{appId:n,apiKey:r}=t,s={method:"GET",headers:zm(r)},i=xm.replace("{app-id}",n),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw ht.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function Gm(t,e=vh,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw ht.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw ht.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Wm;return setTimeout(async()=>{a.abort()},n!==void 0?n:Nm),wh({appId:r,apiKey:s,measurementId:i},o,a,e)}async function wh(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=vh){var i,o;const{appId:a,measurementId:l}=t;try{await Km(r,e)}catch(c){if(l)return at.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${(i=c)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:l};throw c}try{const c=await Hm(t);return s.deleteThrottleMetadata(a),c}catch(c){const u=c;if(!Qm(u)){if(s.deleteThrottleMetadata(a),l)return at.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:l};throw c}const f=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?Tl(n,s.intervalMillis,Um):Tl(n,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+f,backoffCount:n+1};return s.setThrottleMetadata(a,p),at.debug(`Calling attemptFetch again in ${f} millis`),wh(t,p,r,s)}}function Km(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(ht.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Qm(t){if(!(t instanceof qn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class Wm{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Xm(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o=Object.assign(Object.assign({},r),{send_to:i});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ym(){var t;if(qu())try{await zu()}catch(e){return at.warn(ht.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return at.warn(ht.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Jm(t,e,n,r,s,i,o){var a;const l=Gm(t);l.then(d=>{n[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&at.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>at.error(d)),e.push(l);const c=Ym().then(d=>{if(d)return r.getId()}),[u,f]=await Promise.all([l,c]);jm()||Mm(i,u.measurementId),s("js",new Date);const p=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return p[Rm]="firebase",p.update=!0,f!=null&&(p[Dm]=f),s("config",u.measurementId,p),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e){this.app=e}_delete(){return delete fr[this.app.options.appId],Promise.resolve()}}let fr={},Ll=[];const Ol={};let Ki="dataLayer",e0="gtag",Pl,bh,Fl=!1;function t0(){const t=[];if($u()&&t.push("This is a browser extension environment."),Ap()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=ht.create("invalid-analytics-context",{errorInfo:e});at.warn(n.message)}}function n0(t,e,n){t0();const r=t.options.appId;if(!r)throw ht.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)at.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ht.create("no-api-key");if(fr[r]!=null)throw ht.create("already-exists",{id:r});if(!Fl){Lm(Ki);const{wrappedGtag:i,gtagCore:o}=Bm(fr,Ll,Ol,Ki,e0);bh=i,Pl=o,Fl=!0}return fr[r]=Jm(t,Ll,Ol,e,Pl,Ki,n),new Zm(t)}function r0(t=Wu()){t=mt(t);const e=Mr(t,Ss);return e.isInitialized()?e.getImmediate():s0(t)}function s0(t,e={}){const n=Mr(t,Ss);if(n.isInitialized()){const s=n.getImmediate();if(Ts(e,n.getOptions()))return s;throw ht.create("already-initialized")}return n.initialize({options:e})}function i0(t,e,n,r){t=mt(t),Xm(bh,fr[t.app.options.appId],e,n,r).catch(s=>at.error(s))}const Bl="@firebase/analytics",jl="0.8.0";function o0(){jt(new Ct(Ss,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return n0(r,s,n)},"PUBLIC")),jt(new Ct("analytics-internal",t,"PRIVATE")),vt(Bl,jl),vt(Bl,jl,"esm2017");function t(e){try{const n=e.getProvider(Ss).getImmediate();return{logEvent:(r,s,i)=>i0(n,r,s,i)}}catch(n){throw ht.create("interop-component-reg-failed",{reason:n})}}}o0();var a0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},P,Yo=Yo||{},z=a0||self;function As(){}function mo(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Lr(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function l0(t){return Object.prototype.hasOwnProperty.call(t,Qi)&&t[Qi]||(t[Qi]=++c0)}var Qi="closure_uid_"+(1e9*Math.random()>>>0),c0=0;function u0(t,e,n){return t.call.apply(t.bind,arguments)}function h0(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Pe(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Pe=u0:Pe=h0,Pe.apply(null,arguments)}function os(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ve(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function zt(){this.s=this.s,this.o=this.o}var f0=0;zt.prototype.s=!1;zt.prototype.na=function(){!this.s&&(this.s=!0,this.M(),f0!=0)&&l0(this)};zt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const _h=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Eh=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const r=t.length,s=typeof t=="string"?t.split(""):t;for(let i=0;i<r;i++)i in s&&e.call(n,s[i],i,t)};function d0(t){e:{var e=sy;const n=t.length,r=typeof t=="string"?t.split(""):t;for(let s=0;s<n;s++)if(s in r&&e.call(void 0,r[s],s,t)){e=s;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function Vl(t){return Array.prototype.concat.apply([],arguments)}function Jo(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Ds(t){return/^[\s\xa0]*$/.test(t)}var Ul=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ge(t,e){return t.indexOf(e)!=-1}function Wi(t,e){return t<e?-1:t>e?1:0}var Ke;e:{var $l=z.navigator;if($l){var ql=$l.userAgent;if(ql){Ke=ql;break e}}Ke=""}function Zo(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function kh(t){const e={};for(const n in t)e[n]=t[n];return e}var zl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Th(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<zl.length;i++)n=zl[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ea(t){return ea[" "](t),t}ea[" "]=As;function p0(t){var e=y0;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var g0=Ge(Ke,"Opera"),xn=Ge(Ke,"Trident")||Ge(Ke,"MSIE"),Ih=Ge(Ke,"Edge"),yo=Ih||xn,Ch=Ge(Ke,"Gecko")&&!(Ge(Ke.toLowerCase(),"webkit")&&!Ge(Ke,"Edge"))&&!(Ge(Ke,"Trident")||Ge(Ke,"MSIE"))&&!Ge(Ke,"Edge"),m0=Ge(Ke.toLowerCase(),"webkit")&&!Ge(Ke,"Edge");function Sh(){var t=z.document;return t?t.documentMode:void 0}var Rs;e:{var Xi="",Yi=function(){var t=Ke;if(Ch)return/rv:([^\);]+)(\)|;)/.exec(t);if(Ih)return/Edge\/([\d\.]+)/.exec(t);if(xn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(m0)return/WebKit\/(\S+)/.exec(t);if(g0)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Yi&&(Xi=Yi?Yi[1]:""),xn){var Ji=Sh();if(Ji!=null&&Ji>parseFloat(Xi)){Rs=String(Ji);break e}}Rs=Xi}var y0={};function v0(){return p0(function(){let t=0;const e=Ul(String(Rs)).split("."),n=Ul("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var s=e[o]||"",i=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s[0].length==0&&i[0].length==0)break;t=Wi(s[1].length==0?0:parseInt(s[1],10),i[1].length==0?0:parseInt(i[1],10))||Wi(s[2].length==0,i[2].length==0)||Wi(s[2],i[2]),s=s[3],i=i[3]}while(t==0)}return 0<=t})}var vo;if(z.document&&xn){var Hl=Sh();vo=Hl||parseInt(Rs,10)||void 0}else vo=void 0;var w0=vo,b0=function(){if(!z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{z.addEventListener("test",As,e),z.removeEventListener("test",As,e)}catch{}return t}();function $e(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}$e.prototype.h=function(){this.defaultPrevented=!0};function _r(t,e){if($e.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Ch){e:{try{ea(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:_0[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&_r.Z.h.call(this)}}Ve(_r,$e);var _0={2:"touch",3:"pen",4:"mouse"};_r.prototype.h=function(){_r.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Or="closure_listenable_"+(1e6*Math.random()|0),E0=0;function k0(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=s,this.key=++E0,this.ca=this.fa=!1}function Zs(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function ei(t){this.src=t,this.g={},this.h=0}ei.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=bo(t,e,r,s);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new k0(e,this.src,i,!!r,s),e.fa=n,t.push(e)),e};function wo(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=_h(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Zs(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function bo(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==r)return s}return-1}var ta="closure_lm_"+(1e6*Math.random()|0),Zi={};function Ah(t,e,n,r,s){if(r&&r.once)return Rh(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)Ah(t,e[i],n,r,s);return null}return n=sa(n),t&&t[Or]?t.N(e,n,Lr(r)?!!r.capture:!!r,s):Dh(t,e,n,!1,r,s)}function Dh(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Lr(s)?!!s.capture:!!s,a=ra(t);if(a||(t[ta]=a=new ei(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=T0(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)b0||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(xh(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function T0(){function t(n){return e.call(t.src,t.listener,n)}var e=I0;return t}function Rh(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)Rh(t,e[i],n,r,s);return null}return n=sa(n),t&&t[Or]?t.O(e,n,Lr(r)?!!r.capture:!!r,s):Dh(t,e,n,!0,r,s)}function Nh(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)Nh(t,e[i],n,r,s);else r=Lr(r)?!!r.capture:!!r,n=sa(n),t&&t[Or]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=bo(i,n,r,s),-1<n&&(Zs(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=ra(t))&&(e=t.g[e.toString()],t=-1,e&&(t=bo(e,n,r,s)),(n=-1<t?e[t]:null)&&na(n))}function na(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[Or])wo(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(xh(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ra(e))?(wo(n,t),n.h==0&&(n.src=null,e[ta]=null)):Zs(t)}}}function xh(t){return t in Zi?Zi[t]:Zi[t]="on"+t}function I0(t,e){if(t.ca)t=!0;else{e=new _r(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&na(t),t=n.call(r,e)}return t}function ra(t){return t=t[ta],t instanceof ei?t:null}var eo="__closure_events_fn_"+(1e9*Math.random()>>>0);function sa(t){return typeof t=="function"?t:(t[eo]||(t[eo]=function(e){return t.handleEvent(e)}),t[eo])}function xe(){zt.call(this),this.i=new ei(this),this.P=this,this.I=null}Ve(xe,zt);xe.prototype[Or]=!0;xe.prototype.removeEventListener=function(t,e,n,r){Nh(this,t,e,n,r)};function Fe(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new $e(e,t);else if(e instanceof $e)e.target=e.target||t;else{var s=e;e=new $e(r,t),Th(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=as(o,r,!0,e)&&s}if(o=e.g=t,s=as(o,r,!0,e)&&s,s=as(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=as(o,r,!1,e)&&s}xe.prototype.M=function(){if(xe.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Zs(n[r]);delete t.g[e],t.h--}}this.I=null};xe.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};xe.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function as(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&wo(t.i,o),s=a.call(l,r)!==!1&&s}}return s&&!r.defaultPrevented}var ia=z.JSON.stringify;function C0(){var t=Lh;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class S0{constructor(){this.h=this.g=null}add(e,n){const r=Mh.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var Mh=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new A0,t=>t.reset());class A0{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function D0(t){z.setTimeout(()=>{throw t},0)}function oa(t,e){_o||R0(),Eo||(_o(),Eo=!0),Lh.add(t,e)}var _o;function R0(){var t=z.Promise.resolve(void 0);_o=function(){t.then(N0)}}var Eo=!1,Lh=new S0;function N0(){for(var t;t=C0();){try{t.h.call(t.g)}catch(n){D0(n)}var e=Mh;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Eo=!1}function ti(t,e){xe.call(this),this.h=t||1,this.g=e||z,this.j=Pe(this.kb,this),this.l=Date.now()}Ve(ti,xe);P=ti.prototype;P.da=!1;P.S=null;P.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Fe(this,"tick"),this.da&&(aa(this),this.start()))}};P.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function aa(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}P.M=function(){ti.Z.M.call(this),aa(this),delete this.g};function la(t,e,n){if(typeof t=="function")n&&(t=Pe(t,n));else if(t&&typeof t.handleEvent=="function")t=Pe(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:z.setTimeout(t,e||0)}function Oh(t){t.g=la(()=>{t.g=null,t.i&&(t.i=!1,Oh(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class x0 extends zt{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Oh(this)}M(){super.M(),this.g&&(z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Er(t){zt.call(this),this.h=t,this.g={}}Ve(Er,zt);var Gl=[];function Ph(t,e,n,r){Array.isArray(n)||(n&&(Gl[0]=n.toString()),n=Gl);for(var s=0;s<n.length;s++){var i=Ah(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function Fh(t){Zo(t.g,function(e,n){this.g.hasOwnProperty(n)&&na(e)},t),t.g={}}Er.prototype.M=function(){Er.Z.M.call(this),Fh(this)};Er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ni(){this.g=!0}ni.prototype.Aa=function(){this.g=!1};function M0(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var f=u.split("_");o=2<=f.length&&f[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function L0(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function In(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+P0(t,n)+(r?" "+r:"")})}function O0(t,e){t.info(function(){return"TIMEOUT: "+e})}ni.prototype.info=function(){};function P0(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return ia(n)}catch{return e}}var mn={},Kl=null;function ri(){return Kl=Kl||new xe}mn.Ma="serverreachability";function Bh(t){$e.call(this,mn.Ma,t)}Ve(Bh,$e);function kr(t){const e=ri();Fe(e,new Bh(e))}mn.STAT_EVENT="statevent";function jh(t,e){$e.call(this,mn.STAT_EVENT,t),this.stat=e}Ve(jh,$e);function Qe(t){const e=ri();Fe(e,new jh(e,t))}mn.Na="timingevent";function Vh(t,e){$e.call(this,mn.Na,t),this.size=e}Ve(Vh,$e);function Pr(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return z.setTimeout(function(){t()},e)}var si={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Uh={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ca(){}ca.prototype.h=null;function Ql(t){return t.h||(t.h=t.i())}function $h(){}var Fr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ua(){$e.call(this,"d")}Ve(ua,$e);function ha(){$e.call(this,"c")}Ve(ha,$e);var ko;function ii(){}Ve(ii,ca);ii.prototype.g=function(){return new XMLHttpRequest};ii.prototype.i=function(){return{}};ko=new ii;function Br(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Er(this),this.P=F0,t=yo?125:void 0,this.W=new ti(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new qh}function qh(){this.i=null,this.g="",this.h=!1}var F0=45e3,To={},Ns={};P=Br.prototype;P.setTimeout=function(t){this.P=t};function Io(t,e,n){t.K=1,t.v=ai(St(e)),t.s=n,t.U=!0,zh(t,null)}function zh(t,e){t.F=Date.now(),jr(t),t.A=St(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Yh(n.h,"t",r),t.C=0,n=t.l.H,t.h=new qh,t.g=vf(t.l,n?e:null,!t.s),0<t.O&&(t.L=new x0(Pe(t.Ia,t,t.g),t.O)),Ph(t.V,t.g,"readystatechange",t.gb),e=t.H?kh(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),kr(),M0(t.j,t.u,t.A,t.m,t.X,t.s)}P.gb=function(t){t=t.target;const e=this.L;e&&kt(t)==3?e.l():this.Ia(t)};P.Ia=function(t){try{if(t==this.g)e:{const u=kt(this.g);var e=this.g.Da();const f=this.g.ba();if(!(3>u)&&(u!=3||yo||this.g&&(this.h.h||this.g.ga()||Jl(this.g)))){this.I||u!=4||e==7||(e==8||0>=f?kr(3):kr(2)),oi(this);var n=this.g.ba();this.N=n;t:if(Hh(this)){var r=Jl(this.g);t="";var s=r.length,i=kt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jt(this),dr(this);var o="";break t}this.h.i=new z.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,L0(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ds(a)){var c=a;break t}}c=null}if(n=c)In(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Co(this,n);else{this.i=!1,this.o=3,Qe(12),Jt(this),dr(this);break e}}this.U?(Gh(this,u,o),yo&&this.i&&u==3&&(Ph(this.V,this.W,"tick",this.fb),this.W.start())):(In(this.j,this.m,o,null),Co(this,o)),u==4&&Jt(this),this.i&&!this.I&&(u==4?pf(this.l,this):(this.i=!1,jr(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,Qe(12)):(this.o=0,Qe(13)),Jt(this),dr(this)}}}catch{}finally{}};function Hh(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function Gh(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=B0(t,n),s==Ns){e==4&&(t.o=4,Qe(14),r=!1),In(t.j,t.m,null,"[Incomplete Response]");break}else if(s==To){t.o=4,Qe(15),In(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else In(t.j,t.m,s,null),Co(t,s);Hh(t)&&s!=Ns&&s!=To&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,Qe(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),ba(e),e.L=!0,Qe(11))):(In(t.j,t.m,n,"[Invalid Chunked Response]"),Jt(t),dr(t))}P.fb=function(){if(this.g){var t=kt(this.g),e=this.g.ga();this.C<e.length&&(oi(this),Gh(this,t,e),this.i&&t!=4&&jr(this))}};function B0(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Ns:(n=Number(e.substring(n,r)),isNaN(n)?To:(r+=1,r+n>e.length?Ns:(e=e.substr(r,n),t.C=r+n,e)))}P.cancel=function(){this.I=!0,Jt(this)};function jr(t){t.Y=Date.now()+t.P,Kh(t,t.P)}function Kh(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Pr(Pe(t.eb,t),e)}function oi(t){t.B&&(z.clearTimeout(t.B),t.B=null)}P.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(O0(this.j,this.A),this.K!=2&&(kr(),Qe(17)),Jt(this),this.o=2,dr(this)):Kh(this,this.Y-t)};function dr(t){t.l.G==0||t.I||pf(t.l,t)}function Jt(t){oi(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,aa(t.W),Fh(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Co(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||So(n.i,t))){if(n.I=t.N,!t.J&&So(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Os(n),ui(n);else break e;wa(n),Qe(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&n.A==0&&!n.v&&(n.v=Pr(Pe(n.ab,n),6e3));if(1>=ef(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Zt(n,11)}else if((t.J||n.g==t)&&Os(n),!Ds(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.U=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.J=c[1],n.la=c[2];const u=c[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const f=c[4];f!=null&&(n.za=f,n.h.info("SVER="+n.za));const p=c[5];p!=null&&typeof p=="number"&&0<p&&(r=1.5*p,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=t.g;if(d){const h=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var i=r.i;!i.g&&(Ge(h,"spdy")||Ge(h,"quic")||Ge(h,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(pa(i,i.h),i.h=null))}if(r.D){const m=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.sa=m,he(r.F,r.D,m))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var o=t;if(r.oa=yf(r,r.H?r.la:null,r.W),o.J){tf(r.i,o);var a=o,l=r.K;l&&a.setTimeout(l),a.B&&(oi(a),jr(a)),r.g=o}else ff(r);0<n.l.length&&hi(n)}else c[0]!="stop"&&c[0]!="close"||Zt(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Zt(n,7):va(n):c[0]!="noop"&&n.j&&n.j.wa(c),n.A=0)}}kr(4)}catch{}}function j0(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(mo(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function fa(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(mo(t)||typeof t=="string")Eh(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(mo(t)||typeof t=="string"){n=[];for(var r=t.length,s=0;s<r;s++)n.push(s)}else for(s in n=[],r=0,t)n[r++]=s;r=j0(t),s=r.length;for(var i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}}function zn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof zn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}P=zn.prototype;P.R=function(){da(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};P.T=function(){return da(this),this.g.concat()};function da(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ln(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)r=t.g[e],ln(s,r)||(t.g[n++]=r,s[r]=1),e++;t.g.length=n}}P.get=function(t,e){return ln(this.h,t)?this.h[t]:e};P.set=function(t,e){ln(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};P.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var s=n[r],i=this.get(s);t.call(e,i,s,this)}};function ln(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Qh=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function V0(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function cn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof cn){this.g=e!==void 0?e:t.g,xs(this,t.j),this.s=t.s,Ms(this,t.i),Ls(this,t.m),this.l=t.l,e=t.h;var n=new Tr;n.i=e.i,e.g&&(n.g=new zn(e.g),n.h=e.h),Wl(this,n),this.o=t.o}else t&&(n=String(t).match(Qh))?(this.g=!!e,xs(this,n[1]||"",!0),this.s=pr(n[2]||""),Ms(this,n[3]||"",!0),Ls(this,n[4]),this.l=pr(n[5]||"",!0),Wl(this,n[6]||"",!0),this.o=pr(n[7]||"")):(this.g=!!e,this.h=new Tr(null,this.g))}cn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(lr(e,Xl,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(lr(e,Xl,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(lr(n,n.charAt(0)=="/"?H0:z0,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",lr(n,K0)),t.join("")};function St(t){return new cn(t)}function xs(t,e,n){t.j=n?pr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ms(t,e,n){t.i=n?pr(e,!0):e}function Ls(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Wl(t,e,n){e instanceof Tr?(t.h=e,Q0(t.h,t.g)):(n||(e=lr(e,G0)),t.h=new Tr(e,t.g))}function he(t,e,n){t.h.set(e,n)}function ai(t){return he(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function U0(t){return t instanceof cn?St(t):new cn(t,void 0)}function $0(t,e,n,r){var s=new cn(null,void 0);return t&&xs(s,t),e&&Ms(s,e),n&&Ls(s,n),r&&(s.l=r),s}function pr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function lr(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,q0),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function q0(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Xl=/[#\/\?@]/g,z0=/[#\?:]/g,H0=/[#\?]/g,G0=/[#\?@]/g,K0=/#/g;function Tr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ht(t){t.g||(t.g=new zn,t.h=0,t.i&&V0(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}P=Tr.prototype;P.add=function(t,e){Ht(this),this.i=null,t=Hn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Wh(t,e){Ht(t),e=Hn(t,e),ln(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,ln(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&da(t)))}function Xh(t,e){return Ht(t),e=Hn(t,e),ln(t.g.h,e)}P.forEach=function(t,e){Ht(this),this.g.forEach(function(n,r){Eh(n,function(s){t.call(e,s,r,this)},this)},this)};P.T=function(){Ht(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var s=t[r],i=0;i<s.length;i++)n.push(e[r]);return n};P.R=function(t){Ht(this);var e=[];if(typeof t=="string")Xh(this,t)&&(e=Vl(e,this.g.get(Hn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Vl(e,t[n])}return e};P.set=function(t,e){return Ht(this),this.i=null,t=Hn(this,t),Xh(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};P.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function Yh(t,e,n){Wh(t,e),0<n.length&&(t.i=null,t.g.set(Hn(t,e),Jo(n)),t.h+=n.length)}P.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],s=encodeURIComponent(String(r));r=this.R(r);for(var i=0;i<r.length;i++){var o=s;r[i]!==""&&(o+="="+encodeURIComponent(String(r[i]))),t.push(o)}}return this.i=t.join("&")};function Hn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Q0(t,e){e&&!t.j&&(Ht(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(Wh(this,r),Yh(this,s,n))},t)),t.j=e}var W0=class{constructor(t,e){this.h=t,this.g=e}};function Jh(t){this.l=t||X0,z.PerformanceNavigationTiming?(t=z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(z.g&&z.g.Ea&&z.g.Ea()&&z.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var X0=10;function Zh(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function ef(t){return t.h?1:t.g?t.g.size:0}function So(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function pa(t,e){t.g?t.g.add(e):t.h=e}function tf(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Jh.prototype.cancel=function(){if(this.i=nf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function nf(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Jo(t.i)}function ga(){}ga.prototype.stringify=function(t){return z.JSON.stringify(t,void 0)};ga.prototype.parse=function(t){return z.JSON.parse(t,void 0)};function Y0(){this.g=new ga}function J0(t,e,n){const r=n||"";try{fa(t,function(s,i){let o=s;Lr(s)&&(o=ia(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function Z0(t,e){const n=new ni;if(z.Image){const r=new Image;r.onload=os(ls,n,r,"TestLoadImage: loaded",!0,e),r.onerror=os(ls,n,r,"TestLoadImage: error",!1,e),r.onabort=os(ls,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=os(ls,n,r,"TestLoadImage: timeout",!1,e),z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function ls(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Vr(t){this.l=t.$b||null,this.j=t.ib||!1}Ve(Vr,ca);Vr.prototype.g=function(){return new li(this.l,this.j)};Vr.prototype.i=function(t){return function(){return t}}({});function li(t,e){xe.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ma,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ve(li,xe);var ma=0;P=li.prototype;P.open=function(t,e){if(this.readyState!=ma)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ir(this)};P.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||z).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};P.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ur(this)),this.readyState=ma};P.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ir(this)),this.g&&(this.readyState=3,Ir(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;rf(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function rf(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}P.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ur(this):Ir(this),this.readyState==3&&rf(this)}};P.Ua=function(t){this.g&&(this.response=this.responseText=t,Ur(this))};P.Ta=function(t){this.g&&(this.response=t,Ur(this))};P.ha=function(){this.g&&Ur(this)};function Ur(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ir(t)}P.setRequestHeader=function(t,e){this.v.append(t,e)};P.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};P.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Ir(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(li.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var ey=z.JSON.parse;function Ee(t){xe.call(this),this.headers=new zn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=sf,this.K=this.L=!1}Ve(Ee,xe);var sf="",ty=/^https?$/i,ny=["POST","PUT"];P=Ee.prototype;P.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ko.g(),this.C=this.u?Ql(this.u):Ql(ko),this.g.onreadystatechange=Pe(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){Yl(this,i);return}t=n||"";const s=new zn(this.headers);r&&fa(r,function(i,o){s.set(o,i)}),r=d0(s.T()),n=z.FormData&&t instanceof z.FormData,!(0<=_h(ny,e))||r||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{lf(this),0<this.B&&((this.K=ry(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Pe(this.pa,this)):this.A=la(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Yl(this,i)}};function ry(t){return xn&&v0()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function sy(t){return t.toLowerCase()=="content-type"}P.pa=function(){typeof Yo<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Fe(this,"timeout"),this.abort(8))};function Yl(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,of(t),ci(t)}function of(t){t.D||(t.D=!0,Fe(t,"complete"),Fe(t,"error"))}P.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Fe(this,"complete"),Fe(this,"abort"),ci(this))};P.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ci(this,!0)),Ee.Z.M.call(this)};P.Fa=function(){this.s||(this.F||this.v||this.l?af(this):this.cb())};P.cb=function(){af(this)};function af(t){if(t.h&&typeof Yo<"u"&&(!t.C[1]||kt(t)!=4||t.ba()!=2)){if(t.v&&kt(t)==4)la(t.Fa,0,t);else if(Fe(t,"readystatechange"),kt(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(Qh)[1]||null;if(!s&&z.self&&z.self.location){var i=z.self.location.protocol;s=i.substr(0,i.length-1)}r=!ty.test(s?s.toLowerCase():"")}n=r}if(n)Fe(t,"complete"),Fe(t,"success");else{t.m=6;try{var o=2<kt(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",of(t)}}finally{ci(t)}}}}function ci(t,e){if(t.g){lf(t);const n=t.g,r=t.C[0]?As:null;t.g=null,t.C=null,e||Fe(t,"ready");try{n.onreadystatechange=r}catch{}}}function lf(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(z.clearTimeout(t.A),t.A=null)}function kt(t){return t.g?t.g.readyState:0}P.ba=function(){try{return 2<kt(this)?this.g.status:-1}catch{return-1}};P.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};P.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),ey(e)}};function Jl(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case sf:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}P.Da=function(){return this.m};P.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function iy(t){let e="";return Zo(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function ya(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=iy(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):he(t,e,n))}function rr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function cf(t){this.za=0,this.l=[],this.h=new ni,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=rr("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=rr("baseRetryDelayMs",5e3,t),this.$a=rr("retryDelaySeedMs",1e4,t),this.Ya=rr("forwardChannelMaxRetries",2,t),this.ra=rr("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Jh(t&&t.concurrentRequestLimit),this.Ca=new Y0,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}P=cf.prototype;P.ma=8;P.G=1;function va(t){if(uf(t),t.G==3){var e=t.V++,n=St(t.F);he(n,"SID",t.J),he(n,"RID",e),he(n,"TYPE","terminate"),$r(t,n),e=new Br(t,t.h,e,void 0),e.K=2,e.v=ai(St(n)),n=!1,z.navigator&&z.navigator.sendBeacon&&(n=z.navigator.sendBeacon(e.v.toString(),"")),!n&&z.Image&&(new Image().src=e.v,n=!0),n||(e.g=vf(e.l,null),e.g.ea(e.v)),e.F=Date.now(),jr(e)}mf(t)}P.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function ui(t){t.g&&(ba(t),t.g.cancel(),t.g=null)}function uf(t){ui(t),t.u&&(z.clearTimeout(t.u),t.u=null),Os(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&z.clearTimeout(t.m),t.m=null)}function to(t,e){t.l.push(new W0(t.Za++,e)),t.G==3&&hi(t)}function hi(t){Zh(t.i)||t.m||(t.m=!0,oa(t.Ha,t),t.C=0)}function oy(t,e){return ef(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Pr(Pe(t.Ha,t,e),gf(t,t.C)),t.C++,!0)}P.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new Br(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=kh(i),Th(i,this.P)):i=this.P),this.o===null&&(s.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var r=this.l[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=hf(this,s,e),n=St(this.F),he(n,"RID",t),he(n,"CVER",22),this.D&&he(n,"X-HTTP-Session-Id",this.D),$r(this,n),this.o&&i&&ya(n,this.o,i),pa(this.i,s),this.Ra&&he(n,"TYPE","init"),this.ja?(he(n,"$req",e),he(n,"SID","null"),s.$=!0,Io(s,n,null)):Io(s,n,e),this.G=2}}else this.G==3&&(t?Zl(this,t):this.l.length==0||Zh(this.i)||Zl(this))};function Zl(t,e){var n;e?n=e.m:n=t.V++;const r=St(t.F);he(r,"SID",t.J),he(r,"RID",n),he(r,"AID",t.U),$r(t,r),t.o&&t.s&&ya(r,t.o,t.s),n=new Br(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=hf(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),pa(t.i,n),Io(n,r,e)}function $r(t,e){t.j&&fa({},function(n,r){he(e,r,n)})}function hf(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Pe(t.j.Oa,t.j,t):null;e:{var s=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let l=0;l<n;l++){let c=s[l].h;const u=s[l].g;if(c-=i,0>c)i=Math.max(0,s[l].h-100),a=!1;else try{J0(u,o,"req"+c+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,r}function ff(t){t.g||t.u||(t.Y=1,oa(t.Ga,t),t.A=0)}function wa(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Pr(Pe(t.Ga,t),gf(t,t.A)),t.A++,!0)}P.Ga=function(){if(this.u=null,df(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Pr(Pe(this.bb,this),t)}};P.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Qe(10),ui(this),df(this))};function ba(t){t.B!=null&&(z.clearTimeout(t.B),t.B=null)}function df(t){t.g=new Br(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=St(t.oa);he(e,"RID","rpc"),he(e,"SID",t.J),he(e,"CI",t.N?"0":"1"),he(e,"AID",t.U),$r(t,e),he(e,"TYPE","xmlhttp"),t.o&&t.s&&ya(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=ai(St(e)),n.s=null,n.U=!0,zh(n,t)}P.ab=function(){this.v!=null&&(this.v=null,ui(this),wa(this),Qe(19))};function Os(t){t.v!=null&&(z.clearTimeout(t.v),t.v=null)}function pf(t,e){var n=null;if(t.g==e){Os(t),ba(t),t.g=null;var r=2}else if(So(t.i,e))n=e.D,tf(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=ri(),Fe(r,new Vh(r,n)),hi(t)}else ff(t);else if(s=e.o,s==3||s==0&&0<t.I||!(r==1&&oy(t,e)||r==2&&wa(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Zt(t,5);break;case 4:Zt(t,10);break;case 3:Zt(t,6);break;default:Zt(t,2)}}}function gf(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Zt(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=Pe(t.jb,t);n||(n=new cn("//www.google.com/images/cleardot.gif"),z.location&&z.location.protocol=="http"||xs(n,"https"),ai(n)),Z0(n.toString(),r)}else Qe(2);t.G=0,t.j&&t.j.va(e),mf(t),uf(t)}P.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Qe(2)):(this.h.info("Failed to ping google.com"),Qe(1))};function mf(t){t.G=0,t.I=-1,t.j&&((nf(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,Jo(t.l),t.l.length=0),t.j.ua())}function yf(t,e,n){let r=U0(n);if(r.i!="")e&&Ms(r,e+"."+r.i),Ls(r,r.m);else{const s=z.location;r=$0(s.protocol,e?e+"."+s.hostname:s.hostname,+s.port,n)}return t.aa&&Zo(t.aa,function(s,i){he(r,i,s)}),e=t.D,n=t.sa,e&&n&&he(r,e,n),he(r,"VER",t.ma),$r(t,r),r}function vf(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new Ee(new Vr({ib:!0})):new Ee(t.qa),e.L=t.H,e}function wf(){}P=wf.prototype;P.xa=function(){};P.wa=function(){};P.va=function(){};P.ua=function(){};P.Oa=function(){};function Ps(){if(xn&&!(10<=Number(w0)))throw Error("Environmental error: no available transport.")}Ps.prototype.g=function(t,e){return new lt(t,e)};function lt(t,e){xe.call(this),this.g=new cf(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Ds(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ds(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Gn(this)}Ve(lt,xe);lt.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),oa(Pe(t.hb,t,e))),Qe(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=yf(t,null,t.W),hi(t)};lt.prototype.close=function(){va(this.g)};lt.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,to(this.g,e)}else this.v?(e={},e.__data__=ia(t),to(this.g,e)):to(this.g,t)};lt.prototype.M=function(){this.g.j=null,delete this.j,va(this.g),delete this.g,lt.Z.M.call(this)};function bf(t){ua.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ve(bf,ua);function _f(){ha.call(this),this.status=1}Ve(_f,ha);function Gn(t){this.g=t}Ve(Gn,wf);Gn.prototype.xa=function(){Fe(this.g,"a")};Gn.prototype.wa=function(t){Fe(this.g,new bf(t))};Gn.prototype.va=function(t){Fe(this.g,new _f)};Gn.prototype.ua=function(){Fe(this.g,"b")};Ps.prototype.createWebChannel=Ps.prototype.g;lt.prototype.send=lt.prototype.u;lt.prototype.open=lt.prototype.m;lt.prototype.close=lt.prototype.close;si.NO_ERROR=0;si.TIMEOUT=8;si.HTTP_ERROR=6;Uh.COMPLETE="complete";$h.EventType=Fr;Fr.OPEN="a";Fr.CLOSE="b";Fr.ERROR="c";Fr.MESSAGE="d";xe.prototype.listen=xe.prototype.N;Ee.prototype.listenOnce=Ee.prototype.O;Ee.prototype.getLastError=Ee.prototype.La;Ee.prototype.getLastErrorCode=Ee.prototype.Da;Ee.prototype.getStatus=Ee.prototype.ba;Ee.prototype.getResponseJson=Ee.prototype.Qa;Ee.prototype.getResponseText=Ee.prototype.ga;Ee.prototype.send=Ee.prototype.ea;var ay=function(){return new Ps},ly=function(){return ri()},no=si,cy=Uh,uy=mn,ec={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},hy=Vr,cs=$h,fy=Ee;const tc="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ye.UNAUTHENTICATED=new Ye(null),Ye.GOOGLE_CREDENTIALS=new Ye("google-credentials-uid"),Ye.FIRST_PARTY=new Ye("first-party-uid"),Ye.MOCK_USER=new Ye("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kn="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un=new zo("@firebase/firestore");function nc(){return un.logLevel}function B(t,...e){if(un.logLevel<=re.DEBUG){const n=e.map(_a);un.debug(`Firestore (${Kn}): ${t}`,...n)}}function Vt(t,...e){if(un.logLevel<=re.ERROR){const n=e.map(_a);un.error(`Firestore (${Kn}): ${t}`,...n)}}function rc(t,...e){if(un.logLevel<=re.WARN){const n=e.map(_a);un.warn(`Firestore (${Kn}): ${t}`,...n)}}function _a(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(t="Unexpected state"){const e=`FIRESTORE (${Kn}) INTERNAL ASSERTION FAILED: `+t;throw Vt(e),new Error(e)}function ue(t,e){t||H()}function G(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends qn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class py{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ye.UNAUTHENTICATED))}shutdown(){}}class gy{constructor(e){this.t=e,this.currentUser=Ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new Ft;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ft,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{B("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ft)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string"),new dy(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string"),new Ye(e)}}class my{constructor(e,n,r){this.type="FirstParty",this.user=Ye.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const s=e.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class yy{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new my(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(Ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wy{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const r=i=>{i.error!=null&&B("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,B("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{B("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?s(i):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ue(typeof n.token=="string"),this.p=n.token,new vy(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=by(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function se(t,e){return t<e?-1:t>e?1:0}function Mn(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new U(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new U(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new U(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ce.fromMillis(Date.now())}static fromDate(e){return Ce.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ce(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Q(e)}static min(){return new Q(new Ce(0,0))}static max(){return new Q(new Ce(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,n,r){n===void 0?n=0:n>e.length&&H(),r===void 0?r=e.length-n:r>e.length-n&&H(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Cr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Cr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class fe extends Cr{construct(e,n,r){return new fe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new U(x.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new fe(n)}static emptyPath(){return new fe([])}}const _y=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ue extends Cr{construct(e,n,r){return new Ue(e,n,r)}static isValidIdentifier(e){return _y.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ue.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ue(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new U(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new U(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new U(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new U(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ue(n)}static emptyPath(){return new Ue([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.path=e}static fromPath(e){return new j(fe.fromString(e))}static fromName(e){return new j(fe.fromString(e).popFirst(5))}static empty(){return new j(fe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&fe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return fe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new j(new fe(e.slice()))}}function Ey(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Q.fromTimestamp(r===1e9?new Ce(n+1,0):new Ce(n,r));return new Ut(s,j.empty(),e)}function ky(t){return new Ut(t.readTime,t.key,-1)}class Ut{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ut(Q.min(),j.empty(),-1)}static max(){return new Ut(Q.max(),j.empty(),-1)}}function Ty(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=j.comparator(t.documentKey,e.documentKey),n!==0?n:se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Cy{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qr(t){if(t.code!==x.FAILED_PRECONDITION||t.message!==Iy)throw t;B("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new M((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof M?n:M.resolve(n)}catch(n){return M.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):M.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):M.reject(n)}static resolve(e){return new M((n,r)=>{n(e)})}static reject(e){return new M((n,r)=>{r(e)})}static waitFor(e){return new M((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=M.resolve(!1);for(const r of e)n=n.next(s=>s?M.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new M((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new M((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function zr(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.it(r),this.rt=r=>n.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sc(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function yn(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function kf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ea.ot=-1;class Ae{constructor(e,n){this.comparator=e,this.root=n||Le.EMPTY}insert(e,n){return new Ae(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Le.BLACK,null,null))}remove(e){return new Ae(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Le.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new us(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new us(this.root,e,this.comparator,!1)}getReverseIterator(){return new us(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new us(this.root,e,this.comparator,!0)}}class us{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Le{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Le.RED,this.left=s!=null?s:Le.EMPTY,this.right=i!=null?i:Le.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Le(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Le.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Le.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Le.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Le.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();const e=this.left.check();if(e!==this.right.check())throw H();return e+(this.isRed()?0:1)}}Le.EMPTY=null,Le.RED=!0,Le.BLACK=!1;Le.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(t,e,n,r,s){return this}insert(t,e,n){return new Le(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ic(this.data.getIterator())}getIteratorFrom(e){return new ic(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Se)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Se(this.comparator);return n.data=e,n}}class ic{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.fields=e,e.sort(Ue.comparator)}static empty(){return new ft([])}unionWith(e){let n=new Se(Ue.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ft(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Mn(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new Be(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new Be(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Be.EMPTY_BYTE_STRING=new Be("");const Sy=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $t(t){if(ue(!!t),typeof t=="string"){let e=0;const n=Sy.exec(t);if(ue(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:we(t.seconds),nanos:we(t.nanos)}}function we(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ln(t){return typeof t=="string"?Be.fromBase64String(t):Be.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function If(t){const e=t.mapValue.fields.__previous_value__;return Tf(e)?If(e):e}function Sr(t){const e=$t(t.mapValue.fields.__local_write_time__.timestampValue);return new Ce(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,n,r,s,i,o,a,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class On{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new On("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof On&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(t){return t==null}function Fs(t){return t===0&&1/t==-1/0}function Dy(t){return typeof t=="number"&&Number.isInteger(t)&&!Fs(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function hn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Tf(t)?4:Ry(t)?9007199254740991:10:H()}function bt(t,e){if(t===e)return!0;const n=hn(t);if(n!==hn(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Sr(t).isEqual(Sr(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=$t(r.timestampValue),o=$t(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return Ln(r.bytesValue).isEqual(Ln(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return we(r.geoPointValue.latitude)===we(s.geoPointValue.latitude)&&we(r.geoPointValue.longitude)===we(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return we(r.integerValue)===we(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=we(r.doubleValue),o=we(s.doubleValue);return i===o?Fs(i)===Fs(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Mn(t.arrayValue.values||[],e.arrayValue.values||[],bt);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(sc(i)!==sc(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!bt(i[a],o[a])))return!1;return!0}(t,e);default:return H()}}function Ar(t,e){return(t.values||[]).find(n=>bt(n,e))!==void 0}function Pn(t,e){if(t===e)return 0;const n=hn(t),r=hn(e);if(n!==r)return se(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return se(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=we(s.integerValue||s.doubleValue),a=we(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return oc(t.timestampValue,e.timestampValue);case 4:return oc(Sr(t),Sr(e));case 5:return se(t.stringValue,e.stringValue);case 6:return function(s,i){const o=Ln(s),a=Ln(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=se(o[l],a[l]);if(c!==0)return c}return se(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=se(we(s.latitude),we(i.latitude));return o!==0?o:se(we(s.longitude),we(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=Pn(o[l],a[l]);if(c)return c}return se(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===hs.mapValue&&i===hs.mapValue)return 0;if(s===hs.mapValue)return 1;if(i===hs.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),l=i.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let u=0;u<a.length&&u<c.length;++u){const f=se(a[u],c[u]);if(f!==0)return f;const p=Pn(o[a[u]],l[c[u]]);if(p!==0)return p}return se(a.length,c.length)}(t.mapValue,e.mapValue);default:throw H()}}function oc(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return se(t,e);const n=$t(t),r=$t(e),s=se(n.seconds,r.seconds);return s!==0?s:se(n.nanos,r.nanos)}function Sn(t){return Ao(t)}function Ao(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=$t(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ln(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,j.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=Ao(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${Ao(r.fields[a])}`;return i+"}"}(t.mapValue):H();var e,n}function Do(t){return!!t&&"integerValue"in t}function ka(t){return!!t&&"arrayValue"in t}function ac(t){return!!t&&"nullValue"in t}function lc(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function bs(t){return!!t&&"mapValue"in t}function gr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return yn(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=gr(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=gr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ry(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.value=e}static empty(){return new Je({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!bs(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=gr(n)}setAll(e){let n=Ue.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=gr(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());bs(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return bt(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];bs(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){yn(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Je(gr(this.value))}}function Cf(t){const e=[];return yn(t.fields,(n,r)=>{const s=new Ue([n]);if(bs(r)){const i=Cf(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ft(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e,n,r,s,i,o){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Oe(e,0,Q.min(),Q.min(),Je.empty(),0)}static newFoundDocument(e,n,r){return new Oe(e,1,n,Q.min(),r,0)}static newNoDocument(e,n){return new Oe(e,2,n,Q.min(),Je.empty(),0)}static newUnknownDocument(e,n){return new Oe(e,3,n,Q.min(),Je.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Je.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Oe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Oe(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function cc(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Ny(t,e,n,r,s,i,o)}function Ta(t){const e=G(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+Sn(s.value);var s}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),fi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Sn(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Sn(r)).join(",")),e.ut=n}return e.ut}function xy(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${Sn(r.value)}`;var r}).join(", ")}]`),fi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>Sn(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>Sn(n)).join(",")),`Target(${e})`}function Ia(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!Vy(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],r=e.filters[s],n.op!==r.op||!n.field.isEqual(r.field)||!bt(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hc(t.startAt,e.startAt)&&hc(t.endAt,e.endAt)}function Ro(t){return j.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Ze extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,r):new My(e,n,r):n==="array-contains"?new Py(e,r):n==="in"?new Fy(e,r):n==="not-in"?new By(e,r):n==="array-contains-any"?new jy(e,r):new Ze(e,n,r)}static ct(e,n,r){return n==="in"?new Ly(e,r):new Oy(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(Pn(n,this.value)):n!==null&&hn(this.value)===hn(n)&&this.at(Pn(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class My extends Ze{constructor(e,n,r){super(e,n,r),this.key=j.fromName(r.referenceValue)}matches(e){const n=j.comparator(e.key,this.key);return this.at(n)}}class Ly extends Ze{constructor(e,n){super(e,"in",n),this.keys=Sf("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Oy extends Ze{constructor(e,n){super(e,"not-in",n),this.keys=Sf("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Sf(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>j.fromName(r.referenceValue))}class Py extends Ze{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ka(n)&&Ar(n.arrayValue,this.value)}}class Fy extends Ze{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ar(this.value.arrayValue,n)}}class By extends Ze{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ar(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ar(this.value.arrayValue,n)}}class jy extends Ze{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ka(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ar(this.value.arrayValue,r))}}class Bs{constructor(e,n){this.position=e,this.inclusive=n}}class mr{constructor(e,n="asc"){this.field=e,this.dir=n}}function Vy(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function uc(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=j.comparator(j.fromName(o.referenceValue),n.key):r=Pn(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function hc(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!bt(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.lt=null,this.ft=null,this.startAt,this.endAt}}function Uy(t,e,n,r,s,i,o,a){return new di(t,e,n,r,s,i,o,a)}function pi(t){return new di(t)}function $y(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function qy(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function zy(t){for(const e of t.filters)if(e.ht())return e.field;return null}function Hy(t){return t.collectionGroup!==null}function Dr(t){const e=G(t);if(e.lt===null){e.lt=[];const n=zy(e),r=qy(e);if(n!==null&&r===null)n.isKeyField()||e.lt.push(new mr(n)),e.lt.push(new mr(Ue.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new mr(Ue.keyField(),i))}}}return e.lt}function fn(t){const e=G(t);if(!e.ft)if(e.limitType==="F")e.ft=cc(e.path,e.collectionGroup,Dr(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Dr(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new mr(i.field,o))}const r=e.endAt?new Bs(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Bs(e.startAt.position,e.startAt.inclusive):null;e.ft=cc(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.ft}function Gy(t,e,n){return new di(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function gi(t,e){return Ia(fn(t),fn(e))&&t.limitType===e.limitType}function Af(t){return`${Ta(fn(t))}|lt:${t.limitType}`}function No(t){return`Query(target=${xy(fn(t))}; limitType=${t.limitType})`}function Ca(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):j.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of n.explicitOrderBy)if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=uc(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,Dr(n),r)||n.endAt&&!function(s,i,o){const a=uc(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,Dr(n),r))}(t,e)}function Ky(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Df(t){return(e,n)=>{let r=!1;for(const s of Dr(t)){const i=Qy(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Qy(t,e,n){const r=t.field.isKeyField()?j.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),l=o.data.field(s);return a!==null&&l!==null?Pn(a,l):H()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return H()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fs(e)?"-0":e}}function Nf(t){return{integerValue:""+t}}function Wy(t,e){return Dy(e)?Nf(e):Rf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(){this._=void 0}}function Xy(t,e,n){return t instanceof js?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof Fn?Mf(t,e):t instanceof Bn?Lf(t,e):function(r,s){const i=xf(r,s),o=fc(i)+fc(r._t);return Do(i)&&Do(r._t)?Nf(o):Rf(r.wt,o)}(t,e)}function Yy(t,e,n){return t instanceof Fn?Mf(t,e):t instanceof Bn?Lf(t,e):n}function xf(t,e){return t instanceof Vs?Do(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class js extends mi{}class Fn extends mi{constructor(e){super(),this.elements=e}}function Mf(t,e){const n=Of(e);for(const r of t.elements)n.some(s=>bt(s,r))||n.push(r);return{arrayValue:{values:n}}}class Bn extends mi{constructor(e){super(),this.elements=e}}function Lf(t,e){let n=Of(e);for(const r of t.elements)n=n.filter(s=>!bt(s,r));return{arrayValue:{values:n}}}class Vs extends mi{constructor(e,n){super(),this.wt=e,this._t=n}}function fc(t){return we(t.integerValue||t.doubleValue)}function Of(t){return ka(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,n){this.field=e,this.transform=n}}function Jy(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof Fn&&r instanceof Fn||n instanceof Bn&&r instanceof Bn?Mn(n.elements,r.elements,bt):n instanceof Vs&&r instanceof Vs?bt(n._t,r._t):n instanceof js&&r instanceof js}(t.transform,e.transform)}class Zy{constructor(e,n){this.version=e,this.transformResults=n}}class gt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gt}static exists(e){return new gt(void 0,e)}static updateTime(e){return new gt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _s(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class yi{}function Ff(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new jf(t.key,gt.none()):new Hr(t.key,t.data,gt.none());{const n=t.data,r=Je.empty();let s=new Se(Ue.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Gt(t.key,r,new ft(s.toArray()),gt.none())}}function ev(t,e,n){t instanceof Hr?function(r,s,i){const o=r.value.clone(),a=pc(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Gt?function(r,s,i){if(!_s(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=pc(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(Bf(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function yr(t,e,n,r){return t instanceof Hr?function(s,i,o,a){if(!_s(s.precondition,i))return o;const l=s.value.clone(),c=gc(s.fieldTransforms,a,i);return l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Gt?function(s,i,o,a){if(!_s(s.precondition,i))return o;const l=gc(s.fieldTransforms,a,i),c=i.data;return c.setAll(Bf(s)),c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(s,i,o){return _s(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function tv(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=xf(r.transform,s||null);i!=null&&(n===null&&(n=Je.empty()),n.set(r.field,i))}return n||null}function dc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Mn(n,r,(s,i)=>Jy(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Hr extends yi{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Gt extends yi{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Bf(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function pc(t,e,n){const r=new Map;ue(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,Yy(o,a,n[s]))}return r}function gc(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Xy(i,o,e))}return r}class jf extends yi{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nv extends yi{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ve,Y;function sv(t){switch(t){default:return H();case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0}}function Vf(t){if(t===void 0)return Vt("GRPC error has no .code"),x.UNKNOWN;switch(t){case ve.OK:return x.OK;case ve.CANCELLED:return x.CANCELLED;case ve.UNKNOWN:return x.UNKNOWN;case ve.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case ve.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case ve.INTERNAL:return x.INTERNAL;case ve.UNAVAILABLE:return x.UNAVAILABLE;case ve.UNAUTHENTICATED:return x.UNAUTHENTICATED;case ve.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case ve.NOT_FOUND:return x.NOT_FOUND;case ve.ALREADY_EXISTS:return x.ALREADY_EXISTS;case ve.PERMISSION_DENIED:return x.PERMISSION_DENIED;case ve.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case ve.ABORTED:return x.ABORTED;case ve.OUT_OF_RANGE:return x.OUT_OF_RANGE;case ve.UNIMPLEMENTED:return x.UNIMPLEMENTED;case ve.DATA_LOSS:return x.DATA_LOSS;default:return H()}}(Y=ve||(ve={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){yn(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return kf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iv=new Ae(j.comparator);function At(){return iv}const Uf=new Ae(j.comparator);function cr(...t){let e=Uf;for(const n of t)e=e.insert(n.key,n);return e}function $f(t){let e=Uf;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function en(){return vr()}function qf(){return vr()}function vr(){return new Qn(t=>t.toString(),(t,e)=>t.isEqual(e))}const ov=new Ae(j.comparator),av=new Se(j.comparator);function X(...t){let e=av;for(const n of t)e=e.add(n);return e}const lv=new Se(se);function zf(){return lv}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,Gr.createSynthesizedTargetChangeForCurrentChange(e,n)),new vi(Q.min(),r,zf(),At(),X())}}class Gr{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Gr(Be.EMPTY_BYTE_STRING,n,X(),X(),X())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,n,r,s){this.gt=e,this.removedTargetIds=n,this.key=r,this.yt=s}}class Hf{constructor(e,n){this.targetId=e,this.It=n}}class Gf{constructor(e,n,r=Be.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class mc{constructor(){this.Tt=0,this.Et=vc(),this.At=Be.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=X(),n=X(),r=X();return this.Et.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:H()}}),new Gr(this.At,this.Rt,e,n,r)}Dt(){this.bt=!1,this.Et=vc()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class cv{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=At(),this.Bt=yc(),this.Lt=new Se(se)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const r=this.Qt(n);switch(e.state){case 0:this.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),r.Vt(e.resumeToken));break;default:H()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((r,s)=>{this.jt(s)&&n(s)})}zt(e){const n=e.targetId,r=e.It.count,s=this.Ht(n);if(s){const i=s.target;if(Ro(i))if(r===0){const o=new j(i.path);this.Kt(n,o,Oe.newNoDocument(o,Q.min()))}else ue(r===1);else this.Jt(n)!==r&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&Ro(a.target)){const l=new j(a.target.path);this.$t.get(l)!==null||this.Xt(o,l)||this.Kt(o,l,Oe.newNoDocument(l,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let r=X();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Ht(l);return!c||c.purpose===2||(a=!1,!1)}),a&&(r=r.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const s=new vi(e,n,this.Lt,this.$t,r);return this.$t=At(),this.Bt=yc(),this.Lt=new Se(se),s}qt(e,n){if(!this.jt(e))return;const r=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,r),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,r){if(!this.jt(e))return;const s=this.Qt(e);this.Xt(e,n)?s.Ct(n,1):s.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),r&&(this.$t=this.$t.insert(n,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new mc,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new Se(se),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||B("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new mc),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function yc(){return new Ae(j.comparator)}function vc(){return new Ae(j.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),hv=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class fv{constructor(e,n){this.databaseId=e,this.dt=n}}function Us(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kf(t,e){return t.dt?e.toBase64():e.toUint8Array()}function dv(t,e){return Us(t,e.toTimestamp())}function Tt(t){return ue(!!t),Q.fromTimestamp(function(e){const n=$t(e);return new Ce(n.seconds,n.nanos)}(t))}function Sa(t,e){return function(n){return new fe(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function Qf(t){const e=fe.fromString(t);return ue(Yf(e)),e}function xo(t,e){return Sa(t.databaseId,e.path)}function ro(t,e){const n=Qf(e);if(n.get(1)!==t.databaseId.projectId)throw new U(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new U(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new j(Wf(n))}function Mo(t,e){return Sa(t.databaseId,e)}function pv(t){const e=Qf(t);return e.length===4?fe.emptyPath():Wf(e)}function Lo(t){return new fe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Wf(t){return ue(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function wc(t,e,n){return{name:xo(t,e),fields:n.value.mapValue.fields}}function gv(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:H()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,c){return l.dt?(ue(c===void 0||typeof c=="string"),Be.fromBase64String(c||"")):(ue(c===void 0||c instanceof Uint8Array),Be.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?x.UNKNOWN:Vf(l.code);return new U(c,l.message||"")}(o);n=new Gf(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ro(t,r.document.name),i=Tt(r.document.updateTime),o=new Je({mapValue:{fields:r.document.fields}}),a=Oe.newFoundDocument(s,i,o),l=r.targetIds||[],c=r.removedTargetIds||[];n=new Es(l,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ro(t,r.document),i=r.readTime?Tt(r.readTime):Q.min(),o=Oe.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Es([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ro(t,r.document),i=r.removedTargetIds||[];n=new Es([],i,s,null)}else{if(!("filter"in e))return H();{e.filter;const r=e.filter;r.targetId;const s=r.count||0,i=new rv(s),o=r.targetId;n=new Hf(o,i)}}return n}function mv(t,e){let n;if(e instanceof Hr)n={update:wc(t,e.key,e.value)};else if(e instanceof jf)n={delete:xo(t,e.key)};else if(e instanceof Gt)n={update:wc(t,e.key,e.data),updateMask:Cv(e.fieldMask)};else{if(!(e instanceof nv))return H();n={verify:xo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof js)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Fn)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Bn)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Vs)return{fieldPath:i.field.canonicalString(),increment:o._t};throw H()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:dv(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:H()}(t,e.precondition)),n}function yv(t,e){return t&&t.length>0?(ue(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?Tt(r.updateTime):Tt(s);return i.isEqual(Q.min())&&(i=Tt(s)),new Zy(i,r.transformResults||[])}(n,e))):[]}function vv(t,e){return{documents:[Mo(t,e.path)]}}function wv(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Mo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Mo(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(l){if(l.length===0)return;const c=l.map(u=>function(f){if(f.op==="=="){if(lc(f.value))return{unaryFilter:{field:kn(f.field),op:"IS_NAN"}};if(ac(f.value))return{unaryFilter:{field:kn(f.field),op:"IS_NULL"}}}else if(f.op==="!="){if(lc(f.value))return{unaryFilter:{field:kn(f.field),op:"IS_NOT_NAN"}};if(ac(f.value))return{unaryFilter:{field:kn(f.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:kn(f.field),op:kv(f.op),value:f.value}}}(u));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(e.filters);s&&(n.structuredQuery.where=s);const i=function(l){if(l.length!==0)return l.map(c=>function(u){return{field:kn(u.field),direction:Ev(u.dir)}}(c))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(l,c){return l.dt||fi(c)?c:{value:c}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function bv(t){let e=pv(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ue(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=Xf(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(f){return new mr(Cn(f.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(f.direction))}(u)));let a=null;n.limit&&(a=function(u){let f;return f=typeof u=="object"?u.value:u,fi(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(u){const f=!!u.before,p=u.values||[];return new Bs(p,f)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const f=!u.before,p=u.values||[];return new Bs(p,f)}(n.endAt)),Uy(e,s,o,i,a,"F",l,c)}function _v(t,e){const n=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return H()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function Xf(t){return t?t.unaryFilter!==void 0?[Iv(t)]:t.fieldFilter!==void 0?[Tv(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>Xf(e)).reduce((e,n)=>e.concat(n)):H():[]}function Ev(t){return uv[t]}function kv(t){return hv[t]}function kn(t){return{fieldPath:t.canonicalString()}}function Cn(t){return Ue.fromServerFormat(t.fieldPath)}function Tv(t){return Ze.create(Cn(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(t.fieldFilter.op),t.fieldFilter.value)}function Iv(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Cn(t.unaryFilter.field);return Ze.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Cn(t.unaryFilter.field);return Ze.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Cn(t.unaryFilter.field);return Ze.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Cn(t.unaryFilter.field);return Ze.create(s,"!=",{nullValue:"NULL_VALUE"});default:return H()}}function Cv(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Yf(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&ev(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=yr(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=yr(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=qf();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=Ff(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(Q.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),X())}isEqual(e){return this.batchId===e.batchId&&Mn(this.mutations,e.mutations,(n,r)=>dc(n,r))&&Mn(this.baseMutations,e.baseMutations,(n,r)=>dc(n,r))}}class Aa{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ue(e.mutations.length===r.length);let s=ov;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Aa(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,n,r,s,i=Q.min(),o=Q.min(),a=Be.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new rn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new rn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new rn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e){this.ne=e}}function Rv(t){const e=bv({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gy(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(){this.ze=new xv}addToCollectionParentIndex(e,n){return this.ze.add(n),M.resolve()}getCollectionParents(e,n){return M.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return M.resolve()}deleteFieldIndex(e,n){return M.resolve()}getDocumentsMatchingTarget(e,n){return M.resolve(null)}getIndexType(e,n){return M.resolve(0)}getFieldIndexes(e,n){return M.resolve([])}getNextCollectionGroupToUpdate(e){return M.resolve(null)}getMinOffset(e,n){return M.resolve(Ut.min())}getMinOffsetFromCollectionGroup(e,n){return M.resolve(Ut.min())}updateCollectionGroup(e,n,r){return M.resolve()}updateIndexEntries(e,n){return M.resolve()}}class xv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Se(fe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Se(fe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new jn(0)}static Rn(){return new jn(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(){this.changes=new Qn(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Oe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?M.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.getBaseDocument(e,n,r))).next(s=>(r!==null&&yr(r.mutation,s,ft.empty(),Ce.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,X()).next(()=>r))}getLocalViewOfDocuments(e,n,r=X()){const s=en();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=cr();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=en();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,X()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=At();const o=vr(),a=vr();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Gt)?i=i.insert(c.key,c):u!==void 0&&(o.set(c.key,u.mutation.getFieldMask()),yr(u.mutation,c,u.mutation.getFieldMask(),Ce.now()))}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var f;return a.set(c,new Lv(u,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=vr();let s=new Ae((o,a)=>o-a),i=X();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||ft.empty();u=a.applyToLocalView(c,u),r.set(l,u);const f=(s.get(a.batchId)||X()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,f=qf();u.forEach(p=>{if(!i.has(p)){const d=Ff(n.get(p),r.get(p));d!==null&&f.set(p,d),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return M.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return j.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Hy(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):M.resolve(en());let a=-1,l=i;return o.next(c=>M.forEach(c,(u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(u)?M.resolve():this.getBaseDocument(e,u,f).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,X())).next(u=>({batchId:a,changes:$f(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new j(n)).next(r=>{let s=cr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=cr();return this.indexManager.getCollectionParents(e,s).next(o=>M.forEach(o,a=>{const l=function(c,u){return new di(u,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(c=>{c.forEach((u,f)=>{i=i.insert(u,f)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(i=>{i.forEach((a,l)=>{const c=l.getKey();s.get(c)===null&&(s=s.insert(c,Oe.newInvalidDocument(c)))});let o=cr();return s.forEach((a,l)=>{const c=i.get(a);c!==void 0&&yr(c.mutation,l,ft.empty(),Ce.now()),Ca(n,l)&&(o=o.insert(a,l))}),o})}getBaseDocument(e,n,r){return r===null||r.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):M.resolve(Oe.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return M.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var r;return this.Jn.set(n.id,{id:(r=n).id,version:r.version,createTime:Tt(r.createTime)}),M.resolve()}getNamedQuery(e,n){return M.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(r){return{name:r.name,query:Rv(r.bundledQuery),readTime:Tt(r.readTime)}}(n)),M.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(){this.overlays=new Ae(j.comparator),this.Xn=new Map}getOverlay(e,n){return M.resolve(this.overlays.get(n))}getOverlays(e,n){const r=en();return M.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ie(e,n,i)}),M.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Xn.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(r)),M.resolve()}getOverlaysForCollection(e,n,r){const s=en(),i=n.length+1,o=new j(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return M.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ae((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=en(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=en(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return M.resolve(a)}ie(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Xn.get(s.largestBatchId).delete(r.key);this.Xn.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Av(n,r));let i=this.Xn.get(n);i===void 0&&(i=X(),this.Xn.set(n,i)),this.Xn.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(){this.Zn=new Se(Re.ts),this.es=new Se(Re.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const r=new Re(e,n);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.rs(new Re(e,n))}os(e,n){e.forEach(r=>this.removeReference(r,n))}us(e){const n=new j(new fe([])),r=new Re(n,e),s=new Re(n,e+1),i=[];return this.es.forEachInRange([r,s],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new j(new fe([])),r=new Re(n,e),s=new Re(n,e+1);let i=X();return this.es.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Re(e,0),r=this.Zn.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Re{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return j.comparator(e.key,n.key)||se(e.ls,n.ls)}static ns(e,n){return se(e.ls,n.ls)||j.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new Se(Re.ts)}checkEmpty(e){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Sv(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.ds=this.ds.add(new Re(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return M.resolve(o)}lookupMutationBatch(e,n){return M.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ws(r),i=s<0?0:s;return M.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Re(n,0),s=new Re(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([r,s],o=>{const a=this._s(o.ls);i.push(a)}),M.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(se);return n.forEach(s=>{const i=new Re(s,0),o=new Re(s,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{r=r.add(a.ls)})}),M.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;j.isDocumentKey(i)||(i=i.child(""));const o=new Re(new j(i),0);let a=new Se(se);return this.ds.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.ls)),!0)},o),M.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(r=>{const s=this._s(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ue(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.ds;return M.forEach(n.mutations,s=>{const i=new Re(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,n){const r=new Re(n,0),s=this.ds.firstAfterOrEqual(r);return M.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,M.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e){this.ps=e,this.docs=new Ae(j.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ps(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return M.resolve(r?r.document.mutableCopy():Oe.newInvalidDocument(n))}getEntries(e,n){let r=At();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Oe.newInvalidDocument(s))}),M.resolve(r)}getAllFromCollection(e,n,r){let s=At();const i=new j(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:l}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||Ty(ky(l),r)<=0||(s=s.insert(l.key,l.mutableCopy()))}return M.resolve(s)}getAllFromCollectionGroup(e,n,r,s){H()}Is(e,n){return M.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Vv(this)}getSize(e){return M.resolve(this.size)}}class Vv extends Mv{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.zn.addEntry(e,s)):this.zn.removeEntry(r)}),M.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e){this.persistence=e,this.Ts=new Qn(n=>Ta(n),Ia),this.lastRemoteSnapshotVersion=Q.min(),this.highestTargetId=0,this.Es=0,this.As=new Da,this.targetCount=0,this.Rs=jn.An()}forEachTarget(e,n){return this.Ts.forEach((r,s)=>n(s)),M.resolve()}getLastRemoteSnapshotVersion(e){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return M.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Es&&(this.Es=n),M.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new jn(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,M.resolve()}updateTargetData(e,n){return this.vn(n),M.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,M.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),M.waitFor(i).next(()=>s)}getTargetCount(e){return M.resolve(this.targetCount)}getTargetData(e,n){const r=this.Ts.get(n)||null;return M.resolve(r)}addMatchingKeys(e,n,r){return this.As.ss(n,r),M.resolve()}removeMatchingKeys(e,n,r){this.As.os(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),M.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),M.resolve()}getMatchingKeysForTargetId(e,n){const r=this.As.hs(n);return M.resolve(r)}containsKey(e,n){return M.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e,n){this.bs={},this.overlays={},this.Ps=new Ea(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new Uv(this),this.indexManager=new Nv,this.remoteDocumentCache=function(r){return new jv(r)}(r=>this.referenceDelegate.Ss(r)),this.wt=new Dv(n),this.Ds=new Pv(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Fv,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.bs[e.toKey()];return r||(r=new Bv(n,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,r){B("MemoryPersistence","Starting transaction:",e);const s=new qv(this.Ps.next());return this.referenceDelegate.Cs(),r(s).next(i=>this.referenceDelegate.xs(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ns(e,n){return M.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,n)))}}class qv extends Cy{constructor(e){super(),this.currentSequenceNumber=e}}class Ra{constructor(e){this.persistence=e,this.ks=new Da,this.Os=null}static Ms(e){return new Ra(e)}get Fs(){if(this.Os)return this.Os;throw H()}addReference(e,n,r){return this.ks.addReference(r,n),this.Fs.delete(r.toString()),M.resolve()}removeReference(e,n,r){return this.ks.removeReference(r,n),this.Fs.add(r.toString()),M.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),M.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(s=>this.Fs.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Fs.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.Fs,r=>{const s=j.fromPath(r);return this.$s(e,s).next(i=>{i||n.removeEntry(s,Q.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(r=>{r?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return M.or([()=>M.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Pi=r,this.vi=s}static Vi(e,n){let r=X(),s=X();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Na(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ci(e,n).next(i=>i||this.xi(e,n,s,r)).next(i=>i||this.Ni(e,n))}Ci(e,n){return M.resolve(null)}xi(e,n,r,s){return $y(n)||s.isEqual(Q.min())?this.Ni(e,n):this.Di.getDocuments(e,r).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,r,s)?this.Ni(e,n):(nc()<=re.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),No(n)),this.Mi(e,o,n,Ey(s,-1)))})}ki(e,n){let r=new Se(Df(e));return n.forEach((s,i)=>{Ca(e,i)&&(r=r.add(i))}),r}Oi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ni(e,n){return nc()<=re.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",No(n)),this.Di.getDocumentsMatchingQuery(e,n,Ut.min())}Mi(e,n,r,s){return this.Di.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n,r,s){this.persistence=e,this.Fi=n,this.wt=s,this.$i=new Ae(se),this.Bi=new Qn(i=>Ta(i),Ia),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ov(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function Gv(t,e,n,r){return new Hv(t,e,n,r)}async function Jf(t,e){const n=G(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.qi(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=X();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Ki:c,removedBatchIds:o,addedBatchIds:a}))})})}function Kv(t,e){const n=G(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const u=l.batch,f=u.keys();let p=M.resolve();return f.forEach(d=>{p=p.next(()=>c.getEntry(a,d)).next(h=>{const m=l.docVersions.get(d);ue(m!==null),h.version.compareTo(m)<0&&(u.applyToRemoteDocument(h,l),h.isValidDocument()&&(h.setReadTime(l.commitVersion),c.addEntry(h)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=X();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Zf(t){const e=G(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function Qv(t,e){const n=G(t),r=e.snapshotVersion;let s=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});s=n.$i;const a=[];e.targetChanges.forEach((u,f)=>{const p=s.get(f);if(!p)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,f).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,f)));let d=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(f)?d=d.withResumeToken(Be.EMPTY_BYTE_STRING,Q.min()).withLastLimboFreeSnapshotVersion(Q.min()):u.resumeToken.approximateByteSize()>0&&(d=d.withResumeToken(u.resumeToken,r)),s=s.insert(f,d),function(h,m,v){return h.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-h.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(p,d,u)&&a.push(n.Vs.updateTargetData(i,d))});let l=At(),c=X();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(Wv(i,o,e.documentUpdates).next(u=>{l=u.Gi,c=u.Qi})),!r.isEqual(Q.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(f=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return M.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.$i=s,i))}function Wv(t,e,n){let r=X(),s=X();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=At();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(Q.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):B("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Gi:o,Qi:s}})}function Xv(t,e){const n=G(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Yv(t,e){const n=G(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Vs.getTargetData(r,e).next(i=>i?(s=i,M.resolve(s)):n.Vs.allocateTargetId(r).next(o=>(s=new rn(e,o,0,r.currentSequenceNumber),n.Vs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.$i.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.$i=n.$i.insert(r.targetId,r),n.Bi.set(e,r.targetId)),r})}async function Oo(t,e,n){const r=G(t),s=r.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!zr(o))throw o;B("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.$i=r.$i.remove(e),r.Bi.delete(s.target)}function bc(t,e,n){const r=G(t);let s=Q.min(),i=X();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const u=G(a),f=u.Bi.get(c);return f!==void 0?M.resolve(u.$i.get(f)):u.Vs.getTargetData(l,c)}(r,o,fn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fi.getDocumentsMatchingQuery(o,e,n?s:Q.min(),n?i:X())).next(a=>(Jv(r,Ky(e),a),{documents:a,ji:i})))}function Jv(t,e,n){let r=Q.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Li.set(e,r)}class _c{constructor(){this.activeTargetIds=zf()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zv{constructor(){this.Fr=new _c,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,r){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new _c,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){B("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){B("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,r,s,i){const o=this.oo(e,n);B("RestConnection","Sending: ",o,r);const a={};return this.uo(a,s,i),this.co(e,o,a,r).then(l=>(B("RestConnection","Received: ",l),l),l=>{throw rc("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",r),l})}ao(e,n,r,s,i,o){return this.ro(e,n,r,s,i)}uo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Kn,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}oo(e,n){const r=t1[e];return`${this.so}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,r,s){return new Promise((i,o)=>{const a=new fy;a.listenOnce(cy.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case no.NO_ERROR:const c=a.getResponseJson();B("Connection","XHR received:",JSON.stringify(c)),i(c);break;case no.TIMEOUT:B("Connection",'RPC "'+e+'" timed out'),o(new U(x.DEADLINE_EXCEEDED,"Request time out"));break;case no.HTTP_ERROR:const u=a.getStatus();if(B("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const f=a.getResponseJson().error;if(f&&f.status&&f.message){const p=function(d){const h=d.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(h)>=0?h:x.UNKNOWN}(f.status);o(new U(p,f.message))}else o(new U(x.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new U(x.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{B("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(s);a.send(n,"POST",l,r,15)})}ho(e,n,r){const s=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=ay(),o=ly(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new hy({})),this.uo(a.initMessageHeaders,n,r),kp()||Tp()||Ip()||Cp()||Sp()||$u()||(a.httpHeadersOverwriteParam="$httpHeaders");const l=s.join("");B("Connection","Creating WebChannel: "+l,a);const c=i.createWebChannel(l,a);let u=!1,f=!1;const p=new n1({jr:h=>{f?B("Connection","Not sending because WebChannel is closed:",h):(u||(B("Connection","Opening WebChannel transport."),c.open(),u=!0),B("Connection","WebChannel sending:",h),c.send(h))},Wr:()=>c.close()}),d=(h,m,v)=>{h.listen(m,g=>{try{v(g)}catch(w){setTimeout(()=>{throw w},0)}})};return d(c,cs.EventType.OPEN,()=>{f||B("Connection","WebChannel transport opened.")}),d(c,cs.EventType.CLOSE,()=>{f||(f=!0,B("Connection","WebChannel transport closed"),p.eo())}),d(c,cs.EventType.ERROR,h=>{f||(f=!0,rc("Connection","WebChannel transport errored:",h),p.eo(new U(x.UNAVAILABLE,"The operation could not be completed")))}),d(c,cs.EventType.MESSAGE,h=>{var m;if(!f){const v=h.data[0];ue(!!v);const g=v,w=g.error||((m=g[0])===null||m===void 0?void 0:m.error);if(w){B("Connection","WebChannel received error:",w);const E=w.status;let _=function(b){const C=ve[b];if(C!==void 0)return Vf(C)}(E),y=w.message;_===void 0&&(_=x.INTERNAL,y="Unknown error status: "+E+" with message "+w.message),f=!0,p.eo(new U(_,y)),c.close()}else B("Connection","WebChannel received:",v),p.no(v)}}),d(o,uy.STAT_EVENT,h=>{h.stat===ec.PROXY?B("Connection","Detected buffering proxy"):h.stat===ec.NOPROXY&&B("Connection","Detected no buffering proxy")}),setTimeout(()=>{p.Zr()},0),p}}function so(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(t){return new fv(t,!0)}class ed{constructor(e,n,r=1e3,s=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=r,this.fo=s,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),s=Math.max(0,n-r);s>0&&B("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,s,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,n,r,s,i,o,a,l){this.js=e,this.Ao=r,this.Ro=s,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new ed(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===x.RESOURCE_EXHAUSTED?(Vt(n.toString()),Vt("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Po===n&&this.Uo(r,s)},r=>{e(()=>{const s=new U(x.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(s)})})}Uo(e,n){const r=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(s=>{r(()=>this.qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return B("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(B("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class s1 extends td{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=gv(this.wt,e),r=function(s){if(!("targetChange"in s))return Q.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?Q.min():i.readTime?Tt(i.readTime):Q.min()}(e);return this.listener.Go(n,r)}Qo(e){const n={};n.database=Lo(this.wt),n.addTarget=function(s,i){let o;const a=i.target;return o=Ro(a)?{documents:vv(s,a)}:{query:wv(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=Kf(s,i.resumeToken):i.snapshotVersion.compareTo(Q.min())>0&&(o.readTime=Us(s,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const r=_v(this.wt,e);r&&(n.labels=r),this.Mo(n)}jo(e){const n={};n.database=Lo(this.wt),n.removeTarget=e,this.Mo(n)}}class i1 extends td{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=yv(e.writeResults,e.commitTime),r=Tt(e.commitTime);return this.listener.Jo(r,n)}return ue(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=Lo(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>mv(this.wt,r))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=r,this.wt=s,this.Zo=!1}tu(){if(this.Zo)throw new U(x.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.bo.ro(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new U(x.UNKNOWN,s.toString())})}ao(e,n,r,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new U(x.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class a1{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(Vt(n),this.su=!1):B("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{r.enqueueAndForget(async()=>{vn(this)&&(B("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=G(a);l.lu.add(4),await Kr(l),l._u.set("Unknown"),l.lu.delete(4),await bi(l)}(this))})}),this._u=new a1(r,s)}}async function bi(t){if(vn(t))for(const e of t.fu)await e(!0)}async function Kr(t){for(const e of t.fu)await e(!1)}function nd(t,e){const n=G(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),La(n)?Ma(n):Wn(n).Co()&&xa(n,e))}function rd(t,e){const n=G(t),r=Wn(n);n.hu.delete(e),r.Co()&&sd(n,e),n.hu.size===0&&(r.Co()?r.ko():vn(n)&&n._u.set("Unknown"))}function xa(t,e){t.wu.Nt(e.targetId),Wn(t).Qo(e)}function sd(t,e){t.wu.Nt(e),Wn(t).jo(e)}function Ma(t){t.wu=new cv({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),Wn(t).start(),t._u.iu()}function La(t){return vn(t)&&!Wn(t).Do()&&t.hu.size>0}function vn(t){return G(t).lu.size===0}function id(t){t.wu=void 0}async function c1(t){t.hu.forEach((e,n)=>{xa(t,e)})}async function u1(t,e){id(t),La(t)?(t._u.uu(e),Ma(t)):t._u.set("Unknown")}async function h1(t,e,n){if(t._u.set("Online"),e instanceof Gf&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.hu.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.hu.delete(o),r.wu.removeTarget(o))}(t,e)}catch(r){B("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await $s(t,r)}else if(e instanceof Es?t.wu.Ut(e):e instanceof Hf?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(Q.min()))try{const r=await Zf(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.wu.Yt(i);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=s.hu.get(l);c&&s.hu.set(l,c.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const l=s.hu.get(a);if(!l)return;s.hu.set(a,l.withResumeToken(Be.EMPTY_BYTE_STRING,l.snapshotVersion)),sd(s,a);const c=new rn(l.target,a,1,l.sequenceNumber);xa(s,c)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){B("RemoteStore","Failed to raise snapshot:",r),await $s(t,r)}}async function $s(t,e,n){if(!zr(e))throw e;t.lu.add(1),await Kr(t),t._u.set("Offline"),n||(n=()=>Zf(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{B("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await bi(t)})}function od(t,e){return e().catch(n=>$s(t,n,e))}async function _i(t){const e=G(t),n=qt(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;f1(e);)try{const s=await Xv(e.localStore,r);if(s===null){e.au.length===0&&n.ko();break}r=s.batchId,d1(e,s)}catch(s){await $s(e,s)}ad(e)&&ld(e)}function f1(t){return vn(t)&&t.au.length<10}function d1(t,e){t.au.push(e);const n=qt(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function ad(t){return vn(t)&&!qt(t).Do()&&t.au.length>0}function ld(t){qt(t).start()}async function p1(t){qt(t).Xo()}async function g1(t){const e=qt(t);for(const n of t.au)e.Ho(n.mutations)}async function m1(t,e,n){const r=t.au.shift(),s=Aa.from(r,e,n);await od(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await _i(t)}async function y1(t,e){e&&qt(t).zo&&await async function(n,r){if(s=r.code,sv(s)&&s!==x.ABORTED){const i=n.au.shift();qt(n).No(),await od(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await _i(n)}var s}(t,e),ad(t)&&ld(t)}async function kc(t,e){const n=G(t);n.asyncQueue.verifyOperationInProgress(),B("RemoteStore","RemoteStore received new credentials");const r=vn(n);n.lu.add(3),await Kr(n),r&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await bi(n)}async function v1(t,e){const n=G(t);e?(n.lu.delete(2),await bi(n)):e||(n.lu.add(2),await Kr(n),n._u.set("Unknown"))}function Wn(t){return t.mu||(t.mu=function(e,n,r){const s=G(e);return s.tu(),new s1(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:c1.bind(null,t),Jr:u1.bind(null,t),Go:h1.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),La(t)?Ma(t):t._u.set("Unknown")):(await t.mu.stop(),id(t))})),t.mu}function qt(t){return t.gu||(t.gu=function(e,n,r){const s=G(e);return s.tu(),new i1(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:p1.bind(null,t),Jr:y1.bind(null,t),Yo:g1.bind(null,t),Jo:m1.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await _i(t)):(await t.gu.stop(),t.au.length>0&&(B("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ft,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Oa(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pa(t,e){if(Vt("AsyncQueue",`${e}: ${t}`),zr(t))return new U(x.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.comparator=e?(n,r)=>e(n,r)||j.comparator(n.key,r.key):(n,r)=>j.comparator(n.key,r.key),this.keyedMap=cr(),this.sortedSet=new Ae(this.comparator)}static emptySet(e){return new An(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof An)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new An;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(){this.yu=new Ae(j.comparator)}track(e){const n=e.doc.key,r=this.yu.get(n);r?e.type!==0&&r.type===3?this.yu=this.yu.insert(n,e):e.type===3&&r.type!==1?this.yu=this.yu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.yu=this.yu.remove(n):e.type===1&&r.type===2?this.yu=this.yu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):H():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,r)=>{e.push(r)}),e}}class Vn{constructor(e,n,r,s,i,o,a,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(e,n,r,s){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Vn(e,n,An.emptySet(n),i,r,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(){this.Iu=void 0,this.listeners=[]}}class b1{constructor(){this.queries=new Qn(e=>Af(e),gi),this.onlineState="Unknown",this.Tu=new Set}}async function cd(t,e){const n=G(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new w1),s)try{i.Iu=await n.onListen(r)}catch(o){const a=Pa(o,`Initialization of query '${No(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&Fa(n)}async function ud(t,e){const n=G(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function _1(t,e){const n=G(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(s)&&(r=!0);o.Iu=s}}r&&Fa(n)}function E1(t,e,n){const r=G(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function Fa(t){t.Tu.forEach(e=>{e.next()})}class hd{constructor(e,n,r){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Vn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Du||!r)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Vn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e){this.key=e}}class dd{constructor(e){this.key=e}}class k1{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=X(),this.mutatedKeys=X(),this.Lu=Df(e),this.Uu=new An(this.Lu)}get qu(){return this.Fu}Ku(e,n){const r=n?n.Gu:new Tc,s=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,f)=>{const p=s.get(u),d=Ca(this.query,f)?f:null,h=!!p&&this.mutatedKeys.has(p.key),m=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let v=!1;p&&d?p.data.isEqual(d.data)?h!==m&&(r.track({type:3,doc:d}),v=!0):this.Qu(p,d)||(r.track({type:2,doc:d}),v=!0,(l&&this.Lu(d,l)>0||c&&this.Lu(d,c)<0)&&(a=!0)):!p&&d?(r.track({type:0,doc:d}),v=!0):p&&!d&&(r.track({type:1,doc:p}),v=!0,(l||c)&&(a=!0)),v&&(d?(o=o.add(d),i=m?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Uu:o,Gu:r,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((c,u)=>function(f,p){const d=h=>{switch(h){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return d(f)-d(p)}(c.type,u.type)||this.Lu(c.doc,u.doc)),this.ju(r);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,l=a!==this.$u;return this.$u=a,i.length!==0||l?{snapshot:new Vn(this.query,e.Uu,s,i,e.mutatedKeys,a===0,l,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new Tc,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=X(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const n=[];return e.forEach(r=>{this.Bu.has(r)||n.push(new dd(r))}),this.Bu.forEach(r=>{e.has(r)||n.push(new fd(r))}),n}Ju(e){this.Fu=e.ji,this.Bu=X();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Vn.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class T1{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class I1{constructor(e){this.key=e,this.Xu=!1}}class C1{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new Qn(a=>Af(a),gi),this.ec=new Map,this.nc=new Set,this.sc=new Ae(j.comparator),this.ic=new Map,this.rc=new Da,this.oc={},this.uc=new Map,this.cc=jn.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function S1(t,e){const n=F1(t);let r,s;const i=n.tc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Yu();else{const o=await Yv(n.localStore,fn(e));n.isPrimaryClient&&nd(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await A1(n,e,r,a==="current")}return s}async function A1(t,e,n,r){t.hc=(u,f,p)=>async function(d,h,m,v){let g=h.view.Ku(m);g.Oi&&(g=await bc(d.localStore,h.query,!1).then(({documents:_})=>h.view.Ku(_,g)));const w=v&&v.targetChanges.get(h.targetId),E=h.view.applyChanges(g,d.isPrimaryClient,w);return Cc(d,h.targetId,E.zu),E.snapshot}(t,u,f,p);const s=await bc(t.localStore,e,!0),i=new k1(e,s.ji),o=i.Ku(s.documents),a=Gr.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),l=i.applyChanges(o,t.isPrimaryClient,a);Cc(t,n,l.zu);const c=new T1(e,n,i);return t.tc.set(e,c),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),l.snapshot}async function D1(t,e){const n=G(t),r=n.tc.get(e),s=n.ec.get(r.targetId);if(s.length>1)return n.ec.set(r.targetId,s.filter(i=>!gi(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Oo(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),rd(n.remoteStore,r.targetId),Po(n,r.targetId)}).catch(qr)):(Po(n,r.targetId),await Oo(n.localStore,r.targetId,!0))}async function R1(t,e,n){const r=B1(t);try{const s=await function(i,o){const a=G(i),l=Ce.now(),c=o.reduce((p,d)=>p.add(d.key),X());let u,f;return a.persistence.runTransaction("Locally write mutations","readwrite",p=>{let d=At(),h=X();return a.Ui.getEntries(p,c).next(m=>{d=m,d.forEach((v,g)=>{g.isValidDocument()||(h=h.add(v))})}).next(()=>a.localDocuments.getOverlayedDocuments(p,d)).next(m=>{u=m;const v=[];for(const g of o){const w=tv(g,u.get(g.key).overlayedDocument);w!=null&&v.push(new Gt(g.key,w,Cf(w.value.mapValue),gt.exists(!0)))}return a.mutationQueue.addMutationBatch(p,l,v,o)}).next(m=>{f=m;const v=m.applyToLocalDocumentSet(u,h);return a.documentOverlayCache.saveOverlays(p,m.batchId,v)})}).then(()=>({batchId:f.batchId,changes:$f(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let l=i.oc[i.currentUser.toKey()];l||(l=new Ae(se)),l=l.insert(o,a),i.oc[i.currentUser.toKey()]=l}(r,s.batchId,n),await Qr(r,s.changes),await _i(r.remoteStore)}catch(s){const i=Pa(s,"Failed to persist write");n.reject(i)}}async function pd(t,e){const n=G(t);try{const r=await Qv(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.ic.get(i);o&&(ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Xu=!0:s.modifiedDocuments.size>0?ue(o.Xu):s.removedDocuments.size>0&&(ue(o.Xu),o.Xu=!1))}),await Qr(n,r,e)}catch(r){await qr(r)}}function Ic(t,e,n){const r=G(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=G(i);a.onlineState=o;let l=!1;a.queries.forEach((c,u)=>{for(const f of u.listeners)f.Eu(o)&&(l=!0)}),l&&Fa(a)}(r.eventManager,e),s.length&&r.Zu.Go(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function N1(t,e,n){const r=G(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.ic.get(e),i=s&&s.key;if(i){let o=new Ae(j.comparator);o=o.insert(i,Oe.newNoDocument(i,Q.min()));const a=X().add(i),l=new vi(Q.min(),new Map,new Se(se),o,a);await pd(r,l),r.sc=r.sc.remove(i),r.ic.delete(e),Ba(r)}else await Oo(r.localStore,e,!1).then(()=>Po(r,e,n)).catch(qr)}async function x1(t,e){const n=G(t),r=e.batch.batchId;try{const s=await Kv(n.localStore,e);md(n,r,null),gd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Qr(n,s)}catch(s){await qr(s)}}async function M1(t,e,n){const r=G(t);try{const s=await function(i,o){const a=G(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.mutationQueue.lookupMutationBatch(l,o).next(u=>(ue(u!==null),c=u.keys(),a.mutationQueue.removeMutationBatch(l,u))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>a.localDocuments.getDocuments(l,c))})}(r.localStore,e);md(r,e,n),gd(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Qr(r,s)}catch(s){await qr(s)}}function gd(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function md(t,e,n){const r=G(t);let s=r.oc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.oc[r.currentUser.toKey()]=s}}function Po(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ec.get(e))t.tc.delete(r),n&&t.Zu.lc(r,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(r=>{t.rc.containsKey(r)||yd(t,r)})}function yd(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(rd(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),Ba(t))}function Cc(t,e,n){for(const r of n)r instanceof fd?(t.rc.addReference(r.key,e),L1(t,r)):r instanceof dd?(B("SyncEngine","Document no longer in limbo: "+r.key),t.rc.removeReference(r.key,e),t.rc.containsKey(r.key)||yd(t,r.key)):H()}function L1(t,e){const n=e.key,r=n.path.canonicalString();t.sc.get(n)||t.nc.has(r)||(B("SyncEngine","New document in limbo: "+n),t.nc.add(r),Ba(t))}function Ba(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new j(fe.fromString(e)),r=t.cc.next();t.ic.set(r,new I1(n)),t.sc=t.sc.insert(n,r),nd(t.remoteStore,new rn(fn(pi(n.path)),r,2,Ea.ot))}}async function Qr(t,e,n){const r=G(t),s=[],i=[],o=[];r.tc.isEmpty()||(r.tc.forEach((a,l)=>{o.push(r.hc(l,e,n).then(c=>{if(c){r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c.fromCache?"not-current":"current"),s.push(c);const u=Na.Vi(l.targetId,c);i.push(u)}}))}),await Promise.all(o),r.Zu.Go(s),await async function(a,l){const c=G(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>M.forEach(l,f=>M.forEach(f.Pi,p=>c.persistence.referenceDelegate.addReference(u,f.targetId,p)).next(()=>M.forEach(f.vi,p=>c.persistence.referenceDelegate.removeReference(u,f.targetId,p)))))}catch(u){if(!zr(u))throw u;B("LocalStore","Failed to update sequence numbers: "+u)}for(const u of l){const f=u.targetId;if(!u.fromCache){const p=c.$i.get(f),d=p.snapshotVersion,h=p.withLastLimboFreeSnapshotVersion(d);c.$i=c.$i.insert(f,h)}}}(r.localStore,i))}async function O1(t,e){const n=G(t);if(!n.currentUser.isEqual(e)){B("SyncEngine","User change. New user:",e.toKey());const r=await Jf(n.localStore,e);n.currentUser=e,function(s,i){s.uc.forEach(o=>{o.forEach(a=>{a.reject(new U(x.CANCELLED,i))})}),s.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Qr(n,r.Ki)}}function P1(t,e){const n=G(t),r=n.ic.get(e);if(r&&r.Xu)return X().add(r.key);{let s=X();const i=n.ec.get(e);if(!i)return s;for(const o of i){const a=n.tc.get(o);s=s.unionWith(a.view.qu)}return s}}function F1(t){const e=G(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=pd.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=P1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=N1.bind(null,e),e.Zu.Go=_1.bind(null,e.eventManager),e.Zu.lc=E1.bind(null,e.eventManager),e}function B1(t){const e=G(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=x1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=M1.bind(null,e),e}class j1{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=wi(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return Gv(this.persistence,new zv,e.initialUser,this.wt)}_c(e){return new $v(Ra.Ms,this.wt)}dc(e){return new Zv}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class V1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ic(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=O1.bind(null,this.syncEngine),await v1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new b1}createDatastore(e){const n=wi(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new r1(s));var s;return function(i,o,a,l){return new o1(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>Ic(this.syncEngine,a,0),o=Ec.V()?new Ec:new e1,new l1(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,l,c){const u=new C1(r,s,i,o,a,l);return c&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=G(e);B("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await Kr(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ye.UNAUTHENTICATED,this.clientId=Ef.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{B("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(B("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new U(x.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ft;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Pa(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function $1(t,e){t.asyncQueue.verifyOperationInProgress(),B("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Jf(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function q1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await z1(t);B("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>kc(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>kc(e.remoteStore,i)),t.onlineComponents=e}async function z1(t){return t.offlineComponents||(B("FirestoreClient","Using default OfflineComponentProvider"),await $1(t,new j1)),t.offlineComponents}async function wd(t){return t.onlineComponents||(B("FirestoreClient","Using default OnlineComponentProvider"),await q1(t,new V1)),t.onlineComponents}function H1(t){return wd(t).then(e=>e.syncEngine)}async function Fo(t){const e=await wd(t),n=e.eventManager;return n.onListen=S1.bind(null,e.syncEngine),n.onUnlisten=D1.bind(null,e.syncEngine),n}function G1(t,e,n={}){const r=new Ft;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,l){const c=new vd({next:f=>{i.enqueueAndForget(()=>ud(s,u));const p=f.docs.has(o);!p&&f.fromCache?l.reject(new U(x.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&a&&a.source==="server"?l.reject(new U(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(f)},error:f=>l.reject(f)}),u=new hd(pi(o.path),c,{includeMetadataChanges:!0,Du:!0});return cd(s,u)}(await Fo(t),t.asyncQueue,e,n,r)),r.promise}const Sc=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(t,e,n){if(!n)throw new U(x.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function K1(t,e,n,r){if(e===!0&&r===!0)throw new U(x.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ac(t){if(!j.isDocumentKey(t))throw new U(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Dc(t){if(j.isDocumentKey(t))throw new U(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ja(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":H()}function wt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new U(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ja(t);throw new U(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new U(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new U(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,K1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,n,r){this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Rc({}),this._settingsFrozen=!1,e instanceof On?this._databaseId=e:(this._app=e,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new U(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new On(s.options.projectId)}(e))}get app(){if(!this._app)throw new U(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new U(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Rc(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new py;switch(n.type){case"gapi":const r=n.client;return ue(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new yy(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new U(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=Sc.get(e);n&&(B("ComponentProvider","Removing Datastore"),Sc.delete(e),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new We(this.firestore,e,this._key)}}class Ei{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ei(this.firestore,e,this._query)}}class Bt extends Ei{constructor(e,n,r){super(e,n,pi(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new We(this.firestore,null,new j(e))}withConverter(e){return new Bt(this.firestore,e,this._path)}}function Q1(t,e,...n){if(t=mt(t),bd("collection","path",e),t instanceof Va){const r=fe.fromString(e,...n);return Dc(r),new Bt(t,null,r)}{if(!(t instanceof We||t instanceof Bt))throw new U(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(fe.fromString(e,...n));return Dc(r),new Bt(t.firestore,null,r)}}function et(t,e,...n){if(t=mt(t),arguments.length===1&&(e=Ef.I()),bd("doc","path",e),t instanceof Va){const r=fe.fromString(e,...n);return Ac(r),new We(t,null,new j(r))}{if(!(t instanceof We||t instanceof Bt))throw new U(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(fe.fromString(e,...n));return Ac(r),new We(t.firestore,t instanceof Bt?t.converter:null,new j(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new ed(this,"async_queue_retry"),this.Kc=()=>{const n=so();n&&B("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=so();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=so();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new Ft;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!zr(e))throw e;B("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{this.Bc=r,this.Lc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw Vt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Lc=!1,r))));return this.Oc=n,n}enqueueAfterDelay(e,n,r){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const s=Oa.createAndSchedule(this,e,n,r,i=>this.Wc(i));return this.$c.push(s),s}Gc(){this.Bc&&H()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function Nc(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class dn extends Va{constructor(e,n,r){super(e,n,r),this.type="firestore",this._queue=new W1,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||_d(this),this._firestoreClient.terminate()}}function X1(t=Wu()){return Mr(t,"firestore").getImmediate()}function Ua(t){return t._firestoreClient||_d(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function _d(t){var e;const n=t._freezeSettings(),r=function(s,i,o,a){return new Ay(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new U1(t._authCredentials,t._appCheckCredentials,t._queue,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new U(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ue(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Un(Be.fromBase64String(e))}catch(n){throw new U(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Un(Be.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new U(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new U(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1=/^__.*__$/;class J1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Gt(e,this.data,this.fieldMask,n,this.fieldTransforms):new Hr(e,this.data,n,this.fieldTransforms)}}class Ed{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Gt(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function kd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H()}}class Ti{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Ti(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.sa(e),s}ia(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.Xc(),s}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return qs(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(kd(this.Zc)&&Y1.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class Z1{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=r||wi(e)}aa(e,n,r,s=!1){return new Ti({Zc:e,methodName:n,ca:r,path:Ue.emptyPath(),na:!1,ua:s},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function qa(t){const e=t._freezeSettings(),n=wi(t._databaseId);return new Z1(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Td(t,e,n,r,s,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,s);za("Data must be an object, but it was:",o,r);const a=Cd(r,o);let l,c;if(i.merge)l=new ft(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const f of i.mergeFields){const p=Bo(e,f,n);if(!o.contains(p))throw new U(x.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Ad(u,p)||u.push(p)}l=new ft(u),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new J1(new Je(a),l,c)}class Ii extends Wr{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ii}}function Id(t,e,n){return new Ti({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class ew extends Wr{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=Id(this,e,!0),r=this.ha.map(i=>Xn(i,n)),s=new Fn(r);return new Pf(e.path,s)}isEqual(e){return this===e}}class tw extends Wr{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=Id(this,e,!0),r=this.ha.map(i=>Xn(i,n)),s=new Bn(r);return new Pf(e.path,s)}isEqual(e){return this===e}}function nw(t,e,n,r){const s=t.aa(1,e,n);za("Data must be an object, but it was:",s,r);const i=[],o=Je.empty();yn(r,(l,c)=>{const u=Ha(e,l,n);c=mt(c);const f=s.ia(u);if(c instanceof Ii)i.push(u);else{const p=Xn(c,f);p!=null&&(i.push(u),o.set(u,p))}});const a=new ft(i);return new Ed(o,a,s.fieldTransforms)}function rw(t,e,n,r,s,i){const o=t.aa(1,e,n),a=[Bo(e,r,n)],l=[s];if(i.length%2!=0)throw new U(x.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(Bo(e,i[p])),l.push(i[p+1]);const c=[],u=Je.empty();for(let p=a.length-1;p>=0;--p)if(!Ad(c,a[p])){const d=a[p];let h=l[p];h=mt(h);const m=o.ia(d);if(h instanceof Ii)c.push(d);else{const v=Xn(h,m);v!=null&&(c.push(d),u.set(d,v))}}const f=new ft(c);return new Ed(u,f,o.fieldTransforms)}function Xn(t,e){if(Sd(t=mt(t)))return za("Unsupported field value:",e,t),Cd(t,e);if(t instanceof Wr)return function(n,r){if(!kd(r.Zc))throw r.oa(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=Xn(o,r.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=mt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Wy(r.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Ce.fromDate(n);return{timestampValue:Us(r.wt,s)}}if(n instanceof Ce){const s=new Ce(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Us(r.wt,s)}}if(n instanceof $a)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Un)return{bytesValue:Kf(r.wt,n._byteString)};if(n instanceof We){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Sa(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.oa(`Unsupported field value: ${ja(n)}`)}(t,e)}function Cd(t,e){const n={};return kf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yn(t,(r,s)=>{const i=Xn(s,e.ea(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Sd(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ce||t instanceof $a||t instanceof Un||t instanceof We||t instanceof Wr)}function za(t,e,n){if(!Sd(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=ja(n);throw r==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+r)}}function Bo(t,e,n){if((e=mt(e))instanceof ki)return e._internalPath;if(typeof e=="string")return Ha(t,e);throw qs("Field path arguments must be of type string or ",t,!1,void 0,n)}const sw=new RegExp("[~\\*/\\[\\]]");function Ha(t,e,n){if(e.search(sw)>=0)throw qs(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ki(...e.split("."))._internalPath}catch{throw qs(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function qs(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new U(x.INVALID_ARGUMENT,a+t+l)}function Ad(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new We(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Rd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class iw extends Dd{data(){return super.data()}}function Rd(t,e){return typeof e=="string"?Ha(t,e):e instanceof ki?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nd extends Dd{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ks(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Rd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class ks extends Nd{data(e={}){return super.data(e)}}class ow{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ur(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ks(this._firestore,this._userDataWriter,r.key,r,new ur(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new U(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new ks(r._firestore,r._userDataWriter,o.doc.key,o.doc,new ur(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new ks(r._firestore,r._userDataWriter,o.doc.key,o.doc,new ur(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let l=-1,c=-1;return o.type!==0&&(l=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),c=i.indexOf(o.doc.key)),{type:aw(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function aw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new U(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{convertValue(e,n="none"){switch(hn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return we(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ln(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw H()}}convertObject(e,n){const r={};return yn(e.fields,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new $a(we(e.latitude),we(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=If(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Sr(e));default:return null}}convertTimestamp(e){const n=$t(e);return new Ce(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=fe.fromString(e);ue(Yf(r));const s=new On(r.get(1),r.get(3)),i=new j(r.popFirst(5));return s.isEqual(n)||Vt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ga(t){t=wt(t,We);const e=wt(t.firestore,dn);return G1(Ua(e),t._key).then(n=>Ld(e,t,n))}class Md extends cw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Un(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new We(this.firestore,null,n)}}function tn(t,e,n){t=wt(t,We);const r=wt(t.firestore,dn),s=xd(t.converter,e,n);return Ka(r,[Td(qa(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,gt.none())])}function jo(t,e,n,...r){t=wt(t,We);const s=wt(t.firestore,dn),i=qa(s);let o;return o=typeof(e=mt(e))=="string"||e instanceof ki?rw(i,"updateDoc",t._key,e,n,r):nw(i,"updateDoc",t._key,e),Ka(s,[o.toMutation(t._key,gt.exists(!0))])}function uw(t,e){const n=wt(t.firestore,dn),r=et(t),s=xd(t.converter,e);return Ka(n,[Td(qa(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,gt.exists(!1))]).then(()=>r)}function hw(t,...e){var n,r,s;t=mt(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||Nc(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(Nc(e[o])){const f=e[o];e[o]=(n=f.next)===null||n===void 0?void 0:n.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,u;if(t instanceof We)c=wt(t.firestore,dn),u=pi(t._key.path),l={next:f=>{e[o]&&e[o](Ld(c,t,f))},error:e[o+1],complete:e[o+2]};else{const f=wt(t,Ei);c=wt(f.firestore,dn),u=f._query;const p=new Md(c);l={next:d=>{e[o]&&e[o](new ow(c,p,f,d))},error:e[o+1],complete:e[o+2]},lw(t._query)}return function(f,p,d,h){const m=new vd(h),v=new hd(p,m,d);return f.asyncQueue.enqueueAndForget(async()=>cd(await Fo(f),v)),()=>{m.Tc(),f.asyncQueue.enqueueAndForget(async()=>ud(await Fo(f),v))}}(Ua(c),u,a,l)}function Ka(t,e){return function(n,r){const s=new Ft;return n.asyncQueue.enqueueAndForget(async()=>R1(await H1(n),r,s)),s.promise}(Ua(t),e)}function Ld(t,e,n){const r=n.docs.get(e._key),s=new Md(t);return new Nd(t,s,e._key,r,new ur(n.hasPendingWrites,n.fromCache),e.converter)}function fw(...t){return new ew("arrayUnion",t)}function dw(...t){return new tw("arrayRemove",t)}(function(t,e=!0){(function(n){Kn=n})(Ng),jt(new Ct("firestore",(n,{options:r})=>{const s=n.getProvider("app").getImmediate(),i=new dn(s,new gy(n.getProvider("auth-internal")),new wy(n.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),i._setSettings(r),i},"PUBLIC")),vt(tc,"3.4.12",t),vt(tc,"3.4.12","esm2017")})();const pw={apiKey:"AIzaSyAwCY1tRAE0m9SrlSXSVh6im8NJDYGmd8g",authDomain:"scrumik.firebaseapp.com",projectId:"scrumik",storageBucket:"scrumik.appspot.com",messagingSenderId:"480092253511",appId:"1:480092253511:web:6774f2fec537fd6a9a3062",measurementId:"G-KMNHLLXP8N"},Od=xg(pw);r0(Od);const tt=X1(Od),gw=[{text:"1",emoji:!1,id:"1"},{text:"2",emoji:!1,id:"2"},{text:"3",emoji:!1,id:"3"},{text:"5",emoji:!1,id:"5"},{text:"8",emoji:!1,id:"8"},{text:"13",emoji:!1,id:"13"},{text:"21",emoji:!1,id:"21"},{text:"34",emoji:!1,id:"34"},{text:"55",emoji:!1,id:"55"},{text:"\u2615",emoji:!0,id:"coffee"},{text:"\u{1F92F}",emoji:!0,id:"exploding-head"},{text:"\u{1F52D}",emoji:!0,id:"telescope"},{text:"\u2754",emoji:!0,id:"question"}],mw=(t,e,n)=>hw(et(t,"room",e),n),yw=async(t,e)=>{try{return(await uw(Q1(t,"room"),e)).id}catch(n){throw console.error("Error adding document: ",n),n}},vw=async(t,e,n)=>{const r=et(t,"room",e),s=await Ga(r);if(s.exists()){const i=s.get("password");return i.passCode==""?!0:i.passCode===n}else throw new Error("No such document!")};function ww(t){let e,n,r,s,i,o,a;return{c(){e=S("div"),n=S("h2"),n.textContent="Create Room",r=F(),s=S("form"),s.innerHTML=`<label><span class="text-sm font-bold block mb-2">Room Name</span> 
      <input type="text" name="name" placeholder="Enter a room name" autocomplete="off" required="" class="mb-4 form-input"/></label> 
    <label><span class="text-sm font-bold block mb-2">Passcode</span> 
      <input type="text" name="passCode" autocomplete="off" placeholder="Optional passcode to join room" class="mb-4 form-input"/></label> 
    <button type="submit" value="create" class="block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded">Create Room</button>`,I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(e,"class",i=`${t[0]} p-6 bg-white`)},m(l,c){q(l,e,c),T(e,n),T(e,r),T(e,s),t[3](s),o||(a=ne(s,"submit",gn($n(t[2]))),o=!0)},p(l,[c]){c&1&&i!==(i=`${l[0]} p-6 bg-white`)&&I(e,"class",i)},i:W,o:W,d(l){l&&$(e),t[3](null),o=!1,a()}}}function bw(t,e,n){let{class:r=""}=e,s;const i=async()=>{const a=new FormData(s),l={info:{name:a.get("name")},password:{passCode:a.get("passCode")},cards:gw};try{let u=`/room/${await yw(tt,l)}`;l.password.passCode&&(u+=`?password=${l.password.passCode}`),qo(u)}catch(c){console.error(c)}};function o(a){Nn[a?"unshift":"push"](()=>{s=a,n(1,s)})}return t.$$set=a=>{"class"in a&&n(0,r=a.class)},[r,s,i,o]}class _w extends ze{constructor(e){super(),qe(this,e,bw,ww,je,{class:0})}}function Ew(t){var w;let e,n,r,s,i,o,a,l,c,u,f,p,d=((w=t[2])!=null?w:"")+"",h,m,v,g;return{c(){e=S("div"),n=S("h2"),n.textContent="Join Room",r=F(),s=S("form"),i=S("label"),i.innerHTML=`<span class="text-sm font-bold block mb-2">Room ID</span> 
      <input type="text" name="roomID" placeholder="Room ID" required="" class="mb-4 form-input"/>`,o=F(),a=S("label"),a.innerHTML=`<span class="text-sm font-bold block mb-2">Password</span> 
      <input type="password" name="passCode" placeholder="Leave it empty if don&#39;t need password" class="mb-4 form-input"/>`,l=F(),c=S("div"),u=S("button"),u.textContent="Join",f=F(),p=S("button"),h=ce(d),I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(u,"type","submit"),u.value="join",I(u,"class","border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(p,"type","button"),I(p,"class","border border-black bg-white text-black hover:bg-red-500 hover:text-white font-bold py-1 px-3 rounded"),Rn(p,"invisible",!t[2]),I(c,"class","block"),I(e,"class",m=`${t[0]} p-6 bg-white`)},m(E,_){q(E,e,_),T(e,n),T(e,r),T(e,s),T(s,i),T(s,o),T(s,a),T(s,l),T(s,c),T(c,u),T(c,f),T(c,p),T(p,h),t[5](s),v||(g=[ne(p,"click",t[4]),ne(s,"submit",gn($n(t[3])))],v=!0)},p(E,[_]){var y;_&4&&d!==(d=((y=E[2])!=null?y:"")+"")&&pe(h,d),_&4&&Rn(p,"invisible",!E[2]),_&1&&m!==(m=`${E[0]} p-6 bg-white`)&&I(e,"class",m)},i:W,o:W,d(E){E&&$(e),t[5](null),v=!1,rt(g)}}}function kw(t,e,n){let{class:r=""}=e,s,i;const o=async()=>{const c=new FormData(s),u=c.get("roomID"),f=c.get("password");try{if(!await vw(tt,u,f))throw new Error("Passcode is not correct");qo(`/room/${u}?password=${f}`)}catch(p){n(2,i=p.message)}},a=()=>n(2,i="");function l(c){Nn[c?"unshift":"push"](()=>{s=c,n(1,s)})}return t.$$set=c=>{"class"in c&&n(0,r=c.class)},[r,s,i,o,a,l]}class Tw extends ze{constructor(e){super(),qe(this,e,kw,Ew,je,{class:0})}}const Qa=Qs(null),io=()=>{const t=Xr();Qa.set(t)},nn=Qs(!1);var fs,Iw=new Uint8Array(16);function Cw(){if(!fs&&(fs=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!fs))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fs(Iw)}const Sw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Aw(t){return typeof t=="string"&&Sw.test(t)}var Me=[];for(var oo=0;oo<256;++oo)Me.push((oo+256).toString(16).substr(1));function Dw(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(Me[t[e+0]]+Me[t[e+1]]+Me[t[e+2]]+Me[t[e+3]]+"-"+Me[t[e+4]]+Me[t[e+5]]+"-"+Me[t[e+6]]+Me[t[e+7]]+"-"+Me[t[e+8]]+Me[t[e+9]]+"-"+Me[t[e+10]]+Me[t[e+11]]+Me[t[e+12]]+Me[t[e+13]]+Me[t[e+14]]+Me[t[e+15]]).toLowerCase();if(!Aw(n))throw TypeError("Stringified UUID is invalid");return n}function Pd(t,e,n){t=t||{};var r=t.random||(t.rng||Cw)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var s=0;s<16;++s)e[n+s]=r[s];return e}return Dw(r)}const Wa="room",Xa="id",Rw=(t,e,n=!0)=>{let r=Xr();if(!r)r=[e];else{let s;r=r.filter(i=>i.id!=t?!0:(s=i,!1)),n&&(s={...s,...e}),r.push(s)}localStorage.setItem(Wa,JSON.stringify(r))},Xr=()=>{const t=localStorage.getItem(Wa);return t==null?null:JSON.parse(t)},Nw=t=>{var r;const e=Xr();if(e==null)return"";const n=e.find(s=>s.id==t);return(r=n==null?void 0:n.password)!=null?r:""},xw=t=>{const e=Xr();if(e==null)return;const n=e.find(r=>r.id==t);return n==null?void 0:n.name},Fd=t=>{const e=Xr();if(e==null)return;const n=e.filter(r=>r.id!==t);localStorage.setItem(Wa,JSON.stringify(n)),Qa.set(n)},Bd=()=>{const t=localStorage.getItem(Xa);return t==null?null:JSON.parse(t)},jd=t=>{const e=Pd(),n={id:e,nick:t};return localStorage.setItem(Xa,JSON.stringify(n)),{id:e,nick:t}},Vd=(t,e)=>{const n={id:t,nick:e};localStorage.setItem(Xa,JSON.stringify(n))},xc=t=>{t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296};class Mw{constructor(e){this.dictionaries=void 0,this.length=void 0,this.separator=void 0,this.style=void 0,this.seed=void 0;const{length:n,separator:r,dictionaries:s,style:i,seed:o}=e;this.dictionaries=s,this.separator=r,this.length=n,this.style=i,this.seed=o}generate(){if(!this.dictionaries)throw new Error('Cannot find any dictionary. Please provide at least one, or leave the "dictionary" field empty in the config object');if(this.length<=0)throw new Error("Invalid length provided");if(this.length>this.dictionaries.length)throw new Error(`The length cannot be bigger than the number of dictionaries.
Length provided: ${this.length}. Number of dictionaries provided: ${this.dictionaries.length}`);let e=this.seed;return this.dictionaries.slice(0,this.length).reduce((n,r)=>{let s;e?(s=(o=>{if(typeof o=="string"){const a=o.split("").map(c=>c.charCodeAt(0)).reduce((c,u)=>c+u,1),l=Math.floor(Number(a));return xc(l)}return xc(o)})(e),e=4294967296*s):s=Math.random();let i=r[Math.floor(s*r.length)]||"";if(this.style==="lowerCase")i=i.toLowerCase();else if(this.style==="capital"){const[o,...a]=i.split("");i=o.toUpperCase()+a.join("")}else this.style==="upperCase"&&(i=i.toUpperCase());return n?`${n}${this.separator}${i}`:`${i}`},"")}}const Mc={separator:"_",dictionaries:[]},Lw=t=>{const e=[...t&&t.dictionaries||Mc.dictionaries],n={...Mc,...t,length:t&&t.length||e.length,dictionaries:e};if(!t||!t.dictionaries||!t.dictionaries.length)throw new Error('A "dictionaries" array must be provided. This is a breaking change introduced starting from Unique Name Generator v4. Read more about the breaking change here: https://github.com/andreasonny83/unique-names-generator#migration-guide');return new Mw(n).generate()};var Ow=["aardvark","aardwolf","albatross","alligator","alpaca","amphibian","anaconda","angelfish","anglerfish","ant","anteater","antelope","antlion","ape","aphid","armadillo","asp","baboon","badger","bandicoot","barnacle","barracuda","basilisk","bass","bat","bear","beaver","bedbug","bee","beetle","bird","bison","blackbird","boa","boar","bobcat","bobolink","bonobo","booby","bovid","bug","butterfly","buzzard","camel","canid","canidae","capybara","cardinal","caribou","carp","cat","caterpillar","catfish","catshark","cattle","centipede","cephalopod","chameleon","cheetah","chickadee","chicken","chimpanzee","chinchilla","chipmunk","cicada","clam","clownfish","cobra","cockroach","cod","condor","constrictor","coral","cougar","cow","coyote","crab","crane","crawdad","crayfish","cricket","crocodile","crow","cuckoo","damselfly","deer","dingo","dinosaur","dog","dolphin","donkey","dormouse","dove","dragon","dragonfly","duck","eagle","earthworm","earwig","echidna","eel","egret","elephant","elk","emu","ermine","falcon","felidae","ferret","finch","firefly","fish","flamingo","flea","fly","flyingfish","fowl","fox","frog","galliform","gamefowl","gayal","gazelle","gecko","gerbil","gibbon","giraffe","goat","goldfish","goose","gopher","gorilla","grasshopper","grouse","guan","guanaco","guineafowl","gull","guppy","haddock","halibut","hamster","hare","harrier","hawk","hedgehog","heron","herring","hippopotamus","hookworm","hornet","horse","hoverfly","hummingbird","hyena","iguana","impala","jackal","jaguar","jay","jellyfish","junglefowl","kangaroo","kingfisher","kite","kiwi","koala","koi","krill","ladybug","lamprey","landfowl","lark","leech","lemming","lemur","leopard","leopon","limpet","lion","lizard","llama","lobster","locust","loon","louse","lungfish","lynx","macaw","mackerel","magpie","mammal","manatee","mandrill","marlin","marmoset","marmot","marsupial","marten","mastodon","meadowlark","meerkat","mink","minnow","mite","mockingbird","mole","mollusk","mongoose","monkey","moose","mosquito","moth","mouse","mule","muskox","narwhal","newt","nightingale","ocelot","octopus","opossum","orangutan","orca","ostrich","otter","owl","ox","panda","panther","parakeet","parrot","parrotfish","partridge","peacock","peafowl","pelican","penguin","perch","pheasant","pig","pigeon","pike","pinniped","piranha","planarian","platypus","pony","porcupine","porpoise","possum","prawn","primate","ptarmigan","puffin","puma","python","quail","quelea","quokka","rabbit","raccoon","rat","rattlesnake","raven","reindeer","reptile","rhinoceros","roadrunner","rodent","rook","rooster","roundworm","sailfish","salamander","salmon","sawfish","scallop","scorpion","seahorse","shark","sheep","shrew","shrimp","silkworm","silverfish","skink","skunk","sloth","slug","smelt","snail","snake","snipe","sole","sparrow","spider","spoonbill","squid","squirrel","starfish","stingray","stoat","stork","sturgeon","swallow","swan","swift","swordfish","swordtail","tahr","takin","tapir","tarantula","tarsier","termite","tern","thrush","tick","tiger","tiglon","toad","tortoise","toucan","trout","tuna","turkey","turtle","tyrannosaurus","unicorn","urial","vicuna","viper","vole","vulture","wallaby","walrus","warbler","wasp","weasel","whale","whippet","whitefish","wildcat","wildebeest","wildfowl","wolf","wolverine","wombat","woodpecker","worm","wren","xerinae","yak","zebra"],Pw=["amaranth","amber","amethyst","apricot","aqua","aquamarine","azure","beige","black","blue","blush","bronze","brown","chocolate","coffee","copper","coral","crimson","cyan","emerald","fuchsia","gold","gray","green","harlequin","indigo","ivory","jade","lavender","lime","magenta","maroon","moccasin","olive","orange","peach","pink","plum","purple","red","rose","salmon","sapphire","scarlet","silver","tan","teal","tomato","turquoise","violet","white","yellow"];const Fw={dictionaries:[Pw,Ow],separator:"-",length:2},zs=()=>Lw(Fw);function Bw(t){let e,n,r,s;return{c(){e=S("span"),n=ml("svg"),r=ml("path"),I(r,"d",s=t[4][t[0]]),I(n,"xmlns","http://www.w3.org/2000/svg"),I(n,"width",t[2]),I(n,"height",t[1]),I(n,"viewBox","0 0 24 24"),I(e,"title",t[3]),I(e,"class",or(t[5]?t[5]:void 0)+" svelte-fnv3u2")},m(i,o){q(i,e,o),T(e,n),T(n,r)},p(i,[o]){o&17&&s!==(s=i[4][i[0]])&&I(r,"d",s),o&4&&I(n,"width",i[2]),o&2&&I(n,"height",i[1]),o&8&&I(e,"title",i[3])},i:W,o:W,d(i){i&&$(e)}}}function jw(t,e,n){var r;(function(f){f.king="M16.896 10l-4.896-8-4.896 8-7.104-4 3 11v5h18v-5l3-11-7.104 4zm-11.896 10v-2h14v2h-14zm14.2-4h-14.4l-1.612-5.909 4.615 2.598 4.197-6.857 4.197 6.857 4.615-2.598-1.612 5.909z",f.reload="M22 3v18h-5v-2h3v-14h-6v3l-5.25-4 5.25-4v3h8zm-12 16h-6v-14h3v-2h-5v18h8v3l5.25-4-5.25-4v3z"})(r||(r={}));let{icon:s}=e,{height:i="24"}=e,{width:o="24"}=e,{class:a=void 0}=e,{position:l=void 0}=e,{title:c="icon"}=e;const u=[a,l].join(" ");return t.$$set=f=>{"icon"in f&&n(0,s=f.icon),"height"in f&&n(1,i=f.height),"width"in f&&n(2,o=f.width),"class"in f&&n(6,a=f.class),"position"in f&&n(7,l=f.position),"title"in f&&n(3,c=f.title)},[s,i,o,c,r,u,a,l]}class Vw extends ze{constructor(e){super(),qe(this,e,jw,Bw,je,{icon:0,height:1,width:2,class:6,position:7,title:3})}}function Lc(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 h-7 border-l border-b border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){q(s,e,i),n||(r=ne(e,"click",t[4]),n=!0)},p:W,d(s){s&&$(e),n=!1,r()}}}function Uw(t){let e,n;return{c(){e=S("span"),n=ce(t[2]),I(e,"class","font-bold text-xl px-2")},m(r,s){q(r,e,s),T(e,n)},p(r,s){s&4&&pe(n,r[2])},i:W,o:W,d(r){r&&$(e)}}}function $w(t){let e,n,r,s,i,o,a,l;return i=new Vw({props:{icon:"reload",height:"1.75rem",title:"new name generate",class:"pointer-events-none"}}),{c(){e=S("form"),n=S("input"),r=F(),s=S("button"),Ie(i.$$.fragment),I(n,"class","bg-gray-100 border border-gray-200 px-2 text-xl font-bold"),I(n,"type","text"),I(s,"class","bg-white border border-black px-2 text-xl hover:bg-nl hover:text-white"),I(s,"type","button"),I(e,"class","flex items-center")},m(c,u){q(c,e,u),T(e,n),Dn(n,t[3]),T(e,r),T(e,s),be(i,s,null),o=!0,a||(l=[ne(n,"input",t[6]),ne(s,"click",t[7]),ne(e,"submit",gn($n(t[4])))],a=!0)},p(c,u){u&8&&n.value!==c[3]&&Dn(n,c[3])},i(c){o||(J(i.$$.fragment,c),o=!0)},o(c){ee(i.$$.fragment,c),o=!1},d(c){c&&$(e),_e(i),a=!1,rt(l)}}}function qw(t){let e,n,r,s,i,o=t[1]?"Cancel":"Edit Nickname",a,l,c,u,f,p,d,h,m,v,g=t[1]&&Lc(t);const w=[$w,Uw],E=[];function _(y,b){return y[1]?0:1}return f=_(t),p=E[f]=w[f](t),{c(){e=S("div"),n=S("div"),r=S("div"),g&&g.c(),s=F(),i=S("button"),a=ce(o),c=F(),u=S("div"),p.c(),I(i,"class",l=`float-right px-2 h-7 border-l border-b border-black self-end hover:text-white ${t[1]?"hover:bg-red-500":"hover:bg-nl"}`),I(n,"class","float-right"),I(u,"class","py-6 pl-4 pr-6"),I(e,"class",d=`${t[0]} bg-white`)},m(y,b){q(y,e,b),T(e,n),T(n,r),g&&g.m(r,null),T(r,s),T(r,i),T(i,a),T(e,c),T(e,u),E[f].m(u,null),h=!0,m||(v=ne(i,"click",t[5]),m=!0)},p(y,[b]){y[1]?g?g.p(y,b):(g=Lc(y),g.c(),g.m(r,s)):g&&(g.d(1),g=null),(!h||b&2)&&o!==(o=y[1]?"Cancel":"Edit Nickname")&&pe(a,o),(!h||b&2&&l!==(l=`float-right px-2 h-7 border-l border-b border-black self-end hover:text-white ${y[1]?"hover:bg-red-500":"hover:bg-nl"}`))&&I(i,"class",l);let C=f;f=_(y),f===C?E[f].p(y,b):(Dt(),ee(E[C],1,1,()=>{E[C]=null}),Rt(),p=E[f],p?p.p(y,b):(p=E[f]=w[f](y),p.c()),J(p,1),p.m(u,null)),(!h||b&1&&d!==(d=`${y[0]} bg-white`))&&I(e,"class",d)},i(y){h||(J(p),h=!0)},o(y){ee(p),h=!1},d(y){y&&$(e),g&&g.d(),E[f].d(),m=!1,v()}}}function zw(t,e,n){let r=!1,{class:s=""}=e,i="",o="",a="";const l=()=>{Vd(i,a),n(2,o=a),n(1,r=!1)},c=()=>{var h;const d=(h=Bd())!=null?h:jd(zs());i=d.id,n(2,o=d.nick)};Nr(()=>{c(),window.addEventListener("storage",c)}),xr(()=>{window.removeEventListener("storage",c)});const u=()=>{n(1,r=!r),r&&n(3,a=o)};function f(){a=this.value,n(3,a)}const p=()=>n(3,a=zs());return t.$$set=d=>{"class"in d&&n(0,s=d.class)},[s,r,o,a,l,u,f,p]}class Hw extends ze{constructor(e){super(),qe(this,e,zw,qw,je,{class:0})}}const Gw=t=>window.confirm(t);function Oc(t,e,n){const r=t.slice();return r[3]=e[n],r}function Kw(t){let e;return{c(){e=S("p"),e.textContent="No rooms yet",I(e,"class","italic")},m(n,r){q(n,e,r)},p:W,d(n){n&&$(e)}}}function Qw(t){let e,n=[],r=new Map,s=t[1];const i=o=>o[3].id;for(let o=0;o<s.length;o+=1){let a=Oc(t,s,o),l=i(a);r.set(l,n[o]=Pc(l,a))}return{c(){e=S("ul");for(let o=0;o<n.length;o+=1)n[o].c()},m(o,a){q(o,e,a);for(let l=0;l<n.length;l+=1)n[l].m(e,null)},p(o,a){a&2&&(s=o[1],n=Ks(n,a,i,1,o,s,r,e,xu,Pc,null,Oc))},d(o){o&&$(e);for(let a=0;a<n.length;a+=1)n[a].d()}}}function Pc(t,e){let n,r,s=e[3].name+"",i,o,a,l,c,u,f;function p(){return e[2](e[3])}return{key:t,first:null,c(){n=S("li"),r=S("a"),i=ce(s),a=F(),l=S("button"),l.textContent="delete",c=F(),I(r,"class","w-full leading-10 hover:bg-green-500 hover:text-white px-2"),I(r,"href",o=`/room/${e[3].id}`),I(l,"class","border-l border-black bg-white hover:bg-red-500 hover:text-white px-2"),I(n,"class","flex justify-between odd:bg-gray-100 even:bg-gray-200 first:border-t border-b border-black"),this.first=n},m(d,h){q(d,n,h),T(n,r),T(r,i),T(n,a),T(n,l),T(n,c),u||(f=[Cu(ju.call(null,r)),ne(l,"click",p)],u=!0)},p(d,h){e=d,h&2&&s!==(s=e[3].name+"")&&pe(i,s),h&2&&o!==(o=`/room/${e[3].id}`)&&I(r,"href",o)},d(d){d&&$(n),u=!1,rt(f)}}}function Ww(t){let e,n,r,s,i;function o(c,u){return c[1]!=null&&c[1].length>0?Qw:Kw}let a=o(t),l=a(t);return{c(){e=S("div"),n=S("h2"),n.textContent="Room List",r=F(),s=S("div"),l.c(),I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(e,"class",i=`${t[0]} p-6 bg-white`)},m(c,u){q(c,e,u),T(e,n),T(e,r),T(e,s),l.m(s,null)},p(c,[u]){a===(a=o(c))&&l?l.p(c,u):(l.d(1),l=a(c),l&&(l.c(),l.m(s,null))),u&1&&i!==(i=`${c[0]} p-6 bg-white`)&&I(e,"class",i)},i:W,o:W,d(c){c&&$(e),l.d()}}}function Xw(t,e,n){let r;Rr(t,Qa,o=>n(1,r=o));let{class:s=""}=e;Nr(()=>{io(),window.addEventListener("storage",io)}),xr(()=>{window.removeEventListener("storage",io)});const i=o=>{Gw(`Are you sure to delete? [${o.name}]`)&&Fd(o.id)};return t.$$set=o=>{"class"in o&&n(0,s=o.class)},[s,r,i]}class Yw extends ze{constructor(e){super(),qe(this,e,Xw,Ww,je,{class:0})}}function Fc(t){let e,n,r,s,i,o,a;return{c(){e=S("div"),n=S("span"),r=ce(t[0]),s=F(),i=S("button"),i.textContent="X",I(n,"class","p-2"),I(i,"class","border-l border-black bg-gray-200 hover:bg-nl px-2 float-right"),I(e,"class","border-t border-b sm:border border-black mb-3 bg-yellow-200")},m(l,c){q(l,e,c),T(e,n),T(n,r),T(e,s),T(e,i),o||(a=ne(i,"click",t[2]),o=!0)},p(l,c){c&1&&pe(r,l[0])},d(l){l&&$(e),o=!1,a()}}}function Jw(t){let e,n,r,s,i,o,a,l,c,u,f,p,d=t[0]&&Fc(t);return s=new Tw({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),o=new Yw({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),c=new Hw({props:{class:"border-t border-b sm:border border-black h-fit"}}),f=new _w({props:{class:"border-t border-b sm:border border-black h-fit"}}),{c(){d&&d.c(),e=F(),n=S("div"),r=S("div"),Ie(s.$$.fragment),i=F(),Ie(o.$$.fragment),a=F(),l=S("div"),Ie(c.$$.fragment),u=F(),Ie(f.$$.fragment),I(r,"class","flex flex-1 flex-col gap-3"),I(l,"class","flex flex-1 flex-col gap-3"),I(n,"class","flex flex-1 gap-3 md:flex-row flex-col")},m(h,m){d&&d.m(h,m),q(h,e,m),q(h,n,m),T(n,r),be(s,r,null),T(r,i),be(o,r,null),T(n,a),T(n,l),be(c,l,null),T(l,u),be(f,l,null),p=!0},p(h,[m]){h[0]?d?d.p(h,m):(d=Fc(h),d.c(),d.m(e.parentNode,e)):d&&(d.d(1),d=null)},i(h){p||(J(s.$$.fragment,h),J(o.$$.fragment,h),J(c.$$.fragment,h),J(f.$$.fragment,h),p=!0)},o(h){ee(s.$$.fragment,h),ee(o.$$.fragment,h),ee(c.$$.fragment,h),ee(f.$$.fragment,h),p=!1},d(h){d&&d.d(h),h&&$(e),h&&$(n),_e(s),_e(o),_e(c),_e(f)}}}function Zw(t,e,n){let r;Rr(t,Bu,a=>n(1,r=a));let s="";const i=a=>{var u,f;const l=new URLSearchParams(a);n(0,s=(u=l.get("msg"))!=null?u:"");const c=(f=l.get("kickRoom"))!=null?f:"";c&&Fd(c)},o=()=>n(0,s="");return t.$$.update=()=>{t.$$.dirty&2&&i(r)},[s,r,o]}class eb extends ze{constructor(e){super(),qe(this,e,Zw,Jw,je,{})}}function tb(t){let e;return{c(){e=S("div"),e.textContent="What is that URL?",I(e,"class","border border-black bg-yellow-200 w-full text-center font-bold text-xl")},m(n,r){q(n,e,r)},p:W,i:W,o:W,d(n){n&&$(e)}}}class nb extends ze{constructor(e){super(),qe(this,e,null,tb,je,{})}}const Bc=async(t,e)=>{const r=(await Ga(t)).get("password");return(r==null?void 0:r.passCode)==e},jc=async t=>(await Ga(t)).get("password");function rb(t){let e,n,r,s,i,o,a,l,c;return{c(){e=S("button"),n=S("button"),n.textContent="-",r=F(),s=S("span"),i=ce(t[0]),I(n,"class","h-6 w-6 bg-white hover:bg-red-500 border-l border-b border-black absolute top-0 right-0"),Rn(n,"hidden",!t[2]),I(s,"class",o=`${t[1]?"font-emoji":""} text-5xl pointer-events-none`),I(e,"class",a=`${t[3]} h-36 w-28 ${t[2]?"":"hover:bg-nl"} border border-black flex items-center justify-center relative`)},m(u,f){q(u,e,f),T(e,n),T(e,r),T(e,s),T(s,i),l||(c=[ne(n,"click",gn(t[5])),ne(e,"click",t[4])],l=!0)},p(u,[f]){f&4&&Rn(n,"hidden",!u[2]),f&1&&pe(i,u[0]),f&2&&o!==(o=`${u[1]?"font-emoji":""} text-5xl pointer-events-none`)&&I(s,"class",o),f&12&&a!==(a=`${u[3]} h-36 w-28 ${u[2]?"":"hover:bg-nl"} border border-black flex items-center justify-center relative`)&&I(e,"class",a)},i:W,o:W,d(u){u&&$(e),l=!1,rt(c)}}}function sb(t,e,n){let{text:r=""}=e,{emoji:s=!1}=e,{editMode:i=!1}=e,{class:o=""}=e;const a=Su(),l=()=>{a("click",{text:r,emoji:s})},c=()=>{a("delete")};return t.$$set=u=>{"text"in u&&n(0,r=u.text),"emoji"in u&&n(1,s=u.emoji),"editMode"in u&&n(2,i=u.editMode),"class"in u&&n(3,o=u.class)},[r,s,i,o,l,c]}class Ci extends ze{constructor(e){super(),qe(this,e,sb,rb,je,{text:0,emoji:1,editMode:2,class:3})}}const Ud=(t,e)=>isNaN(+t)&&isNaN(+e)?t.localeCompare(e):isNaN(+t)?1:isNaN(+e)?-1:+t-+e,ut=t=>t.id?t.id:t.text+t.emoji.toString();function Vc(t,e,n){const r=t.slice();return r[30]=e[n],r}function Uc(t,e,n){const r=t.slice();return r[27]=e[n],r}function $c(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 bg-white h-7 border-l border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){q(s,e,i),n||(r=ne(e,"click",t[11]),n=!0)},p:W,d(s){s&&$(e),n=!1,r()}}}function ib(t){let e,n=[],r=new Map,s,i=t[0].sort(t[24]);const o=a=>a[30].text;for(let a=0;a<i.length;a+=1){let l=Vc(t,i,a),c=o(l);r.set(c,n[a]=qc(c,l))}return{c(){e=S("div");for(let a=0;a<n.length;a+=1)n[a].c();I(e,"class","grid justify-between auto-fill-col gap-2 svelte-9d72rf")},m(a,l){q(a,e,l);for(let c=0;c<n.length;c+=1)n[c].m(e,null);s=!0},p(a,l){l[0]&513&&(i=a[0].sort(a[24]),Dt(),n=Ks(n,l,o,1,a,i,r,e,Mu,qc,null,Vc),Rt())},i(a){if(!s){for(let l=0;l<i.length;l+=1)J(n[l]);s=!0}},o(a){for(let l=0;l<n.length;l+=1)ee(n[l]);s=!1},d(a){a&&$(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function ob(t){let e,n=[],r=new Map,s,i,o,a=t[5];const l=c=>ut(c[27]);for(let c=0;c<a.length;c+=1){let u=Uc(t,a,c),f=l(u);r.set(f,n[c]=zc(f,u))}return i=new Ci({props:{class:"bg-yellow-200 hover:bg-indigo-400",text:"+"}}),i.$on("click",t[23]),{c(){e=S("div");for(let c=0;c<n.length;c+=1)n[c].c();s=F(),Ie(i.$$.fragment),I(e,"class","grid justify-between auto-fill-col gap-2 svelte-9d72rf")},m(c,u){q(c,e,u);for(let f=0;f<n.length;f+=1)n[f].m(e,null);T(e,s),be(i,e,null),o=!0},p(c,u){u[0]&28900&&(a=c[5],Dt(),n=Ks(n,u,l,1,c,a,r,e,Mu,zc,s,Uc),Rt())},i(c){if(!o){for(let u=0;u<a.length;u+=1)J(n[u]);J(i.$$.fragment,c),o=!0}},o(c){for(let u=0;u<n.length;u+=1)ee(n[u]);ee(i.$$.fragment,c),o=!1},d(c){c&&$(e);for(let u=0;u<n.length;u+=1)n[u].d();_e(i)}}}function qc(t,e){let n,r,s;return r=new Ci({props:{text:e[30].text,emoji:e[30].emoji}}),r.$on("click",e[9]),{key:t,first:null,c(){n=pn(),Ie(r.$$.fragment),this.first=n},m(i,o){q(i,n,o),be(r,i,o),s=!0},p(i,o){e=i;const a={};o[0]&1&&(a.text=e[30].text),o[0]&1&&(a.emoji=e[30].emoji),r.$set(a)},i(i){s||(J(r.$$.fragment,i),s=!0)},o(i){ee(r.$$.fragment,i),s=!1},d(i){i&&$(n),_e(r,i)}}}function zc(t,e){let n,r,s;function i(){return e[22](e[27])}return r=new Ci({props:{class:`${e[2]?`${e[6][ut(e[27])]?"stripe-gray":`${e[7][ut(e[27])]?"bg-indigo-200":"bg-gray-100"}`} cursor-not-allowed`:"bg-white"}`,text:e[27].text,emoji:e[27].emoji,editMode:e[2]}}),r.$on("delete",i),{key:t,first:null,c(){n=pn(),Ie(r.$$.fragment),this.first=n},m(o,a){q(o,n,a),be(r,o,a),s=!0},p(o,a){e=o;const l={};a[0]&228&&(l.class=`${e[2]?`${e[6][ut(e[27])]?"stripe-gray":`${e[7][ut(e[27])]?"bg-indigo-200":"bg-gray-100"}`} cursor-not-allowed`:"bg-white"}`),a[0]&32&&(l.text=e[27].text),a[0]&32&&(l.emoji=e[27].emoji),a[0]&4&&(l.editMode=e[2]),r.$set(l)},i(o){s||(J(r.$$.fragment,o),s=!0)},o(o){ee(r.$$.fragment,o),s=!1},d(o){o&&$(n),_e(r,o)}}}function ab(t){let e,n,r,s,i,o,a=t[2]?"Cancel":"Edit",l,c,u,f,p,d,h,m,v,g,w,E,_,y,b,C,k,D,O,A,V,L,N,R,de,K,ie,le,ge,ke,ct,ye=t[2]&&$c(t);h=new Ci({props:{class:"bg-white",text:t[4].text,emoji:t[4].emoji}});const Nt=[ob,ib],Te=[];function xt(te,Z){return te[2]?0:1}return K=xt(t),ie=Te[K]=Nt[K](t),{c(){e=S("div"),n=S("div"),r=S("button"),r.textContent="Clear My Vote",s=F(),ye&&ye.c(),i=F(),o=S("button"),l=ce(a),u=F(),f=S("div"),p=S("div"),d=S("div"),Ie(h.$$.fragment),m=F(),v=S("div"),g=S("form"),w=S("label"),E=S("span"),E.textContent="Card Text",_=F(),y=S("input"),b=F(),C=S("label"),k=S("span"),k.textContent="Icon",D=F(),O=S("input"),A=F(),V=S("button"),V.textContent="New Card",L=F(),N=S("button"),N.textContent="Cancel",R=F(),de=S("div"),ie.c(),I(r,"class","flex-1 px-2 bg-white hover:bg-nl hover:text-white"),I(o,"class",c=or(`px-2 bg-white h-7 border-l border-black self-end hover:text-white ${t[2]?"hover:bg-red-500":"hover:bg-nl"}`)+" svelte-9d72rf"),I(n,"class","w-full border-b border-black flex flex-wrap justify-end box-content"),I(E,"class","text-sm font-bold block mb-2"),I(y,"type","text"),I(y,"name","cardText"),I(y,"placeholder","&MF"),I(y,"autocomplete","off"),y.required=!0,I(y,"class","mb-2 form-input"),I(k,"class","text-sm font-bold block pr-4"),I(O,"type","checkbox"),I(O,"name","icon"),I(C,"class","flex mb-4"),I(V,"type","submit"),V.value="create",I(V,"class","border border-black bg-white text-black hover:bg-green-500 hover:text-white font-bold py-1 px-3 rounded"),I(N,"type","button"),I(N,"class","border border-black bg-white text-black hover:bg-red-500 hover:text-white font-bold py-1 px-3 rounded"),I(v,"class","bg-white"),I(d,"class","p-2 h-full border border-black bg-white flex justify-around gap-2 items-center"),I(p,"class","p-6 absolute bg-gray-300 bg-opacity-90 w-full h-full z-10"),Rn(p,"hidden",!t[3]),I(de,"class","p-2"),I(f,"class","relative"),I(e,"class",le=or(`${t[1]} relative`)+" svelte-9d72rf")},m(te,Z){q(te,e,Z),T(e,n),T(n,r),T(n,s),ye&&ye.m(n,null),T(n,i),T(n,o),T(o,l),T(e,u),T(e,f),T(f,p),T(p,d),be(h,d,null),T(d,m),T(d,v),T(v,g),T(g,w),T(w,E),T(w,_),T(w,y),Dn(y,t[4].text),T(g,b),T(g,C),T(C,k),T(C,D),T(C,O),O.checked=t[4].emoji,T(g,A),T(g,V),T(g,L),T(g,N),T(f,R),T(f,de),Te[K].m(de,null),ge=!0,ke||(ct=[ne(r,"click",t[17]),ne(o,"click",t[18]),ne(y,"input",t[19]),ne(O,"change",t[20]),ne(N,"click",t[21]),ne(g,"submit",gn($n(t[10])))],ke=!0)},p(te,Z){te[2]?ye?ye.p(te,Z):(ye=$c(te),ye.c(),ye.m(n,i)):ye&&(ye.d(1),ye=null),(!ge||Z[0]&4)&&a!==(a=te[2]?"Cancel":"Edit")&&pe(l,a),(!ge||Z[0]&4&&c!==(c=or(`px-2 bg-white h-7 border-l border-black self-end hover:text-white ${te[2]?"hover:bg-red-500":"hover:bg-nl"}`)+" svelte-9d72rf"))&&I(o,"class",c);const yt={};Z[0]&16&&(yt.text=te[4].text),Z[0]&16&&(yt.emoji=te[4].emoji),h.$set(yt),Z[0]&16&&y.value!==te[4].text&&Dn(y,te[4].text),Z[0]&16&&(O.checked=te[4].emoji),Z[0]&8&&Rn(p,"hidden",!te[3]);let Kt=K;K=xt(te),K===Kt?Te[K].p(te,Z):(Dt(),ee(Te[Kt],1,1,()=>{Te[Kt]=null}),Rt(),ie=Te[K],ie?ie.p(te,Z):(ie=Te[K]=Nt[K](te),ie.c()),J(ie,1),ie.m(de,null)),(!ge||Z[0]&2&&le!==(le=or(`${te[1]} relative`)+" svelte-9d72rf"))&&I(e,"class",le)},i(te){ge||(J(h.$$.fragment,te),J(ie),ge=!0)},o(te){ee(h.$$.fragment,te),ee(ie),ge=!1},d(te){te&&$(e),ye&&ye.d(),_e(h),Te[K].d(),ke=!1,rt(ct)}}}function lb(t,e,n){let r;Rr(t,nn,N=>n(25,r=N));let{cardDeck:s=[]}=e,{class:i=""}=e,{id:o=""}=e,{nickID:a=""}=e,l=!1,c=!1;const u={text:"X",emoji:!1};let f={...u},p;const d=N=>{if(r)return;const R=et(tt,"room",o);tn(R,{people:{[a]:{card:N.detail}}},{merge:!0})},h=()=>{const N=Pd(),R={text:f.text,emoji:f.emoji,id:N};n(5,p=[...p,R]),_(N,R),n(3,c=!1),n(4,f={...u})},m=async()=>{const N=et(tt,"room",o);try{await jo(N,{cards:dw(...Object.values(v))}),await jo(N,{cards:fw(...Object.values(E))})}catch(R){console.error(R)}n(3,c=!1),n(4,f={...u}),n(6,v={}),n(7,E={}),n(2,l=!1)};let v={};const g=(N,R)=>{n(6,v[N]=R,v),n(6,v={...v})},w=N=>{delete v[N],n(6,v={...v})};let E={};const _=(N,R)=>{n(7,E[N]=R,E)},y=N=>{delete E[N],n(7,E={...E})},b=()=>d({detail:""}),C=()=>{if(n(2,l=!l),l){n(5,p=s.slice());return}n(3,c=!1),n(4,f={...u}),n(6,v={}),n(7,E={})};function k(){f.text=this.value,n(4,f)}function D(){f.emoji=this.checked,n(4,f)}const O=()=>{n(3,c=!1),n(4,f={...u})},A=N=>{E[ut(N)]?(y(ut(N)),n(5,p=[...p.filter(R=>ut(R)!=ut(N))])):v[ut(N)]?w(ut(N)):g(ut(N),N)},V=()=>{n(3,c=!0)},L=(N,R)=>Ud(N.text,R.text);return t.$$set=N=>{"cardDeck"in N&&n(0,s=N.cardDeck),"class"in N&&n(1,i=N.class),"id"in N&&n(15,o=N.id),"nickID"in N&&n(16,a=N.nickID)},[s,i,l,c,f,p,v,E,u,d,h,m,g,w,y,o,a,b,C,k,D,O,A,V,L]}class cb extends ze{constructor(e){super(),qe(this,e,lb,ab,je,{cardDeck:0,class:1,id:15,nickID:16},null,[-1,-1])}}var Ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$d={},Ya={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.QRMath=t.QRUtil=t.QRMaskPattern=t.QRErrorCorrectLevel=t.QRCodeModel=void 0;function e(d,h,m){var v=r(h),g=d-1,w=0;switch(m){case t.QRErrorCorrectLevel.L:w=p[g][0];break;case t.QRErrorCorrectLevel.M:w=p[g][1];break;case t.QRErrorCorrectLevel.Q:w=p[g][2];break;case t.QRErrorCorrectLevel.H:w=p[g][3];break}return v<=w}function n(d,h){for(var m=1,v=r(d),g=0,w=p.length;g<w;g++){var E=0;switch(h){case t.QRErrorCorrectLevel.L:E=p[g][0];break;case t.QRErrorCorrectLevel.M:E=p[g][1];break;case t.QRErrorCorrectLevel.Q:E=p[g][2];break;case t.QRErrorCorrectLevel.H:E=p[g][3];break}if(v<=E)break;m++}if(m>p.length)throw new Error("Too long data");return m}function r(d){var h=encodeURI(d).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return h.length+(h.length!=Number(d)?3:0)}var s=function(){function d(h){this.mode=o.MODE_8BIT_BYTE,this.parsedData=[],this.data=h;for(var m=[],v=0,g=this.data.length;v<g;v++){var w=[],E=this.data.charCodeAt(v);E>65536?(w[0]=240|(E&1835008)>>>18,w[1]=128|(E&258048)>>>12,w[2]=128|(E&4032)>>>6,w[3]=128|E&63):E>2048?(w[0]=224|(E&61440)>>>12,w[1]=128|(E&4032)>>>6,w[2]=128|E&63):E>128?(w[0]=192|(E&1984)>>>6,w[1]=128|E&63):w[0]=E,m.push(w)}this.parsedData=Array.prototype.concat.apply([],m),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return d.prototype.getLength=function(){return this.parsedData.length},d.prototype.write=function(h){for(var m=0,v=this.parsedData.length;m<v;m++)h.put(this.parsedData[m],8)},d}(),i=function(){function d(h,m){h===void 0&&(h=-1),m===void 0&&(m=t.QRErrorCorrectLevel.L),this.moduleCount=0,this.dataList=[],this.typeNumber=h,this.errorCorrectLevel=m,this.moduleCount=0,this.dataList=[]}return d.prototype.addData=function(h){if(this.typeNumber<=0)this.typeNumber=n(h,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error("Invalid QR version: "+this.typeNumber);if(!e(this.typeNumber,h,this.errorCorrectLevel))throw new Error("Data is too long for QR version: "+this.typeNumber)}var m=new s(h);this.dataList.push(m),this.dataCache=void 0},d.prototype.isDark=function(h,m){if(h<0||this.moduleCount<=h||m<0||this.moduleCount<=m)throw new Error(h+","+m);return this.modules[h][m]},d.prototype.getModuleCount=function(){return this.moduleCount},d.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},d.prototype.makeImpl=function(h,m){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var v=0;v<this.moduleCount;v++){this.modules[v]=new Array(this.moduleCount);for(var g=0;g<this.moduleCount;g++)this.modules[v][g]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(h,m),this.typeNumber>=7&&this.setupTypeNumber(h),this.dataCache==null&&(this.dataCache=d.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,m)},d.prototype.setupPositionProbePattern=function(h,m){for(var v=-1;v<=7;v++)if(!(h+v<=-1||this.moduleCount<=h+v))for(var g=-1;g<=7;g++)m+g<=-1||this.moduleCount<=m+g||(0<=v&&v<=6&&(g==0||g==6)||0<=g&&g<=6&&(v==0||v==6)||2<=v&&v<=4&&2<=g&&g<=4?this.modules[h+v][m+g]=!0:this.modules[h+v][m+g]=!1)},d.prototype.getBestMaskPattern=function(){if(Number.isInteger(this.maskPattern)&&Object.values(t.QRMaskPattern).includes(this.maskPattern))return this.maskPattern;for(var h=0,m=0,v=0;v<8;v++){this.makeImpl(!0,v);var g=a.getLostPoint(this);(v==0||h>g)&&(h=g,m=v)}return m},d.prototype.setupTimingPattern=function(){for(var h=8;h<this.moduleCount-8;h++)this.modules[h][6]==null&&(this.modules[h][6]=h%2==0);for(var m=8;m<this.moduleCount-8;m++)this.modules[6][m]==null&&(this.modules[6][m]=m%2==0)},d.prototype.setupPositionAdjustPattern=function(){for(var h=a.getPatternPosition(this.typeNumber),m=0;m<h.length;m++)for(var v=0;v<h.length;v++){var g=h[m],w=h[v];if(this.modules[g][w]==null)for(var E=-2;E<=2;E++)for(var _=-2;_<=2;_++)E==-2||E==2||_==-2||_==2||E==0&&_==0?this.modules[g+E][w+_]=!0:this.modules[g+E][w+_]=!1}},d.prototype.setupTypeNumber=function(h){for(var m=a.getBCHTypeNumber(this.typeNumber),v=0;v<18;v++){var g=!h&&(m>>v&1)==1;this.modules[Math.floor(v/3)][v%3+this.moduleCount-8-3]=g}for(var v=0;v<18;v++){var g=!h&&(m>>v&1)==1;this.modules[v%3+this.moduleCount-8-3][Math.floor(v/3)]=g}},d.prototype.setupTypeInfo=function(h,m){for(var v=this.errorCorrectLevel<<3|m,g=a.getBCHTypeInfo(v),w=0;w<15;w++){var E=!h&&(g>>w&1)==1;w<6?this.modules[w][8]=E:w<8?this.modules[w+1][8]=E:this.modules[this.moduleCount-15+w][8]=E}for(var w=0;w<15;w++){var E=!h&&(g>>w&1)==1;w<8?this.modules[8][this.moduleCount-w-1]=E:w<9?this.modules[8][15-w-1+1]=E:this.modules[8][15-w-1]=E}this.modules[this.moduleCount-8][8]=!h},d.prototype.mapData=function(h,m){for(var v=-1,g=this.moduleCount-1,w=7,E=0,_=this.moduleCount-1;_>0;_-=2)for(_==6&&_--;;){for(var y=0;y<2;y++)if(this.modules[g][_-y]==null){var b=!1;E<h.length&&(b=(h[E]>>>w&1)==1);var C=a.getMask(m,g,_-y);C&&(b=!b),this.modules[g][_-y]=b,w--,w==-1&&(E++,w=7)}if(g+=v,g<0||this.moduleCount<=g){g-=v,v=-v;break}}},d.createData=function(h,m,v){for(var g=u.getRSBlocks(h,m),w=new f,E=0;E<v.length;E++){var _=v[E];w.put(_.mode,4),w.put(_.getLength(),a.getLengthInBits(_.mode,h)),_.write(w)}for(var y=0,E=0;E<g.length;E++)y+=g[E].dataCount;if(w.getLengthInBits()>y*8)throw new Error("code length overflow. ("+w.getLengthInBits()+">"+y*8+")");for(w.getLengthInBits()+4<=y*8&&w.put(0,4);w.getLengthInBits()%8!=0;)w.putBit(!1);for(;!(w.getLengthInBits()>=y*8||(w.put(d.PAD0,8),w.getLengthInBits()>=y*8));)w.put(d.PAD1,8);return d.createBytes(w,g)},d.createBytes=function(h,m){for(var v=0,g=0,w=0,E=new Array(m.length),_=new Array(m.length),y=0;y<m.length;y++){var b=m[y].dataCount,C=m[y].totalCount-b;g=Math.max(g,b),w=Math.max(w,C),E[y]=new Array(b);for(var k=0;k<E[y].length;k++)E[y][k]=255&h.buffer[k+v];v+=b;var D=a.getErrorCorrectPolynomial(C),O=new c(E[y],D.getLength()-1),A=O.mod(D);_[y]=new Array(D.getLength()-1);for(var k=0;k<_[y].length;k++){var V=k+A.getLength()-_[y].length;_[y][k]=V>=0?A.get(V):0}}for(var L=0,k=0;k<m.length;k++)L+=m[k].totalCount;for(var N=new Array(L),R=0,k=0;k<g;k++)for(var y=0;y<m.length;y++)k<E[y].length&&(N[R++]=E[y][k]);for(var k=0;k<w;k++)for(var y=0;y<m.length;y++)k<_[y].length&&(N[R++]=_[y][k]);return N},d.PAD0=236,d.PAD1=17,d}();t.QRCodeModel=i,t.QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var o={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};t.QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var a=function(){function d(){}return d.getBCHTypeInfo=function(h){for(var m=h<<10;d.getBCHDigit(m)-d.getBCHDigit(d.G15)>=0;)m^=d.G15<<d.getBCHDigit(m)-d.getBCHDigit(d.G15);return(h<<10|m)^d.G15_MASK},d.getBCHTypeNumber=function(h){for(var m=h<<12;d.getBCHDigit(m)-d.getBCHDigit(d.G18)>=0;)m^=d.G18<<d.getBCHDigit(m)-d.getBCHDigit(d.G18);return h<<12|m},d.getBCHDigit=function(h){for(var m=0;h!=0;)m++,h>>>=1;return m},d.getPatternPosition=function(h){return d.PATTERN_POSITION_TABLE[h-1]},d.getMask=function(h,m,v){switch(h){case t.QRMaskPattern.PATTERN000:return(m+v)%2==0;case t.QRMaskPattern.PATTERN001:return m%2==0;case t.QRMaskPattern.PATTERN010:return v%3==0;case t.QRMaskPattern.PATTERN011:return(m+v)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(m/2)+Math.floor(v/3))%2==0;case t.QRMaskPattern.PATTERN101:return m*v%2+m*v%3==0;case t.QRMaskPattern.PATTERN110:return(m*v%2+m*v%3)%2==0;case t.QRMaskPattern.PATTERN111:return(m*v%3+(m+v)%2)%2==0;default:throw new Error("bad maskPattern:"+h)}},d.getErrorCorrectPolynomial=function(h){for(var m=new c([1],0),v=0;v<h;v++)m=m.multiply(new c([1,l.gexp(v)],0));return m},d.getLengthInBits=function(h,m){if(1<=m&&m<10)switch(h){case o.MODE_NUMBER:return 10;case o.MODE_ALPHA_NUM:return 9;case o.MODE_8BIT_BYTE:return 8;case o.MODE_KANJI:return 8;default:throw new Error("mode:"+h)}else if(m<27)switch(h){case o.MODE_NUMBER:return 12;case o.MODE_ALPHA_NUM:return 11;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 10;default:throw new Error("mode:"+h)}else if(m<41)switch(h){case o.MODE_NUMBER:return 14;case o.MODE_ALPHA_NUM:return 13;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 12;default:throw new Error("mode:"+h)}else throw new Error("type:"+m)},d.getLostPoint=function(h){for(var m=h.getModuleCount(),v=0,g=0;g<m;g++)for(var w=0;w<m;w++){for(var E=0,_=h.isDark(g,w),y=-1;y<=1;y++)if(!(g+y<0||m<=g+y))for(var b=-1;b<=1;b++)w+b<0||m<=w+b||y==0&&b==0||_==h.isDark(g+y,w+b)&&E++;E>5&&(v+=3+E-5)}for(var g=0;g<m-1;g++)for(var w=0;w<m-1;w++){var C=0;h.isDark(g,w)&&C++,h.isDark(g+1,w)&&C++,h.isDark(g,w+1)&&C++,h.isDark(g+1,w+1)&&C++,(C==0||C==4)&&(v+=3)}for(var g=0;g<m;g++)for(var w=0;w<m-6;w++)h.isDark(g,w)&&!h.isDark(g,w+1)&&h.isDark(g,w+2)&&h.isDark(g,w+3)&&h.isDark(g,w+4)&&!h.isDark(g,w+5)&&h.isDark(g,w+6)&&(v+=40);for(var w=0;w<m;w++)for(var g=0;g<m-6;g++)h.isDark(g,w)&&!h.isDark(g+1,w)&&h.isDark(g+2,w)&&h.isDark(g+3,w)&&h.isDark(g+4,w)&&!h.isDark(g+5,w)&&h.isDark(g+6,w)&&(v+=40);for(var k=0,w=0;w<m;w++)for(var g=0;g<m;g++)h.isDark(g,w)&&k++;var D=Math.abs(100*k/m/m-50)/5;return v+=D*10,v},d.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],d.G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,d.G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,d.G15_MASK=1<<14|1<<12|1<<10|1<<4|1<<1,d}();t.QRUtil=a;var l=function(){function d(){}return d.glog=function(h){if(h<1)throw new Error("glog("+h+")");return d.LOG_TABLE[h]},d.gexp=function(h){for(;h<0;)h+=255;for(;h>=256;)h-=255;return d.EXP_TABLE[h]},d.EXP_TABLE=new Array(256),d.LOG_TABLE=new Array(256),d._constructor=function(){for(var h=0;h<8;h++)d.EXP_TABLE[h]=1<<h;for(var h=8;h<256;h++)d.EXP_TABLE[h]=d.EXP_TABLE[h-4]^d.EXP_TABLE[h-5]^d.EXP_TABLE[h-6]^d.EXP_TABLE[h-8];for(var h=0;h<255;h++)d.LOG_TABLE[d.EXP_TABLE[h]]=h}(),d}();t.QRMath=l;var c=function(){function d(h,m){if(h.length==null)throw new Error(h.length+"/"+m);for(var v=0;v<h.length&&h[v]==0;)v++;this.num=new Array(h.length-v+m);for(var g=0;g<h.length-v;g++)this.num[g]=h[g+v]}return d.prototype.get=function(h){return this.num[h]},d.prototype.getLength=function(){return this.num.length},d.prototype.multiply=function(h){for(var m=new Array(this.getLength()+h.getLength()-1),v=0;v<this.getLength();v++)for(var g=0;g<h.getLength();g++)m[v+g]^=l.gexp(l.glog(this.get(v))+l.glog(h.get(g)));return new d(m,0)},d.prototype.mod=function(h){if(this.getLength()-h.getLength()<0)return this;for(var m=l.glog(this.get(0))-l.glog(h.get(0)),v=new Array(this.getLength()),g=0;g<this.getLength();g++)v[g]=this.get(g);for(var g=0;g<h.getLength();g++)v[g]^=l.gexp(l.glog(h.get(g))+m);return new d(v,0).mod(h)},d}(),u=function(){function d(h,m){this.totalCount=h,this.dataCount=m}return d.getRSBlocks=function(h,m){var v=d.getRsBlockTable(h,m);if(v==null)throw new Error("bad rs block @ typeNumber:"+h+"/errorCorrectLevel:"+m);for(var g=v.length/3,w=[],E=0;E<g;E++)for(var _=v[E*3+0],y=v[E*3+1],b=v[E*3+2],C=0;C<_;C++)w.push(new d(y,b));return w},d.getRsBlockTable=function(h,m){switch(m){case t.QRErrorCorrectLevel.L:return d.RS_BLOCK_TABLE[(h-1)*4+0];case t.QRErrorCorrectLevel.M:return d.RS_BLOCK_TABLE[(h-1)*4+1];case t.QRErrorCorrectLevel.Q:return d.RS_BLOCK_TABLE[(h-1)*4+2];case t.QRErrorCorrectLevel.H:return d.RS_BLOCK_TABLE[(h-1)*4+3];default:return}},d.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],d}(),f=function(){function d(){this.buffer=[],this.length=0}return d.prototype.get=function(h){var m=Math.floor(h/8);return(this.buffer[m]>>>7-h%8&1)==1},d.prototype.put=function(h,m){for(var v=0;v<m;v++)this.putBit((h>>>m-v-1&1)==1)},d.prototype.getLengthInBits=function(){return this.length},d.prototype.putBit=function(h){var m=Math.floor(this.length/8);this.buffer.length<=m&&this.buffer.push(0),h&&(this.buffer[m]|=128>>>this.length%8),this.length++},d}(),p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]]})(Ya);var Si={},Yr={};const ub="bold|bolder|lighter|[1-9]00",hb="italic|oblique",fb="small-caps",db="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",pb="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",Hc=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,gb=new RegExp(`(${ub}) +`,"i"),mb=new RegExp(`(${hb}) +`,"i"),yb=new RegExp(`(${fb}) +`,"i"),vb=new RegExp(`(${db}) +`,"i"),wb=new RegExp(`([\\d\\.]+)(${pb}) *((?:${Hc})( *, *(?:${Hc}))*)`),ao={},bb=16;var _b=t=>{if(ao[t])return ao[t];const e=wb.exec(t);if(!e)return;const n={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(e[1]),unit:e[2],family:e[3].replace(/["']/g,"").replace(/ *, */g,",")};let r,s,i,o;const a=t.substring(0,e.index);switch((r=gb.exec(a))&&(n.weight=r[1]),(s=mb.exec(a))&&(n.style=s[1]),(i=yb.exec(a))&&(n.variant=i[1]),(o=vb.exec(a))&&(n.stretch=o[1]),n.unit){case"pt":n.size/=.75;break;case"pc":n.size*=16;break;case"in":n.size*=96;break;case"cm":n.size*=96/2.54;break;case"mm":n.size*=96/25.4;break;case"%":break;case"em":case"rem":n.size*=bb/.75;break;case"q":n.size*=96/25.4/4;break}return ao[t]=n};const Eb=_b;Yr.parseFont=Eb;Yr.createCanvas=function(t,e){return Object.assign(document.createElement("canvas"),{width:t,height:e})};Yr.createImageData=function(t,e,n){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(t);case 2:return new ImageData(t,e);default:return new ImageData(t,e,n)}};Yr.loadImage=function(t,e){return new Promise(function(n,r){const s=Object.assign(document.createElement("img"),e);function i(){s.onload=null,s.onerror=null}s.onload=function(){i(),n(s)},s.onerror=function(){i(),r(new Error('Failed to load the image "'+t+'"'))},s.src=t})};var qd={},zd={},It={};Object.defineProperty(It,"__esModule",{value:!0});It.loop=It.conditional=It.parse=void 0;var kb=function t(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;if(Array.isArray(n))n.forEach(function(o){return t(e,o,r,s)});else if(typeof n=="function")n(e,r,s,t);else{var i=Object.keys(n)[0];Array.isArray(n[i])?(s[i]={},t(e,n[i],r,s[i])):s[i]=n[i](e,r,s,t)}return r};It.parse=kb;var Tb=function(e,n){return function(r,s,i,o){n(r,s,i)&&o(r,e,s,i)}};It.conditional=Tb;var Ib=function(e,n){return function(r,s,i,o){for(var a=[],l=r.pos;n(r,s,i);){var c={};if(o(r,e,s,c),r.pos===l)break;l=r.pos,a.push(c)}return a}};It.loop=Ib;var me={};Object.defineProperty(me,"__esModule",{value:!0});me.readBits=me.readArray=me.readUnsigned=me.readString=me.peekBytes=me.readBytes=me.peekByte=me.readByte=me.buildStream=void 0;var Cb=function(e){return{data:e,pos:0}};me.buildStream=Cb;var Hd=function(){return function(e){return e.data[e.pos++]}};me.readByte=Hd;var Sb=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(n){return n.data[n.pos+e]}};me.peekByte=Sb;var Ai=function(e){return function(n){return n.data.subarray(n.pos,n.pos+=e)}};me.readBytes=Ai;var Ab=function(e){return function(n){return n.data.subarray(n.pos,n.pos+e)}};me.peekBytes=Ab;var Db=function(e){return function(n){return Array.from(Ai(e)(n)).map(function(r){return String.fromCharCode(r)}).join("")}};me.readString=Db;var Rb=function(e){return function(n){var r=Ai(2)(n);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};me.readUnsigned=Rb;var Nb=function(e,n){return function(r,s,i){for(var o=typeof n=="function"?n(r,s,i):n,a=Ai(e),l=new Array(o),c=0;c<o;c++)l[c]=a(r);return l}};me.readArray=Nb;var xb=function(e,n,r){for(var s=0,i=0;i<r;i++)s+=e[n+i]&&Math.pow(2,r-i-1);return s},Mb=function(e){return function(n){for(var r=Hd()(n),s=new Array(8),i=0;i<8;i++)s[7-i]=!!(r&1<<i);return Object.keys(e).reduce(function(o,a){var l=e[a];return l.length?o[a]=xb(s,l.index,l.length):o[a]=s[l.index],o},{})}};me.readBits=Mb;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=It,n=me,r={blocks:function(p){for(var d=0,h=[],m=p.data.length,v=0,g=(0,n.readByte)()(p);g!==d&&g;g=(0,n.readByte)()(p)){if(p.pos+g>=m){var w=m-p.pos;h.push((0,n.readBytes)(w)(p)),v+=w;break}h.push((0,n.readBytes)(g)(p)),v+=g}for(var E=new Uint8Array(v),_=0,y=0;y<h.length;y++)E.set(h[y],_),_+=h[y].length;return E}},s=(0,e.conditional)({gce:[{codes:(0,n.readBytes)(2)},{byteSize:(0,n.readByte)()},{extras:(0,n.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,n.readUnsigned)(!0)},{transparentColorIndex:(0,n.readByte)()},{terminator:(0,n.readByte)()}]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===249}),i=(0,e.conditional)({image:[{code:(0,n.readByte)()},{descriptor:[{left:(0,n.readUnsigned)(!0)},{top:(0,n.readUnsigned)(!0)},{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{lct:(0,n.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,n.readArray)(3,function(f,p,d){return Math.pow(2,d.descriptor.lct.size+1)})},function(f,p,d){return d.descriptor.lct.exists}),{data:[{minCodeSize:(0,n.readByte)()},r]}]},function(f){return(0,n.peekByte)()(f)===44}),o=(0,e.conditional)({text:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{preData:function(p,d,h){return(0,n.readBytes)(h.text.blockSize)(p)}},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===1}),a=(0,e.conditional)({application:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{id:function(p,d,h){return(0,n.readString)(h.blockSize)(p)}},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===255}),l=(0,e.conditional)({comment:[{codes:(0,n.readBytes)(2)},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===254}),c=[{header:[{signature:(0,n.readString)(3)},{version:(0,n.readString)(3)}]},{lsd:[{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{gct:(0,n.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,n.readByte)()},{pixelAspectRatio:(0,n.readByte)()}]},(0,e.conditional)({gct:(0,n.readArray)(3,function(f,p){return Math.pow(2,p.lsd.gct.size+1)})},function(f,p){return p.lsd.gct.exists}),{frames:(0,e.loop)([s,a,l,i,o],function(f){var p=(0,n.peekByte)()(f);return p===33||p===44})}],u=c;t.default=u})(zd);var Di={};Object.defineProperty(Di,"__esModule",{value:!0});Di.deinterlace=void 0;Di.deinterlace=function(t,e){for(var n=new Array(t.length),r=t.length/e,s=function(u,f){var p=t.slice(f*e,(f+1)*e);n.splice.apply(n,[u*e,e].concat(p))},i=[0,4,2,1],o=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=i[l];c<r;c+=o[l])s(c,a),a++;return n};var Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});Ri.lzw=void 0;Ri.lzw=function(t,e,n){var r=4096,s=-1,i=n,o,a,l,c,u,f,p,y,d,h,_,m,b,C,D,k,v=new Array(n),g=new Array(r),w=new Array(r),E=new Array(r+1);for(m=t,a=1<<m,u=a+1,o=a+2,p=s,c=m+1,l=(1<<c)-1,d=0;d<a;d++)g[d]=0,w[d]=d;var _,y,b,C,k,D;for(_=y=b=C=k=D=0,h=0;h<i;){if(C===0){if(y<c){_+=e[D]<<y,y+=8,D++;continue}if(d=_&l,_>>=c,y-=c,d>o||d==u)break;if(d==a){c=m+1,l=(1<<c)-1,o=a+2,p=s;continue}if(p==s){E[C++]=w[d],p=d,b=d;continue}for(f=d,d==o&&(E[C++]=b,d=p);d>a;)E[C++]=w[d],d=g[d];b=w[d]&255,E[C++]=b,o<r&&(g[o]=p,w[o]=b,o++,(o&l)===0&&o<r&&(c++,l+=o)),p=f}C--,v[k++]=E[C],h++}for(h=k;h<i;h++)v[h]=0;return v};(function(t){var e=Ne&&Ne.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(t,"__esModule",{value:!0}),t.decompressFrames=t.decompressFrame=t.parseGIF=void 0;var n=e(zd),r=It,s=me,i=Di,o=Ri;t.parseGIF=function(l){var c=new Uint8Array(l);return r.parse(s.buildStream(c),n.default)};var a=function(l){for(var c=l.pixels.length,u=new Uint8ClampedArray(c*4),f=0;f<c;f++){var p=f*4,d=l.pixels[f],h=l.colorTable[d];u[p]=h[0],u[p+1]=h[1],u[p+2]=h[2],u[p+3]=d!==l.transparentIndex?255:0}return u};t.decompressFrame=function(l,c,u){if(!l.image){console.warn("gif frame does not have associated image.");return}var f=l.image,p=f.descriptor.width*f.descriptor.height,d=o.lzw(f.data.minCodeSize,f.data.blocks,p);f.descriptor.lct.interlaced&&(d=i.deinterlace(d,f.descriptor.width));var h={pixels:d,dims:{top:l.image.descriptor.top,left:l.image.descriptor.left,width:l.image.descriptor.width,height:l.image.descriptor.height}};return f.descriptor.lct&&f.descriptor.lct.exists?h.colorTable=f.lct:h.colorTable=c,l.gce&&(h.delay=(l.gce.delay||10)*10,h.disposalType=l.gce.extras.disposal,l.gce.extras.transparentColorGiven&&(h.transparentIndex=l.gce.transparentColorIndex)),u&&(h.patch=a(h)),h},t.decompressFrames=function(l,c){return l.frames.filter(function(u){return u.image}).map(function(u){return t.decompressFrame(u,l.gct,c)})}})(qd);var Lb=100,De=256,Gc=De-1,Ot=4,Gd=16,Ja=1<<Gd,Kd=10,Za=10,Ob=Ja>>Za,Pb=Ja<<Kd-Za,Fb=De>>3,Vo=6,Bb=1<<Vo,jb=Fb*Bb,Vb=30,Qd=10,ds=1<<Qd,Wd=8,Kc=1<<Wd,Ub=Qd+Wd,Tn=1<<Ub,Qc=499,Wc=491,Xc=487,Xd=503,$b=3*Xd;function qb(t,e){var n,r,s,i,o;function a(){n=[],r=new Int32Array(256),s=new Int32Array(De),i=new Int32Array(De),o=new Int32Array(De>>3);var g,w;for(g=0;g<De;g++)w=(g<<Ot+8)/De,n[g]=new Float64Array([w,w,w,0]),i[g]=Ja/De,s[g]=0}function l(){for(var g=0;g<De;g++)n[g][0]>>=Ot,n[g][1]>>=Ot,n[g][2]>>=Ot,n[g][3]=g}function c(g,w,E,_,y){n[w][0]-=g*(n[w][0]-E)/ds,n[w][1]-=g*(n[w][1]-_)/ds,n[w][2]-=g*(n[w][2]-y)/ds}function u(g,w,E,_,y){for(var b=Math.abs(w-g),C=Math.min(w+g,De),k=w+1,D=w-1,O=1,A,V;k<C||D>b;)V=o[O++],k<C&&(A=n[k++],A[0]-=V*(A[0]-E)/Tn,A[1]-=V*(A[1]-_)/Tn,A[2]-=V*(A[2]-y)/Tn),D>b&&(A=n[D--],A[0]-=V*(A[0]-E)/Tn,A[1]-=V*(A[1]-_)/Tn,A[2]-=V*(A[2]-y)/Tn)}function f(g,w,E){var _=2147483647,y=_,b=-1,C=b,k,D,O,A,V;for(k=0;k<De;k++)D=n[k],O=Math.abs(D[0]-g)+Math.abs(D[1]-w)+Math.abs(D[2]-E),O<_&&(_=O,b=k),A=O-(s[k]>>Gd-Ot),A<y&&(y=A,C=k),V=i[k]>>Za,i[k]-=V,s[k]+=V<<Kd;return i[b]+=Ob,s[b]-=Pb,C}function p(){var g,w,E,_,y,b,C=0,k=0;for(g=0;g<De;g++){for(E=n[g],y=g,b=E[1],w=g+1;w<De;w++)_=n[w],_[1]<b&&(y=w,b=_[1]);if(_=n[y],g!=y&&(w=_[0],_[0]=E[0],E[0]=w,w=_[1],_[1]=E[1],E[1]=w,w=_[2],_[2]=E[2],E[2]=w,w=_[3],_[3]=E[3],E[3]=w),b!=C){for(r[C]=k+g>>1,w=C+1;w<b;w++)r[w]=g;C=b,k=g}}for(r[C]=k+Gc>>1,w=C+1;w<256;w++)r[w]=Gc}function d(g,w,E){for(var _,y,b,C=1e3,k=-1,D=r[w],O=D-1;D<De||O>=0;)D<De&&(y=n[D],b=y[1]-w,b>=C?D=De:(D++,b<0&&(b=-b),_=y[0]-g,_<0&&(_=-_),b+=_,b<C&&(_=y[2]-E,_<0&&(_=-_),b+=_,b<C&&(C=b,k=y[3])))),O>=0&&(y=n[O],b=w-y[1],b>=C?O=-1:(O--,b<0&&(b=-b),_=y[0]-g,_<0&&(_=-_),b+=_,b<C&&(_=y[2]-E,_<0&&(_=-_),b+=_,b<C&&(C=b,k=y[3]))));return k}function h(){var g,w=t.length,E=30+(e-1)/3,_=w/(3*e),y=~~(_/Lb),b=ds,C=jb,k=C>>Vo;for(k<=1&&(k=0),g=0;g<k;g++)o[g]=b*((k*k-g*g)*Kc/(k*k));var D;w<$b?(e=1,D=3):w%Qc!==0?D=3*Qc:w%Wc!==0?D=3*Wc:w%Xc!==0?D=3*Xc:D=3*Xd;var O,A,V,L,N=0;for(g=0;g<_;)if(O=(t[N]&255)<<Ot,A=(t[N+1]&255)<<Ot,V=(t[N+2]&255)<<Ot,L=f(O,A,V),c(b,L,O,A,V),k!==0&&u(k,L,O,A,V),N+=D,N>=w&&(N-=w),g++,y===0&&(y=1),g%y===0)for(b-=b/E,C-=C/Vb,k=C>>Vo,k<=1&&(k=0),L=0;L<k;L++)o[L]=b*((k*k-L*L)*Kc/(k*k))}function m(){a(),h(),l(),p()}this.buildColormap=m;function v(){for(var g=[],w=[],E=0;E<De;E++)w[n[E][3]]=E;for(var _=0,y=0;y<De;y++){var b=w[y];g[_++]=n[b][0],g[_++]=n[b][1],g[_++]=n[b][2]}return g}this.getColormap=v,this.lookupRGB=d}var zb=qb,Yc=-1,ps=12,sr=5003,Hb=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function Gb(t,e,n,r){var s=Math.max(2,r),i=new Uint8Array(256),o=new Int32Array(sr),a=new Int32Array(sr),l,c=0,u,f=0,p,d=!1,h,m,v,g,w,E;function _(L,N){i[u++]=L,u>=254&&D(N)}function y(L){b(sr),f=m+2,d=!0,V(m,L)}function b(L){for(var N=0;N<L;++N)o[N]=-1}function C(L,N){var R,de,K,ie,le,ge,ke;for(h=L,d=!1,E=h,p=O(E),m=1<<L-1,v=m+1,f=m+2,u=0,ie=A(),ke=0,R=sr;R<65536;R*=2)++ke;ke=8-ke,ge=sr,b(ge),V(m,N);e:for(;(de=A())!=Yc;){if(R=(de<<ps)+ie,K=de<<ke^ie,o[K]===R){ie=a[K];continue}else if(o[K]>=0){le=ge-K,K===0&&(le=1);do if((K-=le)<0&&(K+=ge),o[K]===R){ie=a[K];continue e}while(o[K]>=0)}V(ie,N),ie=de,f<1<<ps?(a[K]=f++,o[K]=R):y(N)}V(ie,N),V(v,N)}function k(L){L.writeByte(s),g=t*e,w=0,C(s+1,L),L.writeByte(0)}function D(L){u>0&&(L.writeByte(u),L.writeBytes(i,0,u),u=0)}function O(L){return(1<<L)-1}function A(){if(g===0)return Yc;--g;var L=n[w++];return L&255}function V(L,N){for(l&=Hb[c],c>0?l|=L<<c:l=L,c+=E;c>=8;)_(l&255,N),l>>=8,c-=8;if((f>p||d)&&(d?(p=O(E=h),d=!1):(++E,E==ps?p=1<<ps:p=O(E))),L==v){for(;c>0;)_(l&255,N),l>>=8,c-=8;D(N)}}this.encode=k}var Kb=Gb,Qb=zb,Wb=Kb;function nt(){this.page=-1,this.pages=[],this.newPage()}nt.pageSize=4096;nt.charMap={};for(var gs=0;gs<256;gs++)nt.charMap[gs]=String.fromCharCode(gs);nt.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(nt.pageSize),this.cursor=0};nt.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var n=0;n<nt.pageSize;n++)t+=nt.charMap[this.pages[e][n]];return t};nt.prototype.toFlattenUint8Array=function(){for(var t=[],e=0;e<this.pages.length;e++)if(e===this.pages.length-1){var n=Uint8Array.from(this.pages[e].slice(0,this.cursor));t.push(n)}else t.push(this.pages[e]);var r=new Uint8Array(t.reduce(function(s,i){return s+i.length},0));return t.reduce(function(s,i){return r.set(i,s),s+i.length},0),r};nt.prototype.writeByte=function(t){this.cursor>=nt.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t};nt.prototype.writeUTFBytes=function(t){for(var e=t.length,n=0;n<e;n++)this.writeByte(t.charCodeAt(n))};nt.prototype.writeBytes=function(t,e,n){for(var r=n||t.length,s=e||0;s<r;s++)this.writeByte(t[s])};function ae(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new nt}ae.prototype.setDelay=function(t){this.delay=Math.round(t/10)};ae.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)};ae.prototype.setDispose=function(t){t>=0&&(this.dispose=t)};ae.prototype.setRepeat=function(t){this.repeat=t};ae.prototype.setTransparent=function(t){this.transparent=t};ae.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};ae.prototype.finish=function(){this.out.writeByte(59)};ae.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t};ae.prototype.setDither=function(t){t===!0&&(t="FloydSteinberg"),this.dither=t};ae.prototype.setGlobalPalette=function(t){this.globalPalette=t};ae.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};ae.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};ae.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new Qb(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};ae.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var n=0,r=0;r<e;r++){var s=this.findClosestRGB(this.pixels[n++]&255,this.pixels[n++]&255,this.pixels[n++]&255);this.usedEntry[s]=!0,this.indexedPixels[r]=s}};ae.prototype.ditherPixels=function(t,e){var n={FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],Stucki:[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]};if(!t||!n[t])throw"Unknown dithering kernel: "+t;var r=n[t],s=0,i=this.height,o=this.width,a=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var c=0;c<i;c++){e&&(l=l*-1);for(var u=l==1?0:o-1,f=l==1?o:0;u!==f;u+=l){s=c*o+u;var p=s*3,d=a[p],h=a[p+1],m=a[p+2];p=this.findClosestRGB(d,h,m),this.usedEntry[p]=!0,this.indexedPixels[s]=p,p*=3;for(var v=this.colorTab[p],g=this.colorTab[p+1],w=this.colorTab[p+2],E=d-v,_=h-g,y=m-w,b=l==1?0:r.length-1,C=l==1?r.length:0;b!==C;b+=l){var k=r[b][1],D=r[b][2];if(k+u>=0&&k+u<o&&D+c>=0&&D+c<i){var O=r[b][0];p=s+k+D*o,p*=3,a[p]=Math.max(0,Math.min(255,a[p]+E*O)),a[p+1]=Math.max(0,Math.min(255,a[p+1]+_*O)),a[p+2]=Math.max(0,Math.min(255,a[p+2]+y*O))}}}}};ae.prototype.findClosest=function(t,e){return this.findClosestRGB((t&16711680)>>16,(t&65280)>>8,t&255,e)};ae.prototype.findClosestRGB=function(t,e,n,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,n);for(var s=0,i=256*256*256,o=this.colorTab.length,a=0,l=0;a<o;l++){var c=t-(this.colorTab[a++]&255),u=e-(this.colorTab[a++]&255),f=n-(this.colorTab[a++]&255),p=c*c+u*u+f*f;(!r||this.usedEntry[l])&&p<i&&(i=p,s=l)}return s};ae.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var n=this.image,r=0,s=0,i=0;i<e;i++)for(var o=0;o<t;o++)this.pixels[s++]=n[r++],this.pixels[s++]=n[r++],this.pixels[s++]=n[r++],r++};ae.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var t,e;this.transparent===null?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=this.dispose&7),e<<=2,this.out.writeByte(0|e|0|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};ae.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)};ae.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};ae.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};ae.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=3*256-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)};ae.prototype.writeShort=function(t){this.out.writeByte(t&255),this.out.writeByte(t>>8&255)};ae.prototype.writePixels=function(){var t=new Wb(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)};ae.prototype.stream=function(){return this.out};var Xb=ae,Hs=Ne&&Ne.__assign||function(){return Hs=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Hs.apply(this,arguments)},Yb=Ne&&Ne.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})},Jb=Ne&&Ne.__generator||function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,s=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],s=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},Zb=Ne&&Ne.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Si,"__esModule",{value:!0});Si.AwesomeQR=void 0;var pt=Yr,Jc=qd,ms=Ya,e_=Zb(Xb),ys=.4,t_=function(){function t(e){var n=Object.assign({},e);if(Object.keys(t.defaultOptions).forEach(function(r){r in n||Object.defineProperty(n,r,{value:t.defaultOptions[r],enumerable:!0,writable:!0})}),n.components?typeof n.components=="object"&&Object.keys(t.defaultComponentOptions).forEach(function(r){r in n.components?Object.defineProperty(n.components,r,{value:Hs(Hs({},t.defaultComponentOptions[r]),n.components[r]),enumerable:!0,writable:!0}):Object.defineProperty(n.components,r,{value:t.defaultComponentOptions[r],enumerable:!0,writable:!0})}):n.components=t.defaultComponentOptions,n.dotScale!==null&&n.dotScale!==void 0){if(n.dotScale<=0||n.dotScale>1)throw new Error("dotScale should be in range (0, 1].");n.components.data.scale=n.dotScale,n.components.timing.scale=n.dotScale,n.components.alignment.scale=n.dotScale}this.options=n,this.canvas=pt.createCanvas(e.size,e.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new ms.QRCodeModel(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}return t.prototype.draw=function(){var e=this;return new Promise(function(n){return e._draw().then(n)})},t.prototype._clear=function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},t._prepareRoundedCornerClip=function(e,n,r,s,i,o){e.beginPath(),e.moveTo(n,r),e.arcTo(n+s,r,n+s,r+i,o),e.arcTo(n+s,r+i,n,r+i,o),e.arcTo(n,r+i,n,r,o),e.arcTo(n,r,n+s,r,o),e.closePath()},t._getAverageRGB=function(e){var n=5,r={r:0,g:0,b:0},s,i,o=-4,a={r:0,g:0,b:0},l=0;i=e.naturalHeight||e.height,s=e.naturalWidth||e.width;var c=pt.createCanvas(s,i),u=c.getContext("2d");if(!u)return r;u.drawImage(e,0,0);var f;try{f=u.getImageData(0,0,s,i)}catch{return r}for(;(o+=n*4)<f.data.length;)f.data[o]>200||f.data[o+1]>200||f.data[o+2]>200||(++l,a.r+=f.data[o],a.g+=f.data[o+1],a.b+=f.data[o+2]);return a.r=~~(a.r/l),a.g=~~(a.g/l),a.b=~~(a.b/l),a},t._drawDot=function(e,n,r,s,i,o){i===void 0&&(i=0),o===void 0&&(o=1),e.fillRect((n+i)*s,(r+i)*s,o*s,o*s)},t._drawAlignProtector=function(e,n,r,s){e.clearRect((n-2)*s,(r-2)*s,5*s,5*s),e.fillRect((n-2)*s,(r-2)*s,5*s,5*s)},t._drawAlign=function(e,n,r,s,i,o,a,l){i===void 0&&(i=0),o===void 0&&(o=1);var c=e.fillStyle;e.fillStyle=a,new Array(4).fill(0).map(function(u,f){t._drawDot(e,n-2+f,r-2,s,i,o),t._drawDot(e,n+2,r-2+f,s,i,o),t._drawDot(e,n+2-f,r+2,s,i,o),t._drawDot(e,n-2,r+2-f,s,i,o)}),t._drawDot(e,n,r,s,i,o),l||(e.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map(function(u,f){t._drawDot(e,n-1+f,r-1,s,i,o),t._drawDot(e,n+1,r-1+f,s,i,o),t._drawDot(e,n+1-f,r+1,s,i,o),t._drawDot(e,n-1,r+1-f,s,i,o)})),e.fillStyle=c},t.prototype._draw=function(){var e,n,r,s,i,o,a,l,c,u,f,p,d,h,m,v,g,w,E;return Yb(this,void 0,void 0,function(){var _,y,b,C,k,D,O,A,V,L,N,R,de,K,ie,le,ge,ke,ct,ye,Nt,oe,Te,xt,te,Z,yt,Kt,He,Xe,Ni,wn,nl,dt,oe,xi,Mi,rl,st,sl,oe,_t,it,ot,Jr,Li,oe,Oi,il,Pi,ol,oe,_t,it,ot,al,Yn,Mt,Jn,Lt,Zn,Zr,ll,Et,bn,er,_n,Fi,es,cl,ul,Bi,hl;return Jb(this,function(tr){switch(tr.label){case 0:if(_=(e=this.qrCode)===null||e===void 0?void 0:e.moduleCount,y=this.options.size,b=this.options.margin,(b<0||b*2>=y)&&(b=0),C=Math.ceil(b),k=y-2*b,D=this.options.whiteMargin,O=this.options.backgroundDimming,A=Math.ceil(k/_),V=A*_,L=V+2*C,N=pt.createCanvas(L,L),R=N.getContext("2d"),this._clear(),R.save(),R.translate(C,C),de=pt.createCanvas(L,L),K=de.getContext("2d"),ie=null,le=[],!this.options.gifBackground)return[3,1];if(ge=Jc.parseGIF(this.options.gifBackground),ie=ge,le=Jc.decompressFrames(ge,!0),this.options.autoColor){for(ke=0,ct=0,ye=0,Nt=0,oe=0;oe<le[0].colorTable.length;oe++)Te=le[0].colorTable[oe],!(Te[0]>200||Te[1]>200||Te[2]>200)&&(Te[0]===0&&Te[1]===0&&Te[2]===0||(Nt++,ke+=Te[0],ct+=Te[1],ye+=Te[2]));ke=~~(ke/Nt),ct=~~(ct/Nt),ye=~~(ye/Nt),this.options.colorDark="rgb("+ke+","+ct+","+ye+")"}return[3,4];case 1:return this.options.backgroundImage?[4,pt.loadImage(this.options.backgroundImage)]:[3,3];case 2:return xt=tr.sent(),this.options.autoColor&&(te=t._getAverageRGB(xt),this.options.colorDark="rgb("+te.r+","+te.g+","+te.b+")"),K.drawImage(xt,0,0,xt.width,xt.height,0,0,L,L),K.rect(0,0,L,L),K.fillStyle=O,K.fill(),[3,4];case 3:K.rect(0,0,L,L),K.fillStyle=this.options.colorLight,K.fill(),tr.label=4;case 4:for(Z=ms.QRUtil.getPatternPosition(this.qrCode.typeNumber),yt=((r=(n=this.options.components)===null||n===void 0?void 0:n.data)===null||r===void 0?void 0:r.scale)||ys,Kt=(1-yt)*.5,He=0;He<_;He++)for(Xe=0;Xe<_;Xe++){for(Ni=this.qrCode.isDark(He,Xe),wn=Xe<8&&(He<8||He>=_-8)||Xe>=_-8&&He<8,nl=He==6&&Xe>=8&&Xe<=_-8||Xe==6&&He>=8&&He<=_-8,dt=wn||nl,oe=1;oe<Z.length-1;oe++)dt=dt||He>=Z[oe]-2&&He<=Z[oe]+2&&Xe>=Z[oe]-2&&Xe<=Z[oe]+2;xi=Xe*A+(dt?0:Kt*A),Mi=He*A+(dt?0:Kt*A),R.strokeStyle=Ni?this.options.colorDark:this.options.colorLight,R.lineWidth=.5,R.fillStyle=Ni?this.options.colorDark:"rgba(255, 255, 255, 0.6)",Z.length===0?dt||R.fillRect(xi,Mi,(dt?1:yt)*A,(dt?1:yt)*A):(rl=Xe<_-4&&Xe>=_-4-5&&He<_-4&&He>=_-4-5,!dt&&!rl&&R.fillRect(xi,Mi,(dt?1:yt)*A,(dt?1:yt)*A))}if(st=Z[Z.length-1],sl="rgba(255, 255, 255, 0.6)",R.fillStyle=sl,R.fillRect(0,0,8*A,8*A),R.fillRect(0,(_-8)*A,8*A,8*A),R.fillRect((_-8)*A,0,8*A,8*A),!((i=(s=this.options.components)===null||s===void 0?void 0:s.timing)===null||i===void 0)&&i.protectors&&(R.fillRect(8*A,6*A,(_-8-8)*A,A),R.fillRect(6*A,8*A,A,(_-8-8)*A)),!((a=(o=this.options.components)===null||o===void 0?void 0:o.cornerAlignment)===null||a===void 0)&&a.protectors&&t._drawAlignProtector(R,st,st,A),!((c=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||c===void 0)&&c.protectors){for(oe=0;oe<Z.length;oe++)for(_t=0;_t<Z.length;_t++)if(it=Z[_t],ot=Z[oe],!(it===6&&(ot===6||ot===st))){if(ot===6&&(it===6||it===st))continue;if(it===st&&ot===st)continue;t._drawAlignProtector(R,it,ot,A)}}for(R.fillStyle=this.options.colorDark,R.fillRect(0,0,7*A,A),R.fillRect((_-7)*A,0,7*A,A),R.fillRect(0,6*A,7*A,A),R.fillRect((_-7)*A,6*A,7*A,A),R.fillRect(0,(_-7)*A,7*A,A),R.fillRect(0,(_-7+6)*A,7*A,A),R.fillRect(0,0,A,7*A),R.fillRect(6*A,0,A,7*A),R.fillRect((_-7)*A,0,A,7*A),R.fillRect((_-7+6)*A,0,A,7*A),R.fillRect(0,(_-7)*A,A,7*A),R.fillRect(6*A,(_-7)*A,A,7*A),R.fillRect(2*A,2*A,3*A,3*A),R.fillRect((_-7+2)*A,2*A,3*A,3*A),R.fillRect(2*A,(_-7+2)*A,3*A,3*A),Jr=((f=(u=this.options.components)===null||u===void 0?void 0:u.timing)===null||f===void 0?void 0:f.scale)||ys,Li=(1-Jr)*.5,oe=0;oe<_-8;oe+=2)t._drawDot(R,8+oe,6,A,Li,Jr),t._drawDot(R,6,8+oe,A,Li,Jr);for(Oi=((d=(p=this.options.components)===null||p===void 0?void 0:p.cornerAlignment)===null||d===void 0?void 0:d.scale)||ys,il=(1-Oi)*.5,t._drawAlign(R,st,st,A,il,Oi,this.options.colorDark,((m=(h=this.options.components)===null||h===void 0?void 0:h.cornerAlignment)===null||m===void 0?void 0:m.protectors)||!1),Pi=((g=(v=this.options.components)===null||v===void 0?void 0:v.alignment)===null||g===void 0?void 0:g.scale)||ys,ol=(1-Pi)*.5,oe=0;oe<Z.length;oe++)for(_t=0;_t<Z.length;_t++)if(it=Z[_t],ot=Z[oe],!(it===6&&(ot===6||ot===st))){if(ot===6&&(it===6||it===st))continue;if(it===st&&ot===st)continue;t._drawAlign(R,it,ot,A,ol,Pi,this.options.colorDark,((E=(w=this.options.components)===null||w===void 0?void 0:w.alignment)===null||E===void 0?void 0:E.protectors)||!1)}return D&&(R.fillStyle="#FFFFFF",R.fillRect(-C,-C,L,C),R.fillRect(-C,V,L,C),R.fillRect(V,-C,C,L),R.fillRect(-C,-C,C,L)),this.options.logoImage?[4,pt.loadImage(this.options.logoImage)]:[3,6];case 5:al=tr.sent(),Yn=this.options.logoScale,Mt=this.options.logoMargin,Jn=this.options.logoCornerRadius,(Yn<=0||Yn>=1)&&(Yn=.2),Mt<0&&(Mt=0),Jn<0&&(Jn=0),Lt=V*Yn,Zn=.5*(L-Lt),Zr=Zn,R.restore(),R.fillStyle="#FFFFFF",R.save(),t._prepareRoundedCornerClip(R,Zn-Mt,Zr-Mt,Lt+2*Mt,Lt+2*Mt,Jn+Mt),R.clip(),ll=R.globalCompositeOperation,R.globalCompositeOperation="destination-out",R.fill(),R.globalCompositeOperation=ll,R.restore(),R.save(),t._prepareRoundedCornerClip(R,Zn,Zr,Lt,Lt,Jn),R.clip(),R.drawImage(al,Zn,Zr,Lt,Lt),R.restore(),R.save(),R.translate(C,C),tr.label=6;case 6:if(ie){if(le.forEach(function(Qt){Et||(Et=new e_.default(y,y),Et.setDelay(Qt.delay),Et.setRepeat(0));var ts=Qt.dims,ns=ts.width,rs=ts.height;bn||(bn=pt.createCanvas(ns,rs),er=bn.getContext("2d"),er.rect(0,0,bn.width,bn.height),er.fillStyle="#ffffff",er.fill()),(!_n||!es||ns!==_n.width||rs!==_n.height)&&(_n=pt.createCanvas(ns,rs),Fi=_n.getContext("2d"),es=Fi.createImageData(ns,rs)),es.data.set(Qt.patch),Fi.putImageData(es,0,0),er.drawImage(_n,Qt.dims.left,Qt.dims.top);var fl=pt.createCanvas(L,L),nr=fl.getContext("2d");nr.drawImage(bn,0,0,L,L),nr.rect(0,0,L,L),nr.fillStyle=O,nr.fill(),nr.drawImage(N,0,0,L,L);var ji=pt.createCanvas(y,y),dl=ji.getContext("2d");dl.drawImage(fl,0,0,y,y),Et.addFrame(dl.getImageData(0,0,ji.width,ji.height).data)}),!Et)throw new Error("No frames.");return Et.finish(),Zc(this.canvas)?(cl=Et.stream().toFlattenUint8Array(),ul=cl.reduce(function(Qt,ts){return Qt+String.fromCharCode(ts)},""),[2,Promise.resolve("data:image/gif;base64,"+window.btoa(ul))]):[2,Promise.resolve(Buffer.from(Et.stream().toFlattenUint8Array()))]}else return K.drawImage(N,0,0,L,L),R.drawImage(de,-C,-C,L,L),Bi=pt.createCanvas(y,y),hl=Bi.getContext("2d"),hl.drawImage(N,0,0,y,y),this.canvas=Bi,Zc(this.canvas)?[2,Promise.resolve(this.canvas.toDataURL())]:[2,Promise.resolve(this.canvas.toBuffer())]}})})},t.CorrectLevel=ms.QRErrorCorrectLevel,t.defaultComponentOptions={data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}},t.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"#ffffff",correctLevel:ms.QRErrorCorrectLevel.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:t.defaultComponentOptions,autoColor:!0},t}();Si.AwesomeQR=t_;function Zc(t){try{return t instanceof HTMLElement}catch{return typeof t=="object"&&t.nodeType===1&&typeof t.style=="object"&&typeof t.ownerDocument=="object"}}(function(t){var e=Ne&&Ne.__createBinding||(Object.create?function(s,i,o,a){a===void 0&&(a=o),Object.defineProperty(s,a,{enumerable:!0,get:function(){return i[o]}})}:function(s,i,o,a){a===void 0&&(a=o),s[a]=i[o]}),n=Ne&&Ne.__exportStar||function(s,i){for(var o in s)o!=="default"&&!i.hasOwnProperty(o)&&e(i,s,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(Ya,t);var r=Si;Object.defineProperty(t,"AwesomeQR",{enumerable:!0,get:function(){return r.AwesomeQR}})})($d);const eu=async(t,e=300)=>await new $d.AwesomeQR({text:t,size:e}).draw(),el={password:{}},n_=(t,e,n)=>{el[t][e]=n},r_=(t,e)=>{delete el[t][e]},s_=t=>{const e=el[t];for(const n of Object.values(e))n()};function tu(t){let e,n=t[8]=="link"&&nu(t);return{c(){e=S("div"),n&&n.c(),I(e,"class","block border-b border-black bg-yellow-200 relative")},m(r,s){q(r,e,s),n&&n.m(e,null)},p(r,s){r[8]=="link"?n?n.p(r,s):(n=nu(r),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(r){r&&$(e),n&&n.d()}}}function nu(t){let e,n,r,s,i,o,a,l,c,u,f=t[12]?"Copied":"Copy",p,d,h,m;return{c(){e=S("div"),n=S("img"),s=F(),i=S("div"),o=S("div"),a=S("div"),l=S("input"),c=F(),u=S("button"),p=ce(f),I(n,"alt","qrcode"),gl(n.src,r=t[11])||I(n,"src",r),I(l,"class","bg-white w-full text-ellipsis inline-block flex-1 px-2"),I(l,"type","text"),l.readOnly=!0,I(l,"title",t[9]),l.value=t[9],I(u,"class",d=`${t[12]?"hover:bg-green-500":"hover:bg-nl"} float-right border-t border-black bg-gray-50 hover:text-white px-2 h-7`),I(a,"class","flex-1 border-black border-t border-b flex flex-col"),I(o,"class","flex items-center flex-1 min-w-[20rem]"),I(i,"class","flex flex-1 border-l border-black flex-col"),I(e,"class","flex flex-row flex-wrap-reverse justify-center")},m(v,g){q(v,e,g),T(e,n),T(e,s),T(e,i),T(i,o),T(o,a),T(a,l),T(a,c),T(a,u),T(u,p),h||(m=ne(u,"click",t[23]),h=!0)},p(v,g){g&2048&&!gl(n.src,r=v[11])&&I(n,"src",r),g&512&&I(l,"title",v[9]),g&512&&l.value!==v[9]&&(l.value=v[9]),g&4096&&f!==(f=v[12]?"Copied":"Copy")&&pe(p,f),g&4096&&d!==(d=`${v[12]?"hover:bg-green-500":"hover:bg-nl"} float-right border-t border-black bg-gray-50 hover:text-white px-2 h-7`)&&I(u,"class",d)},d(v){v&&$(e),h=!1,m()}}}function i_(t){var s;let e,n=((s=t[2])==null?void 0:s.name)+"",r;return{c(){e=S("h2"),r=ce(n),I(e,"class","font-semibold leading-tight text-3xl")},m(i,o){q(i,e,o),T(e,r)},p(i,o){var a;o&4&&n!==(n=((a=i[2])==null?void 0:a.name)+"")&&pe(r,n)},d(i){i&&$(e)}}}function o_(t){let e,n,r,s,i,o,a,l,c,u,f,p,d,h,m,v,g,w,E,_,y,b,C,k,D,O,A,V,L=t[6]&&ru(t);return{c(){e=S("form"),n=S("label"),r=S("span"),r.textContent="Room Name",s=F(),i=S("input"),a=F(),l=S("label"),c=S("span"),c.textContent="Nick",u=F(),f=S("input"),d=F(),h=S("button"),h.textContent="Generate",m=F(),v=S("hr"),g=F(),w=S("label"),E=S("span"),E.textContent="Passcode",_=F(),y=S("input"),C=F(),k=S("div"),D=S("button"),D.textContent="Save",O=F(),L&&L.c(),I(r,"class","text-sm font-bold mb-2"),I(i,"type","text"),I(i,"name","roomName"),I(i,"placeholder","Enter a room name"),I(i,"autocomplete","off"),i.value=o=t[13].roomName,i.required=!0,I(i,"class","mb-4 form-input"),I(n,"class","inline-block w-full"),I(c,"class","text-sm font-bold mb-2"),I(f,"type","text"),I(f,"name","nick"),I(f,"placeholder","Marcus Antonius"),I(f,"autocomplete","off"),f.value=p=t[13].nick,f.required=!0,I(f,"class","mb-4 form-input float-right"),I(h,"type","button"),I(h,"class","underline hover:bg-nl hover:text-white"),I(l,"class","inline-block w-full"),I(v,"class","block py-1 px-2"),I(E,"class","text-sm font-bold mb-2"),I(y,"type","text"),I(y,"name","passCode"),I(y,"autocomplete","off"),y.value=b=t[13].passCode,I(y,"placeholder","Optional passcode to join room"),I(y,"class","mb-4 form-input"),I(w,"class","inline-block w-full"),I(D,"type","submit"),D.value="save",I(D,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(k,"class","flex gap-2 justify-between")},m(N,R){q(N,e,R),T(e,n),T(n,r),T(n,s),T(n,i),T(e,a),T(e,l),T(l,c),T(l,u),T(l,f),t[24](f),T(l,d),T(l,h),T(e,m),T(e,v),T(e,g),T(e,w),T(w,E),T(w,_),T(w,y),T(e,C),T(e,k),T(k,D),T(k,O),L&&L.m(k,null),t[26](e),A||(V=[ne(h,"click",t[25]),ne(e,"submit",gn($n(t[16])))],A=!0)},p(N,R){R&8192&&o!==(o=N[13].roomName)&&i.value!==o&&(i.value=o),R&8192&&p!==(p=N[13].nick)&&f.value!==p&&(f.value=p),R&8192&&b!==(b=N[13].passCode)&&y.value!==b&&(y.value=b),N[6]?L?L.p(N,R):(L=ru(N),L.c(),L.m(k,null)):L&&(L.d(1),L=null)},d(N){N&&$(e),t[24](null),L&&L.d(),t[26](null),A=!1,rt(V)}}}function ru(t){let e,n;return{c(){e=S("span"),n=ce(t[6]),I(e,"class","flex-1 bg-red-500 text-white block px-2 leading-loose")},m(r,s){q(r,e,s),T(e,n)},p(r,s){s&64&&pe(n,r[6])},d(r){r&&$(e)}}}function a_(t){let e,n,r,s,i,o,a,l,c=t[3]?"Cancel":"Edit",u,f,p,d=t[10]=="Invite Link"?"Close Invite Link":"Invite Link",h,m,v,g,w,E,_,y=t[7]&&tu(t);function b(D,O){return D[3]?o_:i_}let C=b(t),k=C(t);return{c(){e=S("div"),n=S("div"),r=S("div"),s=S("span"),i=ce(t[1]),o=F(),a=S("div"),l=S("button"),u=ce(c),f=F(),p=S("button"),h=ce(d),m=F(),y&&y.c(),v=F(),g=S("div"),k.c(),I(s,"class","px-2 h-7"),I(l,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7"),I(p,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7"),I(n,"class","flex justify-between w-full border-b border-black"),I(g,"class","p-2"),I(e,"class",w=`${t[0]}`)},m(D,O){q(D,e,O),T(e,n),T(n,r),T(r,s),T(s,i),T(n,o),T(n,a),T(a,l),T(l,u),T(a,f),T(a,p),T(p,h),T(e,m),y&&y.m(e,null),T(e,v),T(e,g),k.m(g,null),E||(_=[ne(l,"click",t[21]),ne(p,"click",t[22])],E=!0)},p(D,[O]){O&2&&pe(i,D[1]),O&8&&c!==(c=D[3]?"Cancel":"Edit")&&pe(u,c),O&1024&&d!==(d=D[10]=="Invite Link"?"Close Invite Link":"Invite Link")&&pe(h,d),D[7]?y?y.p(D,O):(y=tu(D),y.c(),y.m(e,v)):y&&(y.d(1),y=null),C===(C=b(D))&&k?k.p(D,O):(k.d(1),k=C(D),k&&(k.c(),k.m(g,null))),O&1&&w!==(w=`${D[0]}`)&&I(e,"class",w)},i:W,o:W,d(D){D&&$(e),y&&y.d(),k.d(),E=!1,rt(_)}}}function l_(t,e,n){let{class:r=""}=e,{id:s=""}=e,{nick:i=""}=e,{nickID:o=""}=e,{info:a=null}=e,l=!1,c,u,f="",p=!1,d="",h="",m="",v="",g=!1;const w=()=>{n(7,p=!1),n(8,d=""),n(9,h=""),n(10,m=""),n(11,v="")},E={roomName:"",nick:"",passCode:"",leaderCode:""},_=async()=>{n(13,E.roomName=a.name,E),n(13,E.nick=i,E);const R=et(tt,"room",s),de=await jc(R);n(13,E.passCode=de.passCode,E)},y=async()=>{n(6,f="");const R=new FormData(c),de={},K=["roomName","nick","passCode"];for(const le of K)de[le]=R.get(le);const ie={};for(const[le,ge]of Object.entries(de))E[le]!==ge&&(ie[le]=ge);if(Object.keys(ie).length>0){const le={};for(const[ke,ct]of Object.entries(ie))switch(ke){case"roomName":le.info={name:ct};break;case"nick":le.people={[o]:{nick:ct}};break;case"passCode":le.password={...le.password,passCode:ct};break}const ge=et(tt,"room",s);try{await tn(ge,le,{merge:!0}),n(3,l=!1)}catch(ke){n(6,f=ke)}}},b=async()=>{const R=await jc(et(tt,"room",s)),de=R==null?void 0:R.passCode;let K=`${window.location.origin}/#/room/${s}`;return de&&(K+=`?password=${de}`),K},C=R=>{navigator.clipboard.writeText(R).then(()=>{n(12,g=!0),setTimeout(()=>n(12,g=!1),500)},()=>{console.error("clipboard write failed")})},k=async()=>{m=="Invite Link"&&(n(9,h=await b()),n(11,v=await eu(h)))};Nr(()=>{n_("password","settings",k)}),xr(()=>{r_("password","settings")});const D=()=>{n(3,l=!l),l&&_()},O=async()=>{if(m=="Invite Link"){w();return}n(9,h=await b()),n(10,m="Invite Link"),n(8,d="link"),n(11,v=await eu(h)),n(7,p=!0)},A=()=>{C(h)};function V(R){Nn[R?"unshift":"push"](()=>{u=R,n(5,u)})}const L=()=>n(5,u.value=zs(),u);function N(R){Nn[R?"unshift":"push"](()=>{c=R,n(4,c)})}return t.$$set=R=>{"class"in R&&n(0,r=R.class),"id"in R&&n(19,s=R.id),"nick"in R&&n(1,i=R.nick),"nickID"in R&&n(20,o=R.nickID),"info"in R&&n(2,a=R.info)},[r,i,a,l,c,u,f,p,d,h,m,v,g,E,w,_,y,b,C,s,o,D,O,A,V,L,N]}class c_ extends ze{constructor(e){super(),qe(this,e,l_,a_,je,{class:0,id:19,nick:1,nickID:20,info:2})}}var u_=typeof Ne=="object"&&Ne&&Ne.Object===Object&&Ne,h_=u_,f_=h_,d_=typeof self=="object"&&self&&self.Object===Object&&self,p_=f_||d_||Function("return this")(),Yd=p_,g_=/\s/;function m_(t){for(var e=t.length;e--&&g_.test(t.charAt(e)););return e}var y_=m_,v_=y_,w_=/^\s+/;function b_(t){return t&&t.slice(0,v_(t)+1).replace(w_,"")}var __=b_;function E_(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var k_=E_,T_=Yd,I_=T_.Symbol,tl=I_,su=tl,Jd=Object.prototype,C_=Jd.hasOwnProperty,S_=Jd.toString,ir=su?su.toStringTag:void 0;function A_(t){var e=C_.call(t,ir),n=t[ir];try{t[ir]=void 0;var r=!0}catch{}var s=S_.call(t);return r&&(e?t[ir]=n:delete t[ir]),s}var D_=A_,R_=Object.prototype,N_=R_.toString;function x_(t){return N_.call(t)}var M_=x_,iu=tl,L_=D_,O_=M_,P_="[object Null]",F_="[object Undefined]",ou=iu?iu.toStringTag:void 0;function B_(t){return t==null?t===void 0?F_:P_:ou&&ou in Object(t)?L_(t):O_(t)}var j_=B_;function V_(t){return t!=null&&typeof t=="object"}var U_=V_,$_=j_,q_=U_,z_="[object Symbol]";function H_(t){return typeof t=="symbol"||q_(t)&&$_(t)==z_}var Zd=H_,G_=__,au=k_,K_=Zd,lu=0/0,Q_=/^[-+]0x[0-9a-f]+$/i,W_=/^0b[01]+$/i,X_=/^0o[0-7]+$/i,Y_=parseInt;function J_(t){if(typeof t=="number")return t;if(K_(t))return lu;if(au(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=au(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=G_(t);var n=W_.test(t);return n||X_.test(t)?Y_(t.slice(2),n?2:8):Q_.test(t)?lu:+t}var ep=J_,Z_=ep,cu=1/0,eE=17976931348623157e292;function tE(t){if(!t)return t===0?t:0;if(t=Z_(t),t===cu||t===-cu){var e=t<0?-1:1;return e*eE}return t===t?t:0}var nE=tE,rE=nE;function sE(t){var e=rE(t),n=e%1;return e===e?n?e-n:e:0}var iE=sE;function oE(t,e){for(var n=-1,r=t==null?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s}var aE=oE,lE=Array.isArray,cE=lE,uu=tl,uE=aE,hE=cE,fE=Zd,dE=1/0,hu=uu?uu.prototype:void 0,fu=hu?hu.toString:void 0;function tp(t){if(typeof t=="string")return t;if(hE(t))return uE(t,tp)+"";if(fE(t))return fu?fu.call(t):"";var e=t+"";return e=="0"&&1/t==-dE?"-0":e}var pE=tp,gE=pE;function mE(t){return t==null?"":gE(t)}var yE=mE,vE=Yd,wE=iE,bE=ep,du=yE,_E=vE.isFinite,EE=Math.min;function kE(t){var e=Math[t];return function(n,r){if(n=bE(n),r=r==null?0:EE(wE(r),292),r&&_E(n)){var s=(du(n)+"e").split("e"),i=e(s[0]+"e"+(+s[1]+r));return s=(du(i)+"e").split("e"),+(s[0]+"e"+(+s[1]-r))}return e(n)}}var TE=kE,IE=TE,CE=IE("round"),SE=CE;function pu(t,e,n){const r=t.slice();return r[19]=e[n],r}function gu(t){let e,n,r;return{c(){e=S("input"),I(e,"class","bg-gray-200 flex-1 px-2 min-w-[2rem]"),I(e,"type","text")},m(s,i){q(s,e,i),Dn(e,t[1]),n||(r=ne(e,"input",t[14]),n=!0)},p(s,i){i&2&&e.value!==s[1]&&Dn(e,s[1])},d(s){s&&$(e),n=!1,r()}}}function mu(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 h-7 border-l border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){q(s,e,i),n||(r=ne(e,"click",t[8]),n=!0)},p:W,d(s){s&&$(e),n=!1,r()}}}function yu(t){let e,n,r,s,i,o,a,l,c,u,f,p,d=Object.keys(t[0]).length+"",h,m,v,g=[],w=new Map,E,_,y=t[7]&&vu(t),b=Object.keys(t[0]).sort(t[16]);const C=k=>k[19];for(let k=0;k<b.length;k+=1){let D=pu(t,b,k),O=C(D);w.set(O,g[k]=bu(O,D))}return{c(){e=S("div"),n=S("div"),r=S("button"),r.textContent="Clear Votes",s=F(),i=S("button"),i.textContent="Show Results",o=F(),y&&y.c(),a=F(),l=S("span"),c=S("span"),u=ce(t[6]),p=ce("/"),h=ce(d),m=F(),v=S("table");for(let k=0;k<g.length;k+=1)g[k].c();I(r,"class","px-2 h-7 border border-black hover:bg-nl hover:text-white"),I(i,"class","px-2 h-7 border border-black hover:bg-nl hover:text-white"),I(c,"class",f=`${t[6]!=Object.keys(t[0]).length?"text-red-500":""}`),I(l,"class","text-xl font-bold"),I(e,"class","flex items-center justify-between mb-4"),I(v,"class","w-full")},m(k,D){q(k,e,D),T(e,n),T(n,r),T(n,s),T(n,i),T(e,o),y&&y.m(e,null),T(e,a),T(e,l),T(l,c),T(c,u),T(l,p),T(l,h),q(k,m,D),q(k,v,D);for(let O=0;O<g.length;O+=1)g[O].m(v,null);E||(_=[ne(r,"click",t[11]),ne(i,"click",t[12])],E=!0)},p(k,D){k[7]?y?y.p(k,D):(y=vu(k),y.c(),y.m(e,a)):y&&(y.d(1),y=null),D&64&&pe(u,k[6]),D&65&&f!==(f=`${k[6]!=Object.keys(k[0]).length?"text-red-500":""}`)&&I(c,"class",f),D&1&&d!==(d=Object.keys(k[0]).length+"")&&pe(h,d),D&1689&&(b=Object.keys(k[0]).sort(k[16]),g=Ks(g,D,C,1,k,b,w,v,xu,bu,null,pu))},d(k){k&&$(e),y&&y.d(),k&&$(m),k&&$(v);for(let D=0;D<g.length;D+=1)g[D].d();E=!1,rt(_)}}}function vu(t){let e,n;return{c(){e=S("span"),n=ce(t[5]),I(e,"class","text-xl font-bold")},m(r,s){q(r,e,s),T(e,n)},p(r,s){s&32&&pe(n,r[5])},d(r){r&&$(e)}}}function wu(t){let e,n,r;function s(){return t[17](t[19])}return{c(){e=S("button"),e.textContent="X",I(e,"class","bg-white border-l border-r border-black hover:bg-red-500 absolute top-0 right-0 h-full text-2xl px-2")},m(i,o){q(i,e,o),n||(r=ne(e,"click",s),n=!0)},p(i,o){t=i},d(i){i&&$(e),n=!1,r()}}}function bu(t,e){var m,v,g,w;let n,r,s=((m=e[0][e[19]])==null?void 0:m.nick)+"",i,o,a,l=(e[7]?(w=(g=(v=e[0][e[19]])==null?void 0:v.card)==null?void 0:g.text)!=null?w:"-":"\u{1F7E7}")+"",c,u,f,p,d,h=e[3]&&wu(e);return{key:t,first:null,c(){var E,_,y,b;n=S("tr"),r=S("td"),i=ce(s),o=F(),a=S("td"),c=ce(l),u=F(),h&&h.c(),p=F(),I(r,"class","text-left w-1/2 text-2xl"),I(a,"class",f=`${((_=(E=e[0][e[19]])==null?void 0:E.card)==null?void 0:_.emoji)||!e[7]?"font-emoji":""} text-center text-4xl py-1 border border-r-0 border-black relative`),I(n,"class",d=`odd:bg-gray-100 border-b border-black first:border-t ${(b=(y=e[0][e[19]])==null?void 0:y.card)!=null&&b.text?"":"!bg-yellow-100"} ${e[4][e[19]]?"stripe-gray":""}`),this.first=n},m(E,_){q(E,n,_),T(n,r),T(r,i),T(n,o),T(n,a),T(a,c),T(a,u),h&&h.m(a,null),T(n,p)},p(E,_){var y,b,C,k,D,O,A,V;e=E,_&1&&s!==(s=((y=e[0][e[19]])==null?void 0:y.nick)+"")&&pe(i,s),_&129&&l!==(l=(e[7]?(k=(C=(b=e[0][e[19]])==null?void 0:b.card)==null?void 0:C.text)!=null?k:"-":"\u{1F7E7}")+"")&&pe(c,l),e[3]?h?h.p(e,_):(h=wu(e),h.c(),h.m(a,null)):h&&(h.d(1),h=null),_&129&&f!==(f=`${((O=(D=e[0][e[19]])==null?void 0:D.card)==null?void 0:O.emoji)||!e[7]?"font-emoji":""} text-center text-4xl py-1 border border-r-0 border-black relative`)&&I(a,"class",f),_&17&&d!==(d=`odd:bg-gray-100 border-b border-black first:border-t ${(V=(A=e[0][e[19]])==null?void 0:A.card)!=null&&V.text?"":"!bg-yellow-100"} ${e[4][e[19]]?"stripe-gray":""}`)&&I(n,"class",d)},d(E){E&&$(n),h&&h.d()}}}function AE(t){let e,n,r,s,i,o=(t[3]?"":t[1]?t[1]:"Topic Name")+"",a,l,c,u,f,p,d=t[3]?"Cancel":"Edit topic & users",h,m,v,g,w,E,_,y=t[3]&&gu(t),b=t[3]&&mu(t),C=t[0]&&yu(t);return{c(){e=S("div"),n=S("div"),r=S("span"),s=ce(`Voting -
      `),i=S("i"),a=ce(o),l=F(),y&&y.c(),c=F(),u=S("div"),b&&b.c(),f=F(),p=S("button"),h=ce(d),v=F(),g=S("div"),C&&C.c(),I(r,"class","px-2"),I(p,"class",m=`float-right px-2 h-7 border-l border-black self-end hover:text-white ${t[3]?"hover:bg-red-500":"hover:bg-nl"}`),I(n,"class","border-b border-black h-7 flex flex-wrap justify-between box-content"),I(g,"class","p-2"),I(e,"class",w=`${t[2]} relative`)},m(k,D){q(k,e,D),T(e,n),T(n,r),T(r,s),T(r,i),T(i,a),T(n,l),y&&y.m(n,null),T(n,c),T(n,u),b&&b.m(u,null),T(u,f),T(u,p),T(p,h),T(e,v),T(e,g),C&&C.m(g,null),E||(_=ne(p,"click",t[15]),E=!0)},p(k,[D]){D&10&&o!==(o=(k[3]?"":k[1]?k[1]:"Topic Name")+"")&&pe(a,o),k[3]?y?y.p(k,D):(y=gu(k),y.c(),y.m(n,c)):y&&(y.d(1),y=null),k[3]?b?b.p(k,D):(b=mu(k),b.c(),b.m(u,f)):b&&(b.d(1),b=null),D&8&&d!==(d=k[3]?"Cancel":"Edit topic & users")&&pe(h,d),D&8&&m!==(m=`float-right px-2 h-7 border-l border-black self-end hover:text-white ${k[3]?"hover:bg-red-500":"hover:bg-nl"}`)&&I(p,"class",m),k[0]?C?C.p(k,D):(C=yu(k),C.c(),C.m(g,null)):C&&(C.d(1),C=null),D&4&&w!==(w=`${k[2]} relative`)&&I(e,"class",w)},i:W,o:W,d(k){k&&$(e),y&&y.d(),b&&b.d(),C&&C.d(),E=!1,_()}}}function DE(t,e,n){let r,s,i;Rr(t,nn,b=>n(7,i=b));let{class:o=""}=e,{id:a=""}=e,{description:l=""}=e,{people:c=null}=e,u=!1;const f=()=>{const b=et(tt,"room",a);tn(b,{info:{description:l}},{merge:!0});const C={};Object.keys(c).forEach(k=>{d[k]||(C[k]=c[k])}),jo(b,{people:C}),n(3,u=!1),n(4,d={})},p=b=>{let C=0;const k=Object.keys(b).reduce((D,O)=>{var N;const A=(N=b[O].card)==null?void 0:N.text;if(A=="")return D;let V=0;const L=Number(A);return isNaN(L)||(C++,V=L),D+V},0);return SE(k/C,2)};let d={};const h=b=>{n(4,d[b]=!0,d)},m=b=>{delete d[b],n(4,d={...d})},v=()=>{if(c){Object.keys(c).forEach(C=>{c[C].card&&(n(0,c[C].card.text=null,c),n(0,c[C].card.emoji=!1,c))});const b=et(tt,"room",a);tn(b,{people:c,show:!1},{merge:!0}),nn.set(!1)}else{const b=et(tt,"room",a);tn(b,{show:!1},{merge:!0}),nn.set(!1)}},g=()=>{const b=et(tt,"room",a);tn(b,{show:!0},{merge:!0}),nn.set(!0)};function w(){l=this.value,n(1,l)}const E=()=>{n(3,u=!u),n(4,d={})},_=(b,C)=>Ud(c[b].nick,c[C].nick),y=b=>d[b]?m(b):h(b);return t.$$set=b=>{"class"in b&&n(2,o=b.class),"id"in b&&n(13,a=b.id),"description"in b&&n(1,l=b.description),"people"in b&&n(0,c=b.people)},t.$$.update=()=>{t.$$.dirty&1&&n(6,r=c?Object.keys(c).reduce((b,C)=>{var D;const k=(D=c[C].card)!=null&&D.text?1:0;return b+k},0):0),t.$$.dirty&1&&n(5,s=c?p(c):0)},[c,l,o,u,d,s,r,i,f,h,m,v,g,a,w,E,_,y]}class RE extends ze{constructor(e){super(),qe(this,e,DE,AE,je,{class:2,id:13,description:1,people:0})}}function NE(t){var c,u;let e,n,r,s,i,o,a,l;return n=new RE({props:{id:t[0],description:(u=(c=t[1])==null?void 0:c.description)!=null?u:"",people:t[3],class:"flex-1 bg-white border-black border-t border-b sm:border"}}),i=new c_({props:{id:t[0],info:t[1],nick:t[2],nickID:t[5],class:"bg-white border-black border-t border-b sm:border h-fit"}}),a=new cb({props:{id:t[0],nickID:t[5],cardDeck:t[4],class:"flex-1 bg-white border-black border-t border-b sm:border h-fit"}}),{c(){e=S("div"),Ie(n.$$.fragment),r=F(),s=S("div"),Ie(i.$$.fragment),o=F(),Ie(a.$$.fragment),I(s,"class","flex flex-1 flex-col gap-2"),I(e,"class","flex flex-col xl:flex-row gap-2")},m(f,p){q(f,e,p),be(n,e,null),T(e,r),T(e,s),be(i,s,null),T(s,o),be(a,s,null),l=!0},p(f,[p]){var v,g;const d={};p&1&&(d.id=f[0]),p&2&&(d.description=(g=(v=f[1])==null?void 0:v.description)!=null?g:""),p&8&&(d.people=f[3]),n.$set(d);const h={};p&1&&(h.id=f[0]),p&2&&(h.info=f[1]),p&4&&(h.nick=f[2]),i.$set(h);const m={};p&1&&(m.id=f[0]),p&16&&(m.cardDeck=f[4]),a.$set(m)},i(f){l||(J(n.$$.fragment,f),J(i.$$.fragment,f),J(a.$$.fragment,f),l=!0)},o(f){ee(n.$$.fragment,f),ee(i.$$.fragment,f),ee(a.$$.fragment,f),l=!1},d(f){f&&$(e),_e(n),_e(i),_e(a)}}}function xE(t,e,n){var f;let{id:r=""}=e,{password:s=""}=e,i=null,{id:o,nick:a}=(f=Bd())!=null?f:jd(zs()),l=null,c=[],u=null;return Nr(async()=>{const p=et(tt,"room",r);let d=xw(r);await tn(p,{people:{[o]:{nick:a,points:""}}},{merge:!0}),u=mw(tt,r,h=>{var w,E,_;n(1,i=h.get("info")),n(3,l=h.get("people"));const m=h.get("password"),v=h.get("cards");if(n(4,c=(w=v==null?void 0:v.sort((y,b)=>y.text.localeCompare(b.text)))!=null?w:[]),nn.set(h.get("show")),!l[o]){qo("/?msg=You%20have%20been%20kicked!!");return}((E=l[o])==null?void 0:E.nick)!=a&&(n(2,a=(_=l[o])==null?void 0:_.nick),a&&Vd(o,a));const g={};(i==null?void 0:i.name)!=d&&(d=i==null?void 0:i.name,g.name=d),m.passCode!=s&&(n(6,s=m.passCode),g.password=s,s_("password")),Object.keys(g).length&&Rw(r,{...g,id:r}),Object.keys(l).every(y=>{var b;return(b=l[y].card)==null?void 0:b.text})&&nn.set(!0)})}),xr(()=>{u!=null&&u()}),t.$$set=p=>{"id"in p&&n(0,r=p.id),"password"in p&&n(6,s=p.password)},[r,i,a,l,c,o,s]}class ME extends ze{constructor(e){super(),qe(this,e,xE,NE,je,{id:0,password:6})}}function _u(t){let e,n,r,s;const i=[OE,LE],o=[];function a(l,c){return l[3]?1:0}return e=a(t),n=o[e]=i[e](t),{c(){n.c(),r=pn()},m(l,c){o[e].m(l,c),q(l,r,c),s=!0},p(l,c){let u=e;e=a(l),e===u?o[e].p(l,c):(Dt(),ee(o[u],1,1,()=>{o[u]=null}),Rt(),n=o[e],n?n.p(l,c):(n=o[e]=i[e](l),n.c()),J(n,1),n.m(r.parentNode,r))},i(l){s||(J(n),s=!0)},o(l){ee(n),s=!1},d(l){o[e].d(l),l&&$(r)}}}function LE(t){let e,n;return e=new ME({props:{id:t[0].id,password:t[1]}}),{c(){Ie(e.$$.fragment)},m(r,s){be(e,r,s),n=!0},p(r,s){const i={};s&1&&(i.id=r[0].id),s&2&&(i.password=r[1]),e.$set(i)},i(r){n||(J(e.$$.fragment,r),n=!0)},o(r){ee(e.$$.fragment,r),n=!1},d(r){_e(e,r)}}}function OE(t){let e,n,r,s,i,o,a,l,c,u,f,p,d=t[2]&&Eu();return{c(){e=S("div"),n=S("div"),r=S("span"),r.textContent="password not correct!",s=F(),i=S("form"),o=S("label"),o.innerHTML=`<span class="text-sm font-bold block mb-2">Passcode</span> 
            <input type="text" name="passCode" autocomplete="off" placeholder="Password to join room" class="mb-4 form-input"/>`,a=F(),l=S("div"),c=S("button"),c.textContent="Login",u=F(),d&&d.c(),I(r,"class","block mb-4 text-xl font-bold bg-black text-white px-2 py-1"),I(c,"type","submit"),c.value="create",I(c,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(l,"class","flex gap-2 justify-between"),I(n,"class","p-6 bg-white border border-black"),I(e,"class","flex items-center justify-center")},m(h,m){q(h,e,m),T(e,n),T(n,r),T(n,s),T(n,i),T(i,o),T(i,a),T(i,l),T(l,c),T(l,u),d&&d.m(l,null),f||(p=ne(i,"submit",gn($n(t[5]))),f=!0)},p(h,m){h[2]?d||(d=Eu(),d.c(),d.m(l,null)):d&&(d.d(1),d=null)},i:W,o:W,d(h){h&&$(e),d&&d.d(),f=!1,p()}}}function Eu(t){let e;return{c(){e=S("span"),e.textContent="Wrong!",I(e,"class","flex-1 bg-red-500 text-white block px-2 leading-loose")},m(n,r){q(n,e,r)},d(n){n&&$(e)}}}function PE(t){let e,n,r=t[4]&&_u(t);return{c(){r&&r.c(),e=pn()},m(s,i){r&&r.m(s,i),q(s,e,i),n=!0},p(s,[i]){s[4]?r?(r.p(s,i),i&16&&J(r,1)):(r=_u(s),r.c(),J(r,1),r.m(e.parentNode,e)):r&&(Dt(),ee(r,1,1,()=>{r=null}),Rt())},i(s){n||(J(r),n=!0)},o(s){ee(r),n=!1},d(s){r&&r.d(s),s&&$(e)}}}function FE(t,e,n){let r;Rr(t,Bu,p=>n(6,r=p));let{params:s={}}=e,i="",o=!1,a=!1,l=!1;const c=(p,d=!1)=>{var m;if(!d&&!l||(p=p.replace(" ",""),p==""))return;const h=new URLSearchParams(p);return n(1,i=(m=h.get("password"))!=null?m:""),window.history.replaceState({},"",window.location.pathname+window.location.hash.replace("?"+p,"")),i},u=async(p,d,h=!1)=>{if(!h&&!l)return;n(2,o=!1);const m=et(tt,"room",p),v=Nw(p);let g=await Bc(m,v),w=v;if(g||(g=await Bc(m,d),w=d),!g){n(2,o=!0);return}n(1,i=w),n(3,a=!0)},f=p=>{const m=p.currentTarget.elements.namedItem("passCode").value;u(s.id,m)};return Nr(async()=>{const p=c(r,!0);await u(s.id,p,!0),n(4,l=!0)}),t.$$set=p=>{"params"in p&&n(0,s=p.params)},t.$$.update=()=>{t.$$.dirty&64&&c(r),t.$$.dirty&3&&u(s.id,i)},[s,i,o,a,l,f,r]}class BE extends ze{constructor(e){super(),qe(this,e,FE,PE,je,{params:0})}}function jE(t){let e,n,r,s,i,o;return r=new vp({props:{class:"px-2 border-nl border-b-2 mb-3"}}),i=new gp({props:{routes:t[0]}}),{c(){e=S("div"),n=S("div"),Ie(r.$$.fragment),s=F(),Ie(i.$$.fragment),I(n,"class","container mx-auto border-black"),I(e,"class","bg-gray-100 h-full")},m(a,l){q(a,e,l),T(e,n),be(r,n,null),T(n,s),be(i,n,null),o=!0},p:W,i(a){o||(J(r.$$.fragment,a),J(i.$$.fragment,a),o=!0)},o(a){ee(r.$$.fragment,a),ee(i.$$.fragment,a),o=!1},d(a){a&&$(e),_e(r),_e(i)}}}function VE(t){return[{"/":eb,"/room/:id":BE,"*":nb}]}class UE extends ze{constructor(e){super(),qe(this,e,VE,jE,je,{})}}new UE({target:document.body});

const tg=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};tg();function J(){}function gh(t,e){for(const n in e)t[n]=e[n];return t}function mh(t){return t()}function Hl(){return Object.create(null)}function Ke(t){t.forEach(mh)}function pa(t){return typeof t=="function"}function Ue(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ds;function zl(t,e){return ds||(ds=document.createElement("a")),ds.href=e,t===ds.href}function ng(t){return Object.keys(t).length===0}function yh(t,...e){if(t==null)return J;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Ut(t,e,n){t.$$.on_destroy.push(yh(e,n))}function mr(t){return t==null?"":t}function vh(t){return t&&pa(t.destroy)?t.destroy:J}function C(t,e){t.appendChild(e)}function j(t,e,n){t.insertBefore(e,n||null)}function B(t){t.parentNode.removeChild(t)}function rg(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function S(t){return document.createElement(t)}function Kl(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ue(t){return document.createTextNode(t)}function M(){return ue(" ")}function zn(){return ue("")}function Y(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function wn(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Qt(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function I(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function sg(t){return Array.from(t.childNodes)}function be(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Ln(t,e){t.value=e==null?"":e}function $t(t,e,n){t.classList[n?"add":"remove"](e)}function ig(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}let Rr;function _r(t){Rr=t}function si(){if(!Rr)throw new Error("Function called outside component initialization");return Rr}function ga(t){si().$$.on_mount.push(t)}function og(t){si().$$.after_update.push(t)}function ma(t){si().$$.on_destroy.push(t)}function bh(){const t=si();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const i=ig(e,n,{cancelable:r});return s.slice().forEach(o=>{o.call(t,i)}),!i.defaultPrevented}return!0}}function Ql(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const yr=[],Mn=[],Ss=[],Wl=[],wh=Promise.resolve();let Do=!1;function _h(){Do||(Do=!0,wh.then(Th))}function Eh(){return _h(),wh}function Ro(t){Ss.push(t)}const no=new Set;let ps=0;function Th(){const t=Rr;do{for(;ps<yr.length;){const e=yr[ps];ps++,_r(e),ag(e.$$)}for(_r(null),yr.length=0,ps=0;Mn.length;)Mn.pop()();for(let e=0;e<Ss.length;e+=1){const n=Ss[e];no.has(n)||(no.add(n),n())}Ss.length=0}while(yr.length);for(;Wl.length;)Wl.pop()();Do=!1,no.clear(),_r(t)}function ag(t){if(t.fragment!==null){t.update(),Ke(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ro)}}const Ds=new Set;let nn;function Tt(){nn={r:0,c:[],p:nn}}function kt(){nn.r||Ke(nn.c),nn=nn.p}function X(t,e){t&&t.i&&(Ds.delete(t),t.i(e))}function te(t,e,n,r){if(t&&t.o){if(Ds.has(t))return;Ds.add(t),nn.c.push(()=>{Ds.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function lg(t,e){t.d(1),e.delete(t.key)}function kh(t,e){te(t,1,1,()=>{e.delete(t.key)})}function ya(t,e,n,r,s,i,o,a,l,c,u,f){let p=t.length,d=i.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const v=[],g=new Map,y=new Map;for(h=d;h--;){const w=f(s,i,h),E=n(w);let T=o.get(E);T?r&&T.p(w,e):(T=c(E,w),T.c()),g.set(E,v[h]=T),E in m&&y.set(E,Math.abs(h-m[E]))}const k=new Set,b=new Set;function _(w){X(w,1),w.m(a,u),o.set(w.key,w),u=w.first,d--}for(;p&&d;){const w=v[d-1],E=t[p-1],T=w.key,A=E.key;w===E?(u=w.first,p--,d--):g.has(A)?!o.has(T)||k.has(T)?_(w):b.has(A)?p--:y.get(T)>y.get(A)?(b.add(T),_(w)):(k.add(A),p--):(l(E,o),p--)}for(;p--;){const w=t[p];g.has(w.key)||l(w,o)}for(;d;)_(v[d-1]);return v}function Ch(t,e){const n={},r={},s={$$scope:1};let i=t.length;for(;i--;){const o=t[i],a=e[i];if(a){for(const l in o)l in a||(r[l]=1);for(const l in a)s[l]||(n[l]=a[l],s[l]=1);t[i]=a}else for(const l in o)s[l]=1}for(const o in r)o in n||(n[o]=void 0);return n}function Ih(t){return typeof t=="object"&&t!==null?t:{}}function Ae(t){t&&t.c()}function Te(t,e,n,r){const{fragment:s,on_mount:i,on_destroy:o,after_update:a}=t.$$;s&&s.m(e,n),r||Ro(()=>{const l=i.map(mh).filter(pa);o?o.push(...l):Ke(l),t.$$.on_mount=[]}),a.forEach(Ro)}function ke(t,e){const n=t.$$;n.fragment!==null&&(Ke(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function cg(t,e){t.$$.dirty[0]===-1&&(yr.push(t),_h(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Qe(t,e,n,r,s,i,o,a=[-1]){const l=Rr;_r(t);const c=t.$$={fragment:null,ctx:null,props:i,update:J,not_equal:s,bound:Hl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Hl(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(f,p,...d)=>{const h=d.length?d[0]:p;return c.ctx&&s(c.ctx[f],c.ctx[f]=h)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](h),u&&cg(t,f)),p}):[],c.update(),u=!0,Ke(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const f=sg(e.target);c.fragment&&c.fragment.l(f),f.forEach(B)}else c.fragment&&c.fragment.c();e.intro&&X(t.$$.fragment),Te(t,e.target,e.anchor,e.customElement),Th()}_r(l)}class We{$destroy(){ke(this,1),this.$destroy=J}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!ng(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const An=[];function Ah(t,e){return{subscribe:Ur(t,e).subscribe}}function Ur(t,e=J){let n;const r=new Set;function s(a){if(Ue(t,a)&&(t=a,n)){const l=!An.length;for(const c of r)c[1](),An.push(c,t);if(l){for(let c=0;c<An.length;c+=2)An[c][0](An[c+1]);An.length=0}}}function i(a){s(a(t))}function o(a,l=J){const c=[a,l];return r.add(c),r.size===1&&(n=e(s)||J),a(t),()=>{r.delete(c),r.size===0&&(n(),n=null)}}return{set:s,update:i,subscribe:o}}function Sh(t,e,n){const r=!Array.isArray(t),s=r?[t]:t,i=e.length<2;return Ah(n,o=>{let a=!1;const l=[];let c=0,u=J;const f=()=>{if(c)return;u();const d=e(r?l[0]:l,o);i?o(d):u=pa(d)?d:J},p=s.map((d,h)=>yh(d,m=>{l[h]=m,c&=~(1<<h),a&&f()},()=>{c|=1<<h}));return a=!0,f(),function(){Ke(p),u()}})}function ug(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,r,s,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();s=l.shift();)n=s[0],n==="*"?(o.push("wild"),a+="/(.*)"):n===":"?(r=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~r?r:~i?i:s.length)),a+=!!~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~r?"?":"")+"\\"+s.substring(i))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}function hg(t){let e,n,r;const s=[t[2]];var i=t[0];function o(a){let l={};for(let c=0;c<s.length;c+=1)l=gh(l,s[c]);return{props:l}}return i&&(e=new i(o()),e.$on("routeEvent",t[7])),{c(){e&&Ae(e.$$.fragment),n=zn()},m(a,l){e&&Te(e,a,l),j(a,n,l),r=!0},p(a,l){const c=l&4?Ch(s,[Ih(a[2])]):{};if(i!==(i=a[0])){if(e){Tt();const u=e;te(u.$$.fragment,1,0,()=>{ke(u,1)}),kt()}i?(e=new i(o()),e.$on("routeEvent",a[7]),Ae(e.$$.fragment),X(e.$$.fragment,1),Te(e,n.parentNode,n)):e=null}else i&&e.$set(c)},i(a){r||(e&&X(e.$$.fragment,a),r=!0)},o(a){e&&te(e.$$.fragment,a),r=!1},d(a){a&&B(n),e&&ke(e,a)}}}function fg(t){let e,n,r;const s=[{params:t[1]},t[2]];var i=t[0];function o(a){let l={};for(let c=0;c<s.length;c+=1)l=gh(l,s[c]);return{props:l}}return i&&(e=new i(o()),e.$on("routeEvent",t[6])),{c(){e&&Ae(e.$$.fragment),n=zn()},m(a,l){e&&Te(e,a,l),j(a,n,l),r=!0},p(a,l){const c=l&6?Ch(s,[l&2&&{params:a[1]},l&4&&Ih(a[2])]):{};if(i!==(i=a[0])){if(e){Tt();const u=e;te(u.$$.fragment,1,0,()=>{ke(u,1)}),kt()}i?(e=new i(o()),e.$on("routeEvent",a[6]),Ae(e.$$.fragment),X(e.$$.fragment,1),Te(e,n.parentNode,n)):e=null}else i&&e.$set(c)},i(a){r||(e&&X(e.$$.fragment,a),r=!0)},o(a){e&&te(e.$$.fragment,a),r=!1},d(a){a&&B(n),e&&ke(e,a)}}}function dg(t){let e,n,r,s;const i=[fg,hg],o=[];function a(l,c){return l[1]?0:1}return e=a(t),n=o[e]=i[e](t),{c(){n.c(),r=zn()},m(l,c){o[e].m(l,c),j(l,r,c),s=!0},p(l,[c]){let u=e;e=a(l),e===u?o[e].p(l,c):(Tt(),te(o[u],1,1,()=>{o[u]=null}),kt(),n=o[e],n?n.p(l,c):(n=o[e]=i[e](l),n.c()),X(n,1),n.m(r.parentNode,r))},i(l){s||(X(n),s=!0)},o(l){te(n),s=!1},d(l){o[e].d(l),l&&B(r)}}}function Xl(){const t=window.location.href.indexOf("#/");let e=t>-1?window.location.href.substr(t+1):"/";const n=e.indexOf("?");let r="";return n>-1&&(r=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:r}}const va=Ah(null,function(e){e(Xl());const n=()=>{e(Xl())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});Sh(va,t=>t.location);const Dh=Sh(va,t=>t.querystring),Yl=Ur(void 0);async function ba(t){if(!t||t.length<1||t.charAt(0)!="/"&&t.indexOf("#/")!==0)throw Error("Invalid parameter location");await Eh(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0,void 0),window.location.hash=(t.charAt(0)=="#"?"":"#")+t}function Rh(t,e){if(e=Zl(e),!t||!t.tagName||t.tagName.toLowerCase()!="a")throw Error('Action "link" can only be used with <a> tags');return Jl(t,e),{update(n){n=Zl(n),Jl(t,n)}}}function Jl(t,e){let n=e.href||t.getAttribute("href");if(n&&n.charAt(0)=="/")n="#"+n;else if(!n||n.length<2||n.slice(0,2)!="#/")throw Error('Invalid value for "href" attribute: '+n);t.setAttribute("href",n),t.addEventListener("click",r=>{r.preventDefault(),e.disabled||pg(r.currentTarget.getAttribute("href"))})}function Zl(t){return t&&typeof t=="string"?{href:t}:t||{}}function pg(t){history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0,void 0),window.location.hash=t}function gg(t,e,n){let{routes:r={}}=e,{prefix:s=""}=e,{restoreScrollState:i=!1}=e;class o{constructor(_,w){if(!w||typeof w!="function"&&(typeof w!="object"||w._sveltesparouter!==!0))throw Error("Invalid component object");if(!_||typeof _=="string"&&(_.length<1||_.charAt(0)!="/"&&_.charAt(0)!="*")||typeof _=="object"&&!(_ instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:E,keys:T}=ug(_);this.path=_,typeof w=="object"&&w._sveltesparouter===!0?(this.component=w.component,this.conditions=w.conditions||[],this.userData=w.userData,this.props=w.props||{}):(this.component=()=>Promise.resolve(w),this.conditions=[],this.props={}),this._pattern=E,this._keys=T}match(_){if(s){if(typeof s=="string")if(_.startsWith(s))_=_.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const A=_.match(s);if(A&&A[0])_=_.substr(A[0].length)||"/";else return null}}const w=this._pattern.exec(_);if(w===null)return null;if(this._keys===!1)return w;const E={};let T=0;for(;T<this._keys.length;){try{E[this._keys[T]]=decodeURIComponent(w[T+1]||"")||null}catch{E[this._keys[T]]=null}T++}return E}async checkConditions(_){for(let w=0;w<this.conditions.length;w++)if(!await this.conditions[w](_))return!1;return!0}}const a=[];r instanceof Map?r.forEach((b,_)=>{a.push(new o(_,b))}):Object.keys(r).forEach(b=>{a.push(new o(b,r[b]))});let l=null,c=null,u={};const f=bh();async function p(b,_){await Eh(),f(b,_)}let d=null,h=null;i&&(h=b=>{b.state&&b.state.__svelte_spa_router_scrollY?d=b.state:d=null},window.addEventListener("popstate",h),og(()=>{d?window.scrollTo(d.__svelte_spa_router_scrollX,d.__svelte_spa_router_scrollY):window.scrollTo(0,0)}));let m=null,v=null;const g=va.subscribe(async b=>{m=b;let _=0;for(;_<a.length;){const w=a[_].match(b.location);if(!w){_++;continue}const E={route:a[_].path,location:b.location,querystring:b.querystring,userData:a[_].userData,params:w&&typeof w=="object"&&Object.keys(w).length?w:null};if(!await a[_].checkConditions(E)){n(0,l=null),v=null,p("conditionsFailed",E);return}p("routeLoading",Object.assign({},E));const T=a[_].component;if(v!=T){T.loading?(n(0,l=T.loading),v=T,n(1,c=T.loadingParams),n(2,u={}),p("routeLoaded",Object.assign({},E,{component:l,name:l.name,params:c}))):(n(0,l=null),v=null);const A=await T();if(b!=m)return;n(0,l=A&&A.default||A),v=T}w&&typeof w=="object"&&Object.keys(w).length?n(1,c=w):n(1,c=null),n(2,u=a[_].props),p("routeLoaded",Object.assign({},E,{component:l,name:l.name,params:c})).then(()=>{Yl.set(c)});return}n(0,l=null),v=null,Yl.set(void 0)});ma(()=>{g(),h&&window.removeEventListener("popstate",h)});function y(b){Ql.call(this,t,b)}function k(b){Ql.call(this,t,b)}return t.$$set=b=>{"routes"in b&&n(3,r=b.routes),"prefix"in b&&n(4,s=b.prefix),"restoreScrollState"in b&&n(5,i=b.restoreScrollState)},t.$$.update=()=>{t.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[l,c,u,r,s,i,y,k]}class mg extends We{constructor(e){super(),Qe(this,e,gg,dg,Ue,{routes:3,prefix:4,restoreScrollState:5})}}function yg(t){let e,n,r,s,i,o,a,l,c,u,f;return{c(){e=S("div"),n=S("a"),r=ue(t[0]),s=M(),i=S("span"),o=ue(t[1]),a=M(),l=S("div"),l.innerHTML='<a href="https://github.com/rytsh/scrumik" target="_blank" class="hover:text-nl border-l border-white pl-4 pr-2">github</a>',I(n,"href","/"),I(n,"class","appearance-none text-xl font-bold mr-4 hover:text-nl"),I(l,"class","flex-grow text-right"),I(e,"class",c=`${t[2]} bg-black text-white flex items-center`)},m(p,d){j(p,e,d),C(e,n),C(n,r),C(e,s),C(e,i),C(i,o),C(e,a),C(e,l),u||(f=vh(Rh.call(null,n)),u=!0)},p(p,[d]){d&1&&be(r,p[0]),d&2&&be(o,p[1]),d&4&&c!==(c=`${p[2]} bg-black text-white flex items-center`)&&I(e,"class",c)},i:J,o:J,d(p){p&&B(e),u=!1,f()}}}function vg(t,e,n){let{title:r="scrumik"}=e,{message:s="scrum poker tool"}=e,{class:i=""}=e;return t.$$set=o=>{"title"in o&&n(0,r=o.title),"message"in o&&n(1,s=o.message),"class"in o&&n(2,i=o.class)},[r,s,i]}class bg extends We{constructor(e){super(),Qe(this,e,vg,yg,Ue,{title:0,message:1,class:2})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nh=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},wg=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},_g={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,f=(i&3)<<4|a>>4;let p=(a&15)<<2|c>>6,d=c&63;l||(d=64,o||(p=64)),r.push(n[u],n[f],n[p],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Nh(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):wg(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw Error();const p=i<<2|a>>4;if(r.push(p),c!==64){const d=a<<4&240|c>>2;if(r.push(d),f!==64){const h=c<<6&192|f;r.push(h)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Eg=function(t){const e=Nh(t);return _g.encodeByteArray(e,!0)},xh=function(t){return Eg(t).replace(/\./g,"")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ii())}function Oh(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Cg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ig(){return ii().indexOf("Electron/")>=0}function Ag(){const t=ii();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Sg(){return ii().indexOf("MSAppHost/")>=0}function Lh(){return typeof indexedDB=="object"}function Mh(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function Dg(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg="FirebaseError";class Kn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Rg,Object.setPrototypeOf(this,Kn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oi.prototype.create)}}class oi{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Ng(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Kn(s,a,r)}}function Ng(t,e){return t.replace(xg,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const xg=/\{\$([^}]+)}/g;function Ls(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(ec(i)&&ec(o)){if(!Ls(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function ec(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Og=1e3,Lg=2,Mg=4*60*60*1e3,Pg=.5;function tc(t,e=Og,n=Lg){const r=e*Math.pow(n,t),s=Math.round(Pg*r*(Math.random()-.5)*2);return Math.min(Mg,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(t){return t&&t._delegate?t._delegate:t}class Rt{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const en="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Tg;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jg(e))try{this.getOrInitializeService({instanceIdentifier:en})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=en){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=en){return this.instances.has(e)}getOptions(e=en){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Bg(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=en){return this.component?this.component.multipleInstances?e:en:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Bg(t){return t===en?void 0:t}function jg(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Fg(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ie||(ie={}));const Ug={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},$g=ie.INFO,qg={[ie.DEBUG]:"log",[ie.VERBOSE]:"log",[ie.INFO]:"info",[ie.WARN]:"warn",[ie.ERROR]:"error"},Gg=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=qg[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class wa{constructor(e){this.name=e,this._logLevel=$g,this._logHandler=Gg,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ug[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ie.DEBUG,...e),this._logHandler(this,ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ie.VERBOSE,...e),this._logHandler(this,ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ie.INFO,...e),this._logHandler(this,ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ie.WARN,...e),this._logHandler(this,ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ie.ERROR,...e),this._logHandler(this,ie.ERROR,...e)}}const Hg=(t,e)=>e.some(n=>t instanceof n);let nc,rc;function zg(){return nc||(nc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Kg(){return rc||(rc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ph=new WeakMap,No=new WeakMap,Fh=new WeakMap,ro=new WeakMap,_a=new WeakMap;function Qg(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Bt(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Ph.set(n,t)}).catch(()=>{}),_a.set(e,t),e}function Wg(t){if(No.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});No.set(t,e)}let xo={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return No.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Fh.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Bt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Xg(t){xo=t(xo)}function Yg(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(so(this),e,...n);return Fh.set(r,e.sort?e.sort():[e]),Bt(r)}:Kg().includes(t)?function(...e){return t.apply(so(this),e),Bt(Ph.get(this))}:function(...e){return Bt(t.apply(so(this),e))}}function Jg(t){return typeof t=="function"?Yg(t):(t instanceof IDBTransaction&&Wg(t),Hg(t,zg())?new Proxy(t,xo):t)}function Bt(t){if(t instanceof IDBRequest)return Qg(t);if(ro.has(t))return ro.get(t);const e=Jg(t);return e!==t&&(ro.set(t,e),_a.set(e,t)),e}const so=t=>_a.get(t);function Bh(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Bt(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Bt(o.result),l.oldVersion,l.newVersion,Bt(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const Zg=["get","getKey","getAll","getAllKeys","count"],em=["put","add","delete","clear"],io=new Map;function sc(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(io.get(e))return io.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=em.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Zg.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return io.set(e,i),i}Xg(t=>({...t,get:(e,n,r)=>sc(e,n)||t.get(e,n,r),has:(e,n)=>!!sc(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(nm(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function nm(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Oo="@firebase/app",ic="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea=new wa("@firebase/app"),rm="@firebase/app-compat",sm="@firebase/analytics-compat",im="@firebase/analytics",om="@firebase/app-check-compat",am="@firebase/app-check",lm="@firebase/auth",cm="@firebase/auth-compat",um="@firebase/database",hm="@firebase/database-compat",fm="@firebase/functions",dm="@firebase/functions-compat",pm="@firebase/installations",gm="@firebase/installations-compat",mm="@firebase/messaging",ym="@firebase/messaging-compat",vm="@firebase/performance",bm="@firebase/performance-compat",wm="@firebase/remote-config",_m="@firebase/remote-config-compat",Em="@firebase/storage",Tm="@firebase/storage-compat",km="@firebase/firestore",Cm="@firebase/firestore-compat",Im="firebase",Am="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh="[DEFAULT]",Sm={[Oo]:"fire-core",[rm]:"fire-core-compat",[im]:"fire-analytics",[sm]:"fire-analytics-compat",[am]:"fire-app-check",[om]:"fire-app-check-compat",[lm]:"fire-auth",[cm]:"fire-auth-compat",[um]:"fire-rtdb",[hm]:"fire-rtdb-compat",[fm]:"fire-fn",[dm]:"fire-fn-compat",[pm]:"fire-iid",[gm]:"fire-iid-compat",[mm]:"fire-fcm",[ym]:"fire-fcm-compat",[vm]:"fire-perf",[bm]:"fire-perf-compat",[wm]:"fire-rc",[_m]:"fire-rc-compat",[Em]:"fire-gcs",[Tm]:"fire-gcs-compat",[km]:"fire-fst",[Cm]:"fire-fst-compat","fire-js":"fire-js",[Im]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms=new Map,Lo=new Map;function Dm(t,e){try{t.container.addComponent(e)}catch(n){Ea.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function qt(t){const e=t.name;if(Lo.has(e))return Ea.debug(`There were multiple attempts to register component ${e}.`),!1;Lo.set(e,t);for(const n of Ms.values())Dm(n,t);return!0}function $r(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rm={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},hn=new oi("app","Firebase",Rm);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Rt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xm=Am;function Om(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:jh,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw hn.create("bad-app-name",{appName:String(r)});const s=Ms.get(r);if(s){if(Ls(t,s.options)&&Ls(n,s.config))return s;throw hn.create("duplicate-app",{appName:r})}const i=new Vg(r);for(const a of Lo.values())i.addComponent(a);const o=new Nm(t,n,i);return Ms.set(r,o),o}function Vh(t=jh){const e=Ms.get(t);if(!e)throw hn.create("no-app",{appName:t});return e}function wt(t,e,n){var r;let s=(r=Sm[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ea.warn(a.join(" "));return}qt(new Rt(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lm="firebase-heartbeat-database",Mm=1,Nr="firebase-heartbeat-store";let oo=null;function Uh(){return oo||(oo=Bh(Lm,Mm,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Nr)}}}).catch(t=>{throw hn.create("storage-open",{originalErrorMessage:t.message})})),oo}async function Pm(t){var e;try{return(await Uh()).transaction(Nr).objectStore(Nr).get($h(t))}catch(n){throw hn.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function oc(t,e){var n;try{const s=(await Uh()).transaction(Nr,"readwrite");return await s.objectStore(Nr).put(e,$h(t)),s.done}catch(r){throw hn.create("storage-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message})}}function $h(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm=1024,Bm=30*24*60*60*1e3;class jm{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Um(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ac();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Bm}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ac(),{heartbeatsToSend:n,unsentEntries:r}=Vm(this._heartbeatsCache.heartbeats),s=xh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function ac(){return new Date().toISOString().substring(0,10)}function Vm(t,e=Fm){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),lc(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),lc(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Um{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Lh()?Mh().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Pm(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return oc(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return oc(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function lc(t){return xh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(t){qt(new Rt("platform-logger",e=>new tm(e),"PRIVATE")),qt(new Rt("heartbeat",e=>new jm(e),"PRIVATE")),wt(Oo,ic,t),wt(Oo,ic,"esm2017"),wt("fire-js","")}$m("");var qm="firebase",Gm="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wt(qm,Gm,"app");const qh="@firebase/installations",Ta="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gh=1e4,Hh=`w:${Ta}`,zh="FIS_v2",Hm="https://firebaseinstallations.googleapis.com/v1",zm=60*60*1e3,Km="installations",Qm="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},fn=new oi(Km,Qm,Wm);function Kh(t){return t instanceof Kn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh({projectId:t}){return`${Hm}/projects/${t}/installations`}function Wh(t){return{token:t.token,requestStatus:2,expiresIn:Ym(t.expiresIn),creationTime:Date.now()}}async function Xh(t,e){const r=(await e.json()).error;return fn.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Yh({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Xm(t,{refreshToken:e}){const n=Yh(t);return n.append("Authorization",Jm(e)),n}async function Jh(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Ym(t){return Number(t.replace("s","000"))}function Jm(t){return`${zh} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zm({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=Qh(t),s=Yh(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:n,authVersion:zh,appId:t.appId,sdkVersion:Hh},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await Jh(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:Wh(c.authToken)}}else throw await Xh("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty=/^[cdef][\w-]{21}$/,Mo="";function ny(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=ry(t);return ty.test(n)?n:Mo}catch{return Mo}}function ry(t){return ey(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ai(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef=new Map;function tf(t,e){const n=ai(t);nf(n,e),sy(n,e)}function nf(t,e){const n=ef.get(t);if(!!n)for(const r of n)r(e)}function sy(t,e){const n=iy();n&&n.postMessage({key:t,fid:e}),oy()}let rn=null;function iy(){return!rn&&"BroadcastChannel"in self&&(rn=new BroadcastChannel("[Firebase] FID Change"),rn.onmessage=t=>{nf(t.data.key,t.data.fid)}),rn}function oy(){ef.size===0&&rn&&(rn.close(),rn=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ay="firebase-installations-database",ly=1,dn="firebase-installations-store";let ao=null;function ka(){return ao||(ao=Bh(ay,ly,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(dn)}}})),ao}async function Ps(t,e){const n=ai(t),s=(await ka()).transaction(dn,"readwrite"),i=s.objectStore(dn),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&tf(t,e.fid),e}async function rf(t){const e=ai(t),r=(await ka()).transaction(dn,"readwrite");await r.objectStore(dn).delete(e),await r.done}async function li(t,e){const n=ai(t),s=(await ka()).transaction(dn,"readwrite"),i=s.objectStore(dn),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&tf(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ca(t){let e;const n=await li(t.appConfig,r=>{const s=cy(r),i=uy(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Mo?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function cy(t){const e=t||{fid:ny(),registrationStatus:0};return sf(e)}function uy(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(fn.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=hy(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:fy(t)}:{installationEntry:e}}async function hy(t,e){try{const n=await Zm(t,e);return Ps(t.appConfig,n)}catch(n){throw Kh(n)&&n.customData.serverCode===409?await rf(t.appConfig):await Ps(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function fy(t){let e=await cc(t.appConfig);for(;e.registrationStatus===1;)await Zh(100),e=await cc(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Ca(t);return r||n}return e}function cc(t){return li(t,e=>{if(!e)throw fn.create("installation-not-found");return sf(e)})}function sf(t){return dy(t)?{fid:t.fid,registrationStatus:0}:t}function dy(t){return t.registrationStatus===1&&t.registrationTime+Gh<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function py({appConfig:t,heartbeatServiceProvider:e},n){const r=gy(t,n),s=Xm(t,n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:Hh,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await Jh(()=>fetch(r,a));if(l.ok){const c=await l.json();return Wh(c)}else throw await Xh("Generate Auth Token",l)}function gy(t,{fid:e}){return`${Qh(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ia(t,e=!1){let n;const r=await li(t.appConfig,i=>{if(!of(i))throw fn.create("not-registered");const o=i.authToken;if(!e&&vy(o))return i;if(o.requestStatus===1)return n=my(t,e),i;{if(!navigator.onLine)throw fn.create("app-offline");const a=wy(i);return n=yy(t,a),a}});return n?await n:r.authToken}async function my(t,e){let n=await uc(t.appConfig);for(;n.authToken.requestStatus===1;)await Zh(100),n=await uc(t.appConfig);const r=n.authToken;return r.requestStatus===0?Ia(t,e):r}function uc(t){return li(t,e=>{if(!of(e))throw fn.create("not-registered");const n=e.authToken;return _y(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function yy(t,e){try{const n=await py(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Ps(t.appConfig,r),n}catch(n){if(Kh(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await rf(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ps(t.appConfig,r)}throw n}}function of(t){return t!==void 0&&t.registrationStatus===2}function vy(t){return t.requestStatus===2&&!by(t)}function by(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+zm}function wy(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function _y(t){return t.requestStatus===1&&t.requestTime+Gh<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ey(t){const e=t,{installationEntry:n,registrationPromise:r}=await Ca(e);return r?r.catch(console.error):Ia(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ty(t,e=!1){const n=t;return await ky(n),(await Ia(n,e)).token}async function ky(t){const{registrationPromise:e}=await Ca(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cy(t){if(!t||!t.options)throw lo("App Configuration");if(!t.name)throw lo("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw lo(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function lo(t){return fn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af="installations",Iy="installations-internal",Ay=t=>{const e=t.getProvider("app").getImmediate(),n=Cy(e),r=$r(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Sy=t=>{const e=t.getProvider("app").getImmediate(),n=$r(e,af).getImmediate();return{getId:()=>Ey(n),getToken:s=>Ty(n,s)}};function Dy(){qt(new Rt(af,Ay,"PUBLIC")),qt(new Rt(Iy,Sy,"PRIVATE"))}Dy();wt(qh,Ta);wt(qh,Ta,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs="analytics",Ry="firebase_id",Ny="origin",xy=60*1e3,Oy="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",lf="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct=new wa("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function Ly(t,e){const n=document.createElement("script");n.src=`${lf}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function My(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Py(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await cf(n)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(a){ct.error(a)}t("config",s,i)}async function Fy(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await cf(n);for(const l of o){const c=a.find(f=>f.measurementId===l),u=c&&e[c.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){ct.error(i)}}function By(t,e,n,r){async function s(i,o,a){try{i==="event"?await Fy(t,e,n,o,a):i==="config"?await Py(t,e,n,r,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(l){ct.error(l)}}return s}function jy(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=By(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function Vy(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(lf))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},ft=new oi("analytics","Analytics",Uy);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=30,qy=1e3;class Gy{constructor(e={},n=qy){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const uf=new Gy;function Hy(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function zy(t){var e;const{appId:n,apiKey:r}=t,s={method:"GET",headers:Hy(r)},i=Oy.replace("{app-id}",n),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw ft.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function Ky(t,e=uf,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw ft.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw ft.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Xy;return setTimeout(async()=>{a.abort()},n!==void 0?n:xy),hf({appId:r,apiKey:s,measurementId:i},o,a,e)}async function hf(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=uf){var i,o;const{appId:a,measurementId:l}=t;try{await Qy(r,e)}catch(c){if(l)return ct.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${(i=c)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:l};throw c}try{const c=await zy(t);return s.deleteThrottleMetadata(a),c}catch(c){const u=c;if(!Wy(u)){if(s.deleteThrottleMetadata(a),l)return ct.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:l};throw c}const f=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?tc(n,s.intervalMillis,$y):tc(n,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+f,backoffCount:n+1};return s.setThrottleMetadata(a,p),ct.debug(`Calling attemptFetch again in ${f} millis`),hf(t,p,r,s)}}function Qy(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(ft.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Wy(t){if(!(t instanceof Kn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class Xy{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Yy(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o=Object.assign(Object.assign({},r),{send_to:i});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jy(){var t;if(Lh())try{await Mh()}catch(e){return ct.warn(ft.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return ct.warn(ft.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Zy(t,e,n,r,s,i,o){var a;const l=Ky(t);l.then(d=>{n[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&ct.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>ct.error(d)),e.push(l);const c=Jy().then(d=>{if(d)return r.getId()}),[u,f]=await Promise.all([l,c]);Vy()||Ly(i,u.measurementId),s("js",new Date);const p=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return p[Ny]="firebase",p.update=!0,f!=null&&(p[Ry]=f),s("config",u.measurementId,p),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e){this.app=e}_delete(){return delete Er[this.app.options.appId],Promise.resolve()}}let Er={},hc=[];const fc={};let co="dataLayer",tv="gtag",dc,ff,pc=!1;function nv(){const t=[];if(Oh()&&t.push("This is a browser extension environment."),Dg()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=ft.create("invalid-analytics-context",{errorInfo:e});ct.warn(n.message)}}function rv(t,e,n){nv();const r=t.options.appId;if(!r)throw ft.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)ct.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ft.create("no-api-key");if(Er[r]!=null)throw ft.create("already-exists",{id:r});if(!pc){My(co);const{wrappedGtag:i,gtagCore:o}=jy(Er,hc,fc,co,tv);ff=i,dc=o,pc=!0}return Er[r]=Zy(t,hc,fc,e,dc,co,n),new ev(t)}function sv(t=Vh()){t=yt(t);const e=$r(t,Fs);return e.isInitialized()?e.getImmediate():iv(t)}function iv(t,e={}){const n=$r(t,Fs);if(n.isInitialized()){const s=n.getImmediate();if(Ls(e,n.getOptions()))return s;throw ft.create("already-initialized")}return n.initialize({options:e})}function ov(t,e,n,r){t=yt(t),Yy(ff,Er[t.app.options.appId],e,n,r).catch(s=>ct.error(s))}const gc="@firebase/analytics",mc="0.8.0";function av(){qt(new Rt(Fs,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return rv(r,s,n)},"PUBLIC")),qt(new Rt("analytics-internal",t,"PRIVATE")),wt(gc,mc),wt(gc,mc,"esm2017");function t(e){try{const n=e.getProvider(Fs).getImmediate();return{logEvent:(r,s,i)=>ov(n,r,s,i)}}catch(n){throw ft.create("interop-component-reg-failed",{reason:n})}}}av();var lv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},P,Aa=Aa||{},H=lv||self;function Bs(){}function Po(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function qr(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function cv(t){return Object.prototype.hasOwnProperty.call(t,uo)&&t[uo]||(t[uo]=++uv)}var uo="closure_uid_"+(1e9*Math.random()>>>0),uv=0;function hv(t,e,n){return t.call.apply(t.bind,arguments)}function fv(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Be(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Be=hv:Be=fv,Be.apply(null,arguments)}function gs(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function $e(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function Wt(){this.s=this.s,this.o=this.o}var dv=0;Wt.prototype.s=!1;Wt.prototype.na=function(){!this.s&&(this.s=!0,this.M(),dv!=0)&&cv(this)};Wt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const df=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},pf=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const r=t.length,s=typeof t=="string"?t.split(""):t;for(let i=0;i<r;i++)i in s&&e.call(n,s[i],i,t)};function pv(t){e:{var e=i0;const n=t.length,r=typeof t=="string"?t.split(""):t;for(let s=0;s<n;s++)if(s in r&&e.call(void 0,r[s],s,t)){e=s;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function yc(t){return Array.prototype.concat.apply([],arguments)}function Sa(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function js(t){return/^[\s\xa0]*$/.test(t)}var vc=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ye(t,e){return t.indexOf(e)!=-1}function ho(t,e){return t<e?-1:t>e?1:0}var Je;e:{var bc=H.navigator;if(bc){var wc=bc.userAgent;if(wc){Je=wc;break e}}Je=""}function Da(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function gf(t){const e={};for(const n in t)e[n]=t[n];return e}var _c="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mf(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<_c.length;i++)n=_c[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ra(t){return Ra[" "](t),t}Ra[" "]=Bs;function gv(t){var e=vv;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var mv=Ye(Je,"Opera"),Pn=Ye(Je,"Trident")||Ye(Je,"MSIE"),yf=Ye(Je,"Edge"),Fo=yf||Pn,vf=Ye(Je,"Gecko")&&!(Ye(Je.toLowerCase(),"webkit")&&!Ye(Je,"Edge"))&&!(Ye(Je,"Trident")||Ye(Je,"MSIE"))&&!Ye(Je,"Edge"),yv=Ye(Je.toLowerCase(),"webkit")&&!Ye(Je,"Edge");function bf(){var t=H.document;return t?t.documentMode:void 0}var Vs;e:{var fo="",po=function(){var t=Je;if(vf)return/rv:([^\);]+)(\)|;)/.exec(t);if(yf)return/Edge\/([\d\.]+)/.exec(t);if(Pn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(yv)return/WebKit\/(\S+)/.exec(t);if(mv)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(po&&(fo=po?po[1]:""),Pn){var go=bf();if(go!=null&&go>parseFloat(fo)){Vs=String(go);break e}}Vs=fo}var vv={};function bv(){return gv(function(){let t=0;const e=vc(String(Vs)).split("."),n=vc("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var s=e[o]||"",i=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s[0].length==0&&i[0].length==0)break;t=ho(s[1].length==0?0:parseInt(s[1],10),i[1].length==0?0:parseInt(i[1],10))||ho(s[2].length==0,i[2].length==0)||ho(s[2],i[2]),s=s[3],i=i[3]}while(t==0)}return 0<=t})}var Bo;if(H.document&&Pn){var Ec=bf();Bo=Ec||parseInt(Vs,10)||void 0}else Bo=void 0;var wv=Bo,_v=function(){if(!H.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{H.addEventListener("test",Bs,e),H.removeEventListener("test",Bs,e)}catch{}return t}();function ze(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ze.prototype.h=function(){this.defaultPrevented=!0};function xr(t,e){if(ze.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(vf){e:{try{Ra(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Ev[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&xr.Z.h.call(this)}}$e(xr,ze);var Ev={2:"touch",3:"pen",4:"mouse"};xr.prototype.h=function(){xr.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Gr="closure_listenable_"+(1e6*Math.random()|0),Tv=0;function kv(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=s,this.key=++Tv,this.ca=this.fa=!1}function ci(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function ui(t){this.src=t,this.g={},this.h=0}ui.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Vo(t,e,r,s);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new kv(e,this.src,i,!!r,s),e.fa=n,t.push(e)),e};function jo(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=df(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ci(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Vo(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==r)return s}return-1}var Na="closure_lm_"+(1e6*Math.random()|0),mo={};function wf(t,e,n,r,s){if(r&&r.once)return Ef(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)wf(t,e[i],n,r,s);return null}return n=La(n),t&&t[Gr]?t.N(e,n,qr(r)?!!r.capture:!!r,s):_f(t,e,n,!1,r,s)}function _f(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=qr(s)?!!s.capture:!!s,a=Oa(t);if(a||(t[Na]=a=new ui(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=Cv(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)_v||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(kf(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Cv(){function t(n){return e.call(t.src,t.listener,n)}var e=Iv;return t}function Ef(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)Ef(t,e[i],n,r,s);return null}return n=La(n),t&&t[Gr]?t.O(e,n,qr(r)?!!r.capture:!!r,s):_f(t,e,n,!0,r,s)}function Tf(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)Tf(t,e[i],n,r,s);else r=qr(r)?!!r.capture:!!r,n=La(n),t&&t[Gr]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Vo(i,n,r,s),-1<n&&(ci(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Oa(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Vo(e,n,r,s)),(n=-1<t?e[t]:null)&&xa(n))}function xa(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[Gr])jo(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kf(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Oa(e))?(jo(n,t),n.h==0&&(n.src=null,e[Na]=null)):ci(t)}}}function kf(t){return t in mo?mo[t]:mo[t]="on"+t}function Iv(t,e){if(t.ca)t=!0;else{e=new xr(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&xa(t),t=n.call(r,e)}return t}function Oa(t){return t=t[Na],t instanceof ui?t:null}var yo="__closure_events_fn_"+(1e9*Math.random()>>>0);function La(t){return typeof t=="function"?t:(t[yo]||(t[yo]=function(e){return t.handleEvent(e)}),t[yo])}function Le(){Wt.call(this),this.i=new ui(this),this.P=this,this.I=null}$e(Le,Wt);Le.prototype[Gr]=!0;Le.prototype.removeEventListener=function(t,e,n,r){Tf(this,t,e,n,r)};function je(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new ze(e,t);else if(e instanceof ze)e.target=e.target||t;else{var s=e;e=new ze(r,t),mf(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=ms(o,r,!0,e)&&s}if(o=e.g=t,s=ms(o,r,!0,e)&&s,s=ms(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=ms(o,r,!1,e)&&s}Le.prototype.M=function(){if(Le.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ci(n[r]);delete t.g[e],t.h--}}this.I=null};Le.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Le.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function ms(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&jo(t.i,o),s=a.call(l,r)!==!1&&s}}return s&&!r.defaultPrevented}var Ma=H.JSON.stringify;function Av(){var t=If;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Sv{constructor(){this.h=this.g=null}add(e,n){const r=Cf.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var Cf=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Dv,t=>t.reset());class Dv{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Rv(t){H.setTimeout(()=>{throw t},0)}function Pa(t,e){Uo||Nv(),$o||(Uo(),$o=!0),If.add(t,e)}var Uo;function Nv(){var t=H.Promise.resolve(void 0);Uo=function(){t.then(xv)}}var $o=!1,If=new Sv;function xv(){for(var t;t=Av();){try{t.h.call(t.g)}catch(n){Rv(n)}var e=Cf;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}$o=!1}function hi(t,e){Le.call(this),this.h=t||1,this.g=e||H,this.j=Be(this.kb,this),this.l=Date.now()}$e(hi,Le);P=hi.prototype;P.da=!1;P.S=null;P.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),je(this,"tick"),this.da&&(Fa(this),this.start()))}};P.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Fa(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}P.M=function(){hi.Z.M.call(this),Fa(this),delete this.g};function Ba(t,e,n){if(typeof t=="function")n&&(t=Be(t,n));else if(t&&typeof t.handleEvent=="function")t=Be(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:H.setTimeout(t,e||0)}function Af(t){t.g=Ba(()=>{t.g=null,t.i&&(t.i=!1,Af(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class Ov extends Wt{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Af(this)}M(){super.M(),this.g&&(H.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Or(t){Wt.call(this),this.h=t,this.g={}}$e(Or,Wt);var Tc=[];function Sf(t,e,n,r){Array.isArray(n)||(n&&(Tc[0]=n.toString()),n=Tc);for(var s=0;s<n.length;s++){var i=wf(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function Df(t){Da(t.g,function(e,n){this.g.hasOwnProperty(n)&&xa(e)},t),t.g={}}Or.prototype.M=function(){Or.Z.M.call(this),Df(this)};Or.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function fi(){this.g=!0}fi.prototype.Aa=function(){this.g=!1};function Lv(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var f=u.split("_");o=2<=f.length&&f[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function Mv(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function Rn(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Fv(t,n)+(r?" "+r:"")})}function Pv(t,e){t.info(function(){return"TIMEOUT: "+e})}fi.prototype.info=function(){};function Fv(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return Ma(n)}catch{return e}}var _n={},kc=null;function di(){return kc=kc||new Le}_n.Ma="serverreachability";function Rf(t){ze.call(this,_n.Ma,t)}$e(Rf,ze);function Lr(t){const e=di();je(e,new Rf(e))}_n.STAT_EVENT="statevent";function Nf(t,e){ze.call(this,_n.STAT_EVENT,t),this.stat=e}$e(Nf,ze);function Ze(t){const e=di();je(e,new Nf(e,t))}_n.Na="timingevent";function xf(t,e){ze.call(this,_n.Na,t),this.size=e}$e(xf,ze);function Hr(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return H.setTimeout(function(){t()},e)}var pi={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Of={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ja(){}ja.prototype.h=null;function Cc(t){return t.h||(t.h=t.i())}function Lf(){}var zr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Va(){ze.call(this,"d")}$e(Va,ze);function Ua(){ze.call(this,"c")}$e(Ua,ze);var qo;function gi(){}$e(gi,ja);gi.prototype.g=function(){return new XMLHttpRequest};gi.prototype.i=function(){return{}};qo=new gi;function Kr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Or(this),this.P=Bv,t=Fo?125:void 0,this.W=new hi(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Mf}function Mf(){this.i=null,this.g="",this.h=!1}var Bv=45e3,Go={},Us={};P=Kr.prototype;P.setTimeout=function(t){this.P=t};function Ho(t,e,n){t.K=1,t.v=yi(Nt(e)),t.s=n,t.U=!0,Pf(t,null)}function Pf(t,e){t.F=Date.now(),Qr(t),t.A=Nt(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),qf(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Mf,t.g=cd(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Ov(Be(t.Ia,t,t.g),t.O)),Sf(t.V,t.g,"readystatechange",t.gb),e=t.H?gf(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Lr(),Lv(t.j,t.u,t.A,t.m,t.X,t.s)}P.gb=function(t){t=t.target;const e=this.L;e&&At(t)==3?e.l():this.Ia(t)};P.Ia=function(t){try{if(t==this.g)e:{const u=At(this.g);var e=this.g.Da();const f=this.g.ba();if(!(3>u)&&(u!=3||Fo||this.g&&(this.h.h||this.g.ga()||Dc(this.g)))){this.I||u!=4||e==7||(e==8||0>=f?Lr(3):Lr(2)),mi(this);var n=this.g.ba();this.N=n;t:if(Ff(this)){var r=Dc(this.g);t="";var s=r.length,i=At(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){sn(this),Tr(this);var o="";break t}this.h.i=new H.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,Mv(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!js(a)){var c=a;break t}}c=null}if(n=c)Rn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,zo(this,n);else{this.i=!1,this.o=3,Ze(12),sn(this),Tr(this);break e}}this.U?(Bf(this,u,o),Fo&&this.i&&u==3&&(Sf(this.V,this.W,"tick",this.fb),this.W.start())):(Rn(this.j,this.m,o,null),zo(this,o)),u==4&&sn(this),this.i&&!this.I&&(u==4?id(this.l,this):(this.i=!1,Qr(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,Ze(12)):(this.o=0,Ze(13)),sn(this),Tr(this)}}}catch{}finally{}};function Ff(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function Bf(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=jv(t,n),s==Us){e==4&&(t.o=4,Ze(14),r=!1),Rn(t.j,t.m,null,"[Incomplete Response]");break}else if(s==Go){t.o=4,Ze(15),Rn(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Rn(t.j,t.m,s,null),zo(t,s);Ff(t)&&s!=Us&&s!=Go&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,Ze(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xa(e),e.L=!0,Ze(11))):(Rn(t.j,t.m,n,"[Invalid Chunked Response]"),sn(t),Tr(t))}P.fb=function(){if(this.g){var t=At(this.g),e=this.g.ga();this.C<e.length&&(mi(this),Bf(this,t,e),this.i&&t!=4&&Qr(this))}};function jv(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Us:(n=Number(e.substring(n,r)),isNaN(n)?Go:(r+=1,r+n>e.length?Us:(e=e.substr(r,n),t.C=r+n,e)))}P.cancel=function(){this.I=!0,sn(this)};function Qr(t){t.Y=Date.now()+t.P,jf(t,t.P)}function jf(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Hr(Be(t.eb,t),e)}function mi(t){t.B&&(H.clearTimeout(t.B),t.B=null)}P.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(Pv(this.j,this.A),this.K!=2&&(Lr(),Ze(17)),sn(this),this.o=2,Tr(this)):jf(this,this.Y-t)};function Tr(t){t.l.G==0||t.I||id(t.l,t)}function sn(t){mi(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,Fa(t.W),Df(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function zo(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||Ko(n.i,t))){if(n.I=t.N,!t.J&&Ko(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Hs(n),wi(n);else break e;Wa(n),Ze(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&n.A==0&&!n.v&&(n.v=Hr(Be(n.ab,n),6e3));if(1>=zf(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else on(n,11)}else if((t.J||n.g==t)&&Hs(n),!js(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.U=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.J=c[1],n.la=c[2];const u=c[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const f=c[4];f!=null&&(n.za=f,n.h.info("SVER="+n.za));const p=c[5];p!=null&&typeof p=="number"&&0<p&&(r=1.5*p,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=t.g;if(d){const h=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var i=r.i;!i.g&&(Ye(h,"spdy")||Ye(h,"quic")||Ye(h,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(Ga(i,i.h),i.h=null))}if(r.D){const m=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.sa=m,ye(r.F,r.D,m))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var o=t;if(r.oa=ld(r,r.H?r.la:null,r.W),o.J){Kf(r.i,o);var a=o,l=r.K;l&&a.setTimeout(l),a.B&&(mi(a),Qr(a)),r.g=o}else rd(r);0<n.l.length&&_i(n)}else c[0]!="stop"&&c[0]!="close"||on(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?on(n,7):Qa(n):c[0]!="noop"&&n.j&&n.j.wa(c),n.A=0)}}Lr(4)}catch{}}function Vv(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(Po(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function $a(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Po(t)||typeof t=="string")pf(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(Po(t)||typeof t=="string"){n=[];for(var r=t.length,s=0;s<r;s++)n.push(s)}else for(s in n=[],r=0,t)n[r++]=s;r=Vv(t),s=r.length;for(var i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}}function Qn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}P=Qn.prototype;P.R=function(){qa(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};P.T=function(){return qa(this),this.g.concat()};function qa(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];pn(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)r=t.g[e],pn(s,r)||(t.g[n++]=r,s[r]=1),e++;t.g.length=n}}P.get=function(t,e){return pn(this.h,t)?this.h[t]:e};P.set=function(t,e){pn(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};P.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var s=n[r],i=this.get(s);t.call(e,i,s,this)}};function pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Vf=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Uv(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function gn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof gn){this.g=e!==void 0?e:t.g,$s(this,t.j),this.s=t.s,qs(this,t.i),Gs(this,t.m),this.l=t.l,e=t.h;var n=new Mr;n.i=e.i,e.g&&(n.g=new Qn(e.g),n.h=e.h),Ic(this,n),this.o=t.o}else t&&(n=String(t).match(Vf))?(this.g=!!e,$s(this,n[1]||"",!0),this.s=kr(n[2]||""),qs(this,n[3]||"",!0),Gs(this,n[4]),this.l=kr(n[5]||"",!0),Ic(this,n[6]||"",!0),this.o=kr(n[7]||"")):(this.g=!!e,this.h=new Mr(null,this.g))}gn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(vr(e,Ac,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(vr(e,Ac,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(vr(n,n.charAt(0)=="/"?zv:Hv,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",vr(n,Qv)),t.join("")};function Nt(t){return new gn(t)}function $s(t,e,n){t.j=n?kr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function qs(t,e,n){t.i=n?kr(e,!0):e}function Gs(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ic(t,e,n){e instanceof Mr?(t.h=e,Wv(t.h,t.g)):(n||(e=vr(e,Kv)),t.h=new Mr(e,t.g))}function ye(t,e,n){t.h.set(e,n)}function yi(t){return ye(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function $v(t){return t instanceof gn?Nt(t):new gn(t,void 0)}function qv(t,e,n,r){var s=new gn(null,void 0);return t&&$s(s,t),e&&qs(s,e),n&&Gs(s,n),r&&(s.l=r),s}function kr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function vr(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,Gv),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Gv(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Ac=/[#\/\?@]/g,Hv=/[#\?:]/g,zv=/[#\?]/g,Kv=/[#\?@]/g,Qv=/#/g;function Mr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Xt(t){t.g||(t.g=new Qn,t.h=0,t.i&&Uv(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}P=Mr.prototype;P.add=function(t,e){Xt(this),this.i=null,t=Wn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Uf(t,e){Xt(t),e=Wn(t,e),pn(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,pn(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&qa(t)))}function $f(t,e){return Xt(t),e=Wn(t,e),pn(t.g.h,e)}P.forEach=function(t,e){Xt(this),this.g.forEach(function(n,r){pf(n,function(s){t.call(e,s,r,this)},this)},this)};P.T=function(){Xt(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var s=t[r],i=0;i<s.length;i++)n.push(e[r]);return n};P.R=function(t){Xt(this);var e=[];if(typeof t=="string")$f(this,t)&&(e=yc(e,this.g.get(Wn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=yc(e,t[n])}return e};P.set=function(t,e){return Xt(this),this.i=null,t=Wn(this,t),$f(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};P.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function qf(t,e,n){Uf(t,e),0<n.length&&(t.i=null,t.g.set(Wn(t,e),Sa(n)),t.h+=n.length)}P.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],s=encodeURIComponent(String(r));r=this.R(r);for(var i=0;i<r.length;i++){var o=s;r[i]!==""&&(o+="="+encodeURIComponent(String(r[i]))),t.push(o)}}return this.i=t.join("&")};function Wn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Wv(t,e){e&&!t.j&&(Xt(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(Uf(this,r),qf(this,s,n))},t)),t.j=e}var Xv=class{constructor(t,e){this.h=t,this.g=e}};function Gf(t){this.l=t||Yv,H.PerformanceNavigationTiming?(t=H.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(H.g&&H.g.Ea&&H.g.Ea()&&H.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Yv=10;function Hf(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function zf(t){return t.h?1:t.g?t.g.size:0}function Ko(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Ga(t,e){t.g?t.g.add(e):t.h=e}function Kf(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Gf.prototype.cancel=function(){if(this.i=Qf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function Qf(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Sa(t.i)}function Ha(){}Ha.prototype.stringify=function(t){return H.JSON.stringify(t,void 0)};Ha.prototype.parse=function(t){return H.JSON.parse(t,void 0)};function Jv(){this.g=new Ha}function Zv(t,e,n){const r=n||"";try{$a(t,function(s,i){let o=s;qr(s)&&(o=Ma(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function e0(t,e){const n=new fi;if(H.Image){const r=new Image;r.onload=gs(ys,n,r,"TestLoadImage: loaded",!0,e),r.onerror=gs(ys,n,r,"TestLoadImage: error",!1,e),r.onabort=gs(ys,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=gs(ys,n,r,"TestLoadImage: timeout",!1,e),H.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function ys(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Wr(t){this.l=t.$b||null,this.j=t.ib||!1}$e(Wr,ja);Wr.prototype.g=function(){return new vi(this.l,this.j)};Wr.prototype.i=function(t){return function(){return t}}({});function vi(t,e){Le.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=za,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}$e(vi,Le);var za=0;P=vi.prototype;P.open=function(t,e){if(this.readyState!=za)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Pr(this)};P.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||H).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};P.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xr(this)),this.readyState=za};P.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Pr(this)),this.g&&(this.readyState=3,Pr(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof H.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Wf(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function Wf(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}P.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Xr(this):Pr(this),this.readyState==3&&Wf(this)}};P.Ua=function(t){this.g&&(this.response=this.responseText=t,Xr(this))};P.Ta=function(t){this.g&&(this.response=t,Xr(this))};P.ha=function(){this.g&&Xr(this)};function Xr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Pr(t)}P.setRequestHeader=function(t,e){this.v.append(t,e)};P.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};P.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Pr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(vi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var t0=H.JSON.parse;function Ce(t){Le.call(this),this.headers=new Qn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Xf,this.K=this.L=!1}$e(Ce,Le);var Xf="",n0=/^https?$/i,r0=["POST","PUT"];P=Ce.prototype;P.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():qo.g(),this.C=this.u?Cc(this.u):Cc(qo),this.g.onreadystatechange=Be(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){Sc(this,i);return}t=n||"";const s=new Qn(this.headers);r&&$a(r,function(i,o){s.set(o,i)}),r=pv(s.T()),n=H.FormData&&t instanceof H.FormData,!(0<=df(r0,e))||r||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Zf(this),0<this.B&&((this.K=s0(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Be(this.pa,this)):this.A=Ba(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Sc(this,i)}};function s0(t){return Pn&&bv()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function i0(t){return t.toLowerCase()=="content-type"}P.pa=function(){typeof Aa<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,je(this,"timeout"),this.abort(8))};function Sc(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Yf(t),bi(t)}function Yf(t){t.D||(t.D=!0,je(t,"complete"),je(t,"error"))}P.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,je(this,"complete"),je(this,"abort"),bi(this))};P.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),bi(this,!0)),Ce.Z.M.call(this)};P.Fa=function(){this.s||(this.F||this.v||this.l?Jf(this):this.cb())};P.cb=function(){Jf(this)};function Jf(t){if(t.h&&typeof Aa<"u"&&(!t.C[1]||At(t)!=4||t.ba()!=2)){if(t.v&&At(t)==4)Ba(t.Fa,0,t);else if(je(t,"readystatechange"),At(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(Vf)[1]||null;if(!s&&H.self&&H.self.location){var i=H.self.location.protocol;s=i.substr(0,i.length-1)}r=!n0.test(s?s.toLowerCase():"")}n=r}if(n)je(t,"complete"),je(t,"success");else{t.m=6;try{var o=2<At(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",Yf(t)}}finally{bi(t)}}}}function bi(t,e){if(t.g){Zf(t);const n=t.g,r=t.C[0]?Bs:null;t.g=null,t.C=null,e||je(t,"ready");try{n.onreadystatechange=r}catch{}}}function Zf(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(H.clearTimeout(t.A),t.A=null)}function At(t){return t.g?t.g.readyState:0}P.ba=function(){try{return 2<At(this)?this.g.status:-1}catch{return-1}};P.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};P.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),t0(e)}};function Dc(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Xf:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}P.Da=function(){return this.m};P.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function o0(t){let e="";return Da(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Ka(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=o0(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):ye(t,e,n))}function dr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function ed(t){this.za=0,this.l=[],this.h=new fi,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=dr("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=dr("baseRetryDelayMs",5e3,t),this.$a=dr("retryDelaySeedMs",1e4,t),this.Ya=dr("forwardChannelMaxRetries",2,t),this.ra=dr("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Gf(t&&t.concurrentRequestLimit),this.Ca=new Jv,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}P=ed.prototype;P.ma=8;P.G=1;function Qa(t){if(td(t),t.G==3){var e=t.V++,n=Nt(t.F);ye(n,"SID",t.J),ye(n,"RID",e),ye(n,"TYPE","terminate"),Yr(t,n),e=new Kr(t,t.h,e,void 0),e.K=2,e.v=yi(Nt(n)),n=!1,H.navigator&&H.navigator.sendBeacon&&(n=H.navigator.sendBeacon(e.v.toString(),"")),!n&&H.Image&&(new Image().src=e.v,n=!0),n||(e.g=cd(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Qr(e)}ad(t)}P.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function wi(t){t.g&&(Xa(t),t.g.cancel(),t.g=null)}function td(t){wi(t),t.u&&(H.clearTimeout(t.u),t.u=null),Hs(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&H.clearTimeout(t.m),t.m=null)}function vo(t,e){t.l.push(new Xv(t.Za++,e)),t.G==3&&_i(t)}function _i(t){Hf(t.i)||t.m||(t.m=!0,Pa(t.Ha,t),t.C=0)}function a0(t,e){return zf(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Hr(Be(t.Ha,t,e),od(t,t.C)),t.C++,!0)}P.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new Kr(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=gf(i),mf(i,this.P)):i=this.P),this.o===null&&(s.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var r=this.l[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=nd(this,s,e),n=Nt(this.F),ye(n,"RID",t),ye(n,"CVER",22),this.D&&ye(n,"X-HTTP-Session-Id",this.D),Yr(this,n),this.o&&i&&Ka(n,this.o,i),Ga(this.i,s),this.Ra&&ye(n,"TYPE","init"),this.ja?(ye(n,"$req",e),ye(n,"SID","null"),s.$=!0,Ho(s,n,null)):Ho(s,n,e),this.G=2}}else this.G==3&&(t?Rc(this,t):this.l.length==0||Hf(this.i)||Rc(this))};function Rc(t,e){var n;e?n=e.m:n=t.V++;const r=Nt(t.F);ye(r,"SID",t.J),ye(r,"RID",n),ye(r,"AID",t.U),Yr(t,r),t.o&&t.s&&Ka(r,t.o,t.s),n=new Kr(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=nd(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Ga(t.i,n),Ho(n,r,e)}function Yr(t,e){t.j&&$a({},function(n,r){ye(e,r,n)})}function nd(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Be(t.j.Oa,t.j,t):null;e:{var s=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let l=0;l<n;l++){let c=s[l].h;const u=s[l].g;if(c-=i,0>c)i=Math.max(0,s[l].h-100),a=!1;else try{Zv(u,o,"req"+c+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,r}function rd(t){t.g||t.u||(t.Y=1,Pa(t.Ga,t),t.A=0)}function Wa(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Hr(Be(t.Ga,t),od(t,t.A)),t.A++,!0)}P.Ga=function(){if(this.u=null,sd(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Hr(Be(this.bb,this),t)}};P.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ze(10),wi(this),sd(this))};function Xa(t){t.B!=null&&(H.clearTimeout(t.B),t.B=null)}function sd(t){t.g=new Kr(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=Nt(t.oa);ye(e,"RID","rpc"),ye(e,"SID",t.J),ye(e,"CI",t.N?"0":"1"),ye(e,"AID",t.U),Yr(t,e),ye(e,"TYPE","xmlhttp"),t.o&&t.s&&Ka(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=yi(Nt(e)),n.s=null,n.U=!0,Pf(n,t)}P.ab=function(){this.v!=null&&(this.v=null,wi(this),Wa(this),Ze(19))};function Hs(t){t.v!=null&&(H.clearTimeout(t.v),t.v=null)}function id(t,e){var n=null;if(t.g==e){Hs(t),Xa(t),t.g=null;var r=2}else if(Ko(t.i,e))n=e.D,Kf(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=di(),je(r,new xf(r,n)),_i(t)}else rd(t);else if(s=e.o,s==3||s==0&&0<t.I||!(r==1&&a0(t,e)||r==2&&Wa(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:on(t,5);break;case 4:on(t,10);break;case 3:on(t,6);break;default:on(t,2)}}}function od(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function on(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=Be(t.jb,t);n||(n=new gn("//www.google.com/images/cleardot.gif"),H.location&&H.location.protocol=="http"||$s(n,"https"),yi(n)),e0(n.toString(),r)}else Ze(2);t.G=0,t.j&&t.j.va(e),ad(t),td(t)}P.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Ze(2)):(this.h.info("Failed to ping google.com"),Ze(1))};function ad(t){t.G=0,t.I=-1,t.j&&((Qf(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,Sa(t.l),t.l.length=0),t.j.ua())}function ld(t,e,n){let r=$v(n);if(r.i!="")e&&qs(r,e+"."+r.i),Gs(r,r.m);else{const s=H.location;r=qv(s.protocol,e?e+"."+s.hostname:s.hostname,+s.port,n)}return t.aa&&Da(t.aa,function(s,i){ye(r,i,s)}),e=t.D,n=t.sa,e&&n&&ye(r,e,n),ye(r,"VER",t.ma),Yr(t,r),r}function cd(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new Ce(new Wr({ib:!0})):new Ce(t.qa),e.L=t.H,e}function ud(){}P=ud.prototype;P.xa=function(){};P.wa=function(){};P.va=function(){};P.ua=function(){};P.Oa=function(){};function zs(){if(Pn&&!(10<=Number(wv)))throw Error("Environmental error: no available transport.")}zs.prototype.g=function(t,e){return new ut(t,e)};function ut(t,e){Le.call(this),this.g=new ed(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!js(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!js(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Xn(this)}$e(ut,Le);ut.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Pa(Be(t.hb,t,e))),Ze(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=ld(t,null,t.W),_i(t)};ut.prototype.close=function(){Qa(this.g)};ut.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,vo(this.g,e)}else this.v?(e={},e.__data__=Ma(t),vo(this.g,e)):vo(this.g,t)};ut.prototype.M=function(){this.g.j=null,delete this.j,Qa(this.g),delete this.g,ut.Z.M.call(this)};function hd(t){Va.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}$e(hd,Va);function fd(){Ua.call(this),this.status=1}$e(fd,Ua);function Xn(t){this.g=t}$e(Xn,ud);Xn.prototype.xa=function(){je(this.g,"a")};Xn.prototype.wa=function(t){je(this.g,new hd(t))};Xn.prototype.va=function(t){je(this.g,new fd)};Xn.prototype.ua=function(){je(this.g,"b")};zs.prototype.createWebChannel=zs.prototype.g;ut.prototype.send=ut.prototype.u;ut.prototype.open=ut.prototype.m;ut.prototype.close=ut.prototype.close;pi.NO_ERROR=0;pi.TIMEOUT=8;pi.HTTP_ERROR=6;Of.COMPLETE="complete";Lf.EventType=zr;zr.OPEN="a";zr.CLOSE="b";zr.ERROR="c";zr.MESSAGE="d";Le.prototype.listen=Le.prototype.N;Ce.prototype.listenOnce=Ce.prototype.O;Ce.prototype.getLastError=Ce.prototype.La;Ce.prototype.getLastErrorCode=Ce.prototype.Da;Ce.prototype.getStatus=Ce.prototype.ba;Ce.prototype.getResponseJson=Ce.prototype.Qa;Ce.prototype.getResponseText=Ce.prototype.ga;Ce.prototype.send=Ce.prototype.ea;var l0=function(){return new zs},c0=function(){return di()},bo=pi,u0=Of,h0=_n,Nc={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},f0=Wr,vs=Lf,d0=Ce;const xc="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}nt.UNAUTHENTICATED=new nt(null),nt.GOOGLE_CREDENTIALS=new nt("google-credentials-uid"),nt.FIRST_PARTY=new nt("first-party-uid"),nt.MOCK_USER=new nt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yn="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn=new wa("@firebase/firestore");function Oc(){return mn.logLevel}function V(t,...e){if(mn.logLevel<=ie.DEBUG){const n=e.map(Ya);mn.debug(`Firestore (${Yn}): ${t}`,...n)}}function Gt(t,...e){if(mn.logLevel<=ie.ERROR){const n=e.map(Ya);mn.error(`Firestore (${Yn}): ${t}`,...n)}}function Lc(t,...e){if(mn.logLevel<=ie.WARN){const n=e.map(Ya);mn.warn(`Firestore (${Yn}): ${t}`,...n)}}function Ya(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z(t="Unexpected state"){const e=`FIRESTORE (${Yn}) INTERNAL ASSERTION FAILED: `+t;throw Gt(e),new Error(e)}function fe(t,e){t||z()}function K(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends Kn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class g0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(nt.UNAUTHENTICATED))}shutdown(){}}class m0{constructor(e){this.t=e,this.currentUser=nt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new jt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new jt,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new jt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(fe(typeof r.accessToken=="string"),new p0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return fe(e===null||typeof e=="string"),new nt(e)}}class y0{constructor(e,n,r){this.type="FirstParty",this.user=nt.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const s=e.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class v0{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new y0(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(nt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class b0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class w0{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const r=i=>{i.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,V("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?s(i):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(fe(typeof n.token=="string"),this.p=n.token,new b0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=_0(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function oe(t,e){return t<e?-1:t>e?1:0}function Fn(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new $(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new $(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Se.fromMillis(Date.now())}static fromDate(e){return Se.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Se(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?oe(this.nanoseconds,e.nanoseconds):oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.timestamp=e}static fromTimestamp(e){return new W(e)}static min(){return new W(new Se(0,0))}static max(){return new W(new Se(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n,r){n===void 0?n=0:n>e.length&&z(),r===void 0?r=e.length-n:r>e.length-n&&z(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Fr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Fr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ve extends Fr{construct(e,n,r){return new ve(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new $(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ve(n)}static emptyPath(){return new ve([])}}const E0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qe extends Fr{construct(e,n,r){return new qe(e,n,r)}static isValidIdentifier(e){return E0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new qe(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new $(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new $(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new $(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new $(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qe(n)}static emptyPath(){return new qe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.path=e}static fromPath(e){return new U(ve.fromString(e))}static fromName(e){return new U(ve.fromString(e).popFirst(5))}static empty(){return new U(ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ve.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new ve(e.slice()))}}function T0(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=W.fromTimestamp(r===1e9?new Se(n+1,0):new Se(n,r));return new Ht(s,U.empty(),e)}function k0(t){return new Ht(t.readTime,t.key,-1)}class Ht{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ht(W.min(),U.empty(),-1)}static max(){return new Ht(W.max(),U.empty(),-1)}}function C0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=U.comparator(t.documentKey,e.documentKey),n!==0?n:oe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class A0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jr(t){if(t.code!==N.FAILED_PRECONDITION||t.message!==I0)throw t;V("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new x((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof x?n:x.resolve(n)}catch(n){return x.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):x.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):x.reject(n)}static resolve(e){return new x((n,r)=>{n(e)})}static reject(e){return new x((n,r)=>{r(e)})}static waitFor(e){return new x((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=x.resolve(!1);for(const r of e)n=n.next(s=>s?x.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new x((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new x((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Zr(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.it(r),this.rt=r=>n.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mc(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function En(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function pd(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ja.ot=-1;class Re{constructor(e,n){this.comparator=e,this.root=n||Pe.EMPTY}insert(e,n){return new Re(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Pe.BLACK,null,null))}remove(e){return new Re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pe.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bs(this.root,e,this.comparator,!1)}getReverseIterator(){return new bs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bs(this.root,e,this.comparator,!0)}}class bs{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Pe{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Pe.RED,this.left=s!=null?s:Pe.EMPTY,this.right=i!=null?i:Pe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Pe(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Pe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Pe.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Pe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Pe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw z();const e=this.left.check();if(e!==this.right.check())throw z();return e+(this.isRed()?0:1)}}Pe.EMPTY=null,Pe.RED=!0,Pe.BLACK=!1;Pe.EMPTY=new class{constructor(){this.size=0}get key(){throw z()}get value(){throw z()}get color(){throw z()}get left(){throw z()}get right(){throw z()}copy(t,e,n,r,s){return this}insert(t,e,n){return new Pe(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Pc(this.data.getIterator())}getIteratorFrom(e){return new Pc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof De)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new De(this.comparator);return n.data=e,n}}class Pc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.fields=e,e.sort(qe.comparator)}static empty(){return new dt([])}unionWith(e){let n=new De(qe.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new dt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Fn(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new Ve(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new Ve(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ve.EMPTY_BYTE_STRING=new Ve("");const S0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zt(t){if(fe(!!t),typeof t=="string"){let e=0;const n=S0.exec(t);if(fe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ee(t.seconds),nanos:Ee(t.nanos)}}function Ee(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Bn(t){return typeof t=="string"?Ve.fromBase64String(t):Ve.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gd(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function md(t){const e=t.mapValue.fields.__previous_value__;return gd(e)?md(e):e}function Br(t){const e=zt(t.mapValue.fields.__local_write_time__.timestampValue);return new Se(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e,n,r,s,i,o,a,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class jn{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new jn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof jn&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(t){return t==null}function Ks(t){return t===0&&1/t==-1/0}function R0(t){return typeof t=="number"&&Number.isInteger(t)&&!Ks(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function yn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gd(t)?4:N0(t)?9007199254740991:10:z()}function Et(t,e){if(t===e)return!0;const n=yn(t);if(n!==yn(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Br(t).isEqual(Br(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=zt(r.timestampValue),o=zt(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return Bn(r.bytesValue).isEqual(Bn(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return Ee(r.geoPointValue.latitude)===Ee(s.geoPointValue.latitude)&&Ee(r.geoPointValue.longitude)===Ee(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Ee(r.integerValue)===Ee(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=Ee(r.doubleValue),o=Ee(s.doubleValue);return i===o?Ks(i)===Ks(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Fn(t.arrayValue.values||[],e.arrayValue.values||[],Et);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(Mc(i)!==Mc(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Et(i[a],o[a])))return!1;return!0}(t,e);default:return z()}}function jr(t,e){return(t.values||[]).find(n=>Et(n,e))!==void 0}function Vn(t,e){if(t===e)return 0;const n=yn(t),r=yn(e);if(n!==r)return oe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return oe(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=Ee(s.integerValue||s.doubleValue),a=Ee(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return Fc(t.timestampValue,e.timestampValue);case 4:return Fc(Br(t),Br(e));case 5:return oe(t.stringValue,e.stringValue);case 6:return function(s,i){const o=Bn(s),a=Bn(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=oe(o[l],a[l]);if(c!==0)return c}return oe(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=oe(Ee(s.latitude),Ee(i.latitude));return o!==0?o:oe(Ee(s.longitude),Ee(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=Vn(o[l],a[l]);if(c)return c}return oe(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===ws.mapValue&&i===ws.mapValue)return 0;if(s===ws.mapValue)return 1;if(i===ws.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),l=i.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let u=0;u<a.length&&u<c.length;++u){const f=oe(a[u],c[u]);if(f!==0)return f;const p=Vn(o[a[u]],l[c[u]]);if(p!==0)return p}return oe(a.length,c.length)}(t.mapValue,e.mapValue);default:throw z()}}function Fc(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return oe(t,e);const n=zt(t),r=zt(e),s=oe(n.seconds,r.seconds);return s!==0?s:oe(n.nanos,r.nanos)}function xn(t){return Qo(t)}function Qo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=zt(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Bn(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,U.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=Qo(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${Qo(r.fields[a])}`;return i+"}"}(t.mapValue):z();var e,n}function Wo(t){return!!t&&"integerValue"in t}function Za(t){return!!t&&"arrayValue"in t}function Bc(t){return!!t&&"nullValue"in t}function jc(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Rs(t){return!!t&&"mapValue"in t}function Cr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return En(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Cr(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Cr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function N0(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.value=e}static empty(){return new rt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Rs(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cr(n)}setAll(e){let n=qe.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Cr(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Rs(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Et(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Rs(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){En(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new rt(Cr(this.value))}}function yd(t){const e=[];return En(t.fields,(n,r)=>{const s=new qe([n]);if(Rs(r)){const i=yd(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new dt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,n,r,s,i,o){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Fe(e,0,W.min(),W.min(),rt.empty(),0)}static newFoundDocument(e,n,r){return new Fe(e,1,n,W.min(),r,0)}static newNoDocument(e,n){return new Fe(e,2,n,W.min(),rt.empty(),0)}static newUnknownDocument(e,n){return new Fe(e,3,n,W.min(),rt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Fe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fe(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function Vc(t,e=null,n=[],r=[],s=null,i=null,o=null){return new x0(t,e,n,r,s,i,o)}function el(t){const e=K(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+xn(s.value);var s}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ei(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>xn(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>xn(r)).join(",")),e.ut=n}return e.ut}function O0(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${xn(r.value)}`;var r}).join(", ")}]`),Ei(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>xn(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>xn(n)).join(",")),`Target(${e})`}function tl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!U0(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],r=e.filters[s],n.op!==r.op||!n.field.isEqual(r.field)||!Et(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$c(t.startAt,e.startAt)&&$c(t.endAt,e.endAt)}function Xo(t){return U.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class st extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,r):new L0(e,n,r):n==="array-contains"?new F0(e,r):n==="in"?new B0(e,r):n==="not-in"?new j0(e,r):n==="array-contains-any"?new V0(e,r):new st(e,n,r)}static ct(e,n,r){return n==="in"?new M0(e,r):new P0(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(Vn(n,this.value)):n!==null&&yn(this.value)===yn(n)&&this.at(Vn(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return z()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class L0 extends st{constructor(e,n,r){super(e,n,r),this.key=U.fromName(r.referenceValue)}matches(e){const n=U.comparator(e.key,this.key);return this.at(n)}}class M0 extends st{constructor(e,n){super(e,"in",n),this.keys=vd("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class P0 extends st{constructor(e,n){super(e,"not-in",n),this.keys=vd("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function vd(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>U.fromName(r.referenceValue))}class F0 extends st{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Za(n)&&jr(n.arrayValue,this.value)}}class B0 extends st{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&jr(this.value.arrayValue,n)}}class j0 extends st{constructor(e,n){super(e,"not-in",n)}matches(e){if(jr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!jr(this.value.arrayValue,n)}}class V0 extends st{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Za(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>jr(this.value.arrayValue,r))}}class Qs{constructor(e,n){this.position=e,this.inclusive=n}}class Ir{constructor(e,n="asc"){this.field=e,this.dir=n}}function U0(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Uc(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=U.comparator(U.fromName(o.referenceValue),n.key):r=Vn(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function $c(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Et(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.lt=null,this.ft=null,this.startAt,this.endAt}}function $0(t,e,n,r,s,i,o,a){return new Ti(t,e,n,r,s,i,o,a)}function ki(t){return new Ti(t)}function q0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function G0(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function H0(t){for(const e of t.filters)if(e.ht())return e.field;return null}function z0(t){return t.collectionGroup!==null}function Vr(t){const e=K(t);if(e.lt===null){e.lt=[];const n=H0(e),r=G0(e);if(n!==null&&r===null)n.isKeyField()||e.lt.push(new Ir(n)),e.lt.push(new Ir(qe.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Ir(qe.keyField(),i))}}}return e.lt}function vn(t){const e=K(t);if(!e.ft)if(e.limitType==="F")e.ft=Vc(e.path,e.collectionGroup,Vr(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Vr(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new Ir(i.field,o))}const r=e.endAt?new Qs(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Qs(e.startAt.position,e.startAt.inclusive):null;e.ft=Vc(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.ft}function K0(t,e,n){return new Ti(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ci(t,e){return tl(vn(t),vn(e))&&t.limitType===e.limitType}function bd(t){return`${el(vn(t))}|lt:${t.limitType}`}function Yo(t){return`Query(target=${O0(vn(t))}; limitType=${t.limitType})`}function nl(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):U.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of n.explicitOrderBy)if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=Uc(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,Vr(n),r)||n.endAt&&!function(s,i,o){const a=Uc(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,Vr(n),r))}(t,e)}function Q0(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wd(t){return(e,n)=>{let r=!1;for(const s of Vr(t)){const i=W0(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function W0(t,e,n){const r=t.field.isKeyField()?U.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),l=o.data.field(s);return a!==null&&l!==null?Vn(a,l):z()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return z()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ks(e)?"-0":e}}function Ed(t){return{integerValue:""+t}}function X0(t,e){return R0(e)?Ed(e):_d(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(){this._=void 0}}function Y0(t,e,n){return t instanceof Ws?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof Un?kd(t,e):t instanceof $n?Cd(t,e):function(r,s){const i=Td(r,s),o=qc(i)+qc(r._t);return Wo(i)&&Wo(r._t)?Ed(o):_d(r.wt,o)}(t,e)}function J0(t,e,n){return t instanceof Un?kd(t,e):t instanceof $n?Cd(t,e):n}function Td(t,e){return t instanceof Xs?Wo(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class Ws extends Ii{}class Un extends Ii{constructor(e){super(),this.elements=e}}function kd(t,e){const n=Id(e);for(const r of t.elements)n.some(s=>Et(s,r))||n.push(r);return{arrayValue:{values:n}}}class $n extends Ii{constructor(e){super(),this.elements=e}}function Cd(t,e){let n=Id(e);for(const r of t.elements)n=n.filter(s=>!Et(s,r));return{arrayValue:{values:n}}}class Xs extends Ii{constructor(e,n){super(),this.wt=e,this._t=n}}function qc(t){return Ee(t.integerValue||t.doubleValue)}function Id(t){return Za(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,n){this.field=e,this.transform=n}}function Z0(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof Un&&r instanceof Un||n instanceof $n&&r instanceof $n?Fn(n.elements,r.elements,Et):n instanceof Xs&&r instanceof Xs?Et(n._t,r._t):n instanceof Ws&&r instanceof Ws}(t.transform,e.transform)}class e1{constructor(e,n){this.version=e,this.transformResults=n}}class mt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new mt}static exists(e){return new mt(void 0,e)}static updateTime(e){return new mt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ns(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ai{}function Sd(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Rd(t.key,mt.none()):new es(t.key,t.data,mt.none());{const n=t.data,r=rt.empty();let s=new De(qe.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Yt(t.key,r,new dt(s.toArray()),mt.none())}}function t1(t,e,n){t instanceof es?function(r,s,i){const o=r.value.clone(),a=Hc(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Yt?function(r,s,i){if(!Ns(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=Hc(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(Dd(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function Ar(t,e,n,r){return t instanceof es?function(s,i,o,a){if(!Ns(s.precondition,i))return o;const l=s.value.clone(),c=zc(s.fieldTransforms,a,i);return l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Yt?function(s,i,o,a){if(!Ns(s.precondition,i))return o;const l=zc(s.fieldTransforms,a,i),c=i.data;return c.setAll(Dd(s)),c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(s,i,o){return Ns(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function n1(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Td(r.transform,s||null);i!=null&&(n===null&&(n=rt.empty()),n.set(r.field,i))}return n||null}function Gc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Fn(n,r,(s,i)=>Z0(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class es extends Ai{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Yt extends Ai{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Dd(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Hc(t,e,n){const r=new Map;fe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,J0(o,a,n[s]))}return r}function zc(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Y0(i,o,e))}return r}class Rd extends Ai{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class r1 extends Ai{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _e,ee;function i1(t){switch(t){default:return z();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function Nd(t){if(t===void 0)return Gt("GRPC error has no .code"),N.UNKNOWN;switch(t){case _e.OK:return N.OK;case _e.CANCELLED:return N.CANCELLED;case _e.UNKNOWN:return N.UNKNOWN;case _e.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case _e.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case _e.INTERNAL:return N.INTERNAL;case _e.UNAVAILABLE:return N.UNAVAILABLE;case _e.UNAUTHENTICATED:return N.UNAUTHENTICATED;case _e.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case _e.NOT_FOUND:return N.NOT_FOUND;case _e.ALREADY_EXISTS:return N.ALREADY_EXISTS;case _e.PERMISSION_DENIED:return N.PERMISSION_DENIED;case _e.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case _e.ABORTED:return N.ABORTED;case _e.OUT_OF_RANGE:return N.OUT_OF_RANGE;case _e.UNIMPLEMENTED:return N.UNIMPLEMENTED;case _e.DATA_LOSS:return N.DATA_LOSS;default:return z()}}(ee=_e||(_e={}))[ee.OK=0]="OK",ee[ee.CANCELLED=1]="CANCELLED",ee[ee.UNKNOWN=2]="UNKNOWN",ee[ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ee[ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ee[ee.NOT_FOUND=5]="NOT_FOUND",ee[ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",ee[ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",ee[ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",ee[ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ee[ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ee[ee.ABORTED=10]="ABORTED",ee[ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",ee[ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",ee[ee.INTERNAL=13]="INTERNAL",ee[ee.UNAVAILABLE=14]="UNAVAILABLE",ee[ee.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){En(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return pd(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1=new Re(U.comparator);function xt(){return o1}const xd=new Re(U.comparator);function br(...t){let e=xd;for(const n of t)e=e.insert(n.key,n);return e}function Od(t){let e=xd;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function an(){return Sr()}function Ld(){return Sr()}function Sr(){return new Jn(t=>t.toString(),(t,e)=>t.isEqual(e))}const a1=new Re(U.comparator),l1=new De(U.comparator);function Z(...t){let e=l1;for(const n of t)e=e.add(n);return e}const c1=new De(oe);function Md(){return c1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,ts.createSynthesizedTargetChangeForCurrentChange(e,n)),new Si(W.min(),r,Md(),xt(),Z())}}class ts{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new ts(Ve.EMPTY_BYTE_STRING,n,Z(),Z(),Z())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,n,r,s){this.gt=e,this.removedTargetIds=n,this.key=r,this.yt=s}}class Pd{constructor(e,n){this.targetId=e,this.It=n}}class Fd{constructor(e,n,r=Ve.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Kc{constructor(){this.Tt=0,this.Et=Wc(),this.At=Ve.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=Z(),n=Z(),r=Z();return this.Et.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:z()}}),new ts(this.At,this.Rt,e,n,r)}Dt(){this.bt=!1,this.Et=Wc()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class u1{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=xt(),this.Bt=Qc(),this.Lt=new De(oe)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const r=this.Qt(n);switch(e.state){case 0:this.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),r.Vt(e.resumeToken));break;default:z()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((r,s)=>{this.jt(s)&&n(s)})}zt(e){const n=e.targetId,r=e.It.count,s=this.Ht(n);if(s){const i=s.target;if(Xo(i))if(r===0){const o=new U(i.path);this.Kt(n,o,Fe.newNoDocument(o,W.min()))}else fe(r===1);else this.Jt(n)!==r&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&Xo(a.target)){const l=new U(a.target.path);this.$t.get(l)!==null||this.Xt(o,l)||this.Kt(o,l,Fe.newNoDocument(l,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let r=Z();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Ht(l);return!c||c.purpose===2||(a=!1,!1)}),a&&(r=r.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const s=new Si(e,n,this.Lt,this.$t,r);return this.$t=xt(),this.Bt=Qc(),this.Lt=new De(oe),s}qt(e,n){if(!this.jt(e))return;const r=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,r),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,r){if(!this.jt(e))return;const s=this.Qt(e);this.Xt(e,n)?s.Ct(n,1):s.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),r&&(this.$t=this.$t.insert(n,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new Kc,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new De(oe),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||V("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new Kc),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function Qc(){return new Re(U.comparator)}function Wc(){return new Re(U.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),f1=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class d1{constructor(e,n){this.databaseId=e,this.dt=n}}function Ys(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Bd(t,e){return t.dt?e.toBase64():e.toUint8Array()}function p1(t,e){return Ys(t,e.toTimestamp())}function St(t){return fe(!!t),W.fromTimestamp(function(e){const n=zt(e);return new Se(n.seconds,n.nanos)}(t))}function rl(t,e){return function(n){return new ve(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function jd(t){const e=ve.fromString(t);return fe($d(e)),e}function Jo(t,e){return rl(t.databaseId,e.path)}function wo(t,e){const n=jd(e);if(n.get(1)!==t.databaseId.projectId)throw new $(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new $(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new U(Vd(n))}function Zo(t,e){return rl(t.databaseId,e)}function g1(t){const e=jd(t);return e.length===4?ve.emptyPath():Vd(e)}function ea(t){return new ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Vd(t){return fe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Xc(t,e,n){return{name:Jo(t,e),fields:n.value.mapValue.fields}}function m1(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:z()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,c){return l.dt?(fe(c===void 0||typeof c=="string"),Ve.fromBase64String(c||"")):(fe(c===void 0||c instanceof Uint8Array),Ve.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?N.UNKNOWN:Nd(l.code);return new $(c,l.message||"")}(o);n=new Fd(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=wo(t,r.document.name),i=St(r.document.updateTime),o=new rt({mapValue:{fields:r.document.fields}}),a=Fe.newFoundDocument(s,i,o),l=r.targetIds||[],c=r.removedTargetIds||[];n=new xs(l,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=wo(t,r.document),i=r.readTime?St(r.readTime):W.min(),o=Fe.newNoDocument(s,i),a=r.removedTargetIds||[];n=new xs([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=wo(t,r.document),i=r.removedTargetIds||[];n=new xs([],i,s,null)}else{if(!("filter"in e))return z();{e.filter;const r=e.filter;r.targetId;const s=r.count||0,i=new s1(s),o=r.targetId;n=new Pd(o,i)}}return n}function y1(t,e){let n;if(e instanceof es)n={update:Xc(t,e.key,e.value)};else if(e instanceof Rd)n={delete:Jo(t,e.key)};else if(e instanceof Yt)n={update:Xc(t,e.key,e.data),updateMask:A1(e.fieldMask)};else{if(!(e instanceof r1))return z();n={verify:Jo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Ws)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Un)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof $n)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Xs)return{fieldPath:i.field.canonicalString(),increment:o._t};throw z()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:p1(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:z()}(t,e.precondition)),n}function v1(t,e){return t&&t.length>0?(fe(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?St(r.updateTime):St(s);return i.isEqual(W.min())&&(i=St(s)),new e1(i,r.transformResults||[])}(n,e))):[]}function b1(t,e){return{documents:[Zo(t,e.path)]}}function w1(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Zo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Zo(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(l){if(l.length===0)return;const c=l.map(u=>function(f){if(f.op==="=="){if(jc(f.value))return{unaryFilter:{field:Sn(f.field),op:"IS_NAN"}};if(Bc(f.value))return{unaryFilter:{field:Sn(f.field),op:"IS_NULL"}}}else if(f.op==="!="){if(jc(f.value))return{unaryFilter:{field:Sn(f.field),op:"IS_NOT_NAN"}};if(Bc(f.value))return{unaryFilter:{field:Sn(f.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Sn(f.field),op:k1(f.op),value:f.value}}}(u));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(e.filters);s&&(n.structuredQuery.where=s);const i=function(l){if(l.length!==0)return l.map(c=>function(u){return{field:Sn(u.field),direction:T1(u.dir)}}(c))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(l,c){return l.dt||Ei(c)?c:{value:c}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function _1(t){let e=g1(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){fe(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=Ud(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(f){return new Ir(Nn(f.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(f.direction))}(u)));let a=null;n.limit&&(a=function(u){let f;return f=typeof u=="object"?u.value:u,Ei(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(u){const f=!!u.before,p=u.values||[];return new Qs(p,f)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const f=!u.before,p=u.values||[];return new Qs(p,f)}(n.endAt)),$0(e,s,o,i,a,"F",l,c)}function E1(t,e){const n=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return z()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function Ud(t){return t?t.unaryFilter!==void 0?[I1(t)]:t.fieldFilter!==void 0?[C1(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>Ud(e)).reduce((e,n)=>e.concat(n)):z():[]}function T1(t){return h1[t]}function k1(t){return f1[t]}function Sn(t){return{fieldPath:t.canonicalString()}}function Nn(t){return qe.fromServerFormat(t.fieldPath)}function C1(t){return st.create(Nn(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return z()}}(t.fieldFilter.op),t.fieldFilter.value)}function I1(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Nn(t.unaryFilter.field);return st.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Nn(t.unaryFilter.field);return st.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Nn(t.unaryFilter.field);return st.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Nn(t.unaryFilter.field);return st.create(s,"!=",{nullValue:"NULL_VALUE"});default:return z()}}function A1(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function $d(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&t1(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ar(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ar(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Ld();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=Sd(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Z())}isEqual(e){return this.batchId===e.batchId&&Fn(this.mutations,e.mutations,(n,r)=>Gc(n,r))&&Fn(this.baseMutations,e.baseMutations,(n,r)=>Gc(n,r))}}class sl{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){fe(e.mutations.length===r.length);let s=a1;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new sl(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,n,r,s,i=W.min(),o=W.min(),a=Ve.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new un(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new un(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new un(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e){this.ne=e}}function N1(t){const e=_1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?K0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(){this.ze=new O1}addToCollectionParentIndex(e,n){return this.ze.add(n),x.resolve()}getCollectionParents(e,n){return x.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return x.resolve()}deleteFieldIndex(e,n){return x.resolve()}getDocumentsMatchingTarget(e,n){return x.resolve(null)}getIndexType(e,n){return x.resolve(0)}getFieldIndexes(e,n){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,n){return x.resolve(Ht.min())}getMinOffsetFromCollectionGroup(e,n){return x.resolve(Ht.min())}updateCollectionGroup(e,n,r){return x.resolve()}updateIndexEntries(e,n){return x.resolve()}}class O1{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new De(ve.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new De(ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new qn(0)}static Rn(){return new qn(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(){this.changes=new Jn(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Fe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?x.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.getBaseDocument(e,n,r))).next(s=>(r!==null&&Ar(r.mutation,s,dt.empty(),Se.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Z()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Z()){const s=an();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=br();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=an();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Z()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=xt();const o=Sr(),a=Sr();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Yt)?i=i.insert(c.key,c):u!==void 0&&(o.set(c.key,u.mutation.getFieldMask()),Ar(u.mutation,c,u.mutation.getFieldMask(),Se.now()))}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var f;return a.set(c,new M1(u,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Sr();let s=new Re((o,a)=>o-a),i=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||dt.empty();u=a.applyToLocalView(c,u),r.set(l,u);const f=(s.get(a.batchId)||Z()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,f=Ld();u.forEach(p=>{if(!i.has(p)){const d=Sd(n.get(p),r.get(p));d!==null&&f.set(p,d),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return U.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):z0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):x.resolve(an());let a=-1,l=i;return o.next(c=>x.forEach(c,(u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(u)?x.resolve():this.getBaseDocument(e,u,f).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Z())).next(u=>({batchId:a,changes:Od(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new U(n)).next(r=>{let s=br();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=br();return this.indexManager.getCollectionParents(e,s).next(o=>x.forEach(o,a=>{const l=function(c,u){return new Ti(u,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(c=>{c.forEach((u,f)=>{i=i.insert(u,f)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(i=>{i.forEach((a,l)=>{const c=l.getKey();s.get(c)===null&&(s=s.insert(c,Fe.newInvalidDocument(c)))});let o=br();return s.forEach((a,l)=>{const c=i.get(a);c!==void 0&&Ar(c.mutation,l,dt.empty(),Se.now()),nl(n,l)&&(o=o.insert(a,l))}),o})}getBaseDocument(e,n,r){return r===null||r.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):x.resolve(Fe.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return x.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var r;return this.Jn.set(n.id,{id:(r=n).id,version:r.version,createTime:St(r.createTime)}),x.resolve()}getNamedQuery(e,n){return x.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(r){return{name:r.name,query:N1(r.bundledQuery),readTime:St(r.readTime)}}(n)),x.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(){this.overlays=new Re(U.comparator),this.Xn=new Map}getOverlay(e,n){return x.resolve(this.overlays.get(n))}getOverlays(e,n){const r=an();return x.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ie(e,n,i)}),x.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Xn.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(r)),x.resolve()}getOverlaysForCollection(e,n,r){const s=an(),i=n.length+1,o=new U(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return x.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Re((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=an(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=an(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return x.resolve(a)}ie(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Xn.get(s.largestBatchId).delete(r.key);this.Xn.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new D1(n,r));let i=this.Xn.get(n);i===void 0&&(i=Z(),this.Xn.set(n,i)),this.Xn.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(){this.Zn=new De(xe.ts),this.es=new De(xe.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const r=new xe(e,n);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.rs(new xe(e,n))}os(e,n){e.forEach(r=>this.removeReference(r,n))}us(e){const n=new U(new ve([])),r=new xe(n,e),s=new xe(n,e+1),i=[];return this.es.forEachInRange([r,s],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new U(new ve([])),r=new xe(n,e),s=new xe(n,e+1);let i=Z();return this.es.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new xe(e,0),r=this.Zn.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class xe{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return U.comparator(e.key,n.key)||oe(e.ls,n.ls)}static ns(e,n){return oe(e.ls,n.ls)||U.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new De(xe.ts)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new S1(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.ds=this.ds.add(new xe(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,n){return x.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ws(r),i=s<0?0:s;return x.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new xe(n,0),s=new xe(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([r,s],o=>{const a=this._s(o.ls);i.push(a)}),x.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new De(oe);return n.forEach(s=>{const i=new xe(s,0),o=new xe(s,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{r=r.add(a.ls)})}),x.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;U.isDocumentKey(i)||(i=i.child(""));const o=new xe(new U(i),0);let a=new De(oe);return this.ds.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.ls)),!0)},o),x.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(r=>{const s=this._s(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){fe(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.ds;return x.forEach(n.mutations,s=>{const i=new xe(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,n){const r=new xe(n,0),s=this.ds.firstAfterOrEqual(r);return x.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e){this.ps=e,this.docs=new Re(U.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ps(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return x.resolve(r?r.document.mutableCopy():Fe.newInvalidDocument(n))}getEntries(e,n){let r=xt();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Fe.newInvalidDocument(s))}),x.resolve(r)}getAllFromCollection(e,n,r){let s=xt();const i=new U(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:l}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||C0(k0(l),r)<=0||(s=s.insert(l.key,l.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,n,r,s){z()}Is(e,n){return x.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new U1(this)}getSize(e){return x.resolve(this.size)}}class U1 extends L1{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.zn.addEntry(e,s)):this.zn.removeEntry(r)}),x.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e){this.persistence=e,this.Ts=new Jn(n=>el(n),tl),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.Es=0,this.As=new il,this.targetCount=0,this.Rs=qn.An()}forEachTarget(e,n){return this.Ts.forEach((r,s)=>n(s)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Es&&(this.Es=n),x.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new qn(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,x.resolve()}updateTargetData(e,n){return this.vn(n),x.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),x.waitFor(i).next(()=>s)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,n){const r=this.Ts.get(n)||null;return x.resolve(r)}addMatchingKeys(e,n,r){return this.As.ss(n,r),x.resolve()}removeMatchingKeys(e,n,r){this.As.os(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),x.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),x.resolve()}getMatchingKeysForTargetId(e,n){const r=this.As.hs(n);return x.resolve(r)}containsKey(e,n){return x.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(e,n){this.bs={},this.overlays={},this.Ps=new Ja(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new $1(this),this.indexManager=new x1,this.remoteDocumentCache=function(r){return new V1(r)}(r=>this.referenceDelegate.Ss(r)),this.wt=new R1(n),this.Ds=new F1(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new B1,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.bs[e.toKey()];return r||(r=new j1(n,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,r){V("MemoryPersistence","Starting transaction:",e);const s=new G1(this.Ps.next());return this.referenceDelegate.Cs(),r(s).next(i=>this.referenceDelegate.xs(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ns(e,n){return x.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,n)))}}class G1 extends A0{constructor(e){super(),this.currentSequenceNumber=e}}class ol{constructor(e){this.persistence=e,this.ks=new il,this.Os=null}static Ms(e){return new ol(e)}get Fs(){if(this.Os)return this.Os;throw z()}addReference(e,n,r){return this.ks.addReference(r,n),this.Fs.delete(r.toString()),x.resolve()}removeReference(e,n,r){return this.ks.removeReference(r,n),this.Fs.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),x.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(s=>this.Fs.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Fs.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Fs,r=>{const s=U.fromPath(r);return this.$s(e,s).next(i=>{i||n.removeEntry(s,W.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(r=>{r?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return x.or([()=>x.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Pi=r,this.vi=s}static Vi(e,n){let r=Z(),s=Z();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new al(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ci(e,n).next(i=>i||this.xi(e,n,s,r)).next(i=>i||this.Ni(e,n))}Ci(e,n){return x.resolve(null)}xi(e,n,r,s){return q0(n)||s.isEqual(W.min())?this.Ni(e,n):this.Di.getDocuments(e,r).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,r,s)?this.Ni(e,n):(Oc()<=ie.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Yo(n)),this.Mi(e,o,n,T0(s,-1)))})}ki(e,n){let r=new De(wd(e));return n.forEach((s,i)=>{nl(e,i)&&(r=r.add(i))}),r}Oi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ni(e,n){return Oc()<=ie.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",Yo(n)),this.Di.getDocumentsMatchingQuery(e,n,Ht.min())}Mi(e,n,r,s){return this.Di.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e,n,r,s){this.persistence=e,this.Fi=n,this.wt=s,this.$i=new Re(oe),this.Bi=new Jn(i=>el(i),tl),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new P1(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function K1(t,e,n,r){return new z1(t,e,n,r)}async function qd(t,e){const n=K(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.qi(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Z();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Ki:c,removedBatchIds:o,addedBatchIds:a}))})})}function Q1(t,e){const n=K(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const u=l.batch,f=u.keys();let p=x.resolve();return f.forEach(d=>{p=p.next(()=>c.getEntry(a,d)).next(h=>{const m=l.docVersions.get(d);fe(m!==null),h.version.compareTo(m)<0&&(u.applyToRemoteDocument(h,l),h.isValidDocument()&&(h.setReadTime(l.commitVersion),c.addEntry(h)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=Z();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Gd(t){const e=K(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function W1(t,e){const n=K(t),r=e.snapshotVersion;let s=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});s=n.$i;const a=[];e.targetChanges.forEach((u,f)=>{const p=s.get(f);if(!p)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,f).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,f)));let d=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(f)?d=d.withResumeToken(Ve.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):u.resumeToken.approximateByteSize()>0&&(d=d.withResumeToken(u.resumeToken,r)),s=s.insert(f,d),function(h,m,v){return h.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-h.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(p,d,u)&&a.push(n.Vs.updateTargetData(i,d))});let l=xt(),c=Z();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(X1(i,o,e.documentUpdates).next(u=>{l=u.Gi,c=u.Qi})),!r.isEqual(W.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(f=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return x.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.$i=s,i))}function X1(t,e,n){let r=Z(),s=Z();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=xt();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(W.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):V("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Gi:o,Qi:s}})}function Y1(t,e){const n=K(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function J1(t,e){const n=K(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Vs.getTargetData(r,e).next(i=>i?(s=i,x.resolve(s)):n.Vs.allocateTargetId(r).next(o=>(s=new un(e,o,0,r.currentSequenceNumber),n.Vs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.$i.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.$i=n.$i.insert(r.targetId,r),n.Bi.set(e,r.targetId)),r})}async function ta(t,e,n){const r=K(t),s=r.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Zr(o))throw o;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.$i=r.$i.remove(e),r.Bi.delete(s.target)}function Yc(t,e,n){const r=K(t);let s=W.min(),i=Z();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const u=K(a),f=u.Bi.get(c);return f!==void 0?x.resolve(u.$i.get(f)):u.Vs.getTargetData(l,c)}(r,o,vn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fi.getDocumentsMatchingQuery(o,e,n?s:W.min(),n?i:Z())).next(a=>(Z1(r,Q0(e),a),{documents:a,ji:i})))}function Z1(t,e,n){let r=W.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Li.set(e,r)}class Jc{constructor(){this.activeTargetIds=Md()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eb{constructor(){this.Fr=new Jc,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,r){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Jc,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,r,s,i){const o=this.oo(e,n);V("RestConnection","Sending: ",o,r);const a={};return this.uo(a,s,i),this.co(e,o,a,r).then(l=>(V("RestConnection","Received: ",l),l),l=>{throw Lc("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",r),l})}ao(e,n,r,s,i,o){return this.ro(e,n,r,s,i)}uo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Yn,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}oo(e,n){const r=nb[e];return`${this.so}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,r,s){return new Promise((i,o)=>{const a=new d0;a.listenOnce(u0.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case bo.NO_ERROR:const c=a.getResponseJson();V("Connection","XHR received:",JSON.stringify(c)),i(c);break;case bo.TIMEOUT:V("Connection",'RPC "'+e+'" timed out'),o(new $(N.DEADLINE_EXCEEDED,"Request time out"));break;case bo.HTTP_ERROR:const u=a.getStatus();if(V("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const f=a.getResponseJson().error;if(f&&f.status&&f.message){const p=function(d){const h=d.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(h)>=0?h:N.UNKNOWN}(f.status);o(new $(p,f.message))}else o(new $(N.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new $(N.UNAVAILABLE,"Connection failed."));break;default:z()}}finally{V("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(s);a.send(n,"POST",l,r,15)})}ho(e,n,r){const s=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=l0(),o=c0(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new f0({})),this.uo(a.initMessageHeaders,n,r),kg()||Cg()||Ig()||Ag()||Sg()||Oh()||(a.httpHeadersOverwriteParam="$httpHeaders");const l=s.join("");V("Connection","Creating WebChannel: "+l,a);const c=i.createWebChannel(l,a);let u=!1,f=!1;const p=new rb({jr:h=>{f?V("Connection","Not sending because WebChannel is closed:",h):(u||(V("Connection","Opening WebChannel transport."),c.open(),u=!0),V("Connection","WebChannel sending:",h),c.send(h))},Wr:()=>c.close()}),d=(h,m,v)=>{h.listen(m,g=>{try{v(g)}catch(y){setTimeout(()=>{throw y},0)}})};return d(c,vs.EventType.OPEN,()=>{f||V("Connection","WebChannel transport opened.")}),d(c,vs.EventType.CLOSE,()=>{f||(f=!0,V("Connection","WebChannel transport closed"),p.eo())}),d(c,vs.EventType.ERROR,h=>{f||(f=!0,Lc("Connection","WebChannel transport errored:",h),p.eo(new $(N.UNAVAILABLE,"The operation could not be completed")))}),d(c,vs.EventType.MESSAGE,h=>{var m;if(!f){const v=h.data[0];fe(!!v);const g=v,y=g.error||((m=g[0])===null||m===void 0?void 0:m.error);if(y){V("Connection","WebChannel received error:",y);const k=y.status;let b=function(w){const E=_e[w];if(E!==void 0)return Nd(E)}(k),_=y.message;b===void 0&&(b=N.INTERNAL,_="Unknown error status: "+k+" with message "+y.message),f=!0,p.eo(new $(b,_)),c.close()}else V("Connection","WebChannel received:",v),p.no(v)}}),d(o,h0.STAT_EVENT,h=>{h.stat===Nc.PROXY?V("Connection","Detected buffering proxy"):h.stat===Nc.NOPROXY&&V("Connection","Detected no buffering proxy")}),setTimeout(()=>{p.Zr()},0),p}}function _o(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Di(t){return new d1(t,!0)}class Hd{constructor(e,n,r=1e3,s=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=r,this.fo=s,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),s=Math.max(0,n-r);s>0&&V("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,s,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,n,r,s,i,o,a,l){this.js=e,this.Ao=r,this.Ro=s,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Hd(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===N.RESOURCE_EXHAUSTED?(Gt(n.toString()),Gt("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Po===n&&this.Uo(r,s)},r=>{e(()=>{const s=new $(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(s)})})}Uo(e,n){const r=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(s=>{r(()=>this.qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ib extends zd{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=m1(this.wt,e),r=function(s){if(!("targetChange"in s))return W.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?W.min():i.readTime?St(i.readTime):W.min()}(e);return this.listener.Go(n,r)}Qo(e){const n={};n.database=ea(this.wt),n.addTarget=function(s,i){let o;const a=i.target;return o=Xo(a)?{documents:b1(s,a)}:{query:w1(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=Bd(s,i.resumeToken):i.snapshotVersion.compareTo(W.min())>0&&(o.readTime=Ys(s,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const r=E1(this.wt,e);r&&(n.labels=r),this.Mo(n)}jo(e){const n={};n.database=ea(this.wt),n.removeTarget=e,this.Mo(n)}}class ob extends zd{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(fe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=v1(e.writeResults,e.commitTime),r=St(e.commitTime);return this.listener.Jo(r,n)}return fe(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=ea(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>y1(this.wt,r))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=r,this.wt=s,this.Zo=!1}tu(){if(this.Zo)throw new $(N.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.bo.ro(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $(N.UNKNOWN,s.toString())})}ao(e,n,r,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $(N.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class lb{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(Gt(n),this.su=!1):V("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{r.enqueueAndForget(async()=>{Tn(this)&&(V("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=K(a);l.lu.add(4),await ns(l),l._u.set("Unknown"),l.lu.delete(4),await Ri(l)}(this))})}),this._u=new lb(r,s)}}async function Ri(t){if(Tn(t))for(const e of t.fu)await e(!0)}async function ns(t){for(const e of t.fu)await e(!1)}function Kd(t,e){const n=K(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),ul(n)?cl(n):Zn(n).Co()&&ll(n,e))}function Qd(t,e){const n=K(t),r=Zn(n);n.hu.delete(e),r.Co()&&Wd(n,e),n.hu.size===0&&(r.Co()?r.ko():Tn(n)&&n._u.set("Unknown"))}function ll(t,e){t.wu.Nt(e.targetId),Zn(t).Qo(e)}function Wd(t,e){t.wu.Nt(e),Zn(t).jo(e)}function cl(t){t.wu=new u1({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),Zn(t).start(),t._u.iu()}function ul(t){return Tn(t)&&!Zn(t).Do()&&t.hu.size>0}function Tn(t){return K(t).lu.size===0}function Xd(t){t.wu=void 0}async function ub(t){t.hu.forEach((e,n)=>{ll(t,e)})}async function hb(t,e){Xd(t),ul(t)?(t._u.uu(e),cl(t)):t._u.set("Unknown")}async function fb(t,e,n){if(t._u.set("Online"),e instanceof Fd&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.hu.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.hu.delete(o),r.wu.removeTarget(o))}(t,e)}catch(r){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Js(t,r)}else if(e instanceof xs?t.wu.Ut(e):e instanceof Pd?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(W.min()))try{const r=await Gd(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.wu.Yt(i);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=s.hu.get(l);c&&s.hu.set(l,c.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const l=s.hu.get(a);if(!l)return;s.hu.set(a,l.withResumeToken(Ve.EMPTY_BYTE_STRING,l.snapshotVersion)),Wd(s,a);const c=new un(l.target,a,1,l.sequenceNumber);ll(s,c)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){V("RemoteStore","Failed to raise snapshot:",r),await Js(t,r)}}async function Js(t,e,n){if(!Zr(e))throw e;t.lu.add(1),await ns(t),t._u.set("Offline"),n||(n=()=>Gd(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{V("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await Ri(t)})}function Yd(t,e){return e().catch(n=>Js(t,n,e))}async function Ni(t){const e=K(t),n=Kt(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;db(e);)try{const s=await Y1(e.localStore,r);if(s===null){e.au.length===0&&n.ko();break}r=s.batchId,pb(e,s)}catch(s){await Js(e,s)}Jd(e)&&Zd(e)}function db(t){return Tn(t)&&t.au.length<10}function pb(t,e){t.au.push(e);const n=Kt(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function Jd(t){return Tn(t)&&!Kt(t).Do()&&t.au.length>0}function Zd(t){Kt(t).start()}async function gb(t){Kt(t).Xo()}async function mb(t){const e=Kt(t);for(const n of t.au)e.Ho(n.mutations)}async function yb(t,e,n){const r=t.au.shift(),s=sl.from(r,e,n);await Yd(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Ni(t)}async function vb(t,e){e&&Kt(t).zo&&await async function(n,r){if(s=r.code,i1(s)&&s!==N.ABORTED){const i=n.au.shift();Kt(n).No(),await Yd(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ni(n)}var s}(t,e),Jd(t)&&Zd(t)}async function eu(t,e){const n=K(t);n.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");const r=Tn(n);n.lu.add(3),await ns(n),r&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await Ri(n)}async function bb(t,e){const n=K(t);e?(n.lu.delete(2),await Ri(n)):e||(n.lu.add(2),await ns(n),n._u.set("Unknown"))}function Zn(t){return t.mu||(t.mu=function(e,n,r){const s=K(e);return s.tu(),new ib(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:ub.bind(null,t),Jr:hb.bind(null,t),Go:fb.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),ul(t)?cl(t):t._u.set("Unknown")):(await t.mu.stop(),Xd(t))})),t.mu}function Kt(t){return t.gu||(t.gu=function(e,n,r){const s=K(e);return s.tu(),new ob(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:gb.bind(null,t),Jr:vb.bind(null,t),Yo:mb.bind(null,t),Jo:yb.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await Ni(t)):(await t.gu.stop(),t.au.length>0&&(V("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new jt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new hl(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fl(t,e){if(Gt("AsyncQueue",`${e}: ${t}`),Zr(t))return new $(N.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.comparator=e?(n,r)=>e(n,r)||U.comparator(n.key,r.key):(n,r)=>U.comparator(n.key,r.key),this.keyedMap=br(),this.sortedSet=new Re(this.comparator)}static emptySet(e){return new On(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof On)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new On;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(){this.yu=new Re(U.comparator)}track(e){const n=e.doc.key,r=this.yu.get(n);r?e.type!==0&&r.type===3?this.yu=this.yu.insert(n,e):e.type===3&&r.type!==1?this.yu=this.yu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.yu=this.yu.remove(n):e.type===1&&r.type===2?this.yu=this.yu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):z():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,r)=>{e.push(r)}),e}}class Gn{constructor(e,n,r,s,i,o,a,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(e,n,r,s){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Gn(e,n,On.emptySet(n),i,r,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ci(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(){this.Iu=void 0,this.listeners=[]}}class _b{constructor(){this.queries=new Jn(e=>bd(e),Ci),this.onlineState="Unknown",this.Tu=new Set}}async function ep(t,e){const n=K(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new wb),s)try{i.Iu=await n.onListen(r)}catch(o){const a=fl(o,`Initialization of query '${Yo(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&dl(n)}async function tp(t,e){const n=K(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function Eb(t,e){const n=K(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(s)&&(r=!0);o.Iu=s}}r&&dl(n)}function Tb(t,e,n){const r=K(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function dl(t){t.Tu.forEach(e=>{e.next()})}class np{constructor(e,n,r){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Gn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Du||!r)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Gn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e){this.key=e}}class sp{constructor(e){this.key=e}}class kb{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=Z(),this.mutatedKeys=Z(),this.Lu=wd(e),this.Uu=new On(this.Lu)}get qu(){return this.Fu}Ku(e,n){const r=n?n.Gu:new tu,s=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,f)=>{const p=s.get(u),d=nl(this.query,f)?f:null,h=!!p&&this.mutatedKeys.has(p.key),m=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let v=!1;p&&d?p.data.isEqual(d.data)?h!==m&&(r.track({type:3,doc:d}),v=!0):this.Qu(p,d)||(r.track({type:2,doc:d}),v=!0,(l&&this.Lu(d,l)>0||c&&this.Lu(d,c)<0)&&(a=!0)):!p&&d?(r.track({type:0,doc:d}),v=!0):p&&!d&&(r.track({type:1,doc:p}),v=!0,(l||c)&&(a=!0)),v&&(d?(o=o.add(d),i=m?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Uu:o,Gu:r,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((c,u)=>function(f,p){const d=h=>{switch(h){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return z()}};return d(f)-d(p)}(c.type,u.type)||this.Lu(c.doc,u.doc)),this.ju(r);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,l=a!==this.$u;return this.$u=a,i.length!==0||l?{snapshot:new Gn(this.query,e.Uu,s,i,e.mutatedKeys,a===0,l,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new tu,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=Z(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const n=[];return e.forEach(r=>{this.Bu.has(r)||n.push(new sp(r))}),this.Bu.forEach(r=>{e.has(r)||n.push(new rp(r))}),n}Ju(e){this.Fu=e.ji,this.Bu=Z();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Gn.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class Cb{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Ib{constructor(e){this.key=e,this.Xu=!1}}class Ab{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new Jn(a=>bd(a),Ci),this.ec=new Map,this.nc=new Set,this.sc=new Re(U.comparator),this.ic=new Map,this.rc=new il,this.oc={},this.uc=new Map,this.cc=qn.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function Sb(t,e){const n=Bb(t);let r,s;const i=n.tc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Yu();else{const o=await J1(n.localStore,vn(e));n.isPrimaryClient&&Kd(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await Db(n,e,r,a==="current")}return s}async function Db(t,e,n,r){t.hc=(u,f,p)=>async function(d,h,m,v){let g=h.view.Ku(m);g.Oi&&(g=await Yc(d.localStore,h.query,!1).then(({documents:b})=>h.view.Ku(b,g)));const y=v&&v.targetChanges.get(h.targetId),k=h.view.applyChanges(g,d.isPrimaryClient,y);return ru(d,h.targetId,k.zu),k.snapshot}(t,u,f,p);const s=await Yc(t.localStore,e,!0),i=new kb(e,s.ji),o=i.Ku(s.documents),a=ts.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),l=i.applyChanges(o,t.isPrimaryClient,a);ru(t,n,l.zu);const c=new Cb(e,n,i);return t.tc.set(e,c),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),l.snapshot}async function Rb(t,e){const n=K(t),r=n.tc.get(e),s=n.ec.get(r.targetId);if(s.length>1)return n.ec.set(r.targetId,s.filter(i=>!Ci(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await ta(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Qd(n.remoteStore,r.targetId),na(n,r.targetId)}).catch(Jr)):(na(n,r.targetId),await ta(n.localStore,r.targetId,!0))}async function Nb(t,e,n){const r=jb(t);try{const s=await function(i,o){const a=K(i),l=Se.now(),c=o.reduce((p,d)=>p.add(d.key),Z());let u,f;return a.persistence.runTransaction("Locally write mutations","readwrite",p=>{let d=xt(),h=Z();return a.Ui.getEntries(p,c).next(m=>{d=m,d.forEach((v,g)=>{g.isValidDocument()||(h=h.add(v))})}).next(()=>a.localDocuments.getOverlayedDocuments(p,d)).next(m=>{u=m;const v=[];for(const g of o){const y=n1(g,u.get(g.key).overlayedDocument);y!=null&&v.push(new Yt(g.key,y,yd(y.value.mapValue),mt.exists(!0)))}return a.mutationQueue.addMutationBatch(p,l,v,o)}).next(m=>{f=m;const v=m.applyToLocalDocumentSet(u,h);return a.documentOverlayCache.saveOverlays(p,m.batchId,v)})}).then(()=>({batchId:f.batchId,changes:Od(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let l=i.oc[i.currentUser.toKey()];l||(l=new Re(oe)),l=l.insert(o,a),i.oc[i.currentUser.toKey()]=l}(r,s.batchId,n),await rs(r,s.changes),await Ni(r.remoteStore)}catch(s){const i=fl(s,"Failed to persist write");n.reject(i)}}async function ip(t,e){const n=K(t);try{const r=await W1(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.ic.get(i);o&&(fe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Xu=!0:s.modifiedDocuments.size>0?fe(o.Xu):s.removedDocuments.size>0&&(fe(o.Xu),o.Xu=!1))}),await rs(n,r,e)}catch(r){await Jr(r)}}function nu(t,e,n){const r=K(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=K(i);a.onlineState=o;let l=!1;a.queries.forEach((c,u)=>{for(const f of u.listeners)f.Eu(o)&&(l=!0)}),l&&dl(a)}(r.eventManager,e),s.length&&r.Zu.Go(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function xb(t,e,n){const r=K(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.ic.get(e),i=s&&s.key;if(i){let o=new Re(U.comparator);o=o.insert(i,Fe.newNoDocument(i,W.min()));const a=Z().add(i),l=new Si(W.min(),new Map,new De(oe),o,a);await ip(r,l),r.sc=r.sc.remove(i),r.ic.delete(e),pl(r)}else await ta(r.localStore,e,!1).then(()=>na(r,e,n)).catch(Jr)}async function Ob(t,e){const n=K(t),r=e.batch.batchId;try{const s=await Q1(n.localStore,e);ap(n,r,null),op(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await rs(n,s)}catch(s){await Jr(s)}}async function Lb(t,e,n){const r=K(t);try{const s=await function(i,o){const a=K(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.mutationQueue.lookupMutationBatch(l,o).next(u=>(fe(u!==null),c=u.keys(),a.mutationQueue.removeMutationBatch(l,u))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>a.localDocuments.getDocuments(l,c))})}(r.localStore,e);ap(r,e,n),op(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await rs(r,s)}catch(s){await Jr(s)}}function op(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function ap(t,e,n){const r=K(t);let s=r.oc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.oc[r.currentUser.toKey()]=s}}function na(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ec.get(e))t.tc.delete(r),n&&t.Zu.lc(r,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(r=>{t.rc.containsKey(r)||lp(t,r)})}function lp(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(Qd(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),pl(t))}function ru(t,e,n){for(const r of n)r instanceof rp?(t.rc.addReference(r.key,e),Mb(t,r)):r instanceof sp?(V("SyncEngine","Document no longer in limbo: "+r.key),t.rc.removeReference(r.key,e),t.rc.containsKey(r.key)||lp(t,r.key)):z()}function Mb(t,e){const n=e.key,r=n.path.canonicalString();t.sc.get(n)||t.nc.has(r)||(V("SyncEngine","New document in limbo: "+n),t.nc.add(r),pl(t))}function pl(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new U(ve.fromString(e)),r=t.cc.next();t.ic.set(r,new Ib(n)),t.sc=t.sc.insert(n,r),Kd(t.remoteStore,new un(vn(ki(n.path)),r,2,Ja.ot))}}async function rs(t,e,n){const r=K(t),s=[],i=[],o=[];r.tc.isEmpty()||(r.tc.forEach((a,l)=>{o.push(r.hc(l,e,n).then(c=>{if(c){r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c.fromCache?"not-current":"current"),s.push(c);const u=al.Vi(l.targetId,c);i.push(u)}}))}),await Promise.all(o),r.Zu.Go(s),await async function(a,l){const c=K(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>x.forEach(l,f=>x.forEach(f.Pi,p=>c.persistence.referenceDelegate.addReference(u,f.targetId,p)).next(()=>x.forEach(f.vi,p=>c.persistence.referenceDelegate.removeReference(u,f.targetId,p)))))}catch(u){if(!Zr(u))throw u;V("LocalStore","Failed to update sequence numbers: "+u)}for(const u of l){const f=u.targetId;if(!u.fromCache){const p=c.$i.get(f),d=p.snapshotVersion,h=p.withLastLimboFreeSnapshotVersion(d);c.$i=c.$i.insert(f,h)}}}(r.localStore,i))}async function Pb(t,e){const n=K(t);if(!n.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());const r=await qd(n.localStore,e);n.currentUser=e,function(s,i){s.uc.forEach(o=>{o.forEach(a=>{a.reject(new $(N.CANCELLED,i))})}),s.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await rs(n,r.Ki)}}function Fb(t,e){const n=K(t),r=n.ic.get(e);if(r&&r.Xu)return Z().add(r.key);{let s=Z();const i=n.ec.get(e);if(!i)return s;for(const o of i){const a=n.tc.get(o);s=s.unionWith(a.view.qu)}return s}}function Bb(t){const e=K(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ip.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Fb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xb.bind(null,e),e.Zu.Go=Eb.bind(null,e.eventManager),e.Zu.lc=Tb.bind(null,e.eventManager),e}function jb(t){const e=K(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ob.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Lb.bind(null,e),e}class Vb{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=Di(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return K1(this.persistence,new H1,e.initialUser,this.wt)}_c(e){return new q1(ol.Ms,this.wt)}dc(e){return new eb}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Ub{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>nu(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Pb.bind(null,this.syncEngine),await bb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new _b}createDatastore(e){const n=Di(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new sb(s));var s;return function(i,o,a,l){return new ab(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>nu(this.syncEngine,a,0),o=Zc.V()?new Zc:new tb,new cb(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,l,c){const u=new Ab(r,s,i,o,a,l);return c&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=K(e);V("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await ns(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=nt.UNAUTHENTICATED,this.clientId=dd.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{V("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(V("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $(N.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=fl(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function qb(t,e){t.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await qd(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function Gb(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Hb(t);V("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>eu(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>eu(e.remoteStore,i)),t.onlineComponents=e}async function Hb(t){return t.offlineComponents||(V("FirestoreClient","Using default OfflineComponentProvider"),await qb(t,new Vb)),t.offlineComponents}async function up(t){return t.onlineComponents||(V("FirestoreClient","Using default OnlineComponentProvider"),await Gb(t,new Ub)),t.onlineComponents}function zb(t){return up(t).then(e=>e.syncEngine)}async function ra(t){const e=await up(t),n=e.eventManager;return n.onListen=Sb.bind(null,e.syncEngine),n.onUnlisten=Rb.bind(null,e.syncEngine),n}function Kb(t,e,n={}){const r=new jt;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,l){const c=new cp({next:f=>{i.enqueueAndForget(()=>tp(s,u));const p=f.docs.has(o);!p&&f.fromCache?l.reject(new $(N.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&a&&a.source==="server"?l.reject(new $(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(f)},error:f=>l.reject(f)}),u=new np(ki(o.path),c,{includeMetadataChanges:!0,Du:!0});return ep(s,u)}(await ra(t),t.asyncQueue,e,n,r)),r.promise}const su=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(t,e,n){if(!n)throw new $(N.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Qb(t,e,n,r){if(e===!0&&r===!0)throw new $(N.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function iu(t){if(!U.isDocumentKey(t))throw new $(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ou(t){if(U.isDocumentKey(t))throw new $(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function gl(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":z()}function _t(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=gl(t);throw new $(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new $(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Qb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,n,r){this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new au({}),this._settingsFrozen=!1,e instanceof jn?this._databaseId=e:(this._app=e,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new $(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jn(s.options.projectId)}(e))}get app(){if(!this._app)throw new $(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new $(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new au(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new g0;switch(n.type){case"gapi":const r=n.client;return fe(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new v0(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new $(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=su.get(e);n&&(V("ComponentProvider","Removing Datastore"),su.delete(e),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new et(this.firestore,e,this._key)}}class xi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new xi(this.firestore,e,this._query)}}class Vt extends xi{constructor(e,n,r){super(e,n,ki(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new et(this.firestore,null,new U(e))}withConverter(e){return new Vt(this.firestore,e,this._path)}}function Wb(t,e,...n){if(t=yt(t),hp("collection","path",e),t instanceof ml){const r=ve.fromString(e,...n);return ou(r),new Vt(t,null,r)}{if(!(t instanceof et||t instanceof Vt))throw new $(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ve.fromString(e,...n));return ou(r),new Vt(t.firestore,null,r)}}function Ge(t,e,...n){if(t=yt(t),arguments.length===1&&(e=dd.I()),hp("doc","path",e),t instanceof ml){const r=ve.fromString(e,...n);return iu(r),new et(t,null,new U(r))}{if(!(t instanceof et||t instanceof Vt))throw new $(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ve.fromString(e,...n));return iu(r),new et(t.firestore,t instanceof Vt?t.converter:null,new U(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Hd(this,"async_queue_retry"),this.Kc=()=>{const n=_o();n&&V("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=_o();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=_o();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new jt;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!Zr(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{this.Bc=r,this.Lc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw Gt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Lc=!1,r))));return this.Oc=n,n}enqueueAfterDelay(e,n,r){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const s=hl.createAndSchedule(this,e,n,r,i=>this.Wc(i));return this.$c.push(s),s}Gc(){this.Bc&&z()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function lu(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class bn extends ml{constructor(e,n,r){super(e,n,r),this.type="firestore",this._queue=new Xb,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||fp(this),this._firestoreClient.terminate()}}function Yb(t=Vh()){return $r(t,"firestore").getImmediate()}function yl(t){return t._firestoreClient||fp(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function fp(t){var e;const n=t._freezeSettings(),r=function(s,i,o,a){return new D0(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new $b(t._authCredentials,t._appCheckCredentials,t._queue,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new $(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hn(Ve.fromBase64String(e))}catch(n){throw new $(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Hn(Ve.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new $(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new $(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return oe(this._lat,e._lat)||oe(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb=/^__.*__$/;class Zb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Yt(e,this.data,this.fieldMask,n,this.fieldTransforms):new es(e,this.data,n,this.fieldTransforms)}}class dp{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Yt(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function pp(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw z()}}class Li{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Li(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.sa(e),s}ia(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.Xc(),s}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Zs(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(pp(this.Zc)&&Jb.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class ew{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=r||Di(e)}aa(e,n,r,s=!1){return new Li({Zc:e,methodName:n,ca:r,path:qe.emptyPath(),na:!1,ua:s},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function bl(t){const e=t._freezeSettings(),n=Di(t._databaseId);return new ew(t._databaseId,!!e.ignoreUndefinedProperties,n)}function gp(t,e,n,r,s,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,s);wl("Data must be an object, but it was:",o,r);const a=yp(r,o);let l,c;if(i.merge)l=new dt(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const f of i.mergeFields){const p=sa(e,f,n);if(!o.contains(p))throw new $(N.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);bp(u,p)||u.push(p)}l=new dt(u),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new Zb(new rt(a),l,c)}class Mi extends ss{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Mi}}function mp(t,e,n){return new Li({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class tw extends ss{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=mp(this,e,!0),r=this.ha.map(i=>er(i,n)),s=new Un(r);return new Ad(e.path,s)}isEqual(e){return this===e}}class nw extends ss{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=mp(this,e,!0),r=this.ha.map(i=>er(i,n)),s=new $n(r);return new Ad(e.path,s)}isEqual(e){return this===e}}function rw(t,e,n,r){const s=t.aa(1,e,n);wl("Data must be an object, but it was:",s,r);const i=[],o=rt.empty();En(r,(l,c)=>{const u=_l(e,l,n);c=yt(c);const f=s.ia(u);if(c instanceof Mi)i.push(u);else{const p=er(c,f);p!=null&&(i.push(u),o.set(u,p))}});const a=new dt(i);return new dp(o,a,s.fieldTransforms)}function sw(t,e,n,r,s,i){const o=t.aa(1,e,n),a=[sa(e,r,n)],l=[s];if(i.length%2!=0)throw new $(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(sa(e,i[p])),l.push(i[p+1]);const c=[],u=rt.empty();for(let p=a.length-1;p>=0;--p)if(!bp(c,a[p])){const d=a[p];let h=l[p];h=yt(h);const m=o.ia(d);if(h instanceof Mi)c.push(d);else{const v=er(h,m);v!=null&&(c.push(d),u.set(d,v))}}const f=new dt(c);return new dp(u,f,o.fieldTransforms)}function er(t,e){if(vp(t=yt(t)))return wl("Unsupported field value:",e,t),yp(t,e);if(t instanceof ss)return function(n,r){if(!pp(r.Zc))throw r.oa(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=er(o,r.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=yt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return X0(r.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Se.fromDate(n);return{timestampValue:Ys(r.wt,s)}}if(n instanceof Se){const s=new Se(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ys(r.wt,s)}}if(n instanceof vl)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Hn)return{bytesValue:Bd(r.wt,n._byteString)};if(n instanceof et){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:rl(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.oa(`Unsupported field value: ${gl(n)}`)}(t,e)}function yp(t,e){const n={};return pd(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):En(t,(r,s)=>{const i=er(s,e.ea(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function vp(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Se||t instanceof vl||t instanceof Hn||t instanceof et||t instanceof ss)}function wl(t,e,n){if(!vp(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=gl(n);throw r==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+r)}}function sa(t,e,n){if((e=yt(e))instanceof Oi)return e._internalPath;if(typeof e=="string")return _l(t,e);throw Zs("Field path arguments must be of type string or ",t,!1,void 0,n)}const iw=new RegExp("[~\\*/\\[\\]]");function _l(t,e,n){if(e.search(iw)>=0)throw Zs(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Oi(...e.split("."))._internalPath}catch{throw Zs(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Zs(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new $(N.INVALID_ARGUMENT,a+t+l)}function bp(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new et(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ow(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(_p("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ow extends wp{data(){return super.data()}}function _p(t,e){return typeof e=="string"?_l(t,e):e instanceof Oi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ep extends wp{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Os(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(_p("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Os extends Ep{data(e={}){return super.data(e)}}class aw{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new wr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Os(this._firestore,this._userDataWriter,r.key,r,new wr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new Os(r._firestore,r._userDataWriter,o.doc.key,o.doc,new wr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new Os(r._firestore,r._userDataWriter,o.doc.key,o.doc,new wr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let l=-1,c=-1;return o.type!==0&&(l=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),c=i.indexOf(o.doc.key)),{type:lw(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function lw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return z()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{convertValue(e,n="none"){switch(yn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ee(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Bn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw z()}}convertObject(e,n){const r={};return En(e.fields,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new vl(Ee(e.latitude),Ee(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=md(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Br(e));default:return null}}convertTimestamp(e){const n=zt(e);return new Se(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ve.fromString(e);fe($d(r));const s=new jn(r.get(1),r.get(3)),i=new U(r.popFirst(5));return s.isEqual(n)||Gt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(t){t=_t(t,et);const e=_t(t.firestore,bn);return Kb(yl(e),t._key).then(n=>Cp(e,t,n))}class kp extends uw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new et(this.firestore,null,n)}}function ln(t,e,n){t=_t(t,et);const r=_t(t.firestore,bn),s=Tp(t.converter,e,n);return Tl(r,[gp(bl(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,mt.none())])}function ia(t,e,n,...r){t=_t(t,et);const s=_t(t.firestore,bn),i=bl(s);let o;return o=typeof(e=yt(e))=="string"||e instanceof Oi?sw(i,"updateDoc",t._key,e,n,r):rw(i,"updateDoc",t._key,e),Tl(s,[o.toMutation(t._key,mt.exists(!0))])}function hw(t,e){const n=_t(t.firestore,bn),r=Ge(t),s=Tp(t.converter,e);return Tl(n,[gp(bl(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,mt.exists(!1))]).then(()=>r)}function fw(t,...e){var n,r,s;t=yt(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||lu(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(lu(e[o])){const f=e[o];e[o]=(n=f.next)===null||n===void 0?void 0:n.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,u;if(t instanceof et)c=_t(t.firestore,bn),u=ki(t._key.path),l={next:f=>{e[o]&&e[o](Cp(c,t,f))},error:e[o+1],complete:e[o+2]};else{const f=_t(t,xi);c=_t(f.firestore,bn),u=f._query;const p=new kp(c);l={next:d=>{e[o]&&e[o](new aw(c,p,f,d))},error:e[o+1],complete:e[o+2]},cw(t._query)}return function(f,p,d,h){const m=new cp(h),v=new np(p,m,d);return f.asyncQueue.enqueueAndForget(async()=>ep(await ra(f),v)),()=>{m.Tc(),f.asyncQueue.enqueueAndForget(async()=>tp(await ra(f),v))}}(yl(c),u,a,l)}function Tl(t,e){return function(n,r){const s=new jt;return n.asyncQueue.enqueueAndForget(async()=>Nb(await zb(n),r,s)),s.promise}(yl(t),e)}function Cp(t,e,n){const r=n.docs.get(e._key),s=new kp(t);return new Ep(t,s,e._key,r,new wr(n.hasPendingWrites,n.fromCache),e.converter)}function dw(...t){return new tw("arrayUnion",t)}function pw(...t){return new nw("arrayRemove",t)}(function(t,e=!0){(function(n){Yn=n})(xm),qt(new Rt("firestore",(n,{options:r})=>{const s=n.getProvider("app").getImmediate(),i=new bn(s,new m0(n.getProvider("auth-internal")),new w0(n.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),i._setSettings(r),i},"PUBLIC")),wt(xc,"3.4.12",t),wt(xc,"3.4.12","esm2017")})();const gw={apiKey:"AIzaSyAwCY1tRAE0m9SrlSXSVh6im8NJDYGmd8g",authDomain:"scrumik.firebaseapp.com",projectId:"scrumik",storageBucket:"scrumik.appspot.com",messagingSenderId:"480092253511",appId:"1:480092253511:web:6774f2fec537fd6a9a3062",measurementId:"G-KMNHLLXP8N"},Ip=Om(gw);sv(Ip);const He=Yb(Ip),mw=[{text:"1",emoji:!1},{text:"2",emoji:!1},{text:"3",emoji:!1},{text:"5",emoji:!1},{text:"8",emoji:!1},{text:"13",emoji:!1},{text:"21",emoji:!1},{text:"34",emoji:!1},{text:"55",emoji:!1},{text:"\u2615",emoji:!0},{text:"\u{1F92F}",emoji:!0},{text:"\u{1F52D}",emoji:!0},{text:"\u2754",emoji:!0}],yw=(t,e,n)=>fw(Ge(t,"room",e),n),vw=async(t,e)=>{try{return(await hw(Wb(t,"room"),e)).id}catch(n){throw console.error("Error adding document: ",n),n}},bw=async(t,e,n)=>{const r=Ge(t,"room",e),s=await El(r);if(s.exists()){const i=s.get("password");return i.passCode==""?!0:i.passCode===n||i.leaderCode===n}else throw new Error("No such document!")};function ww(t){let e,n,r,s,i,o,a;return{c(){e=S("div"),n=S("h2"),n.textContent="Create Room",r=M(),s=S("form"),s.innerHTML=`<label><span class="text-sm font-bold block mb-2">Room Name</span> 
      <input type="text" name="name" placeholder="Enter a room name" autocomplete="off" required="" class="mb-4 form-input"/></label> 
    <label><span class="text-sm font-bold block mb-2">Passcode</span> 
      <input type="text" name="passCode" autocomplete="off" placeholder="Optional passcode to join room" class="mb-4 form-input"/></label> 
    <label><span class="text-sm font-bold block mb-2">Leader Passcode</span> 
      <input type="text" name="leaderCode" autocomplete="off" placeholder="If not set, will be the same as passcode" class="mb-4 form-input"/></label> 
    <button type="submit" value="create" class="block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded">Create Room</button>`,I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(e,"class",i=`${t[0]} p-6 bg-white`)},m(l,c){j(l,e,c),C(e,n),C(e,r),C(e,s),t[3](s),o||(a=Y(s,"submit",Qt(wn(t[2]))),o=!0)},p(l,[c]){c&1&&i!==(i=`${l[0]} p-6 bg-white`)&&I(e,"class",i)},i:J,o:J,d(l){l&&B(e),t[3](null),o=!1,a()}}}function _w(t,e,n){let{class:r=""}=e,s;const i=async()=>{const a=new FormData(s),l={info:{name:a.get("name")},password:{passCode:a.get("passCode"),leaderCode:a.get("leaderCode")},cards:mw};l.password.leaderCode==""&&(l.password.leaderCode=l.password.passCode);try{const c=await vw(He,l);ba(`/room/${c}?password=${l.password.leaderCode}`)}catch(c){console.error(c)}};function o(a){Mn[a?"unshift":"push"](()=>{s=a,n(1,s)})}return t.$$set=a=>{"class"in a&&n(0,r=a.class)},[r,s,i,o]}class Ew extends We{constructor(e){super(),Qe(this,e,_w,ww,Ue,{class:0})}}function Tw(t){var y;let e,n,r,s,i,o,a,l,c,u,f,p,d=((y=t[2])!=null?y:"")+"",h,m,v,g;return{c(){e=S("div"),n=S("h2"),n.textContent="Join Room",r=M(),s=S("form"),i=S("label"),i.innerHTML=`<span class="text-sm font-bold block mb-2">Room ID</span> 
      <input type="text" name="roomID" placeholder="Room ID" required="" class="mb-4 form-input"/>`,o=M(),a=S("label"),a.innerHTML=`<span class="text-sm font-bold block mb-2">Password</span> 
      <input type="password" name="passCode" placeholder="Leave it empty if don&#39;t need password" class="mb-4 form-input"/>`,l=M(),c=S("div"),u=S("button"),u.textContent="Join",f=M(),p=S("button"),h=ue(d),I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(u,"type","submit"),u.value="join",I(u,"class","border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(p,"type","button"),I(p,"class","border border-black bg-white text-black hover:bg-red-500 hover:text-white font-bold py-1 px-3 rounded"),$t(p,"invisible",!t[2]),I(c,"class","block"),I(e,"class",m=`${t[0]} p-6 bg-white`)},m(k,b){j(k,e,b),C(e,n),C(e,r),C(e,s),C(s,i),C(s,o),C(s,a),C(s,l),C(s,c),C(c,u),C(c,f),C(c,p),C(p,h),t[5](s),v||(g=[Y(p,"click",t[4]),Y(s,"submit",Qt(wn(t[3])))],v=!0)},p(k,[b]){var _;b&4&&d!==(d=((_=k[2])!=null?_:"")+"")&&be(h,d),b&4&&$t(p,"invisible",!k[2]),b&1&&m!==(m=`${k[0]} p-6 bg-white`)&&I(e,"class",m)},i:J,o:J,d(k){k&&B(e),t[5](null),v=!1,Ke(g)}}}function kw(t,e,n){let{class:r=""}=e,s,i;const o=async()=>{const c=new FormData(s),u=c.get("roomID"),f=c.get("password");try{if(!await bw(He,u,f))throw new Error("Passcode is not correct");ba(`/room/${u}?password=${f}`)}catch(p){n(2,i=p.message)}},a=()=>n(2,i="");function l(c){Mn[c?"unshift":"push"](()=>{s=c,n(1,s)})}return t.$$set=c=>{"class"in c&&n(0,r=c.class)},[r,s,i,o,a,l]}class Cw extends We{constructor(e){super(),Qe(this,e,kw,Tw,Ue,{class:0})}}const kl=Ur(null),Eo=()=>{const t=is();kl.set(t)},bt=Ur(!1),cn=Ur(!1);var _s,Iw=new Uint8Array(16);function Aw(){if(!_s&&(_s=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!_s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return _s(Iw)}const Sw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Dw(t){return typeof t=="string"&&Sw.test(t)}var Me=[];for(var To=0;To<256;++To)Me.push((To+256).toString(16).substr(1));function Rw(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(Me[t[e+0]]+Me[t[e+1]]+Me[t[e+2]]+Me[t[e+3]]+"-"+Me[t[e+4]]+Me[t[e+5]]+"-"+Me[t[e+6]]+Me[t[e+7]]+"-"+Me[t[e+8]]+Me[t[e+9]]+"-"+Me[t[e+10]]+Me[t[e+11]]+Me[t[e+12]]+Me[t[e+13]]+Me[t[e+14]]+Me[t[e+15]]).toLowerCase();if(!Dw(n))throw TypeError("Stringified UUID is invalid");return n}function Nw(t,e,n){t=t||{};var r=t.random||(t.rng||Aw)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var s=0;s<16;++s)e[n+s]=r[s];return e}return Rw(r)}const Cl="room",Il="id",oa=(t,e,n=!0)=>{let r=is();if(!r)r=[e];else{let s;r=r.filter(i=>i.id!=t?!0:(s=i,!1)),n&&(s={...s,...e}),r.push(s)}localStorage.setItem(Cl,JSON.stringify(r))},is=()=>{const t=localStorage.getItem(Cl);return t==null?null:JSON.parse(t)},Ap=t=>{var r;const e=is();if(e==null)return"";const n=e.find(s=>s.id==t);return(r=n==null?void 0:n.password)!=null?r:""},xw=t=>{const e=is();if(e==null)return;const n=e.find(r=>r.id==t);return n==null?void 0:n.name},Sp=t=>{const e=is();if(e==null)return;const n=e.filter(r=>r.id!==t);localStorage.setItem(Cl,JSON.stringify(n)),kl.set(n)},Dp=()=>{const t=localStorage.getItem(Il);return t==null?null:JSON.parse(t)},Rp=t=>{const e=Nw(),n={id:e,nick:t};return localStorage.setItem(Il,JSON.stringify(n)),{id:e,nick:t}},Np=(t,e)=>{const n={id:t,nick:e};localStorage.setItem(Il,JSON.stringify(n))},cu=t=>{t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296};class Ow{constructor(e){this.dictionaries=void 0,this.length=void 0,this.separator=void 0,this.style=void 0,this.seed=void 0;const{length:n,separator:r,dictionaries:s,style:i,seed:o}=e;this.dictionaries=s,this.separator=r,this.length=n,this.style=i,this.seed=o}generate(){if(!this.dictionaries)throw new Error('Cannot find any dictionary. Please provide at least one, or leave the "dictionary" field empty in the config object');if(this.length<=0)throw new Error("Invalid length provided");if(this.length>this.dictionaries.length)throw new Error(`The length cannot be bigger than the number of dictionaries.
Length provided: ${this.length}. Number of dictionaries provided: ${this.dictionaries.length}`);let e=this.seed;return this.dictionaries.slice(0,this.length).reduce((n,r)=>{let s;e?(s=(o=>{if(typeof o=="string"){const a=o.split("").map(c=>c.charCodeAt(0)).reduce((c,u)=>c+u,1),l=Math.floor(Number(a));return cu(l)}return cu(o)})(e),e=4294967296*s):s=Math.random();let i=r[Math.floor(s*r.length)]||"";if(this.style==="lowerCase")i=i.toLowerCase();else if(this.style==="capital"){const[o,...a]=i.split("");i=o.toUpperCase()+a.join("")}else this.style==="upperCase"&&(i=i.toUpperCase());return n?`${n}${this.separator}${i}`:`${i}`},"")}}const uu={separator:"_",dictionaries:[]},Lw=t=>{const e=[...t&&t.dictionaries||uu.dictionaries],n={...uu,...t,length:t&&t.length||e.length,dictionaries:e};if(!t||!t.dictionaries||!t.dictionaries.length)throw new Error('A "dictionaries" array must be provided. This is a breaking change introduced starting from Unique Name Generator v4. Read more about the breaking change here: https://github.com/andreasonny83/unique-names-generator#migration-guide');return new Ow(n).generate()};var Mw=["aardvark","aardwolf","albatross","alligator","alpaca","amphibian","anaconda","angelfish","anglerfish","ant","anteater","antelope","antlion","ape","aphid","armadillo","asp","baboon","badger","bandicoot","barnacle","barracuda","basilisk","bass","bat","bear","beaver","bedbug","bee","beetle","bird","bison","blackbird","boa","boar","bobcat","bobolink","bonobo","booby","bovid","bug","butterfly","buzzard","camel","canid","canidae","capybara","cardinal","caribou","carp","cat","caterpillar","catfish","catshark","cattle","centipede","cephalopod","chameleon","cheetah","chickadee","chicken","chimpanzee","chinchilla","chipmunk","cicada","clam","clownfish","cobra","cockroach","cod","condor","constrictor","coral","cougar","cow","coyote","crab","crane","crawdad","crayfish","cricket","crocodile","crow","cuckoo","damselfly","deer","dingo","dinosaur","dog","dolphin","donkey","dormouse","dove","dragon","dragonfly","duck","eagle","earthworm","earwig","echidna","eel","egret","elephant","elk","emu","ermine","falcon","felidae","ferret","finch","firefly","fish","flamingo","flea","fly","flyingfish","fowl","fox","frog","galliform","gamefowl","gayal","gazelle","gecko","gerbil","gibbon","giraffe","goat","goldfish","goose","gopher","gorilla","grasshopper","grouse","guan","guanaco","guineafowl","gull","guppy","haddock","halibut","hamster","hare","harrier","hawk","hedgehog","heron","herring","hippopotamus","hookworm","hornet","horse","hoverfly","hummingbird","hyena","iguana","impala","jackal","jaguar","jay","jellyfish","junglefowl","kangaroo","kingfisher","kite","kiwi","koala","koi","krill","ladybug","lamprey","landfowl","lark","leech","lemming","lemur","leopard","leopon","limpet","lion","lizard","llama","lobster","locust","loon","louse","lungfish","lynx","macaw","mackerel","magpie","mammal","manatee","mandrill","marlin","marmoset","marmot","marsupial","marten","mastodon","meadowlark","meerkat","mink","minnow","mite","mockingbird","mole","mollusk","mongoose","monkey","moose","mosquito","moth","mouse","mule","muskox","narwhal","newt","nightingale","ocelot","octopus","opossum","orangutan","orca","ostrich","otter","owl","ox","panda","panther","parakeet","parrot","parrotfish","partridge","peacock","peafowl","pelican","penguin","perch","pheasant","pig","pigeon","pike","pinniped","piranha","planarian","platypus","pony","porcupine","porpoise","possum","prawn","primate","ptarmigan","puffin","puma","python","quail","quelea","quokka","rabbit","raccoon","rat","rattlesnake","raven","reindeer","reptile","rhinoceros","roadrunner","rodent","rook","rooster","roundworm","sailfish","salamander","salmon","sawfish","scallop","scorpion","seahorse","shark","sheep","shrew","shrimp","silkworm","silverfish","skink","skunk","sloth","slug","smelt","snail","snake","snipe","sole","sparrow","spider","spoonbill","squid","squirrel","starfish","stingray","stoat","stork","sturgeon","swallow","swan","swift","swordfish","swordtail","tahr","takin","tapir","tarantula","tarsier","termite","tern","thrush","tick","tiger","tiglon","toad","tortoise","toucan","trout","tuna","turkey","turtle","tyrannosaurus","unicorn","urial","vicuna","viper","vole","vulture","wallaby","walrus","warbler","wasp","weasel","whale","whippet","whitefish","wildcat","wildebeest","wildfowl","wolf","wolverine","wombat","woodpecker","worm","wren","xerinae","yak","zebra"],Pw=["amaranth","amber","amethyst","apricot","aqua","aquamarine","azure","beige","black","blue","blush","bronze","brown","chocolate","coffee","copper","coral","crimson","cyan","emerald","fuchsia","gold","gray","green","harlequin","indigo","ivory","jade","lavender","lime","magenta","maroon","moccasin","olive","orange","peach","pink","plum","purple","red","rose","salmon","sapphire","scarlet","silver","tan","teal","tomato","turquoise","violet","white","yellow"];const Fw={dictionaries:[Pw,Mw],separator:"-",length:2},ei=()=>Lw(Fw);function hu(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 h-7 border-l border-b border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){j(s,e,i),n||(r=Y(e,"click",t[3]),n=!0)},p:J,d(s){s&&B(e),n=!1,r()}}}function Bw(t){let e,n;return{c(){e=S("span"),n=ue(t[2]),I(e,"class","font-bold text-xl px-2")},m(r,s){j(r,e,s),C(e,n)},p(r,s){s&4&&be(n,r[2])},d(r){r&&B(e)}}}function jw(t){let e,n,r,s,i,o;return{c(){e=S("form"),n=S("input"),r=M(),s=S("button"),s.textContent="Generate Name",I(n,"class","bg-gray-100 border border-gray-200 flex-1 px-2 text-xl font-bold"),I(n,"type","text"),I(s,"class","bg-white border border-black px-2 text-xl hover:bg-nl hover:text-white"),I(s,"type","button")},m(a,l){j(a,e,l),C(e,n),Ln(n,t[2]),C(e,r),C(e,s),i||(o=[Y(n,"input",t[5]),Y(s,"click",t[6]),Y(e,"submit",Qt(wn(t[3])))],i=!0)},p(a,l){l&4&&n.value!==a[2]&&Ln(n,a[2])},d(a){a&&B(e),i=!1,Ke(o)}}}function Vw(t){let e,n,r,s,i,o=t[1]?"Cancel":"Edit Nickname",a,l,c,u,f,p,d,h=t[1]&&hu(t);function m(y,k){return y[1]?jw:Bw}let v=m(t),g=v(t);return{c(){e=S("div"),n=S("div"),r=S("div"),h&&h.c(),s=M(),i=S("button"),a=ue(o),c=M(),u=S("div"),g.c(),I(i,"class",l=`float-right px-2 h-7 border-l border-b border-black self-end hover:text-white ${t[1]?"hover:bg-red-500":"hover:bg-nl"}`),I(n,"class","float-right"),I(u,"class","py-6 pl-4 pr-6"),I(e,"class",f=`${t[0]} bg-white`)},m(y,k){j(y,e,k),C(e,n),C(n,r),h&&h.m(r,null),C(r,s),C(r,i),C(i,a),C(e,c),C(e,u),g.m(u,null),p||(d=Y(i,"click",t[4]),p=!0)},p(y,[k]){y[1]?h?h.p(y,k):(h=hu(y),h.c(),h.m(r,s)):h&&(h.d(1),h=null),k&2&&o!==(o=y[1]?"Cancel":"Edit Nickname")&&be(a,o),k&2&&l!==(l=`float-right px-2 h-7 border-l border-b border-black self-end hover:text-white ${y[1]?"hover:bg-red-500":"hover:bg-nl"}`)&&I(i,"class",l),v===(v=m(y))&&g?g.p(y,k):(g.d(1),g=v(y),g&&(g.c(),g.m(u,null))),k&1&&f!==(f=`${y[0]} bg-white`)&&I(e,"class",f)},i:J,o:J,d(y){y&&B(e),h&&h.d(),g.d(),p=!1,d()}}}function Uw(t,e,n){var f;let r=!1,{class:s=""}=e,{id:i,nick:o}=(f=Dp())!=null?f:Rp(ei());const a=()=>{Np(i,o),n(1,r=!1)},l=()=>{n(1,r=!r)};function c(){o=this.value,n(2,o)}const u=()=>n(2,o=ei());return t.$$set=p=>{"class"in p&&n(0,s=p.class)},[s,r,o,a,l,c,u]}class $w extends We{constructor(e){super(),Qe(this,e,Uw,Vw,Ue,{class:0})}}const qw=t=>window.confirm(t);function fu(t,e,n){const r=t.slice();return r[3]=e[n],r}function Gw(t){let e;return{c(){e=S("p"),e.textContent="No rooms yet",I(e,"class","italic")},m(n,r){j(n,e,r)},p:J,d(n){n&&B(e)}}}function Hw(t){let e,n=[],r=new Map,s=t[1];const i=o=>o[3].id;for(let o=0;o<s.length;o+=1){let a=fu(t,s,o),l=i(a);r.set(l,n[o]=du(l,a))}return{c(){e=S("ul");for(let o=0;o<n.length;o+=1)n[o].c()},m(o,a){j(o,e,a);for(let l=0;l<n.length;l+=1)n[l].m(e,null)},p(o,a){a&2&&(s=o[1],n=ya(n,a,i,1,o,s,r,e,lg,du,null,fu))},d(o){o&&B(e);for(let a=0;a<n.length;a+=1)n[a].d()}}}function du(t,e){let n,r,s=e[3].name+"",i,o,a,l,c,u,f;function p(){return e[2](e[3])}return{key:t,first:null,c(){n=S("li"),r=S("a"),i=ue(s),a=M(),l=S("button"),l.textContent="delete",c=M(),I(r,"class","w-full leading-10 hover:bg-green-500 hover:text-white px-2"),I(r,"href",o=`/room/${e[3].id}`),I(l,"class","border-l border-black bg-white hover:bg-red-500 hover:text-white px-2"),I(n,"class","flex justify-between odd:bg-gray-100 even:bg-gray-200 first:border-t border-b border-black"),this.first=n},m(d,h){j(d,n,h),C(n,r),C(r,i),C(n,a),C(n,l),C(n,c),u||(f=[vh(Rh.call(null,r)),Y(l,"click",p)],u=!0)},p(d,h){e=d,h&2&&s!==(s=e[3].name+"")&&be(i,s),h&2&&o!==(o=`/room/${e[3].id}`)&&I(r,"href",o)},d(d){d&&B(n),u=!1,Ke(f)}}}function zw(t){let e,n,r,s,i;function o(c,u){return c[1]!=null&&c[1].length>0?Hw:Gw}let a=o(t),l=a(t);return{c(){e=S("div"),n=S("h2"),n.textContent="Room List",r=M(),s=S("div"),l.c(),I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(e,"class",i=`${t[0]} p-6 bg-white`)},m(c,u){j(c,e,u),C(e,n),C(e,r),C(e,s),l.m(s,null)},p(c,[u]){a===(a=o(c))&&l?l.p(c,u):(l.d(1),l=a(c),l&&(l.c(),l.m(s,null))),u&1&&i!==(i=`${c[0]} p-6 bg-white`)&&I(e,"class",i)},i:J,o:J,d(c){c&&B(e),l.d()}}}function Kw(t,e,n){let r;Ut(t,kl,o=>n(1,r=o));let{class:s=""}=e;ga(()=>{Eo(),window.addEventListener("storage",Eo)}),ma(()=>{window.removeEventListener("storage",Eo)});const i=o=>{qw(`Are you sure to delete? [${o.name}]`)&&Sp(o.id)};return t.$$set=o=>{"class"in o&&n(0,s=o.class)},[s,r,i]}class Qw extends We{constructor(e){super(),Qe(this,e,Kw,zw,Ue,{class:0})}}function pu(t){let e,n,r,s,i,o,a;return{c(){e=S("div"),n=S("span"),r=ue(t[0]),s=M(),i=S("button"),i.textContent="X",I(n,"class","p-2"),I(i,"class","border-l border-black bg-gray-200 hover:bg-nl px-2 float-right"),I(e,"class","border-t border-b sm:border border-black mb-3 bg-yellow-200")},m(l,c){j(l,e,c),C(e,n),C(n,r),C(e,s),C(e,i),o||(a=Y(i,"click",t[2]),o=!0)},p(l,c){c&1&&be(r,l[0])},d(l){l&&B(e),o=!1,a()}}}function Ww(t){let e,n,r,s,i,o,a,l,c,u,f,p,d=t[0]&&pu(t);return s=new Cw({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),o=new Qw({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),c=new $w({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),f=new Ew({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),{c(){d&&d.c(),e=M(),n=S("div"),r=S("div"),Ae(s.$$.fragment),i=M(),Ae(o.$$.fragment),a=M(),l=S("div"),Ae(c.$$.fragment),u=M(),Ae(f.$$.fragment),I(r,"class","flex flex-1 flex-col gap-3"),I(l,"class","flex flex-1 flex-col gap-3"),I(n,"class","flex flex-1 gap-3 md:flex-row flex-col")},m(h,m){d&&d.m(h,m),j(h,e,m),j(h,n,m),C(n,r),Te(s,r,null),C(r,i),Te(o,r,null),C(n,a),C(n,l),Te(c,l,null),C(l,u),Te(f,l,null),p=!0},p(h,[m]){h[0]?d?d.p(h,m):(d=pu(h),d.c(),d.m(e.parentNode,e)):d&&(d.d(1),d=null)},i(h){p||(X(s.$$.fragment,h),X(o.$$.fragment,h),X(c.$$.fragment,h),X(f.$$.fragment,h),p=!0)},o(h){te(s.$$.fragment,h),te(o.$$.fragment,h),te(c.$$.fragment,h),te(f.$$.fragment,h),p=!1},d(h){d&&d.d(h),h&&B(e),h&&B(n),ke(s),ke(o),ke(c),ke(f)}}}function Xw(t,e,n){let r;Ut(t,Dh,a=>n(1,r=a));let s="";const i=a=>{var u,f;const l=new URLSearchParams(a);n(0,s=(u=l.get("msg"))!=null?u:"");const c=(f=l.get("kickRoom"))!=null?f:"";c&&Sp(c)},o=()=>n(0,s="");return t.$$.update=()=>{t.$$.dirty&2&&i(r)},[s,r,o]}class Yw extends We{constructor(e){super(),Qe(this,e,Xw,Ww,Ue,{})}}function Jw(t){let e;return{c(){e=S("div"),e.textContent="What is that URL?",I(e,"class","border border-black bg-yellow-200 w-full text-center font-bold text-xl")},m(n,r){j(n,e,r)},p:J,i:J,o:J,d(n){n&&B(e)}}}class Zw extends We{constructor(e){super(),Qe(this,e,null,Jw,Ue,{})}}const Dr=async(t,e)=>{const r=(await El(t)).get("password");return(r==null?void 0:r.leaderCode)==e?[!0,!0]:[!1,(r==null?void 0:r.passCode)==e]},ko=async t=>(await El(t)).get("password");var Oe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function e_(){this.__data__=[],this.size=0}var t_=e_;function n_(t,e){return t===e||t!==t&&e!==e}var xp=n_,r_=xp;function s_(t,e){for(var n=t.length;n--;)if(r_(t[n][0],e))return n;return-1}var Pi=s_,i_=Pi,o_=Array.prototype,a_=o_.splice;function l_(t){var e=this.__data__,n=i_(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():a_.call(e,n,1),--this.size,!0}var c_=l_,u_=Pi;function h_(t){var e=this.__data__,n=u_(e,t);return n<0?void 0:e[n][1]}var f_=h_,d_=Pi;function p_(t){return d_(this.__data__,t)>-1}var g_=p_,m_=Pi;function y_(t,e){var n=this.__data__,r=m_(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var v_=y_,b_=t_,w_=c_,__=f_,E_=g_,T_=v_;function tr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}tr.prototype.clear=b_;tr.prototype.delete=w_;tr.prototype.get=__;tr.prototype.has=E_;tr.prototype.set=T_;var Fi=tr,k_=Fi;function C_(){this.__data__=new k_,this.size=0}var I_=C_;function A_(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var S_=A_;function D_(t){return this.__data__.get(t)}var R_=D_;function N_(t){return this.__data__.has(t)}var x_=N_,O_=typeof Oe=="object"&&Oe&&Oe.Object===Object&&Oe,Op=O_,L_=Op,M_=typeof self=="object"&&self&&self.Object===Object&&self,P_=L_||M_||Function("return this")(),Ot=P_,F_=Ot,B_=F_.Symbol,Al=B_,gu=Al,Lp=Object.prototype,j_=Lp.hasOwnProperty,V_=Lp.toString,pr=gu?gu.toStringTag:void 0;function U_(t){var e=j_.call(t,pr),n=t[pr];try{t[pr]=void 0;var r=!0}catch{}var s=V_.call(t);return r&&(e?t[pr]=n:delete t[pr]),s}var $_=U_,q_=Object.prototype,G_=q_.toString;function H_(t){return G_.call(t)}var z_=H_,mu=Al,K_=$_,Q_=z_,W_="[object Null]",X_="[object Undefined]",yu=mu?mu.toStringTag:void 0;function Y_(t){return t==null?t===void 0?X_:W_:yu&&yu in Object(t)?K_(t):Q_(t)}var Bi=Y_;function J_(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Mp=J_,Z_=Bi,eE=Mp,tE="[object AsyncFunction]",nE="[object Function]",rE="[object GeneratorFunction]",sE="[object Proxy]";function iE(t){if(!eE(t))return!1;var e=Z_(t);return e==nE||e==rE||e==tE||e==sE}var Pp=iE,oE=Ot,aE=oE["__core-js_shared__"],lE=aE,Co=lE,vu=function(){var t=/[^.]+$/.exec(Co&&Co.keys&&Co.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function cE(t){return!!vu&&vu in t}var uE=cE,hE=Function.prototype,fE=hE.toString;function dE(t){if(t!=null){try{return fE.call(t)}catch{}try{return t+""}catch{}}return""}var Fp=dE,pE=Pp,gE=uE,mE=Mp,yE=Fp,vE=/[\\^$.*+?()[\]{}|]/g,bE=/^\[object .+?Constructor\]$/,wE=Function.prototype,_E=Object.prototype,EE=wE.toString,TE=_E.hasOwnProperty,kE=RegExp("^"+EE.call(TE).replace(vE,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function CE(t){if(!mE(t)||gE(t))return!1;var e=pE(t)?kE:bE;return e.test(yE(t))}var IE=CE;function AE(t,e){return t==null?void 0:t[e]}var SE=AE,DE=IE,RE=SE;function NE(t,e){var n=RE(t,e);return DE(n)?n:void 0}var nr=NE,xE=nr,OE=Ot,LE=xE(OE,"Map"),Sl=LE,ME=nr,PE=ME(Object,"create"),ji=PE,bu=ji;function FE(){this.__data__=bu?bu(null):{},this.size=0}var BE=FE;function jE(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var VE=jE,UE=ji,$E="__lodash_hash_undefined__",qE=Object.prototype,GE=qE.hasOwnProperty;function HE(t){var e=this.__data__;if(UE){var n=e[t];return n===$E?void 0:n}return GE.call(e,t)?e[t]:void 0}var zE=HE,KE=ji,QE=Object.prototype,WE=QE.hasOwnProperty;function XE(t){var e=this.__data__;return KE?e[t]!==void 0:WE.call(e,t)}var YE=XE,JE=ji,ZE="__lodash_hash_undefined__";function eT(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=JE&&e===void 0?ZE:e,this}var tT=eT,nT=BE,rT=VE,sT=zE,iT=YE,oT=tT;function rr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}rr.prototype.clear=nT;rr.prototype.delete=rT;rr.prototype.get=sT;rr.prototype.has=iT;rr.prototype.set=oT;var aT=rr,wu=aT,lT=Fi,cT=Sl;function uT(){this.size=0,this.__data__={hash:new wu,map:new(cT||lT),string:new wu}}var hT=uT;function fT(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var dT=fT,pT=dT;function gT(t,e){var n=t.__data__;return pT(e)?n[typeof e=="string"?"string":"hash"]:n.map}var Vi=gT,mT=Vi;function yT(t){var e=mT(this,t).delete(t);return this.size-=e?1:0,e}var vT=yT,bT=Vi;function wT(t){return bT(this,t).get(t)}var _T=wT,ET=Vi;function TT(t){return ET(this,t).has(t)}var kT=TT,CT=Vi;function IT(t,e){var n=CT(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var AT=IT,ST=hT,DT=vT,RT=_T,NT=kT,xT=AT;function sr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}sr.prototype.clear=ST;sr.prototype.delete=DT;sr.prototype.get=RT;sr.prototype.has=NT;sr.prototype.set=xT;var Bp=sr,OT=Fi,LT=Sl,MT=Bp,PT=200;function FT(t,e){var n=this.__data__;if(n instanceof OT){var r=n.__data__;if(!LT||r.length<PT-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new MT(r)}return n.set(t,e),this.size=n.size,this}var BT=FT,jT=Fi,VT=I_,UT=S_,$T=R_,qT=x_,GT=BT;function ir(t){var e=this.__data__=new jT(t);this.size=e.size}ir.prototype.clear=VT;ir.prototype.delete=UT;ir.prototype.get=$T;ir.prototype.has=qT;ir.prototype.set=GT;var HT=ir,zT="__lodash_hash_undefined__";function KT(t){return this.__data__.set(t,zT),this}var QT=KT;function WT(t){return this.__data__.has(t)}var XT=WT,YT=Bp,JT=QT,ZT=XT;function ti(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new YT;++e<n;)this.add(t[e])}ti.prototype.add=ti.prototype.push=JT;ti.prototype.has=ZT;var ek=ti;function tk(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var nk=tk;function rk(t,e){return t.has(e)}var sk=rk,ik=ek,ok=nk,ak=sk,lk=1,ck=2;function uk(t,e,n,r,s,i){var o=n&lk,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=i.get(t),u=i.get(e);if(c&&u)return c==e&&u==t;var f=-1,p=!0,d=n&ck?new ik:void 0;for(i.set(t,e),i.set(e,t);++f<a;){var h=t[f],m=e[f];if(r)var v=o?r(m,h,f,e,t,i):r(h,m,f,t,e,i);if(v!==void 0){if(v)continue;p=!1;break}if(d){if(!ok(e,function(g,y){if(!ak(d,y)&&(h===g||s(h,g,n,r,i)))return d.push(y)})){p=!1;break}}else if(!(h===m||s(h,m,n,r,i))){p=!1;break}}return i.delete(t),i.delete(e),p}var jp=uk,hk=Ot,fk=hk.Uint8Array,dk=fk;function pk(t){var e=-1,n=Array(t.size);return t.forEach(function(r,s){n[++e]=[s,r]}),n}var gk=pk;function mk(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var yk=mk,_u=Al,Eu=dk,vk=xp,bk=jp,wk=gk,_k=yk,Ek=1,Tk=2,kk="[object Boolean]",Ck="[object Date]",Ik="[object Error]",Ak="[object Map]",Sk="[object Number]",Dk="[object RegExp]",Rk="[object Set]",Nk="[object String]",xk="[object Symbol]",Ok="[object ArrayBuffer]",Lk="[object DataView]",Tu=_u?_u.prototype:void 0,Io=Tu?Tu.valueOf:void 0;function Mk(t,e,n,r,s,i,o){switch(n){case Lk:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Ok:return!(t.byteLength!=e.byteLength||!i(new Eu(t),new Eu(e)));case kk:case Ck:case Sk:return vk(+t,+e);case Ik:return t.name==e.name&&t.message==e.message;case Dk:case Nk:return t==e+"";case Ak:var a=wk;case Rk:var l=r&Ek;if(a||(a=_k),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;r|=Tk,o.set(t,e);var u=bk(a(t),a(e),r,s,i,o);return o.delete(t),u;case xk:if(Io)return Io.call(t)==Io.call(e)}return!1}var Pk=Mk;function Fk(t,e){for(var n=-1,r=e.length,s=t.length;++n<r;)t[s+n]=e[n];return t}var Bk=Fk,jk=Array.isArray,Dl=jk,Vk=Bk,Uk=Dl;function $k(t,e,n){var r=e(t);return Uk(t)?r:Vk(r,n(t))}var qk=$k;function Gk(t,e){for(var n=-1,r=t==null?0:t.length,s=0,i=[];++n<r;){var o=t[n];e(o,n,t)&&(i[s++]=o)}return i}var Hk=Gk;function zk(){return[]}var Kk=zk,Qk=Hk,Wk=Kk,Xk=Object.prototype,Yk=Xk.propertyIsEnumerable,ku=Object.getOwnPropertySymbols,Jk=ku?function(t){return t==null?[]:(t=Object(t),Qk(ku(t),function(e){return Yk.call(t,e)}))}:Wk,Zk=Jk;function eC(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var tC=eC;function nC(t){return t!=null&&typeof t=="object"}var Ui=nC,rC=Bi,sC=Ui,iC="[object Arguments]";function oC(t){return sC(t)&&rC(t)==iC}var aC=oC,Cu=aC,lC=Ui,Vp=Object.prototype,cC=Vp.hasOwnProperty,uC=Vp.propertyIsEnumerable,hC=Cu(function(){return arguments}())?Cu:function(t){return lC(t)&&cC.call(t,"callee")&&!uC.call(t,"callee")},fC=hC,ni={exports:{}};function dC(){return!1}var pC=dC;(function(t,e){var n=Ot,r=pC,s=e&&!e.nodeType&&e,i=s&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===s,a=o?n.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||r;t.exports=c})(ni,ni.exports);var gC=9007199254740991,mC=/^(?:0|[1-9]\d*)$/;function yC(t,e){var n=typeof t;return e=e==null?gC:e,!!e&&(n=="number"||n!="symbol"&&mC.test(t))&&t>-1&&t%1==0&&t<e}var vC=yC,bC=9007199254740991;function wC(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=bC}var Up=wC,_C=Bi,EC=Up,TC=Ui,kC="[object Arguments]",CC="[object Array]",IC="[object Boolean]",AC="[object Date]",SC="[object Error]",DC="[object Function]",RC="[object Map]",NC="[object Number]",xC="[object Object]",OC="[object RegExp]",LC="[object Set]",MC="[object String]",PC="[object WeakMap]",FC="[object ArrayBuffer]",BC="[object DataView]",jC="[object Float32Array]",VC="[object Float64Array]",UC="[object Int8Array]",$C="[object Int16Array]",qC="[object Int32Array]",GC="[object Uint8Array]",HC="[object Uint8ClampedArray]",zC="[object Uint16Array]",KC="[object Uint32Array]",pe={};pe[jC]=pe[VC]=pe[UC]=pe[$C]=pe[qC]=pe[GC]=pe[HC]=pe[zC]=pe[KC]=!0;pe[kC]=pe[CC]=pe[FC]=pe[IC]=pe[BC]=pe[AC]=pe[SC]=pe[DC]=pe[RC]=pe[NC]=pe[xC]=pe[OC]=pe[LC]=pe[MC]=pe[PC]=!1;function QC(t){return TC(t)&&EC(t.length)&&!!pe[_C(t)]}var WC=QC;function XC(t){return function(e){return t(e)}}var YC=XC,aa={exports:{}};(function(t,e){var n=Op,r=e&&!e.nodeType&&e,s=r&&!0&&t&&!t.nodeType&&t,i=s&&s.exports===r,o=i&&n.process,a=function(){try{var l=s&&s.require&&s.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(aa,aa.exports);var JC=WC,ZC=YC,Iu=aa.exports,Au=Iu&&Iu.isTypedArray,eI=Au?ZC(Au):JC,$p=eI,tI=tC,nI=fC,rI=Dl,sI=ni.exports,iI=vC,oI=$p,aI=Object.prototype,lI=aI.hasOwnProperty;function cI(t,e){var n=rI(t),r=!n&&nI(t),s=!n&&!r&&sI(t),i=!n&&!r&&!s&&oI(t),o=n||r||s||i,a=o?tI(t.length,String):[],l=a.length;for(var c in t)(e||lI.call(t,c))&&!(o&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||iI(c,l)))&&a.push(c);return a}var uI=cI,hI=Object.prototype;function fI(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||hI;return t===n}var dI=fI;function pI(t,e){return function(n){return t(e(n))}}var gI=pI,mI=gI,yI=mI(Object.keys,Object),vI=yI,bI=dI,wI=vI,_I=Object.prototype,EI=_I.hasOwnProperty;function TI(t){if(!bI(t))return wI(t);var e=[];for(var n in Object(t))EI.call(t,n)&&n!="constructor"&&e.push(n);return e}var kI=TI,CI=Pp,II=Up;function AI(t){return t!=null&&II(t.length)&&!CI(t)}var SI=AI,DI=uI,RI=kI,NI=SI;function xI(t){return NI(t)?DI(t):RI(t)}var OI=xI,LI=qk,MI=Zk,PI=OI;function FI(t){return LI(t,PI,MI)}var BI=FI,Su=BI,jI=1,VI=Object.prototype,UI=VI.hasOwnProperty;function $I(t,e,n,r,s,i){var o=n&jI,a=Su(t),l=a.length,c=Su(e),u=c.length;if(l!=u&&!o)return!1;for(var f=l;f--;){var p=a[f];if(!(o?p in e:UI.call(e,p)))return!1}var d=i.get(t),h=i.get(e);if(d&&h)return d==e&&h==t;var m=!0;i.set(t,e),i.set(e,t);for(var v=o;++f<l;){p=a[f];var g=t[p],y=e[p];if(r)var k=o?r(y,g,p,e,t,i):r(g,y,p,t,e,i);if(!(k===void 0?g===y||s(g,y,n,r,i):k)){m=!1;break}v||(v=p=="constructor")}if(m&&!v){var b=t.constructor,_=e.constructor;b!=_&&"constructor"in t&&"constructor"in e&&!(typeof b=="function"&&b instanceof b&&typeof _=="function"&&_ instanceof _)&&(m=!1)}return i.delete(t),i.delete(e),m}var qI=$I,GI=nr,HI=Ot,zI=GI(HI,"DataView"),KI=zI,QI=nr,WI=Ot,XI=QI(WI,"Promise"),YI=XI,JI=nr,ZI=Ot,e2=JI(ZI,"Set"),t2=e2,n2=nr,r2=Ot,s2=n2(r2,"WeakMap"),i2=s2,la=KI,ca=Sl,ua=YI,ha=t2,fa=i2,qp=Bi,or=Fp,Du="[object Map]",o2="[object Object]",Ru="[object Promise]",Nu="[object Set]",xu="[object WeakMap]",Ou="[object DataView]",a2=or(la),l2=or(ca),c2=or(ua),u2=or(ha),h2=or(fa),tn=qp;(la&&tn(new la(new ArrayBuffer(1)))!=Ou||ca&&tn(new ca)!=Du||ua&&tn(ua.resolve())!=Ru||ha&&tn(new ha)!=Nu||fa&&tn(new fa)!=xu)&&(tn=function(t){var e=qp(t),n=e==o2?t.constructor:void 0,r=n?or(n):"";if(r)switch(r){case a2:return Ou;case l2:return Du;case c2:return Ru;case u2:return Nu;case h2:return xu}return e});var f2=tn,Ao=HT,d2=jp,p2=Pk,g2=qI,Lu=f2,Mu=Dl,Pu=ni.exports,m2=$p,y2=1,Fu="[object Arguments]",Bu="[object Array]",Es="[object Object]",v2=Object.prototype,ju=v2.hasOwnProperty;function b2(t,e,n,r,s,i){var o=Mu(t),a=Mu(e),l=o?Bu:Lu(t),c=a?Bu:Lu(e);l=l==Fu?Es:l,c=c==Fu?Es:c;var u=l==Es,f=c==Es,p=l==c;if(p&&Pu(t)){if(!Pu(e))return!1;o=!0,u=!1}if(p&&!u)return i||(i=new Ao),o||m2(t)?d2(t,e,n,r,s,i):p2(t,e,l,n,r,s,i);if(!(n&y2)){var d=u&&ju.call(t,"__wrapped__"),h=f&&ju.call(e,"__wrapped__");if(d||h){var m=d?t.value():t,v=h?e.value():e;return i||(i=new Ao),s(m,v,n,r,i)}}return p?(i||(i=new Ao),g2(t,e,n,r,s,i)):!1}var w2=b2,_2=w2,Vu=Ui;function Gp(t,e,n,r,s){return t===e?!0:t==null||e==null||!Vu(t)&&!Vu(e)?t!==t&&e!==e:_2(t,e,n,r,Gp,s)}var E2=Gp,T2=E2;function k2(t,e){return T2(t,e)}var C2=k2;function I2(t){let e,n,r,s,i,o,a,l,c;return{c(){e=S("button"),n=S("button"),n.textContent="-",r=M(),s=S("span"),i=ue(t[0]),I(n,"class","h-6 w-6 bg-white hover:bg-red-500 border-l border-b border-black absolute top-0 right-0"),$t(n,"hidden",!t[2]),I(s,"class",o=`${t[1]?"font-emoji":""} text-5xl pointer-events-none`),I(e,"class",a=`${t[3]} h-36 w-28 ${t[2]?"hover:bg-yellow-200":"hover:bg-nl"} border border-black flex items-center justify-center relative`)},m(u,f){j(u,e,f),C(e,n),C(e,r),C(e,s),C(s,i),l||(c=[Y(n,"click",Qt(t[5])),Y(e,"click",t[4])],l=!0)},p(u,[f]){f&4&&$t(n,"hidden",!u[2]),f&1&&be(i,u[0]),f&2&&o!==(o=`${u[1]?"font-emoji":""} text-5xl pointer-events-none`)&&I(s,"class",o),f&12&&a!==(a=`${u[3]} h-36 w-28 ${u[2]?"hover:bg-yellow-200":"hover:bg-nl"} border border-black flex items-center justify-center relative`)&&I(e,"class",a)},i:J,o:J,d(u){u&&B(e),l=!1,Ke(c)}}}function A2(t,e,n){let{text:r=""}=e,{emoji:s=!1}=e,{editMode:i=!1}=e,{class:o=""}=e;const a=bh(),l=()=>{a("click",{text:r,emoji:s})},c=()=>{a("delete")};return t.$$set=u=>{"text"in u&&n(0,r=u.text),"emoji"in u&&n(1,s=u.emoji),"editMode"in u&&n(2,i=u.editMode),"class"in u&&n(3,o=u.class)},[r,s,i,o,l,c]}class $i extends We{constructor(e){super(),Qe(this,e,A2,I2,Ue,{text:0,emoji:1,editMode:2,class:3})}}const Hp=(t,e)=>isNaN(+t)&&isNaN(+e)?t.localeCompare(e):isNaN(+t)?1:isNaN(+e)?-1:+t-+e;function Uu(t,e,n){const r=t.slice();return r[24]=e[n],r}function $u(t,e,n){const r=t.slice();return r[21]=e[n],r[23]=n,r}function qu(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 bg-white h-7 border-l border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){j(s,e,i),n||(r=Y(e,"click",t[9]),n=!0)},p:J,d(s){s&&B(e),n=!1,r()}}}function S2(t){let e,n=[],r=new Map,s,i=t[0].sort(t[19]);const o=a=>a[24].text;for(let a=0;a<i.length;a+=1){let l=Uu(t,i,a),c=o(l);r.set(c,n[a]=Gu(c,l))}return{c(){e=S("div");for(let a=0;a<n.length;a+=1)n[a].c();I(e,"class","grid justify-between auto-fill-col gap-2 svelte-9d72rf")},m(a,l){j(a,e,l);for(let c=0;c<n.length;c+=1)n[c].m(e,null);s=!0},p(a,l){l&129&&(i=a[0].sort(a[19]),Tt(),n=ya(n,l,o,1,a,i,r,e,kh,Gu,null,Uu),kt())},i(a){if(!s){for(let l=0;l<i.length;l+=1)X(n[l]);s=!0}},o(a){for(let l=0;l<n.length;l+=1)te(n[l]);s=!1},d(a){a&&B(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function D2(t){let e,n,r,s,i=t[5],o=[];for(let l=0;l<i.length;l+=1)o[l]=Hu($u(t,i,l));const a=l=>te(o[l],1,1,()=>{o[l]=null});return r=new $i({props:{class:"bg-yellow-200 hover:bg-indigo-400",text:"+"}}),r.$on("click",t[18]),{c(){e=S("div");for(let l=0;l<o.length;l+=1)o[l].c();n=M(),Ae(r.$$.fragment),I(e,"class","grid justify-between auto-fill-col gap-2 svelte-9d72rf")},m(l,c){j(l,e,c);for(let u=0;u<o.length;u+=1)o[u].m(e,null);C(e,n),Te(r,e,null),s=!0},p(l,c){if(c&36){i=l[5];let u;for(u=0;u<i.length;u+=1){const f=$u(l,i,u);o[u]?(o[u].p(f,c),X(o[u],1)):(o[u]=Hu(f),o[u].c(),X(o[u],1),o[u].m(e,n))}for(Tt(),u=i.length;u<o.length;u+=1)a(u);kt()}},i(l){if(!s){for(let c=0;c<i.length;c+=1)X(o[c]);X(r.$$.fragment,l),s=!0}},o(l){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)te(o[c]);te(r.$$.fragment,l),s=!1},d(l){l&&B(e),rg(o,l),ke(r)}}}function Gu(t,e){let n,r,s;return r=new $i({props:{text:e[24].text,emoji:e[24].emoji}}),r.$on("click",e[7]),{key:t,first:null,c(){n=zn(),Ae(r.$$.fragment),this.first=n},m(i,o){j(i,n,o),Te(r,i,o),s=!0},p(i,o){e=i;const a={};o&1&&(a.text=e[24].text),o&1&&(a.emoji=e[24].emoji),r.$set(a)},i(i){s||(X(r.$$.fragment,i),s=!0)},o(i){te(r.$$.fragment,i),s=!1},d(i){i&&B(n),ke(r,i)}}}function Hu(t){let e,n;function r(){return t[17](t[23])}return e=new $i({props:{class:"bg-white",text:t[21].text,emoji:t[21].emoji,editMode:t[2]}}),e.$on("delete",r),{c(){Ae(e.$$.fragment)},m(s,i){Te(e,s,i),n=!0},p(s,i){t=s;const o={};i&32&&(o.text=t[21].text),i&32&&(o.emoji=t[21].emoji),i&4&&(o.editMode=t[2]),e.$set(o)},i(s){n||(X(e.$$.fragment,s),n=!0)},o(s){te(e.$$.fragment,s),n=!1},d(s){ke(e,s)}}}function R2(t){let e,n,r,s,i,o,a=t[2]?"Cancel":"Edit",l,c,u,f,p,d,h,m,v,g,y,k,b,_,w,E,T,A,R,D,q,O,G,L,Ie,Q,F,ne,ae,ce,ge,de=t[2]&&qu(t);h=new $i({props:{class:"bg-white",text:t[4].text,emoji:t[4].emoji}});const ht=[D2,S2],me=[];function Lt(se,re){return se[2]?0:1}return Q=Lt(t),F=me[Q]=ht[Q](t),{c(){e=S("div"),n=S("div"),r=S("button"),r.textContent="Clear Vote",s=M(),de&&de.c(),i=M(),o=S("button"),l=ue(a),u=M(),f=S("div"),p=S("div"),d=S("div"),Ae(h.$$.fragment),m=M(),v=S("div"),g=S("form"),y=S("label"),k=S("span"),k.textContent="Card Text",b=M(),_=S("input"),w=M(),E=S("label"),T=S("span"),T.textContent="Icon",A=M(),R=S("input"),D=M(),q=S("button"),q.textContent="New Card",O=M(),G=S("button"),G.textContent="Cancel",L=M(),Ie=S("div"),F.c(),I(r,"class","flex-1 px-2 bg-white hover:bg-nl hover:text-white"),I(o,"class",c=mr(`px-2 bg-white h-7 border-l border-black self-end hover:text-white ${t[2]?"hover:bg-red-500":"hover:bg-nl"}`)+" svelte-9d72rf"),I(n,"class","w-full border-b border-black flex flex-wrap justify-end box-content"),I(k,"class","text-sm font-bold block mb-2"),I(_,"type","text"),I(_,"name","cardText"),I(_,"placeholder","&MF"),I(_,"autocomplete","off"),_.required=!0,I(_,"class","mb-2 form-input"),I(T,"class","text-sm font-bold block pr-4"),I(R,"type","checkbox"),I(R,"name","icon"),I(E,"class","flex mb-4"),I(q,"type","submit"),q.value="create",I(q,"class","border border-black bg-white text-black hover:bg-green-500 hover:text-white font-bold py-1 px-3 rounded"),I(G,"type","button"),I(G,"class","border border-black bg-white text-black hover:bg-red-500 hover:text-white font-bold py-1 px-3 rounded"),I(v,"class","bg-white"),I(d,"class","p-2 h-full border border-black bg-white flex justify-around gap-2 items-center"),I(p,"class","p-6 absolute bg-gray-300 bg-opacity-90 w-full h-full z-10"),$t(p,"hidden",!t[3]),I(Ie,"class","p-2"),I(f,"class","relative"),I(e,"class",ne=mr(`${t[1]} relative`)+" svelte-9d72rf")},m(se,re){j(se,e,re),C(e,n),C(n,r),C(n,s),de&&de.m(n,null),C(n,i),C(n,o),C(o,l),C(e,u),C(e,f),C(f,p),C(p,d),Te(h,d,null),C(d,m),C(d,v),C(v,g),C(g,y),C(y,k),C(y,b),C(y,_),Ln(_,t[4].text),C(g,w),C(g,E),C(E,T),C(E,A),C(E,R),R.checked=t[4].emoji,C(g,D),C(g,q),C(g,O),C(g,G),C(f,L),C(f,Ie),me[Q].m(Ie,null),ae=!0,ce||(ge=[Y(r,"click",t[12]),Y(o,"click",t[13]),Y(_,"input",t[14]),Y(R,"change",t[15]),Y(G,"click",t[16]),Y(g,"submit",Qt(wn(t[8])))],ce=!0)},p(se,[re]){se[2]?de?de.p(se,re):(de=qu(se),de.c(),de.m(n,i)):de&&(de.d(1),de=null),(!ae||re&4)&&a!==(a=se[2]?"Cancel":"Edit")&&be(l,a),(!ae||re&4&&c!==(c=mr(`px-2 bg-white h-7 border-l border-black self-end hover:text-white ${se[2]?"hover:bg-red-500":"hover:bg-nl"}`)+" svelte-9d72rf"))&&I(o,"class",c);const vt={};re&16&&(vt.text=se[4].text),re&16&&(vt.emoji=se[4].emoji),h.$set(vt),re&16&&_.value!==se[4].text&&Ln(_,se[4].text),re&16&&(R.checked=se[4].emoji),re&8&&$t(p,"hidden",!se[3]);let Jt=Q;Q=Lt(se),Q===Jt?me[Q].p(se,re):(Tt(),te(me[Jt],1,1,()=>{me[Jt]=null}),kt(),F=me[Q],F?F.p(se,re):(F=me[Q]=ht[Q](se),F.c()),X(F,1),F.m(Ie,null)),(!ae||re&2&&ne!==(ne=mr(`${se[1]} relative`)+" svelte-9d72rf"))&&I(e,"class",ne)},i(se){ae||(X(h.$$.fragment,se),X(F),ae=!0)},o(se){te(h.$$.fragment,se),te(F),ae=!1},d(se){se&&B(e),de&&de.d(),ke(h),me[Q].d(),ce=!1,Ke(ge)}}}function N2(t,e,n){let r;Ut(t,cn,T=>n(20,r=T));let{cardDeck:s=[]}=e,{class:i=""}=e,{id:o=""}=e,{nickID:a=""}=e,l=!1,c=!1;const u={text:"X",emoji:!1};let f={...u},p;const d=T=>{if(r)return;const A=Ge(He,"room",o);ln(A,{people:{[a]:{card:T.detail}}},{merge:!0})},h=()=>{n(5,p=[...p,{text:f.text,emoji:f.emoji}]),n(3,c=!1),n(4,f={...u})},m=async()=>{const T=Ge(He,"room",o);let A=p.slice(),R=[];for(const D of s){const q=A.length;A=A.filter(O=>!C2(O,D)),A.length==q&&(R=[...R,D])}try{await ia(T,{cards:pw(...R)}),await ia(T,{cards:dw(...A)})}catch(D){console.error(D)}n(3,c=!1),n(4,f={...u}),n(2,l=!1)},v=()=>d({detail:""}),g=()=>{l?(n(3,c=!1),n(4,f={...u})):n(5,p=s.slice()),n(2,l=!l)};function y(){f.text=this.value,n(4,f)}function k(){f.emoji=this.checked,n(4,f)}const b=()=>{n(3,c=!1),n(4,f={...u})},_=T=>{n(5,p=[...p.filter((A,R)=>R!==T)])},w=()=>{n(3,c=!0)},E=(T,A)=>Hp(T.text,A.text);return t.$$set=T=>{"cardDeck"in T&&n(0,s=T.cardDeck),"class"in T&&n(1,i=T.class),"id"in T&&n(10,o=T.id),"nickID"in T&&n(11,a=T.nickID)},[s,i,l,c,f,p,u,d,h,m,o,a,v,g,y,k,b,_,w,E]}class x2 extends We{constructor(e){super(),Qe(this,e,N2,R2,Ue,{cardDeck:0,class:1,id:10,nickID:11})}}var zp={},Rl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.QRMath=t.QRUtil=t.QRMaskPattern=t.QRErrorCorrectLevel=t.QRCodeModel=void 0;function e(d,h,m){var v=r(h),g=d-1,y=0;switch(m){case t.QRErrorCorrectLevel.L:y=p[g][0];break;case t.QRErrorCorrectLevel.M:y=p[g][1];break;case t.QRErrorCorrectLevel.Q:y=p[g][2];break;case t.QRErrorCorrectLevel.H:y=p[g][3];break}return v<=y}function n(d,h){for(var m=1,v=r(d),g=0,y=p.length;g<y;g++){var k=0;switch(h){case t.QRErrorCorrectLevel.L:k=p[g][0];break;case t.QRErrorCorrectLevel.M:k=p[g][1];break;case t.QRErrorCorrectLevel.Q:k=p[g][2];break;case t.QRErrorCorrectLevel.H:k=p[g][3];break}if(v<=k)break;m++}if(m>p.length)throw new Error("Too long data");return m}function r(d){var h=encodeURI(d).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return h.length+(h.length!=Number(d)?3:0)}var s=function(){function d(h){this.mode=o.MODE_8BIT_BYTE,this.parsedData=[],this.data=h;for(var m=[],v=0,g=this.data.length;v<g;v++){var y=[],k=this.data.charCodeAt(v);k>65536?(y[0]=240|(k&1835008)>>>18,y[1]=128|(k&258048)>>>12,y[2]=128|(k&4032)>>>6,y[3]=128|k&63):k>2048?(y[0]=224|(k&61440)>>>12,y[1]=128|(k&4032)>>>6,y[2]=128|k&63):k>128?(y[0]=192|(k&1984)>>>6,y[1]=128|k&63):y[0]=k,m.push(y)}this.parsedData=Array.prototype.concat.apply([],m),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return d.prototype.getLength=function(){return this.parsedData.length},d.prototype.write=function(h){for(var m=0,v=this.parsedData.length;m<v;m++)h.put(this.parsedData[m],8)},d}(),i=function(){function d(h,m){h===void 0&&(h=-1),m===void 0&&(m=t.QRErrorCorrectLevel.L),this.moduleCount=0,this.dataList=[],this.typeNumber=h,this.errorCorrectLevel=m,this.moduleCount=0,this.dataList=[]}return d.prototype.addData=function(h){if(this.typeNumber<=0)this.typeNumber=n(h,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error("Invalid QR version: "+this.typeNumber);if(!e(this.typeNumber,h,this.errorCorrectLevel))throw new Error("Data is too long for QR version: "+this.typeNumber)}var m=new s(h);this.dataList.push(m),this.dataCache=void 0},d.prototype.isDark=function(h,m){if(h<0||this.moduleCount<=h||m<0||this.moduleCount<=m)throw new Error(h+","+m);return this.modules[h][m]},d.prototype.getModuleCount=function(){return this.moduleCount},d.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},d.prototype.makeImpl=function(h,m){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var v=0;v<this.moduleCount;v++){this.modules[v]=new Array(this.moduleCount);for(var g=0;g<this.moduleCount;g++)this.modules[v][g]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(h,m),this.typeNumber>=7&&this.setupTypeNumber(h),this.dataCache==null&&(this.dataCache=d.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,m)},d.prototype.setupPositionProbePattern=function(h,m){for(var v=-1;v<=7;v++)if(!(h+v<=-1||this.moduleCount<=h+v))for(var g=-1;g<=7;g++)m+g<=-1||this.moduleCount<=m+g||(0<=v&&v<=6&&(g==0||g==6)||0<=g&&g<=6&&(v==0||v==6)||2<=v&&v<=4&&2<=g&&g<=4?this.modules[h+v][m+g]=!0:this.modules[h+v][m+g]=!1)},d.prototype.getBestMaskPattern=function(){if(Number.isInteger(this.maskPattern)&&Object.values(t.QRMaskPattern).includes(this.maskPattern))return this.maskPattern;for(var h=0,m=0,v=0;v<8;v++){this.makeImpl(!0,v);var g=a.getLostPoint(this);(v==0||h>g)&&(h=g,m=v)}return m},d.prototype.setupTimingPattern=function(){for(var h=8;h<this.moduleCount-8;h++)this.modules[h][6]==null&&(this.modules[h][6]=h%2==0);for(var m=8;m<this.moduleCount-8;m++)this.modules[6][m]==null&&(this.modules[6][m]=m%2==0)},d.prototype.setupPositionAdjustPattern=function(){for(var h=a.getPatternPosition(this.typeNumber),m=0;m<h.length;m++)for(var v=0;v<h.length;v++){var g=h[m],y=h[v];if(this.modules[g][y]==null)for(var k=-2;k<=2;k++)for(var b=-2;b<=2;b++)k==-2||k==2||b==-2||b==2||k==0&&b==0?this.modules[g+k][y+b]=!0:this.modules[g+k][y+b]=!1}},d.prototype.setupTypeNumber=function(h){for(var m=a.getBCHTypeNumber(this.typeNumber),v=0;v<18;v++){var g=!h&&(m>>v&1)==1;this.modules[Math.floor(v/3)][v%3+this.moduleCount-8-3]=g}for(var v=0;v<18;v++){var g=!h&&(m>>v&1)==1;this.modules[v%3+this.moduleCount-8-3][Math.floor(v/3)]=g}},d.prototype.setupTypeInfo=function(h,m){for(var v=this.errorCorrectLevel<<3|m,g=a.getBCHTypeInfo(v),y=0;y<15;y++){var k=!h&&(g>>y&1)==1;y<6?this.modules[y][8]=k:y<8?this.modules[y+1][8]=k:this.modules[this.moduleCount-15+y][8]=k}for(var y=0;y<15;y++){var k=!h&&(g>>y&1)==1;y<8?this.modules[8][this.moduleCount-y-1]=k:y<9?this.modules[8][15-y-1+1]=k:this.modules[8][15-y-1]=k}this.modules[this.moduleCount-8][8]=!h},d.prototype.mapData=function(h,m){for(var v=-1,g=this.moduleCount-1,y=7,k=0,b=this.moduleCount-1;b>0;b-=2)for(b==6&&b--;;){for(var _=0;_<2;_++)if(this.modules[g][b-_]==null){var w=!1;k<h.length&&(w=(h[k]>>>y&1)==1);var E=a.getMask(m,g,b-_);E&&(w=!w),this.modules[g][b-_]=w,y--,y==-1&&(k++,y=7)}if(g+=v,g<0||this.moduleCount<=g){g-=v,v=-v;break}}},d.createData=function(h,m,v){for(var g=u.getRSBlocks(h,m),y=new f,k=0;k<v.length;k++){var b=v[k];y.put(b.mode,4),y.put(b.getLength(),a.getLengthInBits(b.mode,h)),b.write(y)}for(var _=0,k=0;k<g.length;k++)_+=g[k].dataCount;if(y.getLengthInBits()>_*8)throw new Error("code length overflow. ("+y.getLengthInBits()+">"+_*8+")");for(y.getLengthInBits()+4<=_*8&&y.put(0,4);y.getLengthInBits()%8!=0;)y.putBit(!1);for(;!(y.getLengthInBits()>=_*8||(y.put(d.PAD0,8),y.getLengthInBits()>=_*8));)y.put(d.PAD1,8);return d.createBytes(y,g)},d.createBytes=function(h,m){for(var v=0,g=0,y=0,k=new Array(m.length),b=new Array(m.length),_=0;_<m.length;_++){var w=m[_].dataCount,E=m[_].totalCount-w;g=Math.max(g,w),y=Math.max(y,E),k[_]=new Array(w);for(var T=0;T<k[_].length;T++)k[_][T]=255&h.buffer[T+v];v+=w;var A=a.getErrorCorrectPolynomial(E),R=new c(k[_],A.getLength()-1),D=R.mod(A);b[_]=new Array(A.getLength()-1);for(var T=0;T<b[_].length;T++){var q=T+D.getLength()-b[_].length;b[_][T]=q>=0?D.get(q):0}}for(var O=0,T=0;T<m.length;T++)O+=m[T].totalCount;for(var G=new Array(O),L=0,T=0;T<g;T++)for(var _=0;_<m.length;_++)T<k[_].length&&(G[L++]=k[_][T]);for(var T=0;T<y;T++)for(var _=0;_<m.length;_++)T<b[_].length&&(G[L++]=b[_][T]);return G},d.PAD0=236,d.PAD1=17,d}();t.QRCodeModel=i,t.QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var o={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};t.QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var a=function(){function d(){}return d.getBCHTypeInfo=function(h){for(var m=h<<10;d.getBCHDigit(m)-d.getBCHDigit(d.G15)>=0;)m^=d.G15<<d.getBCHDigit(m)-d.getBCHDigit(d.G15);return(h<<10|m)^d.G15_MASK},d.getBCHTypeNumber=function(h){for(var m=h<<12;d.getBCHDigit(m)-d.getBCHDigit(d.G18)>=0;)m^=d.G18<<d.getBCHDigit(m)-d.getBCHDigit(d.G18);return h<<12|m},d.getBCHDigit=function(h){for(var m=0;h!=0;)m++,h>>>=1;return m},d.getPatternPosition=function(h){return d.PATTERN_POSITION_TABLE[h-1]},d.getMask=function(h,m,v){switch(h){case t.QRMaskPattern.PATTERN000:return(m+v)%2==0;case t.QRMaskPattern.PATTERN001:return m%2==0;case t.QRMaskPattern.PATTERN010:return v%3==0;case t.QRMaskPattern.PATTERN011:return(m+v)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(m/2)+Math.floor(v/3))%2==0;case t.QRMaskPattern.PATTERN101:return m*v%2+m*v%3==0;case t.QRMaskPattern.PATTERN110:return(m*v%2+m*v%3)%2==0;case t.QRMaskPattern.PATTERN111:return(m*v%3+(m+v)%2)%2==0;default:throw new Error("bad maskPattern:"+h)}},d.getErrorCorrectPolynomial=function(h){for(var m=new c([1],0),v=0;v<h;v++)m=m.multiply(new c([1,l.gexp(v)],0));return m},d.getLengthInBits=function(h,m){if(1<=m&&m<10)switch(h){case o.MODE_NUMBER:return 10;case o.MODE_ALPHA_NUM:return 9;case o.MODE_8BIT_BYTE:return 8;case o.MODE_KANJI:return 8;default:throw new Error("mode:"+h)}else if(m<27)switch(h){case o.MODE_NUMBER:return 12;case o.MODE_ALPHA_NUM:return 11;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 10;default:throw new Error("mode:"+h)}else if(m<41)switch(h){case o.MODE_NUMBER:return 14;case o.MODE_ALPHA_NUM:return 13;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 12;default:throw new Error("mode:"+h)}else throw new Error("type:"+m)},d.getLostPoint=function(h){for(var m=h.getModuleCount(),v=0,g=0;g<m;g++)for(var y=0;y<m;y++){for(var k=0,b=h.isDark(g,y),_=-1;_<=1;_++)if(!(g+_<0||m<=g+_))for(var w=-1;w<=1;w++)y+w<0||m<=y+w||_==0&&w==0||b==h.isDark(g+_,y+w)&&k++;k>5&&(v+=3+k-5)}for(var g=0;g<m-1;g++)for(var y=0;y<m-1;y++){var E=0;h.isDark(g,y)&&E++,h.isDark(g+1,y)&&E++,h.isDark(g,y+1)&&E++,h.isDark(g+1,y+1)&&E++,(E==0||E==4)&&(v+=3)}for(var g=0;g<m;g++)for(var y=0;y<m-6;y++)h.isDark(g,y)&&!h.isDark(g,y+1)&&h.isDark(g,y+2)&&h.isDark(g,y+3)&&h.isDark(g,y+4)&&!h.isDark(g,y+5)&&h.isDark(g,y+6)&&(v+=40);for(var y=0;y<m;y++)for(var g=0;g<m-6;g++)h.isDark(g,y)&&!h.isDark(g+1,y)&&h.isDark(g+2,y)&&h.isDark(g+3,y)&&h.isDark(g+4,y)&&!h.isDark(g+5,y)&&h.isDark(g+6,y)&&(v+=40);for(var T=0,y=0;y<m;y++)for(var g=0;g<m;g++)h.isDark(g,y)&&T++;var A=Math.abs(100*T/m/m-50)/5;return v+=A*10,v},d.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],d.G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,d.G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,d.G15_MASK=1<<14|1<<12|1<<10|1<<4|1<<1,d}();t.QRUtil=a;var l=function(){function d(){}return d.glog=function(h){if(h<1)throw new Error("glog("+h+")");return d.LOG_TABLE[h]},d.gexp=function(h){for(;h<0;)h+=255;for(;h>=256;)h-=255;return d.EXP_TABLE[h]},d.EXP_TABLE=new Array(256),d.LOG_TABLE=new Array(256),d._constructor=function(){for(var h=0;h<8;h++)d.EXP_TABLE[h]=1<<h;for(var h=8;h<256;h++)d.EXP_TABLE[h]=d.EXP_TABLE[h-4]^d.EXP_TABLE[h-5]^d.EXP_TABLE[h-6]^d.EXP_TABLE[h-8];for(var h=0;h<255;h++)d.LOG_TABLE[d.EXP_TABLE[h]]=h}(),d}();t.QRMath=l;var c=function(){function d(h,m){if(h.length==null)throw new Error(h.length+"/"+m);for(var v=0;v<h.length&&h[v]==0;)v++;this.num=new Array(h.length-v+m);for(var g=0;g<h.length-v;g++)this.num[g]=h[g+v]}return d.prototype.get=function(h){return this.num[h]},d.prototype.getLength=function(){return this.num.length},d.prototype.multiply=function(h){for(var m=new Array(this.getLength()+h.getLength()-1),v=0;v<this.getLength();v++)for(var g=0;g<h.getLength();g++)m[v+g]^=l.gexp(l.glog(this.get(v))+l.glog(h.get(g)));return new d(m,0)},d.prototype.mod=function(h){if(this.getLength()-h.getLength()<0)return this;for(var m=l.glog(this.get(0))-l.glog(h.get(0)),v=new Array(this.getLength()),g=0;g<this.getLength();g++)v[g]=this.get(g);for(var g=0;g<h.getLength();g++)v[g]^=l.gexp(l.glog(h.get(g))+m);return new d(v,0).mod(h)},d}(),u=function(){function d(h,m){this.totalCount=h,this.dataCount=m}return d.getRSBlocks=function(h,m){var v=d.getRsBlockTable(h,m);if(v==null)throw new Error("bad rs block @ typeNumber:"+h+"/errorCorrectLevel:"+m);for(var g=v.length/3,y=[],k=0;k<g;k++)for(var b=v[k*3+0],_=v[k*3+1],w=v[k*3+2],E=0;E<b;E++)y.push(new d(_,w));return y},d.getRsBlockTable=function(h,m){switch(m){case t.QRErrorCorrectLevel.L:return d.RS_BLOCK_TABLE[(h-1)*4+0];case t.QRErrorCorrectLevel.M:return d.RS_BLOCK_TABLE[(h-1)*4+1];case t.QRErrorCorrectLevel.Q:return d.RS_BLOCK_TABLE[(h-1)*4+2];case t.QRErrorCorrectLevel.H:return d.RS_BLOCK_TABLE[(h-1)*4+3];default:return}},d.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],d}(),f=function(){function d(){this.buffer=[],this.length=0}return d.prototype.get=function(h){var m=Math.floor(h/8);return(this.buffer[m]>>>7-h%8&1)==1},d.prototype.put=function(h,m){for(var v=0;v<m;v++)this.putBit((h>>>m-v-1&1)==1)},d.prototype.getLengthInBits=function(){return this.length},d.prototype.putBit=function(h){var m=Math.floor(this.length/8);this.buffer.length<=m&&this.buffer.push(0),h&&(this.buffer[m]|=128>>>this.length%8),this.length++},d}(),p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]]})(Rl);var qi={},os={};const O2="bold|bolder|lighter|[1-9]00",L2="italic|oblique",M2="small-caps",P2="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",F2="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",zu=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,B2=new RegExp(`(${O2}) +`,"i"),j2=new RegExp(`(${L2}) +`,"i"),V2=new RegExp(`(${M2}) +`,"i"),U2=new RegExp(`(${P2}) +`,"i"),$2=new RegExp(`([\\d\\.]+)(${F2}) *((?:${zu})( *, *(?:${zu}))*)`),So={},q2=16;var G2=t=>{if(So[t])return So[t];const e=$2.exec(t);if(!e)return;const n={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(e[1]),unit:e[2],family:e[3].replace(/["']/g,"").replace(/ *, */g,",")};let r,s,i,o;const a=t.substring(0,e.index);switch((r=B2.exec(a))&&(n.weight=r[1]),(s=j2.exec(a))&&(n.style=s[1]),(i=V2.exec(a))&&(n.variant=i[1]),(o=U2.exec(a))&&(n.stretch=o[1]),n.unit){case"pt":n.size/=.75;break;case"pc":n.size*=16;break;case"in":n.size*=96;break;case"cm":n.size*=96/2.54;break;case"mm":n.size*=96/25.4;break;case"%":break;case"em":case"rem":n.size*=q2/.75;break;case"q":n.size*=96/25.4/4;break}return So[t]=n};const H2=G2;os.parseFont=H2;os.createCanvas=function(t,e){return Object.assign(document.createElement("canvas"),{width:t,height:e})};os.createImageData=function(t,e,n){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(t);case 2:return new ImageData(t,e);default:return new ImageData(t,e,n)}};os.loadImage=function(t,e){return new Promise(function(n,r){const s=Object.assign(document.createElement("img"),e);function i(){s.onload=null,s.onerror=null}s.onload=function(){i(),n(s)},s.onerror=function(){i(),r(new Error('Failed to load the image "'+t+'"'))},s.src=t})};var Kp={},Qp={},Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.loop=Dt.conditional=Dt.parse=void 0;var z2=function t(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;if(Array.isArray(n))n.forEach(function(o){return t(e,o,r,s)});else if(typeof n=="function")n(e,r,s,t);else{var i=Object.keys(n)[0];Array.isArray(n[i])?(s[i]={},t(e,n[i],r,s[i])):s[i]=n[i](e,r,s,t)}return r};Dt.parse=z2;var K2=function(e,n){return function(r,s,i,o){n(r,s,i)&&o(r,e,s,i)}};Dt.conditional=K2;var Q2=function(e,n){return function(r,s,i,o){for(var a=[],l=r.pos;n(r,s,i);){var c={};if(o(r,e,s,c),r.pos===l)break;l=r.pos,a.push(c)}return a}};Dt.loop=Q2;var we={};Object.defineProperty(we,"__esModule",{value:!0});we.readBits=we.readArray=we.readUnsigned=we.readString=we.peekBytes=we.readBytes=we.peekByte=we.readByte=we.buildStream=void 0;var W2=function(e){return{data:e,pos:0}};we.buildStream=W2;var Wp=function(){return function(e){return e.data[e.pos++]}};we.readByte=Wp;var X2=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(n){return n.data[n.pos+e]}};we.peekByte=X2;var Gi=function(e){return function(n){return n.data.subarray(n.pos,n.pos+=e)}};we.readBytes=Gi;var Y2=function(e){return function(n){return n.data.subarray(n.pos,n.pos+e)}};we.peekBytes=Y2;var J2=function(e){return function(n){return Array.from(Gi(e)(n)).map(function(r){return String.fromCharCode(r)}).join("")}};we.readString=J2;var Z2=function(e){return function(n){var r=Gi(2)(n);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};we.readUnsigned=Z2;var eA=function(e,n){return function(r,s,i){for(var o=typeof n=="function"?n(r,s,i):n,a=Gi(e),l=new Array(o),c=0;c<o;c++)l[c]=a(r);return l}};we.readArray=eA;var tA=function(e,n,r){for(var s=0,i=0;i<r;i++)s+=e[n+i]&&Math.pow(2,r-i-1);return s},nA=function(e){return function(n){for(var r=Wp()(n),s=new Array(8),i=0;i<8;i++)s[7-i]=!!(r&1<<i);return Object.keys(e).reduce(function(o,a){var l=e[a];return l.length?o[a]=tA(s,l.index,l.length):o[a]=s[l.index],o},{})}};we.readBits=nA;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=Dt,n=we,r={blocks:function(p){for(var d=0,h=[],m=p.data.length,v=0,g=(0,n.readByte)()(p);g!==d&&g;g=(0,n.readByte)()(p)){if(p.pos+g>=m){var y=m-p.pos;h.push((0,n.readBytes)(y)(p)),v+=y;break}h.push((0,n.readBytes)(g)(p)),v+=g}for(var k=new Uint8Array(v),b=0,_=0;_<h.length;_++)k.set(h[_],b),b+=h[_].length;return k}},s=(0,e.conditional)({gce:[{codes:(0,n.readBytes)(2)},{byteSize:(0,n.readByte)()},{extras:(0,n.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,n.readUnsigned)(!0)},{transparentColorIndex:(0,n.readByte)()},{terminator:(0,n.readByte)()}]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===249}),i=(0,e.conditional)({image:[{code:(0,n.readByte)()},{descriptor:[{left:(0,n.readUnsigned)(!0)},{top:(0,n.readUnsigned)(!0)},{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{lct:(0,n.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,n.readArray)(3,function(f,p,d){return Math.pow(2,d.descriptor.lct.size+1)})},function(f,p,d){return d.descriptor.lct.exists}),{data:[{minCodeSize:(0,n.readByte)()},r]}]},function(f){return(0,n.peekByte)()(f)===44}),o=(0,e.conditional)({text:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{preData:function(p,d,h){return(0,n.readBytes)(h.text.blockSize)(p)}},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===1}),a=(0,e.conditional)({application:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{id:function(p,d,h){return(0,n.readString)(h.blockSize)(p)}},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===255}),l=(0,e.conditional)({comment:[{codes:(0,n.readBytes)(2)},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===254}),c=[{header:[{signature:(0,n.readString)(3)},{version:(0,n.readString)(3)}]},{lsd:[{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{gct:(0,n.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,n.readByte)()},{pixelAspectRatio:(0,n.readByte)()}]},(0,e.conditional)({gct:(0,n.readArray)(3,function(f,p){return Math.pow(2,p.lsd.gct.size+1)})},function(f,p){return p.lsd.gct.exists}),{frames:(0,e.loop)([s,a,l,i,o],function(f){var p=(0,n.peekByte)()(f);return p===33||p===44})}],u=c;t.default=u})(Qp);var Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});Hi.deinterlace=void 0;Hi.deinterlace=function(t,e){for(var n=new Array(t.length),r=t.length/e,s=function(u,f){var p=t.slice(f*e,(f+1)*e);n.splice.apply(n,[u*e,e].concat(p))},i=[0,4,2,1],o=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=i[l];c<r;c+=o[l])s(c,a),a++;return n};var zi={};Object.defineProperty(zi,"__esModule",{value:!0});zi.lzw=void 0;zi.lzw=function(t,e,n){var r=4096,s=-1,i=n,o,a,l,c,u,f,p,_,d,h,b,m,w,E,A,T,v=new Array(n),g=new Array(r),y=new Array(r),k=new Array(r+1);for(m=t,a=1<<m,u=a+1,o=a+2,p=s,c=m+1,l=(1<<c)-1,d=0;d<a;d++)g[d]=0,y[d]=d;var b,_,w,E,T,A;for(b=_=w=E=T=A=0,h=0;h<i;){if(E===0){if(_<c){b+=e[A]<<_,_+=8,A++;continue}if(d=b&l,b>>=c,_-=c,d>o||d==u)break;if(d==a){c=m+1,l=(1<<c)-1,o=a+2,p=s;continue}if(p==s){k[E++]=y[d],p=d,w=d;continue}for(f=d,d==o&&(k[E++]=w,d=p);d>a;)k[E++]=y[d],d=g[d];w=y[d]&255,k[E++]=w,o<r&&(g[o]=p,y[o]=w,o++,(o&l)===0&&o<r&&(c++,l+=o)),p=f}E--,v[T++]=k[E],h++}for(h=T;h<i;h++)v[h]=0;return v};(function(t){var e=Oe&&Oe.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(t,"__esModule",{value:!0}),t.decompressFrames=t.decompressFrame=t.parseGIF=void 0;var n=e(Qp),r=Dt,s=we,i=Hi,o=zi;t.parseGIF=function(l){var c=new Uint8Array(l);return r.parse(s.buildStream(c),n.default)};var a=function(l){for(var c=l.pixels.length,u=new Uint8ClampedArray(c*4),f=0;f<c;f++){var p=f*4,d=l.pixels[f],h=l.colorTable[d];u[p]=h[0],u[p+1]=h[1],u[p+2]=h[2],u[p+3]=d!==l.transparentIndex?255:0}return u};t.decompressFrame=function(l,c,u){if(!l.image){console.warn("gif frame does not have associated image.");return}var f=l.image,p=f.descriptor.width*f.descriptor.height,d=o.lzw(f.data.minCodeSize,f.data.blocks,p);f.descriptor.lct.interlaced&&(d=i.deinterlace(d,f.descriptor.width));var h={pixels:d,dims:{top:l.image.descriptor.top,left:l.image.descriptor.left,width:l.image.descriptor.width,height:l.image.descriptor.height}};return f.descriptor.lct&&f.descriptor.lct.exists?h.colorTable=f.lct:h.colorTable=c,l.gce&&(h.delay=(l.gce.delay||10)*10,h.disposalType=l.gce.extras.disposal,l.gce.extras.transparentColorGiven&&(h.transparentIndex=l.gce.transparentColorIndex)),u&&(h.patch=a(h)),h},t.decompressFrames=function(l,c){return l.frames.filter(function(u){return u.image}).map(function(u){return t.decompressFrame(u,l.gct,c)})}})(Kp);var rA=100,Ne=256,Ku=Ne-1,Ft=4,Xp=16,Nl=1<<Xp,Yp=10,xl=10,sA=Nl>>xl,iA=Nl<<Yp-xl,oA=Ne>>3,da=6,aA=1<<da,lA=oA*aA,cA=30,Jp=10,Ts=1<<Jp,Zp=8,Qu=1<<Zp,uA=Jp+Zp,Dn=1<<uA,Wu=499,Xu=491,Yu=487,eg=503,hA=3*eg;function fA(t,e){var n,r,s,i,o;function a(){n=[],r=new Int32Array(256),s=new Int32Array(Ne),i=new Int32Array(Ne),o=new Int32Array(Ne>>3);var g,y;for(g=0;g<Ne;g++)y=(g<<Ft+8)/Ne,n[g]=new Float64Array([y,y,y,0]),i[g]=Nl/Ne,s[g]=0}function l(){for(var g=0;g<Ne;g++)n[g][0]>>=Ft,n[g][1]>>=Ft,n[g][2]>>=Ft,n[g][3]=g}function c(g,y,k,b,_){n[y][0]-=g*(n[y][0]-k)/Ts,n[y][1]-=g*(n[y][1]-b)/Ts,n[y][2]-=g*(n[y][2]-_)/Ts}function u(g,y,k,b,_){for(var w=Math.abs(y-g),E=Math.min(y+g,Ne),T=y+1,A=y-1,R=1,D,q;T<E||A>w;)q=o[R++],T<E&&(D=n[T++],D[0]-=q*(D[0]-k)/Dn,D[1]-=q*(D[1]-b)/Dn,D[2]-=q*(D[2]-_)/Dn),A>w&&(D=n[A--],D[0]-=q*(D[0]-k)/Dn,D[1]-=q*(D[1]-b)/Dn,D[2]-=q*(D[2]-_)/Dn)}function f(g,y,k){var b=2147483647,_=b,w=-1,E=w,T,A,R,D,q;for(T=0;T<Ne;T++)A=n[T],R=Math.abs(A[0]-g)+Math.abs(A[1]-y)+Math.abs(A[2]-k),R<b&&(b=R,w=T),D=R-(s[T]>>Xp-Ft),D<_&&(_=D,E=T),q=i[T]>>xl,i[T]-=q,s[T]+=q<<Yp;return i[w]+=sA,s[w]-=iA,E}function p(){var g,y,k,b,_,w,E=0,T=0;for(g=0;g<Ne;g++){for(k=n[g],_=g,w=k[1],y=g+1;y<Ne;y++)b=n[y],b[1]<w&&(_=y,w=b[1]);if(b=n[_],g!=_&&(y=b[0],b[0]=k[0],k[0]=y,y=b[1],b[1]=k[1],k[1]=y,y=b[2],b[2]=k[2],k[2]=y,y=b[3],b[3]=k[3],k[3]=y),w!=E){for(r[E]=T+g>>1,y=E+1;y<w;y++)r[y]=g;E=w,T=g}}for(r[E]=T+Ku>>1,y=E+1;y<256;y++)r[y]=Ku}function d(g,y,k){for(var b,_,w,E=1e3,T=-1,A=r[y],R=A-1;A<Ne||R>=0;)A<Ne&&(_=n[A],w=_[1]-y,w>=E?A=Ne:(A++,w<0&&(w=-w),b=_[0]-g,b<0&&(b=-b),w+=b,w<E&&(b=_[2]-k,b<0&&(b=-b),w+=b,w<E&&(E=w,T=_[3])))),R>=0&&(_=n[R],w=y-_[1],w>=E?R=-1:(R--,w<0&&(w=-w),b=_[0]-g,b<0&&(b=-b),w+=b,w<E&&(b=_[2]-k,b<0&&(b=-b),w+=b,w<E&&(E=w,T=_[3]))));return T}function h(){var g,y=t.length,k=30+(e-1)/3,b=y/(3*e),_=~~(b/rA),w=Ts,E=lA,T=E>>da;for(T<=1&&(T=0),g=0;g<T;g++)o[g]=w*((T*T-g*g)*Qu/(T*T));var A;y<hA?(e=1,A=3):y%Wu!==0?A=3*Wu:y%Xu!==0?A=3*Xu:y%Yu!==0?A=3*Yu:A=3*eg;var R,D,q,O,G=0;for(g=0;g<b;)if(R=(t[G]&255)<<Ft,D=(t[G+1]&255)<<Ft,q=(t[G+2]&255)<<Ft,O=f(R,D,q),c(w,O,R,D,q),T!==0&&u(T,O,R,D,q),G+=A,G>=y&&(G-=y),g++,_===0&&(_=1),g%_===0)for(w-=w/k,E-=E/cA,T=E>>da,T<=1&&(T=0),O=0;O<T;O++)o[O]=w*((T*T-O*O)*Qu/(T*T))}function m(){a(),h(),l(),p()}this.buildColormap=m;function v(){for(var g=[],y=[],k=0;k<Ne;k++)y[n[k][3]]=k;for(var b=0,_=0;_<Ne;_++){var w=y[_];g[b++]=n[w][0],g[b++]=n[w][1],g[b++]=n[w][2]}return g}this.getColormap=v,this.lookupRGB=d}var dA=fA,Ju=-1,ks=12,gr=5003,pA=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function gA(t,e,n,r){var s=Math.max(2,r),i=new Uint8Array(256),o=new Int32Array(gr),a=new Int32Array(gr),l,c=0,u,f=0,p,d=!1,h,m,v,g,y,k;function b(O,G){i[u++]=O,u>=254&&A(G)}function _(O){w(gr),f=m+2,d=!0,q(m,O)}function w(O){for(var G=0;G<O;++G)o[G]=-1}function E(O,G){var L,Ie,Q,F,ne,ae,ce;for(h=O,d=!1,k=h,p=R(k),m=1<<O-1,v=m+1,f=m+2,u=0,F=D(),ce=0,L=gr;L<65536;L*=2)++ce;ce=8-ce,ae=gr,w(ae),q(m,G);e:for(;(Ie=D())!=Ju;){if(L=(Ie<<ks)+F,Q=Ie<<ce^F,o[Q]===L){F=a[Q];continue}else if(o[Q]>=0){ne=ae-Q,Q===0&&(ne=1);do if((Q-=ne)<0&&(Q+=ae),o[Q]===L){F=a[Q];continue e}while(o[Q]>=0)}q(F,G),F=Ie,f<1<<ks?(a[Q]=f++,o[Q]=L):_(G)}q(F,G),q(v,G)}function T(O){O.writeByte(s),g=t*e,y=0,E(s+1,O),O.writeByte(0)}function A(O){u>0&&(O.writeByte(u),O.writeBytes(i,0,u),u=0)}function R(O){return(1<<O)-1}function D(){if(g===0)return Ju;--g;var O=n[y++];return O&255}function q(O,G){for(l&=pA[c],c>0?l|=O<<c:l=O,c+=k;c>=8;)b(l&255,G),l>>=8,c-=8;if((f>p||d)&&(d?(p=R(k=h),d=!1):(++k,k==ks?p=1<<ks:p=R(k))),O==v){for(;c>0;)b(l&255,G),l>>=8,c-=8;A(G)}}this.encode=T}var mA=gA,yA=dA,vA=mA;function it(){this.page=-1,this.pages=[],this.newPage()}it.pageSize=4096;it.charMap={};for(var Cs=0;Cs<256;Cs++)it.charMap[Cs]=String.fromCharCode(Cs);it.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(it.pageSize),this.cursor=0};it.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var n=0;n<it.pageSize;n++)t+=it.charMap[this.pages[e][n]];return t};it.prototype.toFlattenUint8Array=function(){for(var t=[],e=0;e<this.pages.length;e++)if(e===this.pages.length-1){var n=Uint8Array.from(this.pages[e].slice(0,this.cursor));t.push(n)}else t.push(this.pages[e]);var r=new Uint8Array(t.reduce(function(s,i){return s+i.length},0));return t.reduce(function(s,i){return r.set(i,s),s+i.length},0),r};it.prototype.writeByte=function(t){this.cursor>=it.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t};it.prototype.writeUTFBytes=function(t){for(var e=t.length,n=0;n<e;n++)this.writeByte(t.charCodeAt(n))};it.prototype.writeBytes=function(t,e,n){for(var r=n||t.length,s=e||0;s<r;s++)this.writeByte(t[s])};function he(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new it}he.prototype.setDelay=function(t){this.delay=Math.round(t/10)};he.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)};he.prototype.setDispose=function(t){t>=0&&(this.dispose=t)};he.prototype.setRepeat=function(t){this.repeat=t};he.prototype.setTransparent=function(t){this.transparent=t};he.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};he.prototype.finish=function(){this.out.writeByte(59)};he.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t};he.prototype.setDither=function(t){t===!0&&(t="FloydSteinberg"),this.dither=t};he.prototype.setGlobalPalette=function(t){this.globalPalette=t};he.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};he.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};he.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new yA(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};he.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var n=0,r=0;r<e;r++){var s=this.findClosestRGB(this.pixels[n++]&255,this.pixels[n++]&255,this.pixels[n++]&255);this.usedEntry[s]=!0,this.indexedPixels[r]=s}};he.prototype.ditherPixels=function(t,e){var n={FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],Stucki:[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]};if(!t||!n[t])throw"Unknown dithering kernel: "+t;var r=n[t],s=0,i=this.height,o=this.width,a=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var c=0;c<i;c++){e&&(l=l*-1);for(var u=l==1?0:o-1,f=l==1?o:0;u!==f;u+=l){s=c*o+u;var p=s*3,d=a[p],h=a[p+1],m=a[p+2];p=this.findClosestRGB(d,h,m),this.usedEntry[p]=!0,this.indexedPixels[s]=p,p*=3;for(var v=this.colorTab[p],g=this.colorTab[p+1],y=this.colorTab[p+2],k=d-v,b=h-g,_=m-y,w=l==1?0:r.length-1,E=l==1?r.length:0;w!==E;w+=l){var T=r[w][1],A=r[w][2];if(T+u>=0&&T+u<o&&A+c>=0&&A+c<i){var R=r[w][0];p=s+T+A*o,p*=3,a[p]=Math.max(0,Math.min(255,a[p]+k*R)),a[p+1]=Math.max(0,Math.min(255,a[p+1]+b*R)),a[p+2]=Math.max(0,Math.min(255,a[p+2]+_*R))}}}}};he.prototype.findClosest=function(t,e){return this.findClosestRGB((t&16711680)>>16,(t&65280)>>8,t&255,e)};he.prototype.findClosestRGB=function(t,e,n,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,n);for(var s=0,i=256*256*256,o=this.colorTab.length,a=0,l=0;a<o;l++){var c=t-(this.colorTab[a++]&255),u=e-(this.colorTab[a++]&255),f=n-(this.colorTab[a++]&255),p=c*c+u*u+f*f;(!r||this.usedEntry[l])&&p<i&&(i=p,s=l)}return s};he.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var n=this.image,r=0,s=0,i=0;i<e;i++)for(var o=0;o<t;o++)this.pixels[s++]=n[r++],this.pixels[s++]=n[r++],this.pixels[s++]=n[r++],r++};he.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var t,e;this.transparent===null?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=this.dispose&7),e<<=2,this.out.writeByte(0|e|0|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};he.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)};he.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};he.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};he.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=3*256-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)};he.prototype.writeShort=function(t){this.out.writeByte(t&255),this.out.writeByte(t>>8&255)};he.prototype.writePixels=function(){var t=new vA(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)};he.prototype.stream=function(){return this.out};var bA=he,ri=Oe&&Oe.__assign||function(){return ri=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},ri.apply(this,arguments)},wA=Oe&&Oe.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})},_A=Oe&&Oe.__generator||function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,s=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],s=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},EA=Oe&&Oe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(qi,"__esModule",{value:!0});qi.AwesomeQR=void 0;var gt=os,Zu=Kp,Is=Rl,TA=EA(bA),As=.4,kA=function(){function t(e){var n=Object.assign({},e);if(Object.keys(t.defaultOptions).forEach(function(r){r in n||Object.defineProperty(n,r,{value:t.defaultOptions[r],enumerable:!0,writable:!0})}),n.components?typeof n.components=="object"&&Object.keys(t.defaultComponentOptions).forEach(function(r){r in n.components?Object.defineProperty(n.components,r,{value:ri(ri({},t.defaultComponentOptions[r]),n.components[r]),enumerable:!0,writable:!0}):Object.defineProperty(n.components,r,{value:t.defaultComponentOptions[r],enumerable:!0,writable:!0})}):n.components=t.defaultComponentOptions,n.dotScale!==null&&n.dotScale!==void 0){if(n.dotScale<=0||n.dotScale>1)throw new Error("dotScale should be in range (0, 1].");n.components.data.scale=n.dotScale,n.components.timing.scale=n.dotScale,n.components.alignment.scale=n.dotScale}this.options=n,this.canvas=gt.createCanvas(e.size,e.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new Is.QRCodeModel(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}return t.prototype.draw=function(){var e=this;return new Promise(function(n){return e._draw().then(n)})},t.prototype._clear=function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},t._prepareRoundedCornerClip=function(e,n,r,s,i,o){e.beginPath(),e.moveTo(n,r),e.arcTo(n+s,r,n+s,r+i,o),e.arcTo(n+s,r+i,n,r+i,o),e.arcTo(n,r+i,n,r,o),e.arcTo(n,r,n+s,r,o),e.closePath()},t._getAverageRGB=function(e){var n=5,r={r:0,g:0,b:0},s,i,o=-4,a={r:0,g:0,b:0},l=0;i=e.naturalHeight||e.height,s=e.naturalWidth||e.width;var c=gt.createCanvas(s,i),u=c.getContext("2d");if(!u)return r;u.drawImage(e,0,0);var f;try{f=u.getImageData(0,0,s,i)}catch{return r}for(;(o+=n*4)<f.data.length;)f.data[o]>200||f.data[o+1]>200||f.data[o+2]>200||(++l,a.r+=f.data[o],a.g+=f.data[o+1],a.b+=f.data[o+2]);return a.r=~~(a.r/l),a.g=~~(a.g/l),a.b=~~(a.b/l),a},t._drawDot=function(e,n,r,s,i,o){i===void 0&&(i=0),o===void 0&&(o=1),e.fillRect((n+i)*s,(r+i)*s,o*s,o*s)},t._drawAlignProtector=function(e,n,r,s){e.clearRect((n-2)*s,(r-2)*s,5*s,5*s),e.fillRect((n-2)*s,(r-2)*s,5*s,5*s)},t._drawAlign=function(e,n,r,s,i,o,a,l){i===void 0&&(i=0),o===void 0&&(o=1);var c=e.fillStyle;e.fillStyle=a,new Array(4).fill(0).map(function(u,f){t._drawDot(e,n-2+f,r-2,s,i,o),t._drawDot(e,n+2,r-2+f,s,i,o),t._drawDot(e,n+2-f,r+2,s,i,o),t._drawDot(e,n-2,r+2-f,s,i,o)}),t._drawDot(e,n,r,s,i,o),l||(e.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map(function(u,f){t._drawDot(e,n-1+f,r-1,s,i,o),t._drawDot(e,n+1,r-1+f,s,i,o),t._drawDot(e,n+1-f,r+1,s,i,o),t._drawDot(e,n-1,r+1-f,s,i,o)})),e.fillStyle=c},t.prototype._draw=function(){var e,n,r,s,i,o,a,l,c,u,f,p,d,h,m,v,g,y,k;return wA(this,void 0,void 0,function(){var b,_,w,E,T,A,R,D,q,O,G,L,Ie,Q,F,ne,ae,ce,ge,de,ht,le,me,Lt,se,re,vt,Jt,Xe,tt,Ki,kn,Ol,pt,le,Qi,Wi,Ll,ot,Ml,le,Ct,at,lt,as,Xi,le,Yi,Pl,Ji,Fl,le,Ct,at,lt,Bl,ar,Mt,lr,Pt,cr,ls,jl,It,Cn,ur,In,Zi,cs,Vl,Ul,eo,$l;return _A(this,function(hr){switch(hr.label){case 0:if(b=(e=this.qrCode)===null||e===void 0?void 0:e.moduleCount,_=this.options.size,w=this.options.margin,(w<0||w*2>=_)&&(w=0),E=Math.ceil(w),T=_-2*w,A=this.options.whiteMargin,R=this.options.backgroundDimming,D=Math.ceil(T/b),q=D*b,O=q+2*E,G=gt.createCanvas(O,O),L=G.getContext("2d"),this._clear(),L.save(),L.translate(E,E),Ie=gt.createCanvas(O,O),Q=Ie.getContext("2d"),F=null,ne=[],!this.options.gifBackground)return[3,1];if(ae=Zu.parseGIF(this.options.gifBackground),F=ae,ne=Zu.decompressFrames(ae,!0),this.options.autoColor){for(ce=0,ge=0,de=0,ht=0,le=0;le<ne[0].colorTable.length;le++)me=ne[0].colorTable[le],!(me[0]>200||me[1]>200||me[2]>200)&&(me[0]===0&&me[1]===0&&me[2]===0||(ht++,ce+=me[0],ge+=me[1],de+=me[2]));ce=~~(ce/ht),ge=~~(ge/ht),de=~~(de/ht),this.options.colorDark="rgb("+ce+","+ge+","+de+")"}return[3,4];case 1:return this.options.backgroundImage?[4,gt.loadImage(this.options.backgroundImage)]:[3,3];case 2:return Lt=hr.sent(),this.options.autoColor&&(se=t._getAverageRGB(Lt),this.options.colorDark="rgb("+se.r+","+se.g+","+se.b+")"),Q.drawImage(Lt,0,0,Lt.width,Lt.height,0,0,O,O),Q.rect(0,0,O,O),Q.fillStyle=R,Q.fill(),[3,4];case 3:Q.rect(0,0,O,O),Q.fillStyle=this.options.colorLight,Q.fill(),hr.label=4;case 4:for(re=Is.QRUtil.getPatternPosition(this.qrCode.typeNumber),vt=((r=(n=this.options.components)===null||n===void 0?void 0:n.data)===null||r===void 0?void 0:r.scale)||As,Jt=(1-vt)*.5,Xe=0;Xe<b;Xe++)for(tt=0;tt<b;tt++){for(Ki=this.qrCode.isDark(Xe,tt),kn=tt<8&&(Xe<8||Xe>=b-8)||tt>=b-8&&Xe<8,Ol=Xe==6&&tt>=8&&tt<=b-8||tt==6&&Xe>=8&&Xe<=b-8,pt=kn||Ol,le=1;le<re.length-1;le++)pt=pt||Xe>=re[le]-2&&Xe<=re[le]+2&&tt>=re[le]-2&&tt<=re[le]+2;Qi=tt*D+(pt?0:Jt*D),Wi=Xe*D+(pt?0:Jt*D),L.strokeStyle=Ki?this.options.colorDark:this.options.colorLight,L.lineWidth=.5,L.fillStyle=Ki?this.options.colorDark:"rgba(255, 255, 255, 0.6)",re.length===0?pt||L.fillRect(Qi,Wi,(pt?1:vt)*D,(pt?1:vt)*D):(Ll=tt<b-4&&tt>=b-4-5&&Xe<b-4&&Xe>=b-4-5,!pt&&!Ll&&L.fillRect(Qi,Wi,(pt?1:vt)*D,(pt?1:vt)*D))}if(ot=re[re.length-1],Ml="rgba(255, 255, 255, 0.6)",L.fillStyle=Ml,L.fillRect(0,0,8*D,8*D),L.fillRect(0,(b-8)*D,8*D,8*D),L.fillRect((b-8)*D,0,8*D,8*D),!((i=(s=this.options.components)===null||s===void 0?void 0:s.timing)===null||i===void 0)&&i.protectors&&(L.fillRect(8*D,6*D,(b-8-8)*D,D),L.fillRect(6*D,8*D,D,(b-8-8)*D)),!((a=(o=this.options.components)===null||o===void 0?void 0:o.cornerAlignment)===null||a===void 0)&&a.protectors&&t._drawAlignProtector(L,ot,ot,D),!((c=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||c===void 0)&&c.protectors){for(le=0;le<re.length;le++)for(Ct=0;Ct<re.length;Ct++)if(at=re[Ct],lt=re[le],!(at===6&&(lt===6||lt===ot))){if(lt===6&&(at===6||at===ot))continue;if(at===ot&&lt===ot)continue;t._drawAlignProtector(L,at,lt,D)}}for(L.fillStyle=this.options.colorDark,L.fillRect(0,0,7*D,D),L.fillRect((b-7)*D,0,7*D,D),L.fillRect(0,6*D,7*D,D),L.fillRect((b-7)*D,6*D,7*D,D),L.fillRect(0,(b-7)*D,7*D,D),L.fillRect(0,(b-7+6)*D,7*D,D),L.fillRect(0,0,D,7*D),L.fillRect(6*D,0,D,7*D),L.fillRect((b-7)*D,0,D,7*D),L.fillRect((b-7+6)*D,0,D,7*D),L.fillRect(0,(b-7)*D,D,7*D),L.fillRect(6*D,(b-7)*D,D,7*D),L.fillRect(2*D,2*D,3*D,3*D),L.fillRect((b-7+2)*D,2*D,3*D,3*D),L.fillRect(2*D,(b-7+2)*D,3*D,3*D),as=((f=(u=this.options.components)===null||u===void 0?void 0:u.timing)===null||f===void 0?void 0:f.scale)||As,Xi=(1-as)*.5,le=0;le<b-8;le+=2)t._drawDot(L,8+le,6,D,Xi,as),t._drawDot(L,6,8+le,D,Xi,as);for(Yi=((d=(p=this.options.components)===null||p===void 0?void 0:p.cornerAlignment)===null||d===void 0?void 0:d.scale)||As,Pl=(1-Yi)*.5,t._drawAlign(L,ot,ot,D,Pl,Yi,this.options.colorDark,((m=(h=this.options.components)===null||h===void 0?void 0:h.cornerAlignment)===null||m===void 0?void 0:m.protectors)||!1),Ji=((g=(v=this.options.components)===null||v===void 0?void 0:v.alignment)===null||g===void 0?void 0:g.scale)||As,Fl=(1-Ji)*.5,le=0;le<re.length;le++)for(Ct=0;Ct<re.length;Ct++)if(at=re[Ct],lt=re[le],!(at===6&&(lt===6||lt===ot))){if(lt===6&&(at===6||at===ot))continue;if(at===ot&&lt===ot)continue;t._drawAlign(L,at,lt,D,Fl,Ji,this.options.colorDark,((k=(y=this.options.components)===null||y===void 0?void 0:y.alignment)===null||k===void 0?void 0:k.protectors)||!1)}return A&&(L.fillStyle="#FFFFFF",L.fillRect(-E,-E,O,E),L.fillRect(-E,q,O,E),L.fillRect(q,-E,E,O),L.fillRect(-E,-E,E,O)),this.options.logoImage?[4,gt.loadImage(this.options.logoImage)]:[3,6];case 5:Bl=hr.sent(),ar=this.options.logoScale,Mt=this.options.logoMargin,lr=this.options.logoCornerRadius,(ar<=0||ar>=1)&&(ar=.2),Mt<0&&(Mt=0),lr<0&&(lr=0),Pt=q*ar,cr=.5*(O-Pt),ls=cr,L.restore(),L.fillStyle="#FFFFFF",L.save(),t._prepareRoundedCornerClip(L,cr-Mt,ls-Mt,Pt+2*Mt,Pt+2*Mt,lr+Mt),L.clip(),jl=L.globalCompositeOperation,L.globalCompositeOperation="destination-out",L.fill(),L.globalCompositeOperation=jl,L.restore(),L.save(),t._prepareRoundedCornerClip(L,cr,ls,Pt,Pt,lr),L.clip(),L.drawImage(Bl,cr,ls,Pt,Pt),L.restore(),L.save(),L.translate(E,E),hr.label=6;case 6:if(F){if(ne.forEach(function(Zt){It||(It=new TA.default(_,_),It.setDelay(Zt.delay),It.setRepeat(0));var us=Zt.dims,hs=us.width,fs=us.height;Cn||(Cn=gt.createCanvas(hs,fs),ur=Cn.getContext("2d"),ur.rect(0,0,Cn.width,Cn.height),ur.fillStyle="#ffffff",ur.fill()),(!In||!cs||hs!==In.width||fs!==In.height)&&(In=gt.createCanvas(hs,fs),Zi=In.getContext("2d"),cs=Zi.createImageData(hs,fs)),cs.data.set(Zt.patch),Zi.putImageData(cs,0,0),ur.drawImage(In,Zt.dims.left,Zt.dims.top);var ql=gt.createCanvas(O,O),fr=ql.getContext("2d");fr.drawImage(Cn,0,0,O,O),fr.rect(0,0,O,O),fr.fillStyle=R,fr.fill(),fr.drawImage(G,0,0,O,O);var to=gt.createCanvas(_,_),Gl=to.getContext("2d");Gl.drawImage(ql,0,0,_,_),It.addFrame(Gl.getImageData(0,0,to.width,to.height).data)}),!It)throw new Error("No frames.");return It.finish(),eh(this.canvas)?(Vl=It.stream().toFlattenUint8Array(),Ul=Vl.reduce(function(Zt,us){return Zt+String.fromCharCode(us)},""),[2,Promise.resolve("data:image/gif;base64,"+window.btoa(Ul))]):[2,Promise.resolve(Buffer.from(It.stream().toFlattenUint8Array()))]}else return Q.drawImage(G,0,0,O,O),L.drawImage(Ie,-E,-E,O,O),eo=gt.createCanvas(_,_),$l=eo.getContext("2d"),$l.drawImage(G,0,0,_,_),this.canvas=eo,eh(this.canvas)?[2,Promise.resolve(this.canvas.toDataURL())]:[2,Promise.resolve(this.canvas.toBuffer())]}})})},t.CorrectLevel=Is.QRErrorCorrectLevel,t.defaultComponentOptions={data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}},t.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"#ffffff",correctLevel:Is.QRErrorCorrectLevel.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:t.defaultComponentOptions,autoColor:!0},t}();qi.AwesomeQR=kA;function eh(t){try{return t instanceof HTMLElement}catch{return typeof t=="object"&&t.nodeType===1&&typeof t.style=="object"&&typeof t.ownerDocument=="object"}}(function(t){var e=Oe&&Oe.__createBinding||(Object.create?function(s,i,o,a){a===void 0&&(a=o),Object.defineProperty(s,a,{enumerable:!0,get:function(){return i[o]}})}:function(s,i,o,a){a===void 0&&(a=o),s[a]=i[o]}),n=Oe&&Oe.__exportStar||function(s,i){for(var o in s)o!=="default"&&!i.hasOwnProperty(o)&&e(i,s,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(Rl,t);var r=qi;Object.defineProperty(t,"AwesomeQR",{enumerable:!0,get:function(){return r.AwesomeQR}})})(zp);const th=async(t,e=300)=>await new zp.AwesomeQR({text:t,size:e}).draw();function nh(t){let e,n,r;return{c(){e=S("button"),e.textContent="Leader Link",I(e,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7")},m(s,i){j(s,e,i),n||(r=Y(e,"click",t[25]),n=!0)},p:J,d(s){s&&B(e),n=!1,r()}}}function rh(t){let e;function n(i,o){if(i[8]=="pass")return IA;if(i[8]=="link")return CA}let r=n(t),s=r&&r(t);return{c(){e=S("div"),s&&s.c(),I(e,"class","block border-b border-black bg-yellow-200 relative")},m(i,o){j(i,e,o),s&&s.m(e,null)},p(i,o){r===(r=n(i))&&s?s.p(i,o):(s&&s.d(1),s=r&&r(i),s&&(s.c(),s.m(e,null)))},d(i){i&&B(e),s&&s.d()}}}function CA(t){let e,n,r,s,i,o,a,l,c,u,f,p,d,h,m,v,g,y;return{c(){e=S("div"),n=S("img"),s=M(),i=S("div"),o=S("div"),a=S("span"),l=ue(t[10]),c=M(),u=S("button"),u.textContent="X",f=M(),p=S("div"),d=S("div"),h=S("input"),m=M(),v=S("button"),v.textContent="Copy",I(n,"alt","qrcode"),zl(n.src,r=t[11])||I(n,"src",r),I(a,"class","inline-block px-2 leading-7"),I(u,"class","px-2 h-7 float-right border-l border-black hover:bg-red-500 hover:text-white"),I(o,"class","bg-gray-100 border-b border-black w-full"),I(h,"class","bg-white w-full h-7 text-ellipsis inline-block flex-1 px-2"),I(h,"type","text"),h.readOnly=!0,I(h,"title",t[9]),h.value=t[9],I(v,"class","float-right border-l border-black bg-gray-100 hover:text-white hover:bg-nl px-2 h-7"),I(d,"class","flex-1 border-black border-t border-b flex"),I(p,"class","flex items-center flex-1"),I(i,"class","flex flex-1 border-l border-black flex-col"),I(e,"class","flex flex-row flex-wrap")},m(k,b){j(k,e,b),C(e,n),C(e,s),C(e,i),C(i,o),C(o,a),C(a,l),C(o,c),C(o,u),C(i,f),C(i,p),C(p,d),C(d,h),C(d,m),C(d,v),g||(y=[Y(u,"click",t[14]),Y(v,"click",t[26])],g=!0)},p(k,b){b&2048&&!zl(n.src,r=k[11])&&I(n,"src",r),b&1024&&be(l,k[10]),b&512&&I(h,"title",k[9]),b&512&&h.value!==k[9]&&(h.value=k[9])},d(k){k&&B(e),g=!1,Ke(y)}}}function IA(t){let e,n,r,s,i,o,a,l,c,u,f,p;return{c(){e=S("button"),e.textContent="X",n=M(),r=S("form"),s=S("label"),s.innerHTML=`<span class="text-sm font-bold block mb-2">Passcode for leader</span> 
            <input type="text" name="passCode" autocomplete="off" placeholder="Password to join room" class="mb-4 form-input"/>`,i=M(),o=S("div"),a=S("button"),a.textContent="Try Switch Leader",l=M(),c=S("span"),u=ue(t[10]),I(e,"class","px-2 h-7 bg-gray-100 border-b border-l border-black hover:bg-red-500 hover:text-white absolute top-0 right-0"),I(a,"type","submit"),a.value="create",I(a,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-2"),I(c,"class","flex-1 bg-red-500 text-white block px-2 leading-loose"),I(o,"class","flex gap-2 justify-between"),I(r,"class","p-2")},m(d,h){j(d,e,h),j(d,n,h),j(d,r,h),C(r,s),C(r,i),C(r,o),C(o,a),C(o,l),C(o,c),C(c,u),f||(p=[Y(e,"click",t[14]),Y(r,"submit",Qt(wn(t[16])))],f=!0)},p(d,h){h&1024&&be(u,d[10])},d(d){d&&B(e),d&&B(n),d&&B(r),f=!1,Ke(p)}}}function AA(t){var a;let e,n=((a=t[2])==null?void 0:a.name)+"",r,s,i,o;return{c(){e=S("h2"),r=ue(n),s=M(),i=S("span"),o=ue(t[1]),I(e,"class","font-semibold leading-tight text-3xl")},m(l,c){j(l,e,c),C(e,r),j(l,s,c),j(l,i,c),C(i,o)},p(l,c){var u;c&4&&n!==(n=((u=l[2])==null?void 0:u.name)+"")&&be(r,n),c&2&&be(o,l[1])},d(l){l&&B(e),l&&B(s),l&&B(i)}}}function SA(t){let e,n,r,s,i,o,a,l,c,u,f,p,d,h,m,v,g,y,k,b,_,w=t[13]&&sh(t),E=t[6]&&ih(t);return{c(){e=S("form"),n=S("label"),r=S("span"),r.textContent="Room Name",s=M(),i=S("input"),a=M(),l=S("label"),c=S("span"),c.textContent="Nick",u=M(),f=S("input"),d=M(),h=S("button"),h.textContent="Generate",m=M(),w&&w.c(),v=M(),g=S("div"),y=S("button"),y.textContent="Save",k=M(),E&&E.c(),I(r,"class","text-sm font-bold mb-2"),I(i,"type","text"),I(i,"name","roomName"),I(i,"placeholder","Enter a room name"),I(i,"autocomplete","off"),i.value=o=t[12].roomName,i.required=!0,I(i,"class","mb-4 form-input"),I(n,"class","inline-block w-full"),I(c,"class","text-sm font-bold mb-2"),I(f,"type","text"),I(f,"name","nick"),I(f,"placeholder","Marcus Antonius"),I(f,"autocomplete","off"),f.value=p=t[12].nick,f.required=!0,I(f,"class","mb-4 form-input float-right"),I(h,"type","button"),I(h,"class","underline hover:bg-nl hover:text-white"),I(l,"class","inline-block w-full"),I(y,"type","submit"),y.value="save",I(y,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(g,"class","flex gap-2 justify-between")},m(T,A){j(T,e,A),C(e,n),C(n,r),C(n,s),C(n,i),C(e,a),C(e,l),C(l,c),C(l,u),C(l,f),t[27](f),C(l,d),C(l,h),C(e,m),w&&w.m(e,null),C(e,v),C(e,g),C(g,y),C(g,k),E&&E.m(g,null),t[29](e),b||(_=[Y(h,"click",t[28]),Y(e,"submit",Qt(wn(t[18])))],b=!0)},p(T,A){A&4096&&o!==(o=T[12].roomName)&&i.value!==o&&(i.value=o),A&4096&&p!==(p=T[12].nick)&&f.value!==p&&(f.value=p),T[13]?w?w.p(T,A):(w=sh(T),w.c(),w.m(e,v)):w&&(w.d(1),w=null),T[6]?E?E.p(T,A):(E=ih(T),E.c(),E.m(g,null)):E&&(E.d(1),E=null)},d(T){T&&B(e),t[27](null),w&&w.d(),E&&E.d(),t[29](null),b=!1,Ke(_)}}}function sh(t){let e,n,r,s,i,o,a,l,c,u,f,p,d;return{c(){e=S("hr"),n=M(),r=S("label"),s=S("span"),s.textContent="Passcode",i=M(),o=S("input"),l=M(),c=S("label"),u=S("span"),u.textContent="Leader Passcode",f=M(),p=S("input"),I(e,"class","block py-2 px-2"),I(s,"class","text-sm font-bold mb-2"),I(o,"type","text"),I(o,"name","passCode"),I(o,"autocomplete","off"),o.value=a=t[12].passCode,I(o,"placeholder","Optional passcode to join room"),I(o,"class","mb-4 form-input"),I(r,"class","inline-block w-full"),I(u,"class","text-sm font-bold mb-2"),I(p,"type","text"),I(p,"name","leaderCode"),I(p,"autocomplete","off"),p.value=d=t[12].leaderCode,I(p,"placeholder","Optional passcode to be leader"),I(p,"class","mb-4 form-input"),I(c,"class","inline-block w-full")},m(h,m){j(h,e,m),j(h,n,m),j(h,r,m),C(r,s),C(r,i),C(r,o),j(h,l,m),j(h,c,m),C(c,u),C(c,f),C(c,p)},p(h,m){m&4096&&a!==(a=h[12].passCode)&&o.value!==a&&(o.value=a),m&4096&&d!==(d=h[12].leaderCode)&&p.value!==d&&(p.value=d)},d(h){h&&B(e),h&&B(n),h&&B(r),h&&B(l),h&&B(c)}}}function ih(t){let e,n;return{c(){e=S("span"),n=ue(t[6]),I(e,"class","flex-1 bg-red-500 text-white block px-2 leading-loose")},m(r,s){j(r,e,s),C(e,n)},p(r,s){s&64&&be(n,r[6])},d(r){r&&B(e)}}}function DA(t){let e,n,r,s=t[13]?"Leader - switch":"User - switch",i,o,a,l,c=t[3]?"Cancel":"Edit",u,f,p,d,h,m,v,g,y,k,b=t[13]&&nh(t),_=t[7]&&rh(t);function w(A,R){return A[3]?SA:AA}let E=w(t),T=E(t);return{c(){e=S("div"),n=S("div"),r=S("button"),i=ue(s),o=M(),a=S("div"),l=S("button"),u=ue(c),f=M(),p=S("button"),p.textContent="Invite Link",d=M(),b&&b.c(),h=M(),_&&_.c(),m=M(),v=S("div"),T.c(),I(r,"class","h-7 flex-1 px-2 text-left hover:bg-nl hover:text-white"),I(l,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7"),I(p,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7"),I(n,"class","flex justify-between w-full border-b border-black"),I(v,"class","p-2"),I(e,"class",g=`${t[0]}`)},m(A,R){j(A,e,R),C(e,n),C(n,r),C(r,i),C(n,o),C(n,a),C(a,l),C(l,u),C(a,f),C(a,p),C(a,d),b&&b.m(a,null),C(e,h),_&&_.m(e,null),C(e,m),C(e,v),T.m(v,null),y||(k=[Y(r,"click",t[15]),Y(l,"click",t[23]),Y(p,"click",t[24])],y=!0)},p(A,[R]){R&8192&&s!==(s=A[13]?"Leader - switch":"User - switch")&&be(i,s),R&8&&c!==(c=A[3]?"Cancel":"Edit")&&be(u,c),A[13]?b?b.p(A,R):(b=nh(A),b.c(),b.m(a,null)):b&&(b.d(1),b=null),A[7]?_?_.p(A,R):(_=rh(A),_.c(),_.m(e,m)):_&&(_.d(1),_=null),E===(E=w(A))&&T?T.p(A,R):(T.d(1),T=E(A),T&&(T.c(),T.m(v,null))),R&1&&g!==(g=`${A[0]}`)&&I(e,"class",g)},i:J,o:J,d(A){A&&B(e),b&&b.d(),_&&_.d(),T.d(),y=!1,Ke(k)}}}function RA(t,e,n){let r;Ut(t,bt,F=>n(13,r=F));let{class:s=""}=e,{id:i=""}=e,{nick:o=""}=e,{nickID:a=""}=e,{info:l=null}=e,c=!1,u,f,p="",d=!1,h="",m="",v="",g="";const y=()=>{n(7,d=!1),n(8,h=""),n(9,m=""),n(10,v=""),n(11,g="")},k=async()=>{const F=Ap(i),ne=Ge(He,"room",i),[ae]=await Dr(ne,F);if(r){if(ae){bt.set(!1);const ge=await ko(ne);oa(i,{password:ge.passCode,id:i});return}bt.set(!1)}else{if(!ae){n(8,h="pass"),n(10,v="Password is incorrect"),n(7,d=!0);return}bt.set(!0)}},b=async F=>{const ne=Ge(He,"room",i),[ae]=await Dr(ne,F);if(!ae){n(10,v="Password is incorrect");return}bt.set(!0),oa(i,{password:F,id:i}),y()},_=F=>{n(10,v="");const ce=F.currentTarget.elements.namedItem("passCode").value;b(ce)},w={roomName:"",nick:"",passCode:"",leaderCode:""},E=async()=>{if(n(12,w.roomName=l.name,w),n(12,w.nick=o,w),r){const F=Ge(He,"room",i),ne=await ko(F);n(12,w.passCode=ne.passCode,w),n(12,w.leaderCode=ne.leaderCode,w)}else n(12,w.passCode="",w),n(12,w.leaderCode="",w)},T=async()=>{n(6,p="");const F=new FormData(u),ne={},ae=["roomName","nick"];bt&&ae.push("passCode","leaderCode");for(const ge of ae)ne[ge]=F.get(ge);const ce={};for(const[ge,de]of Object.entries(ne))w[ge]!==de&&(ce[ge]=de);if(!bt&&("passCode"in ce||"leaderCode"in ce)){n(6,p="leader can change passwords");return}if(Object.keys(ce).length>0){const ge={};for(const[ht,me]of Object.entries(ce))switch(ht){case"roomName":ge.info={name:me};break;case"nick":ge.people={[a]:{nick:me}};break;case"passCode":ge.password={...ge.password,passCode:me};break;case"leaderCode":ge.password={...ge.password,leaderCode:me};break}const de=Ge(He,"room",i);try{await ln(de,ge,{merge:!0}),n(3,c=!1)}catch(ht){n(6,p=ht)}}},A=async(F=!1)=>{const ne=await ko(Ge(He,"room",i));let ae=ne==null?void 0:ne.passCode;F&&(ae=ne==null?void 0:ne.leaderCode);let ce=`${window.location.origin}/#/room/${i}`;return ae&&(ce+=`?password=${ae}`),ce},R=F=>{navigator.clipboard.writeText(F)},D=()=>{n(3,c=!c),c&&E()},q=async()=>{n(9,m=await A(!1)),n(10,v="Selected Invite link"),n(8,h="link"),n(11,g=await th(m)),n(7,d=!0)},O=async()=>{n(9,m=await A(!0)),n(10,v="Selected Leader link"),n(8,h="link"),n(11,g=await th(m)),n(7,d=!0)},G=()=>{R(m)};function L(F){Mn[F?"unshift":"push"](()=>{f=F,n(5,f)})}const Ie=()=>n(5,f.value=ei(),f);function Q(F){Mn[F?"unshift":"push"](()=>{u=F,n(4,u)})}return t.$$set=F=>{"class"in F&&n(0,s=F.class),"id"in F&&n(21,i=F.id),"nick"in F&&n(1,o=F.nick),"nickID"in F&&n(22,a=F.nickID),"info"in F&&n(2,l=F.info)},[s,o,l,c,u,f,p,d,h,m,v,g,w,r,y,k,_,E,T,A,R,i,a,D,q,O,G,L,Ie,Q]}class NA extends We{constructor(e){super(),Qe(this,e,RA,DA,Ue,{class:0,id:21,nick:1,nickID:22,info:2})}}function xA(t){let e,n,r,s;return{c(){e=S("span"),n=Kl("svg"),r=Kl("path"),I(r,"d",s=t[4][t[0]]),I(n,"xmlns","http://www.w3.org/2000/svg"),I(n,"width",t[2]),I(n,"height",t[1]),I(n,"viewBox","0 0 24 24"),I(e,"title",t[3]),I(e,"class",mr(t[5]?t[5]:void 0)+" svelte-fnv3u2")},m(i,o){j(i,e,o),C(e,n),C(n,r)},p(i,[o]){o&17&&s!==(s=i[4][i[0]])&&I(r,"d",s),o&4&&I(n,"width",i[2]),o&2&&I(n,"height",i[1]),o&8&&I(e,"title",i[3])},i:J,o:J,d(i){i&&B(e)}}}function OA(t,e,n){var r;(function(f){f.king="M16.896 10l-4.896-8-4.896 8-7.104-4 3 11v5h18v-5l3-11-7.104 4zm-11.896 10v-2h14v2h-14zm14.2-4h-14.4l-1.612-5.909 4.615 2.598 4.197-6.857 4.197 6.857 4.615-2.598-1.612 5.909z"})(r||(r={}));let{icon:s}=e,{height:i="24"}=e,{width:o="24"}=e,{class:a=void 0}=e,{position:l=void 0}=e,{title:c="icon"}=e;const u=[a,l].join(" ");return t.$$set=f=>{"icon"in f&&n(0,s=f.icon),"height"in f&&n(1,i=f.height),"width"in f&&n(2,o=f.width),"class"in f&&n(6,a=f.class),"position"in f&&n(7,l=f.position),"title"in f&&n(3,c=f.title)},[s,i,o,c,r,u,a,l]}class LA extends We{constructor(e){super(),Qe(this,e,OA,xA,Ue,{icon:0,height:1,width:2,class:6,position:7,title:3})}}function oh(t,e,n){const r=t.slice();return r[20]=e[n],r}function ah(t){let e,n,r;return{c(){e=S("input"),I(e,"class","bg-gray-200 flex-1 px-2 min-w-[2rem]"),I(e,"type","text")},m(s,i){j(s,e,i),Ln(e,t[1]),n||(r=Y(e,"input",t[15]),n=!0)},p(s,i){i&2&&e.value!==s[1]&&Ln(e,s[1])},d(s){s&&B(e),n=!1,r()}}}function lh(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 h-7 border-l border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){j(s,e,i),n||(r=Y(e,"click",t[9]),n=!0)},p:J,d(s){s&&B(e),n=!1,r()}}}function ch(t){let e,n,r,s,i,o,a,l,c,u,f,p,d=Object.keys(t[0]).length+"",h,m,v,g=[],y=new Map,k,b,_,w=t[8]&&uh(t),E=Object.keys(t[0]).sort(t[17]);const T=A=>A[20];for(let A=0;A<E.length;A+=1){let R=oh(t,E,A),D=T(R);y.set(D,g[A]=fh(D,R))}return{c(){e=S("div"),n=S("div"),r=S("button"),r.textContent="Clear Votes",s=M(),i=S("button"),i.textContent="Show Results",o=M(),w&&w.c(),a=M(),l=S("span"),c=S("span"),u=ue(t[6]),p=ue("/"),h=ue(d),m=M(),v=S("table");for(let A=0;A<g.length;A+=1)g[A].c();I(r,"class","px-2 h-7 border border-black hover:bg-nl hover:text-white"),I(i,"class","px-2 h-7 border border-black hover:bg-nl hover:text-white"),$t(i,"invisible",!t[7]),I(c,"class",f=`${t[6]!=Object.keys(t[0]).length?"text-red-500":""}`),I(l,"class","text-xl font-bold"),I(e,"class","flex items-center justify-between mb-4"),I(v,"class","w-full")},m(A,R){j(A,e,R),C(e,n),C(n,r),C(n,s),C(n,i),C(e,o),w&&w.m(e,null),C(e,a),C(e,l),C(l,c),C(c,u),C(l,p),C(l,h),j(A,m,R),j(A,v,R);for(let D=0;D<g.length;D+=1)g[D].m(v,null);k=!0,b||(_=[Y(r,"click",t[12]),Y(i,"click",t[13])],b=!0)},p(A,R){R&128&&$t(i,"invisible",!A[7]),A[8]?w?w.p(A,R):(w=uh(A),w.c(),w.m(e,a)):w&&(w.d(1),w=null),(!k||R&64)&&be(u,A[6]),(!k||R&65&&f!==(f=`${A[6]!=Object.keys(A[0]).length?"text-red-500":""}`))&&I(c,"class",f),(!k||R&1)&&d!==(d=Object.keys(A[0]).length+"")&&be(h,d),R&3481&&(E=Object.keys(A[0]).sort(A[17]),Tt(),g=ya(g,R,T,1,A,E,y,v,kh,fh,null,oh),kt())},i(A){if(!k){for(let R=0;R<E.length;R+=1)X(g[R]);k=!0}},o(A){for(let R=0;R<g.length;R+=1)te(g[R]);k=!1},d(A){A&&B(e),w&&w.d(),A&&B(m),A&&B(v);for(let R=0;R<g.length;R+=1)g[R].d();b=!1,Ke(_)}}}function uh(t){let e,n;return{c(){e=S("span"),n=ue(t[5]),I(e,"class","text-xl font-bold")},m(r,s){j(r,e,s),C(e,n)},p(r,s){s&32&&be(n,r[5])},d(r){r&&B(e)}}}function hh(t){let e,n,r;function s(){return t[18](t[20])}return{c(){e=S("button"),e.textContent="X",I(e,"class","bg-white border-l border-r border-black hover:bg-red-500 absolute top-0 right-0 h-full text-2xl px-2")},m(i,o){j(i,e,o),n||(r=Y(e,"click",s),n=!0)},p(i,o){t=i},d(i){i&&B(e),n=!1,r()}}}function fh(t,e){var g,y,k,b,_;let n,r,s=((g=e[0][e[20]])==null?void 0:g.nick)+"",i,o,a,l,c=(e[8]?(b=(k=(y=e[0][e[20]])==null?void 0:y.card)==null?void 0:k.text)!=null?b:"-":"\u{1F7E7}")+"",u,f,p,d,h,m;o=new LA({props:{class:`float-right pr-2 ${(_=e[0][e[20]])!=null&&_.isLeader?"":"invisible"}`,icon:"king",title:"Leader"}});let v=e[7]&&e[3]&&hh(e);return{key:t,first:null,c(){var w,E,T,A;n=S("tr"),r=S("td"),i=ue(s),Ae(o.$$.fragment),a=M(),l=S("td"),u=ue(c),f=M(),v&&v.c(),d=M(),I(r,"class","text-left w-1/2 text-2xl"),I(l,"class",p=`${((E=(w=e[0][e[20]])==null?void 0:w.card)==null?void 0:E.emoji)||!e[8]?"font-emoji":""} text-center text-4xl py-1 border border-r-0 border-black relative`),I(n,"class",h=`odd:bg-gray-100 border-b border-black first:border-t ${(A=(T=e[0][e[20]])==null?void 0:T.card)!=null&&A.text?"":"!bg-yellow-100"} ${e[4][e[20]]?"stripe-gray":""}`),this.first=n},m(w,E){j(w,n,E),C(n,r),C(r,i),Te(o,r,null),C(n,a),C(n,l),C(l,u),C(l,f),v&&v.m(l,null),C(n,d),m=!0},p(w,E){var A,R,D,q,O,G,L,Ie,Q;e=w,(!m||E&1)&&s!==(s=((A=e[0][e[20]])==null?void 0:A.nick)+"")&&be(i,s);const T={};E&1&&(T.class=`float-right pr-2 ${(R=e[0][e[20]])!=null&&R.isLeader?"":"invisible"}`),o.$set(T),(!m||E&257)&&c!==(c=(e[8]?(O=(q=(D=e[0][e[20]])==null?void 0:D.card)==null?void 0:q.text)!=null?O:"-":"\u{1F7E7}")+"")&&be(u,c),e[7]&&e[3]?v?v.p(e,E):(v=hh(e),v.c(),v.m(l,null)):v&&(v.d(1),v=null),(!m||E&257&&p!==(p=`${((L=(G=e[0][e[20]])==null?void 0:G.card)==null?void 0:L.emoji)||!e[8]?"font-emoji":""} text-center text-4xl py-1 border border-r-0 border-black relative`))&&I(l,"class",p),(!m||E&17&&h!==(h=`odd:bg-gray-100 border-b border-black first:border-t ${(Q=(Ie=e[0][e[20]])==null?void 0:Ie.card)!=null&&Q.text?"":"!bg-yellow-100"} ${e[4][e[20]]?"stripe-gray":""}`))&&I(n,"class",h)},i(w){m||(X(o.$$.fragment,w),m=!0)},o(w){te(o.$$.fragment,w),m=!1},d(w){w&&B(n),ke(o),v&&v.d()}}}function MA(t){let e,n,r,s,i=(t[3]?"":t[1])+"",o,a,l,c,u,f,p=t[3]?"Cancel":"Edit",d,h,m,v,g,y,k,b,_=t[3]&&ah(t),w=t[3]&&lh(t),E=t[0]&&ch(t);return{c(){e=S("div"),n=S("div"),r=S("span"),s=ue("Voting - "),o=ue(i),a=M(),_&&_.c(),l=M(),c=S("div"),w&&w.c(),u=M(),f=S("button"),d=ue(p),m=M(),v=S("div"),E&&E.c(),I(r,"class","px-2"),I(f,"class",h=`float-right px-2 h-7 border-l border-black self-end hover:text-white ${t[3]?"hover:bg-red-500":"hover:bg-nl"}`),I(n,"class","border-b border-black h-7 flex flex-wrap justify-between box-content"),I(v,"class","p-2"),I(e,"class",g=`${t[2]} relative`)},m(T,A){j(T,e,A),C(e,n),C(n,r),C(r,s),C(r,o),C(n,a),_&&_.m(n,null),C(n,l),C(n,c),w&&w.m(c,null),C(c,u),C(c,f),C(f,d),C(e,m),C(e,v),E&&E.m(v,null),y=!0,k||(b=Y(f,"click",t[16]),k=!0)},p(T,[A]){(!y||A&10)&&i!==(i=(T[3]?"":T[1])+"")&&be(o,i),T[3]?_?_.p(T,A):(_=ah(T),_.c(),_.m(n,l)):_&&(_.d(1),_=null),T[3]?w?w.p(T,A):(w=lh(T),w.c(),w.m(c,u)):w&&(w.d(1),w=null),(!y||A&8)&&p!==(p=T[3]?"Cancel":"Edit")&&be(d,p),(!y||A&8&&h!==(h=`float-right px-2 h-7 border-l border-black self-end hover:text-white ${T[3]?"hover:bg-red-500":"hover:bg-nl"}`))&&I(f,"class",h),T[0]?E?(E.p(T,A),A&1&&X(E,1)):(E=ch(T),E.c(),X(E,1),E.m(v,null)):E&&(Tt(),te(E,1,1,()=>{E=null}),kt()),(!y||A&4&&g!==(g=`${T[2]} relative`))&&I(e,"class",g)},i(T){y||(X(E),y=!0)},o(T){te(E),y=!1},d(T){T&&B(e),_&&_.d(),w&&w.d(),E&&E.d(),k=!1,b()}}}function PA(t,e,n){let r,s,i,o;Ut(t,bt,E=>n(7,i=E)),Ut(t,cn,E=>n(8,o=E));let{class:a=""}=e,{id:l=""}=e,{description:c=""}=e,{people:u=null}=e,f=!1;const p=()=>{const E=Ge(He,"room",l);if(ln(E,{info:{description:c}},{merge:!0}),i){const T={};Object.keys(u).forEach(A=>{h[A]||(T[A]=u[A])}),ia(E,{people:T})}n(3,f=!1),n(4,h={})},d=E=>{let T=0;return Object.keys(E).reduce((R,D)=>{var G;let q=0;const O=Number((G=E[D].card)==null?void 0:G.text);return isNaN(O)||(T++,q=O),R+q},0)/T};let h={};const m=E=>{n(4,h[E]=!0,h)},v=E=>{delete h[E],n(4,h={...h})},g=()=>{if(u){Object.keys(u).forEach(T=>{u[T].card&&(n(0,u[T].card.text=null,u),n(0,u[T].card.emoji=!1,u))});const E=Ge(He,"room",l);ln(E,{people:u,show:!1},{merge:!0}),cn.set(!1)}else{const E=Ge(He,"room",l);ln(E,{show:!1},{merge:!0}),cn.set(!1)}},y=()=>{if(!i)return;const E=Ge(He,"room",l);ln(E,{show:!0},{merge:!0}),cn.set(!0)};function k(){c=this.value,n(1,c)}const b=()=>{n(3,f=!f),n(4,h={})},_=(E,T)=>Hp(u[E].nick,u[T].nick),w=E=>h[E]?v(E):m(E);return t.$$set=E=>{"class"in E&&n(2,a=E.class),"id"in E&&n(14,l=E.id),"description"in E&&n(1,c=E.description),"people"in E&&n(0,u=E.people)},t.$$.update=()=>{t.$$.dirty&1&&n(6,r=u?Object.keys(u).reduce((E,T)=>{var R;const A=(R=u[T].card)!=null&&R.text?1:0;return E+A},0):0),t.$$.dirty&1&&n(5,s=d(u))},[u,c,a,f,h,s,r,i,o,p,m,v,g,y,l,k,b,_,w]}class FA extends We{constructor(e){super(),Qe(this,e,PA,MA,Ue,{class:2,id:14,description:1,people:0})}}function BA(t){var c,u;let e,n,r,s,i,o,a,l;return n=new FA({props:{id:t[0],description:(u=(c=t[1])==null?void 0:c.description)!=null?u:"",people:t[3],class:"flex-1 bg-white border-black border-t border-b sm:border"}}),i=new NA({props:{id:t[0],info:t[1],nick:t[2],nickID:t[5],class:"bg-white border-black border-t border-b sm:border h-fit"}}),a=new x2({props:{id:t[0],nickID:t[5],cardDeck:t[4],class:"flex-1 bg-white border-black border-t border-b sm:border h-fit"}}),{c(){e=S("div"),Ae(n.$$.fragment),r=M(),s=S("div"),Ae(i.$$.fragment),o=M(),Ae(a.$$.fragment),I(s,"class","flex flex-1 flex-col gap-2"),I(e,"class","flex flex-col xl:flex-row gap-2")},m(f,p){j(f,e,p),Te(n,e,null),C(e,r),C(e,s),Te(i,s,null),C(s,o),Te(a,s,null),l=!0},p(f,[p]){var v,g;const d={};p&1&&(d.id=f[0]),p&2&&(d.description=(g=(v=f[1])==null?void 0:v.description)!=null?g:""),p&8&&(d.people=f[3]),n.$set(d);const h={};p&1&&(h.id=f[0]),p&2&&(h.info=f[1]),p&4&&(h.nick=f[2]),i.$set(h);const m={};p&1&&(m.id=f[0]),p&16&&(m.cardDeck=f[4]),a.$set(m)},i(f){l||(X(n.$$.fragment,f),X(i.$$.fragment,f),X(a.$$.fragment,f),l=!0)},o(f){te(n.$$.fragment,f),te(i.$$.fragment,f),te(a.$$.fragment,f),l=!1},d(f){f&&B(e),ke(n),ke(i),ke(a)}}}function jA(t,e,n){var d;let r;Ut(t,bt,h=>n(9,r=h));let{id:s=""}=e,{password:i=""}=e,{checkLeader:o=!1}=e,a=null,{id:l,nick:c}=(d=Dp())!=null?d:Rp(ei()),u=null,f=[],p=null;return ga(async()=>{const h=Ge(He,"room",s);bt.set(o);let m=xw(s);await ln(h,{people:{[l]:{nick:c,points:"",isLeader:o}}},{merge:!0}),p=yw(He,s,v=>{var b,_,w;n(1,a=v.get("info")),n(3,u=v.get("people"));const g=v.get("password"),y=v.get("cards");if(n(4,f=(b=y==null?void 0:y.sort((E,T)=>E.text.localeCompare(T.text)))!=null?b:[]),cn.set(v.get("show")),!u[l]){ba("/?msg=You%20have%20been%20kicked!!&kickRoom=");return}((_=u[l])==null?void 0:_.nick)!=c&&(n(2,c=(w=u[l])==null?void 0:w.nick),c&&Np(l,c));const k={};(a==null?void 0:a.name)!=m&&(m=a==null?void 0:a.name,k.name=m),r&&g.leaderCode!=i&&(n(6,i=g.leaderCode),k.password=i),!r&&g.passCode!=i&&(n(6,i=g.passCode),k.password=i),Object.keys(k).length&&oa(s,{...k,id:s}),Object.keys(u).every(E=>{var T;return(T=u[E].card)==null?void 0:T.text})&&cn.set(!0)})}),ma(()=>{p!=null&&p()}),t.$$set=h=>{"id"in h&&n(0,s=h.id),"password"in h&&n(6,i=h.password),"checkLeader"in h&&n(7,o=h.checkLeader)},[s,a,c,u,f,l,i,o]}class VA extends We{constructor(e){super(),Qe(this,e,jA,BA,Ue,{id:0,password:6,checkLeader:7})}}function dh(t){let e,n,r,s;const i=[$A,UA],o=[];function a(l,c){return l[3]?1:0}return e=a(t),n=o[e]=i[e](t),{c(){n.c(),r=zn()},m(l,c){o[e].m(l,c),j(l,r,c),s=!0},p(l,c){let u=e;e=a(l),e===u?o[e].p(l,c):(Tt(),te(o[u],1,1,()=>{o[u]=null}),kt(),n=o[e],n?n.p(l,c):(n=o[e]=i[e](l),n.c()),X(n,1),n.m(r.parentNode,r))},i(l){s||(X(n),s=!0)},o(l){te(n),s=!1},d(l){o[e].d(l),l&&B(r)}}}function UA(t){let e,n;return e=new VA({props:{id:t[0].id,checkLeader:t[5],password:t[1]}}),{c(){Ae(e.$$.fragment)},m(r,s){Te(e,r,s),n=!0},p(r,s){const i={};s&1&&(i.id=r[0].id),s&32&&(i.checkLeader=r[5]),s&2&&(i.password=r[1]),e.$set(i)},i(r){n||(X(e.$$.fragment,r),n=!0)},o(r){te(e.$$.fragment,r),n=!1},d(r){ke(e,r)}}}function $A(t){let e,n,r,s,i,o,a,l,c,u,f,p,d=t[2]&&ph();return{c(){e=S("div"),n=S("div"),r=S("span"),r.textContent="password not correct!",s=M(),i=S("form"),o=S("label"),o.innerHTML=`<span class="text-sm font-bold block mb-2">Passcode</span> 
            <input type="text" name="passCode" autocomplete="off" placeholder="Password to join room" class="mb-4 form-input"/>`,a=M(),l=S("div"),c=S("button"),c.textContent="Login",u=M(),d&&d.c(),I(r,"class","block mb-4 text-xl font-bold bg-black text-white px-2 py-1"),I(c,"type","submit"),c.value="create",I(c,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(l,"class","flex gap-2 justify-between"),I(n,"class","p-6 bg-white border border-black"),I(e,"class","flex items-center justify-center")},m(h,m){j(h,e,m),C(e,n),C(n,r),C(n,s),C(n,i),C(i,o),C(i,a),C(i,l),C(l,c),C(l,u),d&&d.m(l,null),f||(p=Y(i,"submit",Qt(wn(t[6]))),f=!0)},p(h,m){h[2]?d||(d=ph(),d.c(),d.m(l,null)):d&&(d.d(1),d=null)},i:J,o:J,d(h){h&&B(e),d&&d.d(),f=!1,p()}}}function ph(t){let e;return{c(){e=S("span"),e.textContent="Wrong!",I(e,"class","flex-1 bg-red-500 text-white block px-2 leading-loose")},m(n,r){j(n,e,r)},d(n){n&&B(e)}}}function qA(t){let e,n,r=t[4]&&dh(t);return{c(){r&&r.c(),e=zn()},m(s,i){r&&r.m(s,i),j(s,e,i),n=!0},p(s,[i]){s[4]?r?(r.p(s,i),i&16&&X(r,1)):(r=dh(s),r.c(),X(r,1),r.m(e.parentNode,e)):r&&(Tt(),te(r,1,1,()=>{r=null}),kt())},i(s){n||(X(r),n=!0)},o(s){te(r),n=!1},d(s){r&&r.d(s),s&&B(e)}}}function GA(t,e,n){let r;Ut(t,Dh,d=>n(7,r=d));let{params:s={}}=e,i="",o=!1,a=!1,l=!1,c=!1;const u=(d,h=!1)=>{var v;if(!h&&!l||(d=d.replace(" ",""),d==""))return;console.log("called",d);const m=new URLSearchParams(d);return n(1,i=(v=m.get("password"))!=null?v:""),window.history.replaceState({},"",window.location.pathname+window.location.hash.replace("?"+d,"")),i},f=async(d,h,m=!1)=>{if(!m&&!l)return;n(2,o=!1);const v=Ge(He,"room",d),g=Ap(d);let[y,k]=await Dr(v,g),b=g;if(!k)[y,k]=await Dr(v,h),b=h;else if(!y){const _=k;[y,k]=await Dr(v,h),k?b=h:k=_}if(!k){n(2,o=!0);return}return n(5,c=y),n(1,i=b),n(3,a=!0),a},p=d=>{const v=d.currentTarget.elements.namedItem("passCode").value;f(s.id,v)};return ga(async()=>{const d=u(r,!0);n(3,a=await f(s.id,d,!0)),n(4,l=!0)}),t.$$set=d=>{"params"in d&&n(0,s=d.params)},t.$$.update=()=>{t.$$.dirty&128&&u(r),t.$$.dirty&3&&f(s.id,i)},[s,i,o,a,l,c,p,r]}class HA extends We{constructor(e){super(),Qe(this,e,GA,qA,Ue,{params:0})}}function zA(t){let e,n,r,s,i,o;return r=new bg({props:{class:"px-2 border-nl border-b-2 mb-3"}}),i=new mg({props:{routes:t[0]}}),{c(){e=S("div"),n=S("div"),Ae(r.$$.fragment),s=M(),Ae(i.$$.fragment),I(n,"class","container mx-auto border-black"),I(e,"class","bg-gray-100 h-full")},m(a,l){j(a,e,l),C(e,n),Te(r,n,null),C(n,s),Te(i,n,null),o=!0},p:J,i(a){o||(X(r.$$.fragment,a),X(i.$$.fragment,a),o=!0)},o(a){te(r.$$.fragment,a),te(i.$$.fragment,a),o=!1},d(a){a&&B(e),ke(r),ke(i)}}}function KA(t){return[{"/":Yw,"/room/:id":HA,"*":Zw}]}class QA extends We{constructor(e){super(),Qe(this,e,KA,zA,Ue,{})}}new QA({target:document.body});

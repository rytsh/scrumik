const Zp=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};Zp();function J(){}function dh(t,e){for(const n in e)t[n]=e[n];return t}function ph(t){return t()}function Gl(){return Object.create(null)}function Ge(t){t.forEach(ph)}function da(t){return typeof t=="function"}function He(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let hs;function Hl(t,e){return hs||(hs=document.createElement("a")),hs.href=e,t===hs.href}function eg(t){return Object.keys(t).length===0}function gh(t,...e){if(t==null)return J;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function jt(t,e,n){t.$$.on_destroy.push(gh(e,n))}function fs(t){return t==null?"":t}function mh(t){return t&&da(t.destroy)?t.destroy:J}function k(t,e){t.appendChild(e)}function B(t,e,n){t.insertBefore(e,n||null)}function F(t){t.parentNode.removeChild(t)}function tg(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function A(t){return document.createElement(t)}function ce(t){return document.createTextNode(t)}function L(){return ce(" ")}function Hn(){return ce("")}function Y(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function vn(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Ht(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function I(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ng(t){return Array.from(t.childNodes)}function ye(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function On(t,e){t.value=e==null?"":e}function _t(t,e,n){t.classList[n?"add":"remove"](e)}function rg(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}let Sr;function br(t){Sr=t}function ri(){if(!Sr)throw new Error("Function called outside component initialization");return Sr}function pa(t){ri().$$.on_mount.push(t)}function sg(t){ri().$$.after_update.push(t)}function ga(t){ri().$$.on_destroy.push(t)}function yh(){const t=ri();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const i=rg(e,n,{cancelable:r});return s.slice().forEach(o=>{o.call(t,i)}),!i.defaultPrevented}return!0}}function zl(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const gr=[],Ln=[],As=[],Kl=[],vh=Promise.resolve();let So=!1;function bh(){So||(So=!0,vh.then(_h))}function wh(){return bh(),vh}function Do(t){As.push(t)}const no=new Set;let ds=0;function _h(){const t=Sr;do{for(;ds<gr.length;){const e=gr[ds];ds++,br(e),ig(e.$$)}for(br(null),gr.length=0,ds=0;Ln.length;)Ln.pop()();for(let e=0;e<As.length;e+=1){const n=As[e];no.has(n)||(no.add(n),n())}As.length=0}while(gr.length);for(;Kl.length;)Kl.pop()();So=!1,no.clear(),br(t)}function ig(t){if(t.fragment!==null){t.update(),Ge(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Do)}}const Ss=new Set;let en;function zt(){en={r:0,c:[],p:en}}function Kt(){en.r||Ge(en.c),en=en.p}function te(t,e){t&&t.i&&(Ss.delete(t),t.i(e))}function ie(t,e,n,r){if(t&&t.o){if(Ss.has(t))return;Ss.add(t),en.c.push(()=>{Ss.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function Eh(t,e){t.d(1),e.delete(t.key)}function og(t,e){ie(t,1,1,()=>{e.delete(t.key)})}function ma(t,e,n,r,s,i,o,a,l,c,u,f){let p=t.length,d=i.length,h=p;const g={};for(;h--;)g[t[h].key]=h;const v=[],m=new Map,y=new Map;for(h=d;h--;){const _=f(s,i,h),C=n(_);let T=o.get(C);T?r&&T.p(_,e):(T=c(C,_),T.c()),m.set(C,v[h]=T),C in g&&y.set(C,Math.abs(h-g[C]))}const E=new Set,w=new Set;function b(_){te(_,1),_.m(a,u),o.set(_.key,_),u=_.first,d--}for(;p&&d;){const _=v[d-1],C=t[p-1],T=_.key,D=C.key;_===C?(u=_.first,p--,d--):m.has(D)?!o.has(T)||E.has(T)?b(_):w.has(D)?p--:y.get(T)>y.get(D)?(w.add(T),b(_)):(E.add(D),p--):(l(C,o),p--)}for(;p--;){const _=t[p];m.has(_.key)||l(_,o)}for(;d;)b(v[d-1]);return v}function Th(t,e){const n={},r={},s={$$scope:1};let i=t.length;for(;i--;){const o=t[i],a=e[i];if(a){for(const l in o)l in a||(r[l]=1);for(const l in a)s[l]||(n[l]=a[l],s[l]=1);t[i]=a}else for(const l in o)s[l]=1}for(const o in r)o in n||(n[o]=void 0);return n}function kh(t){return typeof t=="object"&&t!==null?t:{}}function Ne(t){t&&t.c()}function Ce(t,e,n,r){const{fragment:s,on_mount:i,on_destroy:o,after_update:a}=t.$$;s&&s.m(e,n),r||Do(()=>{const l=i.map(ph).filter(da);o?o.push(...l):Ge(l),t.$$.on_mount=[]}),a.forEach(Do)}function Ie(t,e){const n=t.$$;n.fragment!==null&&(Ge(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ag(t,e){t.$$.dirty[0]===-1&&(gr.push(t),bh(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ze(t,e,n,r,s,i,o,a=[-1]){const l=Sr;br(t);const c=t.$$={fragment:null,ctx:null,props:i,update:J,not_equal:s,bound:Gl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Gl(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(f,p,...d)=>{const h=d.length?d[0]:p;return c.ctx&&s(c.ctx[f],c.ctx[f]=h)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](h),u&&ag(t,f)),p}):[],c.update(),u=!0,Ge(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const f=ng(e.target);c.fragment&&c.fragment.l(f),f.forEach(F)}else c.fragment&&c.fragment.c();e.intro&&te(t.$$.fragment),Ce(t,e.target,e.anchor,e.customElement),_h()}br(l)}class et{$destroy(){Ie(this,1),this.$destroy=J}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!eg(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const In=[];function Ch(t,e){return{subscribe:jr(t,e).subscribe}}function jr(t,e=J){let n;const r=new Set;function s(a){if(He(t,a)&&(t=a,n)){const l=!In.length;for(const c of r)c[1](),In.push(c,t);if(l){for(let c=0;c<In.length;c+=2)In[c][0](In[c+1]);In.length=0}}}function i(a){s(a(t))}function o(a,l=J){const c=[a,l];return r.add(c),r.size===1&&(n=e(s)||J),a(t),()=>{r.delete(c),r.size===0&&(n(),n=null)}}return{set:s,update:i,subscribe:o}}function Ih(t,e,n){const r=!Array.isArray(t),s=r?[t]:t,i=e.length<2;return Ch(n,o=>{let a=!1;const l=[];let c=0,u=J;const f=()=>{if(c)return;u();const d=e(r?l[0]:l,o);i?o(d):u=da(d)?d:J},p=s.map((d,h)=>gh(d,g=>{l[h]=g,c&=~(1<<h),a&&f()},()=>{c|=1<<h}));return a=!0,f(),function(){Ge(p),u()}})}function lg(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,r,s,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();s=l.shift();)n=s[0],n==="*"?(o.push("wild"),a+="/(.*)"):n===":"?(r=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~r?r:~i?i:s.length)),a+=!!~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~r?"?":"")+"\\"+s.substring(i))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}function cg(t){let e,n,r;const s=[t[2]];var i=t[0];function o(a){let l={};for(let c=0;c<s.length;c+=1)l=dh(l,s[c]);return{props:l}}return i&&(e=new i(o()),e.$on("routeEvent",t[7])),{c(){e&&Ne(e.$$.fragment),n=Hn()},m(a,l){e&&Ce(e,a,l),B(a,n,l),r=!0},p(a,l){const c=l&4?Th(s,[kh(a[2])]):{};if(i!==(i=a[0])){if(e){zt();const u=e;ie(u.$$.fragment,1,0,()=>{Ie(u,1)}),Kt()}i?(e=new i(o()),e.$on("routeEvent",a[7]),Ne(e.$$.fragment),te(e.$$.fragment,1),Ce(e,n.parentNode,n)):e=null}else i&&e.$set(c)},i(a){r||(e&&te(e.$$.fragment,a),r=!0)},o(a){e&&ie(e.$$.fragment,a),r=!1},d(a){a&&F(n),e&&Ie(e,a)}}}function ug(t){let e,n,r;const s=[{params:t[1]},t[2]];var i=t[0];function o(a){let l={};for(let c=0;c<s.length;c+=1)l=dh(l,s[c]);return{props:l}}return i&&(e=new i(o()),e.$on("routeEvent",t[6])),{c(){e&&Ne(e.$$.fragment),n=Hn()},m(a,l){e&&Ce(e,a,l),B(a,n,l),r=!0},p(a,l){const c=l&6?Th(s,[l&2&&{params:a[1]},l&4&&kh(a[2])]):{};if(i!==(i=a[0])){if(e){zt();const u=e;ie(u.$$.fragment,1,0,()=>{Ie(u,1)}),Kt()}i?(e=new i(o()),e.$on("routeEvent",a[6]),Ne(e.$$.fragment),te(e.$$.fragment,1),Ce(e,n.parentNode,n)):e=null}else i&&e.$set(c)},i(a){r||(e&&te(e.$$.fragment,a),r=!0)},o(a){e&&ie(e.$$.fragment,a),r=!1},d(a){a&&F(n),e&&Ie(e,a)}}}function hg(t){let e,n,r,s;const i=[ug,cg],o=[];function a(l,c){return l[1]?0:1}return e=a(t),n=o[e]=i[e](t),{c(){n.c(),r=Hn()},m(l,c){o[e].m(l,c),B(l,r,c),s=!0},p(l,[c]){let u=e;e=a(l),e===u?o[e].p(l,c):(zt(),ie(o[u],1,1,()=>{o[u]=null}),Kt(),n=o[e],n?n.p(l,c):(n=o[e]=i[e](l),n.c()),te(n,1),n.m(r.parentNode,r))},i(l){s||(te(n),s=!0)},o(l){ie(n),s=!1},d(l){o[e].d(l),l&&F(r)}}}function Ql(){const t=window.location.href.indexOf("#/");let e=t>-1?window.location.href.substr(t+1):"/";const n=e.indexOf("?");let r="";return n>-1&&(r=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:r}}const ya=Ch(null,function(e){e(Ql());const n=()=>{e(Ql())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});Ih(ya,t=>t.location);const Ah=Ih(ya,t=>t.querystring),Wl=jr(void 0);async function va(t){if(!t||t.length<1||t.charAt(0)!="/"&&t.indexOf("#/")!==0)throw Error("Invalid parameter location");await wh(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0,void 0),window.location.hash=(t.charAt(0)=="#"?"":"#")+t}function Sh(t,e){if(e=Yl(e),!t||!t.tagName||t.tagName.toLowerCase()!="a")throw Error('Action "link" can only be used with <a> tags');return Xl(t,e),{update(n){n=Yl(n),Xl(t,n)}}}function Xl(t,e){let n=e.href||t.getAttribute("href");if(n&&n.charAt(0)=="/")n="#"+n;else if(!n||n.length<2||n.slice(0,2)!="#/")throw Error('Invalid value for "href" attribute: '+n);t.setAttribute("href",n),t.addEventListener("click",r=>{r.preventDefault(),e.disabled||fg(r.currentTarget.getAttribute("href"))})}function Yl(t){return t&&typeof t=="string"?{href:t}:t||{}}function fg(t){history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0,void 0),window.location.hash=t}function dg(t,e,n){let{routes:r={}}=e,{prefix:s=""}=e,{restoreScrollState:i=!1}=e;class o{constructor(b,_){if(!_||typeof _!="function"&&(typeof _!="object"||_._sveltesparouter!==!0))throw Error("Invalid component object");if(!b||typeof b=="string"&&(b.length<1||b.charAt(0)!="/"&&b.charAt(0)!="*")||typeof b=="object"&&!(b instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:C,keys:T}=lg(b);this.path=b,typeof _=="object"&&_._sveltesparouter===!0?(this.component=_.component,this.conditions=_.conditions||[],this.userData=_.userData,this.props=_.props||{}):(this.component=()=>Promise.resolve(_),this.conditions=[],this.props={}),this._pattern=C,this._keys=T}match(b){if(s){if(typeof s=="string")if(b.startsWith(s))b=b.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const D=b.match(s);if(D&&D[0])b=b.substr(D[0].length)||"/";else return null}}const _=this._pattern.exec(b);if(_===null)return null;if(this._keys===!1)return _;const C={};let T=0;for(;T<this._keys.length;){try{C[this._keys[T]]=decodeURIComponent(_[T+1]||"")||null}catch{C[this._keys[T]]=null}T++}return C}async checkConditions(b){for(let _=0;_<this.conditions.length;_++)if(!await this.conditions[_](b))return!1;return!0}}const a=[];r instanceof Map?r.forEach((w,b)=>{a.push(new o(b,w))}):Object.keys(r).forEach(w=>{a.push(new o(w,r[w]))});let l=null,c=null,u={};const f=yh();async function p(w,b){await wh(),f(w,b)}let d=null,h=null;i&&(h=w=>{w.state&&w.state.__svelte_spa_router_scrollY?d=w.state:d=null},window.addEventListener("popstate",h),sg(()=>{d?window.scrollTo(d.__svelte_spa_router_scrollX,d.__svelte_spa_router_scrollY):window.scrollTo(0,0)}));let g=null,v=null;const m=ya.subscribe(async w=>{g=w;let b=0;for(;b<a.length;){const _=a[b].match(w.location);if(!_){b++;continue}const C={route:a[b].path,location:w.location,querystring:w.querystring,userData:a[b].userData,params:_&&typeof _=="object"&&Object.keys(_).length?_:null};if(!await a[b].checkConditions(C)){n(0,l=null),v=null,p("conditionsFailed",C);return}p("routeLoading",Object.assign({},C));const T=a[b].component;if(v!=T){T.loading?(n(0,l=T.loading),v=T,n(1,c=T.loadingParams),n(2,u={}),p("routeLoaded",Object.assign({},C,{component:l,name:l.name,params:c}))):(n(0,l=null),v=null);const D=await T();if(w!=g)return;n(0,l=D&&D.default||D),v=T}_&&typeof _=="object"&&Object.keys(_).length?n(1,c=_):n(1,c=null),n(2,u=a[b].props),p("routeLoaded",Object.assign({},C,{component:l,name:l.name,params:c})).then(()=>{Wl.set(c)});return}n(0,l=null),v=null,Wl.set(void 0)});ga(()=>{m(),h&&window.removeEventListener("popstate",h)});function y(w){zl.call(this,t,w)}function E(w){zl.call(this,t,w)}return t.$$set=w=>{"routes"in w&&n(3,r=w.routes),"prefix"in w&&n(4,s=w.prefix),"restoreScrollState"in w&&n(5,i=w.restoreScrollState)},t.$$.update=()=>{t.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[l,c,u,r,s,i,y,E]}class pg extends et{constructor(e){super(),Ze(this,e,dg,hg,He,{routes:3,prefix:4,restoreScrollState:5})}}function gg(t){let e,n,r,s,i,o,a,l,c,u,f;return{c(){e=A("div"),n=A("a"),r=ce(t[0]),s=L(),i=A("span"),o=ce(t[1]),a=L(),l=A("div"),l.innerHTML='<a href="https://github.com/rytsh/scrumik" target="_blank" class="hover:text-nl border-l border-white pl-4 pr-2">github</a>',I(n,"href","/"),I(n,"class","appearance-none text-xl font-bold mr-4 hover:text-nl"),I(l,"class","flex-grow text-right"),I(e,"class",c=`${t[2]} bg-black text-white flex items-center`)},m(p,d){B(p,e,d),k(e,n),k(n,r),k(e,s),k(e,i),k(i,o),k(e,a),k(e,l),u||(f=mh(Sh.call(null,n)),u=!0)},p(p,[d]){d&1&&ye(r,p[0]),d&2&&ye(o,p[1]),d&4&&c!==(c=`${p[2]} bg-black text-white flex items-center`)&&I(e,"class",c)},i:J,o:J,d(p){p&&F(e),u=!1,f()}}}function mg(t,e,n){let{title:r="scrumik"}=e,{message:s="scrum poker tool"}=e,{class:i=""}=e;return t.$$set=o=>{"title"in o&&n(0,r=o.title),"message"in o&&n(1,s=o.message),"class"in o&&n(2,i=o.class)},[r,s,i]}class yg extends et{constructor(e){super(),Ze(this,e,mg,gg,He,{title:0,message:1,class:2})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},vg=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},bg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,f=(i&3)<<4|a>>4;let p=(a&15)<<2|c>>6,d=c&63;l||(d=64,o||(p=64)),r.push(n[u],n[f],n[p],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Dh(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):vg(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const f=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw Error();const p=i<<2|a>>4;if(r.push(p),c!==64){const d=a<<4&240|c>>2;if(r.push(d),f!==64){const h=c<<6&192|f;r.push(h)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},wg=function(t){const e=Dh(t);return bg.encodeByteArray(e,!0)},Rh=function(t){return wg(t).replace(/\./g,"")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Eg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(si())}function xh(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Tg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kg(){return si().indexOf("Electron/")>=0}function Cg(){const t=si();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Ig(){return si().indexOf("MSAppHost/")>=0}function Nh(){return typeof indexedDB=="object"}function Oh(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function Ag(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sg="FirebaseError";class zn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Sg,Object.setPrototypeOf(this,zn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ii.prototype.create)}}class ii{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Dg(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new zn(s,a,r)}}function Dg(t,e){return t.replace(Rg,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Rg=/\{\$([^}]+)}/g;function Os(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Jl(i)&&Jl(o)){if(!Os(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Jl(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg=1e3,Ng=2,Og=4*60*60*1e3,Lg=.5;function Zl(t,e=xg,n=Ng){const r=e*Math.pow(n,t),s=Math.round(Lg*r*(Math.random()-.5)*2);return Math.min(Og,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yt(t){return t&&t._delegate?t._delegate:t}class St{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new _g;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Fg(e))try{this.getOrInitializeService({instanceIdentifier:Jt})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Jt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jt){return this.instances.has(e)}getOptions(e=Jt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Pg(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Jt){return this.component?this.component.multipleInstances?e:Jt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Pg(t){return t===Jt?void 0:t}function Fg(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Mg(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var re;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(re||(re={}));const jg={debug:re.DEBUG,verbose:re.VERBOSE,info:re.INFO,warn:re.WARN,error:re.ERROR,silent:re.SILENT},$g=re.INFO,Vg={[re.DEBUG]:"log",[re.VERBOSE]:"log",[re.INFO]:"info",[re.WARN]:"warn",[re.ERROR]:"error"},Ug=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Vg[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ba{constructor(e){this.name=e,this._logLevel=$g,this._logHandler=Ug,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,re.DEBUG,...e),this._logHandler(this,re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,re.VERBOSE,...e),this._logHandler(this,re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,re.INFO,...e),this._logHandler(this,re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,re.WARN,...e),this._logHandler(this,re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,re.ERROR,...e),this._logHandler(this,re.ERROR,...e)}}const qg=(t,e)=>e.some(n=>t instanceof n);let ec,tc;function Gg(){return ec||(ec=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Hg(){return tc||(tc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lh=new WeakMap,Ro=new WeakMap,Mh=new WeakMap,ro=new WeakMap,wa=new WeakMap;function zg(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Pt(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Lh.set(n,t)}).catch(()=>{}),wa.set(e,t),e}function Kg(t){if(Ro.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Ro.set(t,e)}let xo={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ro.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Mh.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Pt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Qg(t){xo=t(xo)}function Wg(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(so(this),e,...n);return Mh.set(r,e.sort?e.sort():[e]),Pt(r)}:Hg().includes(t)?function(...e){return t.apply(so(this),e),Pt(Lh.get(this))}:function(...e){return Pt(t.apply(so(this),e))}}function Xg(t){return typeof t=="function"?Wg(t):(t instanceof IDBTransaction&&Kg(t),qg(t,Gg())?new Proxy(t,xo):t)}function Pt(t){if(t instanceof IDBRequest)return zg(t);if(ro.has(t))return ro.get(t);const e=Xg(t);return e!==t&&(ro.set(t,e),wa.set(e,t)),e}const so=t=>wa.get(t);function Ph(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Pt(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Pt(o.result),l.oldVersion,l.newVersion,Pt(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const Yg=["get","getKey","getAll","getAllKeys","count"],Jg=["put","add","delete","clear"],io=new Map;function nc(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(io.get(e))return io.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Jg.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Yg.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return io.set(e,i),i}Qg(t=>({...t,get:(e,n,r)=>nc(e,n)||t.get(e,n,r),has:(e,n)=>!!nc(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(em(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function em(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const No="@firebase/app",rc="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a=new ba("@firebase/app"),tm="@firebase/app-compat",nm="@firebase/analytics-compat",rm="@firebase/analytics",sm="@firebase/app-check-compat",im="@firebase/app-check",om="@firebase/auth",am="@firebase/auth-compat",lm="@firebase/database",cm="@firebase/database-compat",um="@firebase/functions",hm="@firebase/functions-compat",fm="@firebase/installations",dm="@firebase/installations-compat",pm="@firebase/messaging",gm="@firebase/messaging-compat",mm="@firebase/performance",ym="@firebase/performance-compat",vm="@firebase/remote-config",bm="@firebase/remote-config-compat",wm="@firebase/storage",_m="@firebase/storage-compat",Em="@firebase/firestore",Tm="@firebase/firestore-compat",km="firebase",Cm="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="[DEFAULT]",Im={[No]:"fire-core",[tm]:"fire-core-compat",[rm]:"fire-analytics",[nm]:"fire-analytics-compat",[im]:"fire-app-check",[sm]:"fire-app-check-compat",[om]:"fire-auth",[am]:"fire-auth-compat",[lm]:"fire-rtdb",[cm]:"fire-rtdb-compat",[um]:"fire-fn",[hm]:"fire-fn-compat",[fm]:"fire-iid",[dm]:"fire-iid-compat",[pm]:"fire-fcm",[gm]:"fire-fcm-compat",[mm]:"fire-perf",[ym]:"fire-perf-compat",[vm]:"fire-rc",[bm]:"fire-rc-compat",[wm]:"fire-gcs",[_m]:"fire-gcs-compat",[Em]:"fire-fst",[Tm]:"fire-fst-compat","fire-js":"fire-js",[km]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls=new Map,Oo=new Map;function Am(t,e){try{t.container.addComponent(e)}catch(n){_a.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $t(t){const e=t.name;if(Oo.has(e))return _a.debug(`There were multiple attempts to register component ${e}.`),!1;Oo.set(e,t);for(const n of Ls.values())Am(n,t);return!0}function $r(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},cn=new ii("app","Firebase",Sm);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new St("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rm=Cm;function xm(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:Fh,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw cn.create("bad-app-name",{appName:String(r)});const s=Ls.get(r);if(s){if(Os(t,s.options)&&Os(n,s.config))return s;throw cn.create("duplicate-app",{appName:r})}const i=new Bg(r);for(const a of Oo.values())i.addComponent(a);const o=new Dm(t,n,i);return Ls.set(r,o),o}function Bh(t=Fh){const e=Ls.get(t);if(!e)throw cn.create("no-app",{appName:t});return e}function bt(t,e,n){var r;let s=(r=Im[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_a.warn(a.join(" "));return}$t(new St(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nm="firebase-heartbeat-database",Om=1,Dr="firebase-heartbeat-store";let oo=null;function jh(){return oo||(oo=Ph(Nm,Om,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Dr)}}}).catch(t=>{throw cn.create("storage-open",{originalErrorMessage:t.message})})),oo}async function Lm(t){var e;try{return(await jh()).transaction(Dr).objectStore(Dr).get($h(t))}catch(n){throw cn.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function sc(t,e){var n;try{const s=(await jh()).transaction(Dr,"readwrite");return await s.objectStore(Dr).put(e,$h(t)),s.done}catch(r){throw cn.create("storage-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message})}}function $h(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm=1024,Pm=30*24*60*60*1e3;class Fm{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new jm(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ic();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Pm}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ic(),{heartbeatsToSend:n,unsentEntries:r}=Bm(this._heartbeatsCache.heartbeats),s=Rh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function ic(){return new Date().toISOString().substring(0,10)}function Bm(t,e=Mm){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),oc(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),oc(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class jm{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Nh()?Oh().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Lm(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return sc(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return sc(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function oc(t){return Rh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(t){$t(new St("platform-logger",e=>new Zg(e),"PRIVATE")),$t(new St("heartbeat",e=>new Fm(e),"PRIVATE")),bt(No,rc,t),bt(No,rc,"esm2017"),bt("fire-js","")}$m("");var Vm="firebase",Um="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bt(Vm,Um,"app");const Vh="@firebase/installations",Ea="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=1e4,qh=`w:${Ea}`,Gh="FIS_v2",qm="https://firebaseinstallations.googleapis.com/v1",Gm=60*60*1e3,Hm="installations",zm="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},un=new ii(Hm,zm,Km);function Hh(t){return t instanceof zn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh({projectId:t}){return`${qm}/projects/${t}/installations`}function Kh(t){return{token:t.token,requestStatus:2,expiresIn:Wm(t.expiresIn),creationTime:Date.now()}}async function Qh(t,e){const r=(await e.json()).error;return un.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Wh({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function Qm(t,{refreshToken:e}){const n=Wh(t);return n.append("Authorization",Xm(e)),n}async function Xh(t){const e=await t();return e.status>=500&&e.status<600?t():e}function Wm(t){return Number(t.replace("s","000"))}function Xm(t){return`${Gh} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ym({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=zh(t),s=Wh(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:n,authVersion:Gh,appId:t.appId,sdkVersion:qh},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await Xh(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:Kh(c.authToken)}}else throw await Qh("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jm(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm=/^[cdef][\w-]{21}$/,Lo="";function ey(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=ty(t);return Zm.test(n)?n:Lo}catch{return Lo}}function ty(t){return Jm(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh=new Map;function Zh(t,e){const n=oi(t);ef(n,e),ny(n,e)}function ef(t,e){const n=Jh.get(t);if(!!n)for(const r of n)r(e)}function ny(t,e){const n=ry();n&&n.postMessage({key:t,fid:e}),sy()}let tn=null;function ry(){return!tn&&"BroadcastChannel"in self&&(tn=new BroadcastChannel("[Firebase] FID Change"),tn.onmessage=t=>{ef(t.data.key,t.data.fid)}),tn}function sy(){Jh.size===0&&tn&&(tn.close(),tn=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iy="firebase-installations-database",oy=1,hn="firebase-installations-store";let ao=null;function Ta(){return ao||(ao=Ph(iy,oy,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(hn)}}})),ao}async function Ms(t,e){const n=oi(t),s=(await Ta()).transaction(hn,"readwrite"),i=s.objectStore(hn),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&Zh(t,e.fid),e}async function tf(t){const e=oi(t),r=(await Ta()).transaction(hn,"readwrite");await r.objectStore(hn).delete(e),await r.done}async function ai(t,e){const n=oi(t),s=(await Ta()).transaction(hn,"readwrite"),i=s.objectStore(hn),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&Zh(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ka(t){let e;const n=await ai(t.appConfig,r=>{const s=ay(r),i=ly(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Lo?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function ay(t){const e=t||{fid:ey(),registrationStatus:0};return nf(e)}function ly(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(un.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=cy(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:uy(t)}:{installationEntry:e}}async function cy(t,e){try{const n=await Ym(t,e);return Ms(t.appConfig,n)}catch(n){throw Hh(n)&&n.customData.serverCode===409?await tf(t.appConfig):await Ms(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function uy(t){let e=await ac(t.appConfig);for(;e.registrationStatus===1;)await Yh(100),e=await ac(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await ka(t);return r||n}return e}function ac(t){return ai(t,e=>{if(!e)throw un.create("installation-not-found");return nf(e)})}function nf(t){return hy(t)?{fid:t.fid,registrationStatus:0}:t}function hy(t){return t.registrationStatus===1&&t.registrationTime+Uh<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fy({appConfig:t,heartbeatServiceProvider:e},n){const r=dy(t,n),s=Qm(t,n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:qh,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await Xh(()=>fetch(r,a));if(l.ok){const c=await l.json();return Kh(c)}else throw await Qh("Generate Auth Token",l)}function dy(t,{fid:e}){return`${zh(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ca(t,e=!1){let n;const r=await ai(t.appConfig,i=>{if(!rf(i))throw un.create("not-registered");const o=i.authToken;if(!e&&my(o))return i;if(o.requestStatus===1)return n=py(t,e),i;{if(!navigator.onLine)throw un.create("app-offline");const a=vy(i);return n=gy(t,a),a}});return n?await n:r.authToken}async function py(t,e){let n=await lc(t.appConfig);for(;n.authToken.requestStatus===1;)await Yh(100),n=await lc(t.appConfig);const r=n.authToken;return r.requestStatus===0?Ca(t,e):r}function lc(t){return ai(t,e=>{if(!rf(e))throw un.create("not-registered");const n=e.authToken;return by(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function gy(t,e){try{const n=await fy(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Ms(t.appConfig,r),n}catch(n){if(Hh(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await tf(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ms(t.appConfig,r)}throw n}}function rf(t){return t!==void 0&&t.registrationStatus===2}function my(t){return t.requestStatus===2&&!yy(t)}function yy(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Gm}function vy(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function by(t){return t.requestStatus===1&&t.requestTime+Uh<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wy(t){const e=t,{installationEntry:n,registrationPromise:r}=await ka(e);return r?r.catch(console.error):Ca(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _y(t,e=!1){const n=t;return await Ey(n),(await Ca(n,e)).token}async function Ey(t){const{registrationPromise:e}=await ka(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(t){if(!t||!t.options)throw lo("App Configuration");if(!t.name)throw lo("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw lo(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function lo(t){return un.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf="installations",ky="installations-internal",Cy=t=>{const e=t.getProvider("app").getImmediate(),n=Ty(e),r=$r(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Iy=t=>{const e=t.getProvider("app").getImmediate(),n=$r(e,sf).getImmediate();return{getId:()=>wy(n),getToken:s=>_y(n,s)}};function Ay(){$t(new St(sf,Cy,"PUBLIC")),$t(new St(ky,Iy,"PRIVATE"))}Ay();bt(Vh,Ea);bt(Vh,Ea,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps="analytics",Sy="firebase_id",Dy="origin",Ry=60*1e3,xy="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",of="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct=new ba("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function af(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function Ny(t,e){const n=document.createElement("script");n.src=`${of}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function Oy(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Ly(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await af(n)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(a){ct.error(a)}t("config",s,i)}async function My(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await af(n);for(const l of o){const c=a.find(f=>f.measurementId===l),u=c&&e[c.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){ct.error(i)}}function Py(t,e,n,r){async function s(i,o,a){try{i==="event"?await My(t,e,n,o,a):i==="config"?await Ly(t,e,n,r,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(l){ct.error(l)}}return s}function Fy(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=Py(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function By(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(of))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jy={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},ft=new ii("analytics","Analytics",jy);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=30,Vy=1e3;class Uy{constructor(e={},n=Vy){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const lf=new Uy;function qy(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Gy(t){var e;const{appId:n,apiKey:r}=t,s={method:"GET",headers:qy(r)},i=xy.replace("{app-id}",n),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw ft.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function Hy(t,e=lf,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw ft.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw ft.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Qy;return setTimeout(async()=>{a.abort()},n!==void 0?n:Ry),cf({appId:r,apiKey:s,measurementId:i},o,a,e)}async function cf(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=lf){var i,o;const{appId:a,measurementId:l}=t;try{await zy(r,e)}catch(c){if(l)return ct.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${(i=c)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:l};throw c}try{const c=await Gy(t);return s.deleteThrottleMetadata(a),c}catch(c){const u=c;if(!Ky(u)){if(s.deleteThrottleMetadata(a),l)return ct.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:l};throw c}const f=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?Zl(n,s.intervalMillis,$y):Zl(n,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+f,backoffCount:n+1};return s.setThrottleMetadata(a,p),ct.debug(`Calling attemptFetch again in ${f} millis`),cf(t,p,r,s)}}function zy(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(ft.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Ky(t){if(!(t instanceof zn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class Qy{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function Wy(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o=Object.assign(Object.assign({},r),{send_to:i});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xy(){var t;if(Nh())try{await Oh()}catch(e){return ct.warn(ft.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return ct.warn(ft.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Yy(t,e,n,r,s,i,o){var a;const l=Hy(t);l.then(d=>{n[d.measurementId]=d.appId,t.options.measurementId&&d.measurementId!==t.options.measurementId&&ct.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>ct.error(d)),e.push(l);const c=Xy().then(d=>{if(d)return r.getId()}),[u,f]=await Promise.all([l,c]);By()||Ny(i,u.measurementId),s("js",new Date);const p=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return p[Dy]="firebase",p.update=!0,f!=null&&(p[Sy]=f),s("config",u.measurementId,p),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e){this.app=e}_delete(){return delete wr[this.app.options.appId],Promise.resolve()}}let wr={},cc=[];const uc={};let co="dataLayer",Zy="gtag",hc,uf,fc=!1;function ev(){const t=[];if(xh()&&t.push("This is a browser extension environment."),Ag()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=ft.create("invalid-analytics-context",{errorInfo:e});ct.warn(n.message)}}function tv(t,e,n){ev();const r=t.options.appId;if(!r)throw ft.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)ct.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ft.create("no-api-key");if(wr[r]!=null)throw ft.create("already-exists",{id:r});if(!fc){Oy(co);const{wrappedGtag:i,gtagCore:o}=Fy(wr,cc,uc,co,Zy);uf=i,hc=o,fc=!0}return wr[r]=Yy(t,cc,uc,e,hc,co,n),new Jy(t)}function nv(t=Bh()){t=yt(t);const e=$r(t,Ps);return e.isInitialized()?e.getImmediate():rv(t)}function rv(t,e={}){const n=$r(t,Ps);if(n.isInitialized()){const s=n.getImmediate();if(Os(e,n.getOptions()))return s;throw ft.create("already-initialized")}return n.initialize({options:e})}function sv(t,e,n,r){t=yt(t),Wy(uf,wr[t.app.options.appId],e,n,r).catch(s=>ct.error(s))}const dc="@firebase/analytics",pc="0.8.0";function iv(){$t(new St(Ps,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return tv(r,s,n)},"PUBLIC")),$t(new St("analytics-internal",t,"PRIVATE")),bt(dc,pc),bt(dc,pc,"esm2017");function t(e){try{const n=e.getProvider(Ps).getImmediate();return{logEvent:(r,s,i)=>sv(n,r,s,i)}}catch(n){throw ft.create("interop-component-reg-failed",{reason:n})}}}iv();var ov=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},M,Ia=Ia||{},G=ov||self;function Fs(){}function Mo(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Vr(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function av(t){return Object.prototype.hasOwnProperty.call(t,uo)&&t[uo]||(t[uo]=++lv)}var uo="closure_uid_"+(1e9*Math.random()>>>0),lv=0;function cv(t,e,n){return t.call.apply(t.bind,arguments)}function uv(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Be(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Be=cv:Be=uv,Be.apply(null,arguments)}function ps(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ve(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function Qt(){this.s=this.s,this.o=this.o}var hv=0;Qt.prototype.s=!1;Qt.prototype.na=function(){!this.s&&(this.s=!0,this.M(),hv!=0)&&av(this)};Qt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const hf=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ff=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const r=t.length,s=typeof t=="string"?t.split(""):t;for(let i=0;i<r;i++)i in s&&e.call(n,s[i],i,t)};function fv(t){e:{var e=r0;const n=t.length,r=typeof t=="string"?t.split(""):t;for(let s=0;s<n;s++)if(s in r&&e.call(void 0,r[s],s,t)){e=s;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function gc(t){return Array.prototype.concat.apply([],arguments)}function Aa(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Bs(t){return/^[\s\xa0]*$/.test(t)}var mc=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ke(t,e){return t.indexOf(e)!=-1}function ho(t,e){return t<e?-1:t>e?1:0}var Qe;e:{var yc=G.navigator;if(yc){var vc=yc.userAgent;if(vc){Qe=vc;break e}}Qe=""}function Sa(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function df(t){const e={};for(const n in t)e[n]=t[n];return e}var bc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pf(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<bc.length;i++)n=bc[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Da(t){return Da[" "](t),t}Da[" "]=Fs;function dv(t){var e=mv;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var pv=Ke(Qe,"Opera"),Mn=Ke(Qe,"Trident")||Ke(Qe,"MSIE"),gf=Ke(Qe,"Edge"),Po=gf||Mn,mf=Ke(Qe,"Gecko")&&!(Ke(Qe.toLowerCase(),"webkit")&&!Ke(Qe,"Edge"))&&!(Ke(Qe,"Trident")||Ke(Qe,"MSIE"))&&!Ke(Qe,"Edge"),gv=Ke(Qe.toLowerCase(),"webkit")&&!Ke(Qe,"Edge");function yf(){var t=G.document;return t?t.documentMode:void 0}var js;e:{var fo="",po=function(){var t=Qe;if(mf)return/rv:([^\);]+)(\)|;)/.exec(t);if(gf)return/Edge\/([\d\.]+)/.exec(t);if(Mn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(gv)return/WebKit\/(\S+)/.exec(t);if(pv)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(po&&(fo=po?po[1]:""),Mn){var go=yf();if(go!=null&&go>parseFloat(fo)){js=String(go);break e}}js=fo}var mv={};function yv(){return dv(function(){let t=0;const e=mc(String(js)).split("."),n=mc("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var s=e[o]||"",i=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s[0].length==0&&i[0].length==0)break;t=ho(s[1].length==0?0:parseInt(s[1],10),i[1].length==0?0:parseInt(i[1],10))||ho(s[2].length==0,i[2].length==0)||ho(s[2],i[2]),s=s[3],i=i[3]}while(t==0)}return 0<=t})}var Fo;if(G.document&&Mn){var wc=yf();Fo=wc||parseInt(js,10)||void 0}else Fo=void 0;var vv=Fo,bv=function(){if(!G.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{G.addEventListener("test",Fs,e),G.removeEventListener("test",Fs,e)}catch{}return t}();function qe(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}qe.prototype.h=function(){this.defaultPrevented=!0};function Rr(t,e){if(qe.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(mf){e:{try{Da(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:wv[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Rr.Z.h.call(this)}}Ve(Rr,qe);var wv={2:"touch",3:"pen",4:"mouse"};Rr.prototype.h=function(){Rr.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Ur="closure_listenable_"+(1e6*Math.random()|0),_v=0;function Ev(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=s,this.key=++_v,this.ca=this.fa=!1}function li(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function ci(t){this.src=t,this.g={},this.h=0}ci.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=jo(t,e,r,s);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new Ev(e,this.src,i,!!r,s),e.fa=n,t.push(e)),e};function Bo(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=hf(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(li(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function jo(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==r)return s}return-1}var Ra="closure_lm_"+(1e6*Math.random()|0),mo={};function vf(t,e,n,r,s){if(r&&r.once)return wf(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)vf(t,e[i],n,r,s);return null}return n=Oa(n),t&&t[Ur]?t.N(e,n,Vr(r)?!!r.capture:!!r,s):bf(t,e,n,!1,r,s)}function bf(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Vr(s)?!!s.capture:!!s,a=Na(t);if(a||(t[Ra]=a=new ci(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=Tv(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)bv||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(Ef(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Tv(){function t(n){return e.call(t.src,t.listener,n)}var e=kv;return t}function wf(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)wf(t,e[i],n,r,s);return null}return n=Oa(n),t&&t[Ur]?t.O(e,n,Vr(r)?!!r.capture:!!r,s):bf(t,e,n,!0,r,s)}function _f(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)_f(t,e[i],n,r,s);else r=Vr(r)?!!r.capture:!!r,n=Oa(n),t&&t[Ur]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=jo(i,n,r,s),-1<n&&(li(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Na(t))&&(e=t.g[e.toString()],t=-1,e&&(t=jo(e,n,r,s)),(n=-1<t?e[t]:null)&&xa(n))}function xa(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[Ur])Bo(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ef(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Na(e))?(Bo(n,t),n.h==0&&(n.src=null,e[Ra]=null)):li(t)}}}function Ef(t){return t in mo?mo[t]:mo[t]="on"+t}function kv(t,e){if(t.ca)t=!0;else{e=new Rr(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&xa(t),t=n.call(r,e)}return t}function Na(t){return t=t[Ra],t instanceof ci?t:null}var yo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Oa(t){return typeof t=="function"?t:(t[yo]||(t[yo]=function(e){return t.handleEvent(e)}),t[yo])}function Le(){Qt.call(this),this.i=new ci(this),this.P=this,this.I=null}Ve(Le,Qt);Le.prototype[Ur]=!0;Le.prototype.removeEventListener=function(t,e,n,r){_f(this,t,e,n,r)};function je(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new qe(e,t);else if(e instanceof qe)e.target=e.target||t;else{var s=e;e=new qe(r,t),pf(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=gs(o,r,!0,e)&&s}if(o=e.g=t,s=gs(o,r,!0,e)&&s,s=gs(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=gs(o,r,!1,e)&&s}Le.prototype.M=function(){if(Le.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)li(n[r]);delete t.g[e],t.h--}}this.I=null};Le.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Le.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function gs(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&Bo(t.i,o),s=a.call(l,r)!==!1&&s}}return s&&!r.defaultPrevented}var La=G.JSON.stringify;function Cv(){var t=kf;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Iv{constructor(){this.h=this.g=null}add(e,n){const r=Tf.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var Tf=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Av,t=>t.reset());class Av{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Sv(t){G.setTimeout(()=>{throw t},0)}function Ma(t,e){$o||Dv(),Vo||($o(),Vo=!0),kf.add(t,e)}var $o;function Dv(){var t=G.Promise.resolve(void 0);$o=function(){t.then(Rv)}}var Vo=!1,kf=new Iv;function Rv(){for(var t;t=Cv();){try{t.h.call(t.g)}catch(n){Sv(n)}var e=Tf;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Vo=!1}function ui(t,e){Le.call(this),this.h=t||1,this.g=e||G,this.j=Be(this.kb,this),this.l=Date.now()}Ve(ui,Le);M=ui.prototype;M.da=!1;M.S=null;M.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),je(this,"tick"),this.da&&(Pa(this),this.start()))}};M.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Pa(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}M.M=function(){ui.Z.M.call(this),Pa(this),delete this.g};function Fa(t,e,n){if(typeof t=="function")n&&(t=Be(t,n));else if(t&&typeof t.handleEvent=="function")t=Be(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:G.setTimeout(t,e||0)}function Cf(t){t.g=Fa(()=>{t.g=null,t.i&&(t.i=!1,Cf(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class xv extends Qt{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Cf(this)}M(){super.M(),this.g&&(G.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xr(t){Qt.call(this),this.h=t,this.g={}}Ve(xr,Qt);var _c=[];function If(t,e,n,r){Array.isArray(n)||(n&&(_c[0]=n.toString()),n=_c);for(var s=0;s<n.length;s++){var i=vf(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function Af(t){Sa(t.g,function(e,n){this.g.hasOwnProperty(n)&&xa(e)},t),t.g={}}xr.prototype.M=function(){xr.Z.M.call(this),Af(this)};xr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function hi(){this.g=!0}hi.prototype.Aa=function(){this.g=!1};function Nv(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var f=u.split("_");o=2<=f.length&&f[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function Ov(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function Dn(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Mv(t,n)+(r?" "+r:"")})}function Lv(t,e){t.info(function(){return"TIMEOUT: "+e})}hi.prototype.info=function(){};function Mv(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return La(n)}catch{return e}}var bn={},Ec=null;function fi(){return Ec=Ec||new Le}bn.Ma="serverreachability";function Sf(t){qe.call(this,bn.Ma,t)}Ve(Sf,qe);function Nr(t){const e=fi();je(e,new Sf(e))}bn.STAT_EVENT="statevent";function Df(t,e){qe.call(this,bn.STAT_EVENT,t),this.stat=e}Ve(Df,qe);function We(t){const e=fi();je(e,new Df(e,t))}bn.Na="timingevent";function Rf(t,e){qe.call(this,bn.Na,t),this.size=e}Ve(Rf,qe);function qr(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return G.setTimeout(function(){t()},e)}var di={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},xf={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Ba(){}Ba.prototype.h=null;function Tc(t){return t.h||(t.h=t.i())}function Nf(){}var Gr={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ja(){qe.call(this,"d")}Ve(ja,qe);function $a(){qe.call(this,"c")}Ve($a,qe);var Uo;function pi(){}Ve(pi,Ba);pi.prototype.g=function(){return new XMLHttpRequest};pi.prototype.i=function(){return{}};Uo=new pi;function Hr(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new xr(this),this.P=Pv,t=Po?125:void 0,this.W=new ui(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Of}function Of(){this.i=null,this.g="",this.h=!1}var Pv=45e3,qo={},$s={};M=Hr.prototype;M.setTimeout=function(t){this.P=t};function Go(t,e,n){t.K=1,t.v=mi(Dt(e)),t.s=n,t.U=!0,Lf(t,null)}function Lf(t,e){t.F=Date.now(),zr(t),t.A=Dt(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Vf(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Of,t.g=ad(t.l,n?e:null,!t.s),0<t.O&&(t.L=new xv(Be(t.Ia,t,t.g),t.O)),If(t.V,t.g,"readystatechange",t.gb),e=t.H?df(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Nr(),Nv(t.j,t.u,t.A,t.m,t.X,t.s)}M.gb=function(t){t=t.target;const e=this.L;e&&Ct(t)==3?e.l():this.Ia(t)};M.Ia=function(t){try{if(t==this.g)e:{const u=Ct(this.g);var e=this.g.Da();const f=this.g.ba();if(!(3>u)&&(u!=3||Po||this.g&&(this.h.h||this.g.ga()||Ac(this.g)))){this.I||u!=4||e==7||(e==8||0>=f?Nr(3):Nr(2)),gi(this);var n=this.g.ba();this.N=n;t:if(Mf(this)){var r=Ac(this.g);t="";var s=r.length,i=Ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){nn(this),_r(this);var o="";break t}this.h.i=new G.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,Ov(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Bs(a)){var c=a;break t}}c=null}if(n=c)Dn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ho(this,n);else{this.i=!1,this.o=3,We(12),nn(this),_r(this);break e}}this.U?(Pf(this,u,o),Po&&this.i&&u==3&&(If(this.V,this.W,"tick",this.fb),this.W.start())):(Dn(this.j,this.m,o,null),Ho(this,o)),u==4&&nn(this),this.i&&!this.I&&(u==4?rd(this.l,this):(this.i=!1,zr(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,We(12)):(this.o=0,We(13)),nn(this),_r(this)}}}catch{}finally{}};function Mf(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function Pf(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=Fv(t,n),s==$s){e==4&&(t.o=4,We(14),r=!1),Dn(t.j,t.m,null,"[Incomplete Response]");break}else if(s==qo){t.o=4,We(15),Dn(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Dn(t.j,t.m,s,null),Ho(t,s);Mf(t)&&s!=$s&&s!=qo&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,We(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Wa(e),e.L=!0,We(11))):(Dn(t.j,t.m,n,"[Invalid Chunked Response]"),nn(t),_r(t))}M.fb=function(){if(this.g){var t=Ct(this.g),e=this.g.ga();this.C<e.length&&(gi(this),Pf(this,t,e),this.i&&t!=4&&zr(this))}};function Fv(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?$s:(n=Number(e.substring(n,r)),isNaN(n)?qo:(r+=1,r+n>e.length?$s:(e=e.substr(r,n),t.C=r+n,e)))}M.cancel=function(){this.I=!0,nn(this)};function zr(t){t.Y=Date.now()+t.P,Ff(t,t.P)}function Ff(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=qr(Be(t.eb,t),e)}function gi(t){t.B&&(G.clearTimeout(t.B),t.B=null)}M.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(Lv(this.j,this.A),this.K!=2&&(Nr(),We(17)),nn(this),this.o=2,_r(this)):Ff(this,this.Y-t)};function _r(t){t.l.G==0||t.I||rd(t.l,t)}function nn(t){gi(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,Pa(t.W),Af(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Ho(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||zo(n.i,t))){if(n.I=t.N,!t.J&&zo(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Gs(n),bi(n);else break e;Qa(n),We(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&n.A==0&&!n.v&&(n.v=qr(Be(n.ab,n),6e3));if(1>=Gf(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else rn(n,11)}else if((t.J||n.g==t)&&Gs(n),!Bs(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.U=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.J=c[1],n.la=c[2];const u=c[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const f=c[4];f!=null&&(n.za=f,n.h.info("SVER="+n.za));const p=c[5];p!=null&&typeof p=="number"&&0<p&&(r=1.5*p,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=t.g;if(d){const h=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var i=r.i;!i.g&&(Ke(h,"spdy")||Ke(h,"quic")||Ke(h,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(qa(i,i.h),i.h=null))}if(r.D){const g=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.sa=g,pe(r.F,r.D,g))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var o=t;if(r.oa=od(r,r.H?r.la:null,r.W),o.J){Hf(r.i,o);var a=o,l=r.K;l&&a.setTimeout(l),a.B&&(gi(a),zr(a)),r.g=o}else td(r);0<n.l.length&&wi(n)}else c[0]!="stop"&&c[0]!="close"||rn(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?rn(n,7):Ka(n):c[0]!="noop"&&n.j&&n.j.wa(c),n.A=0)}}Nr(4)}catch{}}function Bv(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(Mo(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Va(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Mo(t)||typeof t=="string")ff(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(Mo(t)||typeof t=="string"){n=[];for(var r=t.length,s=0;s<r;s++)n.push(s)}else for(s in n=[],r=0,t)n[r++]=s;r=Bv(t),s=r.length;for(var i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}}function Kn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Kn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}M=Kn.prototype;M.R=function(){Ua(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};M.T=function(){return Ua(this),this.g.concat()};function Ua(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];fn(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)r=t.g[e],fn(s,r)||(t.g[n++]=r,s[r]=1),e++;t.g.length=n}}M.get=function(t,e){return fn(this.h,t)?this.h[t]:e};M.set=function(t,e){fn(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};M.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var s=n[r],i=this.get(s);t.call(e,i,s,this)}};function fn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Bf=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function jv(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function dn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof dn){this.g=e!==void 0?e:t.g,Vs(this,t.j),this.s=t.s,Us(this,t.i),qs(this,t.m),this.l=t.l,e=t.h;var n=new Or;n.i=e.i,e.g&&(n.g=new Kn(e.g),n.h=e.h),kc(this,n),this.o=t.o}else t&&(n=String(t).match(Bf))?(this.g=!!e,Vs(this,n[1]||"",!0),this.s=Er(n[2]||""),Us(this,n[3]||"",!0),qs(this,n[4]),this.l=Er(n[5]||"",!0),kc(this,n[6]||"",!0),this.o=Er(n[7]||"")):(this.g=!!e,this.h=new Or(null,this.g))}dn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(mr(e,Cc,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(mr(e,Cc,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(mr(n,n.charAt(0)=="/"?Gv:qv,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",mr(n,zv)),t.join("")};function Dt(t){return new dn(t)}function Vs(t,e,n){t.j=n?Er(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Us(t,e,n){t.i=n?Er(e,!0):e}function qs(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function kc(t,e,n){e instanceof Or?(t.h=e,Kv(t.h,t.g)):(n||(e=mr(e,Hv)),t.h=new Or(e,t.g))}function pe(t,e,n){t.h.set(e,n)}function mi(t){return pe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function $v(t){return t instanceof dn?Dt(t):new dn(t,void 0)}function Vv(t,e,n,r){var s=new dn(null,void 0);return t&&Vs(s,t),e&&Us(s,e),n&&qs(s,n),r&&(s.l=r),s}function Er(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function mr(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,Uv),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Uv(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Cc=/[#\/\?@]/g,qv=/[#\?:]/g,Gv=/[#\?]/g,Hv=/[#\?@]/g,zv=/#/g;function Or(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Wt(t){t.g||(t.g=new Kn,t.h=0,t.i&&jv(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}M=Or.prototype;M.add=function(t,e){Wt(this),this.i=null,t=Qn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function jf(t,e){Wt(t),e=Qn(t,e),fn(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,fn(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Ua(t)))}function $f(t,e){return Wt(t),e=Qn(t,e),fn(t.g.h,e)}M.forEach=function(t,e){Wt(this),this.g.forEach(function(n,r){ff(n,function(s){t.call(e,s,r,this)},this)},this)};M.T=function(){Wt(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var s=t[r],i=0;i<s.length;i++)n.push(e[r]);return n};M.R=function(t){Wt(this);var e=[];if(typeof t=="string")$f(this,t)&&(e=gc(e,this.g.get(Qn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=gc(e,t[n])}return e};M.set=function(t,e){return Wt(this),this.i=null,t=Qn(this,t),$f(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};M.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function Vf(t,e,n){jf(t,e),0<n.length&&(t.i=null,t.g.set(Qn(t,e),Aa(n)),t.h+=n.length)}M.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],s=encodeURIComponent(String(r));r=this.R(r);for(var i=0;i<r.length;i++){var o=s;r[i]!==""&&(o+="="+encodeURIComponent(String(r[i]))),t.push(o)}}return this.i=t.join("&")};function Qn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Kv(t,e){e&&!t.j&&(Wt(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(jf(this,r),Vf(this,s,n))},t)),t.j=e}var Qv=class{constructor(t,e){this.h=t,this.g=e}};function Uf(t){this.l=t||Wv,G.PerformanceNavigationTiming?(t=G.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(G.g&&G.g.Ea&&G.g.Ea()&&G.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Wv=10;function qf(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Gf(t){return t.h?1:t.g?t.g.size:0}function zo(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function qa(t,e){t.g?t.g.add(e):t.h=e}function Hf(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Uf.prototype.cancel=function(){if(this.i=zf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function zf(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Aa(t.i)}function Ga(){}Ga.prototype.stringify=function(t){return G.JSON.stringify(t,void 0)};Ga.prototype.parse=function(t){return G.JSON.parse(t,void 0)};function Xv(){this.g=new Ga}function Yv(t,e,n){const r=n||"";try{Va(t,function(s,i){let o=s;Vr(s)&&(o=La(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function Jv(t,e){const n=new hi;if(G.Image){const r=new Image;r.onload=ps(ms,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ps(ms,n,r,"TestLoadImage: error",!1,e),r.onabort=ps(ms,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ps(ms,n,r,"TestLoadImage: timeout",!1,e),G.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function ms(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Kr(t){this.l=t.$b||null,this.j=t.ib||!1}Ve(Kr,Ba);Kr.prototype.g=function(){return new yi(this.l,this.j)};Kr.prototype.i=function(t){return function(){return t}}({});function yi(t,e){Le.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Ha,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ve(yi,Le);var Ha=0;M=yi.prototype;M.open=function(t,e){if(this.readyState!=Ha)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Lr(this)};M.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||G).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};M.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Qr(this)),this.readyState=Ha};M.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Lr(this)),this.g&&(this.readyState=3,Lr(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof G.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Kf(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function Kf(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}M.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Qr(this):Lr(this),this.readyState==3&&Kf(this)}};M.Ua=function(t){this.g&&(this.response=this.responseText=t,Qr(this))};M.Ta=function(t){this.g&&(this.response=t,Qr(this))};M.ha=function(){this.g&&Qr(this)};function Qr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Lr(t)}M.setRequestHeader=function(t,e){this.v.append(t,e)};M.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};M.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Lr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Zv=G.JSON.parse;function Te(t){Le.call(this),this.headers=new Kn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Qf,this.K=this.L=!1}Ve(Te,Le);var Qf="",e0=/^https?$/i,t0=["POST","PUT"];M=Te.prototype;M.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Uo.g(),this.C=this.u?Tc(this.u):Tc(Uo),this.g.onreadystatechange=Be(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){Ic(this,i);return}t=n||"";const s=new Kn(this.headers);r&&Va(r,function(i,o){s.set(o,i)}),r=fv(s.T()),n=G.FormData&&t instanceof G.FormData,!(0<=hf(t0,e))||r||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Yf(this),0<this.B&&((this.K=n0(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Be(this.pa,this)):this.A=Fa(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Ic(this,i)}};function n0(t){return Mn&&yv()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function r0(t){return t.toLowerCase()=="content-type"}M.pa=function(){typeof Ia<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,je(this,"timeout"),this.abort(8))};function Ic(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Wf(t),vi(t)}function Wf(t){t.D||(t.D=!0,je(t,"complete"),je(t,"error"))}M.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,je(this,"complete"),je(this,"abort"),vi(this))};M.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vi(this,!0)),Te.Z.M.call(this)};M.Fa=function(){this.s||(this.F||this.v||this.l?Xf(this):this.cb())};M.cb=function(){Xf(this)};function Xf(t){if(t.h&&typeof Ia<"u"&&(!t.C[1]||Ct(t)!=4||t.ba()!=2)){if(t.v&&Ct(t)==4)Fa(t.Fa,0,t);else if(je(t,"readystatechange"),Ct(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(Bf)[1]||null;if(!s&&G.self&&G.self.location){var i=G.self.location.protocol;s=i.substr(0,i.length-1)}r=!e0.test(s?s.toLowerCase():"")}n=r}if(n)je(t,"complete"),je(t,"success");else{t.m=6;try{var o=2<Ct(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",Wf(t)}}finally{vi(t)}}}}function vi(t,e){if(t.g){Yf(t);const n=t.g,r=t.C[0]?Fs:null;t.g=null,t.C=null,e||je(t,"ready");try{n.onreadystatechange=r}catch{}}}function Yf(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(G.clearTimeout(t.A),t.A=null)}function Ct(t){return t.g?t.g.readyState:0}M.ba=function(){try{return 2<Ct(this)?this.g.status:-1}catch{return-1}};M.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};M.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Zv(e)}};function Ac(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Qf:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}M.Da=function(){return this.m};M.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function s0(t){let e="";return Sa(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function za(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=s0(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):pe(t,e,n))}function fr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Jf(t){this.za=0,this.l=[],this.h=new hi,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=fr("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=fr("baseRetryDelayMs",5e3,t),this.$a=fr("retryDelaySeedMs",1e4,t),this.Ya=fr("forwardChannelMaxRetries",2,t),this.ra=fr("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Uf(t&&t.concurrentRequestLimit),this.Ca=new Xv,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}M=Jf.prototype;M.ma=8;M.G=1;function Ka(t){if(Zf(t),t.G==3){var e=t.V++,n=Dt(t.F);pe(n,"SID",t.J),pe(n,"RID",e),pe(n,"TYPE","terminate"),Wr(t,n),e=new Hr(t,t.h,e,void 0),e.K=2,e.v=mi(Dt(n)),n=!1,G.navigator&&G.navigator.sendBeacon&&(n=G.navigator.sendBeacon(e.v.toString(),"")),!n&&G.Image&&(new Image().src=e.v,n=!0),n||(e.g=ad(e.l,null),e.g.ea(e.v)),e.F=Date.now(),zr(e)}id(t)}M.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function bi(t){t.g&&(Wa(t),t.g.cancel(),t.g=null)}function Zf(t){bi(t),t.u&&(G.clearTimeout(t.u),t.u=null),Gs(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&G.clearTimeout(t.m),t.m=null)}function vo(t,e){t.l.push(new Qv(t.Za++,e)),t.G==3&&wi(t)}function wi(t){qf(t.i)||t.m||(t.m=!0,Ma(t.Ha,t),t.C=0)}function i0(t,e){return Gf(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=qr(Be(t.Ha,t,e),sd(t,t.C)),t.C++,!0)}M.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new Hr(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=df(i),pf(i,this.P)):i=this.P),this.o===null&&(s.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var r=this.l[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=ed(this,s,e),n=Dt(this.F),pe(n,"RID",t),pe(n,"CVER",22),this.D&&pe(n,"X-HTTP-Session-Id",this.D),Wr(this,n),this.o&&i&&za(n,this.o,i),qa(this.i,s),this.Ra&&pe(n,"TYPE","init"),this.ja?(pe(n,"$req",e),pe(n,"SID","null"),s.$=!0,Go(s,n,null)):Go(s,n,e),this.G=2}}else this.G==3&&(t?Sc(this,t):this.l.length==0||qf(this.i)||Sc(this))};function Sc(t,e){var n;e?n=e.m:n=t.V++;const r=Dt(t.F);pe(r,"SID",t.J),pe(r,"RID",n),pe(r,"AID",t.U),Wr(t,r),t.o&&t.s&&za(r,t.o,t.s),n=new Hr(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=ed(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),qa(t.i,n),Go(n,r,e)}function Wr(t,e){t.j&&Va({},function(n,r){pe(e,r,n)})}function ed(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Be(t.j.Oa,t.j,t):null;e:{var s=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let l=0;l<n;l++){let c=s[l].h;const u=s[l].g;if(c-=i,0>c)i=Math.max(0,s[l].h-100),a=!1;else try{Yv(u,o,"req"+c+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,r}function td(t){t.g||t.u||(t.Y=1,Ma(t.Ga,t),t.A=0)}function Qa(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=qr(Be(t.Ga,t),sd(t,t.A)),t.A++,!0)}M.Ga=function(){if(this.u=null,nd(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=qr(Be(this.bb,this),t)}};M.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,We(10),bi(this),nd(this))};function Wa(t){t.B!=null&&(G.clearTimeout(t.B),t.B=null)}function nd(t){t.g=new Hr(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=Dt(t.oa);pe(e,"RID","rpc"),pe(e,"SID",t.J),pe(e,"CI",t.N?"0":"1"),pe(e,"AID",t.U),Wr(t,e),pe(e,"TYPE","xmlhttp"),t.o&&t.s&&za(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=mi(Dt(e)),n.s=null,n.U=!0,Lf(n,t)}M.ab=function(){this.v!=null&&(this.v=null,bi(this),Qa(this),We(19))};function Gs(t){t.v!=null&&(G.clearTimeout(t.v),t.v=null)}function rd(t,e){var n=null;if(t.g==e){Gs(t),Wa(t),t.g=null;var r=2}else if(zo(t.i,e))n=e.D,Hf(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=fi(),je(r,new Rf(r,n)),wi(t)}else td(t);else if(s=e.o,s==3||s==0&&0<t.I||!(r==1&&i0(t,e)||r==2&&Qa(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:rn(t,5);break;case 4:rn(t,10);break;case 3:rn(t,6);break;default:rn(t,2)}}}function sd(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function rn(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=Be(t.jb,t);n||(n=new dn("//www.google.com/images/cleardot.gif"),G.location&&G.location.protocol=="http"||Vs(n,"https"),mi(n)),Jv(n.toString(),r)}else We(2);t.G=0,t.j&&t.j.va(e),id(t),Zf(t)}M.jb=function(t){t?(this.h.info("Successfully pinged google.com"),We(2)):(this.h.info("Failed to ping google.com"),We(1))};function id(t){t.G=0,t.I=-1,t.j&&((zf(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,Aa(t.l),t.l.length=0),t.j.ua())}function od(t,e,n){let r=$v(n);if(r.i!="")e&&Us(r,e+"."+r.i),qs(r,r.m);else{const s=G.location;r=Vv(s.protocol,e?e+"."+s.hostname:s.hostname,+s.port,n)}return t.aa&&Sa(t.aa,function(s,i){pe(r,i,s)}),e=t.D,n=t.sa,e&&n&&pe(r,e,n),pe(r,"VER",t.ma),Wr(t,r),r}function ad(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new Te(new Kr({ib:!0})):new Te(t.qa),e.L=t.H,e}function ld(){}M=ld.prototype;M.xa=function(){};M.wa=function(){};M.va=function(){};M.ua=function(){};M.Oa=function(){};function Hs(){if(Mn&&!(10<=Number(vv)))throw Error("Environmental error: no available transport.")}Hs.prototype.g=function(t,e){return new ut(t,e)};function ut(t,e){Le.call(this),this.g=new Jf(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Bs(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Bs(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Wn(this)}Ve(ut,Le);ut.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Ma(Be(t.hb,t,e))),We(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=od(t,null,t.W),wi(t)};ut.prototype.close=function(){Ka(this.g)};ut.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,vo(this.g,e)}else this.v?(e={},e.__data__=La(t),vo(this.g,e)):vo(this.g,t)};ut.prototype.M=function(){this.g.j=null,delete this.j,Ka(this.g),delete this.g,ut.Z.M.call(this)};function cd(t){ja.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ve(cd,ja);function ud(){$a.call(this),this.status=1}Ve(ud,$a);function Wn(t){this.g=t}Ve(Wn,ld);Wn.prototype.xa=function(){je(this.g,"a")};Wn.prototype.wa=function(t){je(this.g,new cd(t))};Wn.prototype.va=function(t){je(this.g,new ud)};Wn.prototype.ua=function(){je(this.g,"b")};Hs.prototype.createWebChannel=Hs.prototype.g;ut.prototype.send=ut.prototype.u;ut.prototype.open=ut.prototype.m;ut.prototype.close=ut.prototype.close;di.NO_ERROR=0;di.TIMEOUT=8;di.HTTP_ERROR=6;xf.COMPLETE="complete";Nf.EventType=Gr;Gr.OPEN="a";Gr.CLOSE="b";Gr.ERROR="c";Gr.MESSAGE="d";Le.prototype.listen=Le.prototype.N;Te.prototype.listenOnce=Te.prototype.O;Te.prototype.getLastError=Te.prototype.La;Te.prototype.getLastErrorCode=Te.prototype.Da;Te.prototype.getStatus=Te.prototype.ba;Te.prototype.getResponseJson=Te.prototype.Qa;Te.prototype.getResponseText=Te.prototype.ga;Te.prototype.send=Te.prototype.ea;var o0=function(){return new Hs},a0=function(){return fi()},bo=di,l0=xf,c0=bn,Dc={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},u0=Kr,ys=Nf,h0=Te;const Rc="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}nt.UNAUTHENTICATED=new nt(null),nt.GOOGLE_CREDENTIALS=new nt("google-credentials-uid"),nt.FIRST_PARTY=new nt("first-party-uid"),nt.MOCK_USER=new nt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xn="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn=new ba("@firebase/firestore");function xc(){return pn.logLevel}function j(t,...e){if(pn.logLevel<=re.DEBUG){const n=e.map(Xa);pn.debug(`Firestore (${Xn}): ${t}`,...n)}}function Vt(t,...e){if(pn.logLevel<=re.ERROR){const n=e.map(Xa);pn.error(`Firestore (${Xn}): ${t}`,...n)}}function Nc(t,...e){if(pn.logLevel<=re.WARN){const n=e.map(Xa);pn.warn(`Firestore (${Xn}): ${t}`,...n)}}function Xa(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z(t="Unexpected state"){const e=`FIRESTORE (${Xn}) INTERNAL ASSERTION FAILED: `+t;throw Vt(e),new Error(e)}function ue(t,e){t||z()}function Q(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends zn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class d0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(nt.UNAUTHENTICATED))}shutdown(){}}class p0{constructor(e){this.t=e,this.currentUser=nt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new Ft;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ft,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ft)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string"),new f0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string"),new nt(e)}}class g0{constructor(e,n,r){this.type="FirstParty",this.user=nt.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const s=e.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class m0{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new g0(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(nt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class y0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class v0{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const r=i=>{i.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?s(i):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ue(typeof n.token=="string"),this.p=n.token,new y0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=b0(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function se(t,e){return t<e?-1:t>e?1:0}function Pn(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new U(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new U(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new U(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ae.fromMillis(Date.now())}static fromDate(e){return Ae.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ae(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.timestamp=e}static fromTimestamp(e){return new X(e)}static min(){return new X(new Ae(0,0))}static max(){return new X(new Ae(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,n,r){n===void 0?n=0:n>e.length&&z(),r===void 0?r=e.length-n:r>e.length-n&&z(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Mr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Mr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ge extends Mr{construct(e,n,r){return new ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new U(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ge(n)}static emptyPath(){return new ge([])}}const w0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ue extends Mr{construct(e,n,r){return new Ue(e,n,r)}static isValidIdentifier(e){return w0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ue.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ue(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new U(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new U(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new U(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new U(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ue(n)}static emptyPath(){return new Ue([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.path=e}static fromPath(e){return new V(ge.fromString(e))}static fromName(e){return new V(ge.fromString(e).popFirst(5))}static empty(){return new V(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new V(new ge(e.slice()))}}function _0(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=X.fromTimestamp(r===1e9?new Ae(n+1,0):new Ae(n,r));return new Ut(s,V.empty(),e)}function E0(t){return new Ut(t.readTime,t.key,-1)}class Ut{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ut(X.min(),V.empty(),-1)}static max(){return new Ut(X.max(),V.empty(),-1)}}function T0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=V.comparator(t.documentKey,e.documentKey),n!==0?n:se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class C0{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xr(t){if(t.code!==R.FAILED_PRECONDITION||t.message!==k0)throw t;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new x((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof x?n:x.resolve(n)}catch(n){return x.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):x.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):x.reject(n)}static resolve(e){return new x((n,r)=>{n(e)})}static reject(e){return new x((n,r)=>{r(e)})}static waitFor(e){return new x((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=x.resolve(!1);for(const r of e)n=n.next(s=>s?x.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new x((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new x((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Yr(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.it(r),this.rt=r=>n.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wn(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fd(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ya.ot=-1;class De{constructor(e,n){this.comparator=e,this.root=n||Pe.EMPTY}insert(e,n){return new De(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Pe.BLACK,null,null))}remove(e){return new De(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pe.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vs(this.root,e,this.comparator,!1)}getReverseIterator(){return new vs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vs(this.root,e,this.comparator,!0)}}class vs{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Pe{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Pe.RED,this.left=s!=null?s:Pe.EMPTY,this.right=i!=null?i:Pe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Pe(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Pe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Pe.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Pe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Pe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw z();const e=this.left.check();if(e!==this.right.check())throw z();return e+(this.isRed()?0:1)}}Pe.EMPTY=null,Pe.RED=!0,Pe.BLACK=!1;Pe.EMPTY=new class{constructor(){this.size=0}get key(){throw z()}get value(){throw z()}get color(){throw z()}get left(){throw z()}get right(){throw z()}copy(t,e,n,r,s){return this}insert(t,e,n){return new Pe(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.comparator=e,this.data=new De(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Lc(this.data.getIterator())}getIteratorFrom(e){return new Lc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Se)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Se(this.comparator);return n.data=e,n}}class Lc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.fields=e,e.sort(Ue.comparator)}static empty(){return new dt([])}unionWith(e){let n=new Se(Ue.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new dt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Pn(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new $e(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new $e(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$e.EMPTY_BYTE_STRING=new $e("");const I0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qt(t){if(ue(!!t),typeof t=="string"){let e=0;const n=I0.exec(t);if(ue(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ee(t.seconds),nanos:Ee(t.nanos)}}function Ee(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Fn(t){return typeof t=="string"?$e.fromBase64String(t):$e.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function pd(t){const e=t.mapValue.fields.__previous_value__;return dd(e)?pd(e):e}function Pr(t){const e=qt(t.mapValue.fields.__local_write_time__.timestampValue);return new Ae(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,n,r,s,i,o,a,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class Bn{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Bn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Bn&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(t){return t==null}function zs(t){return t===0&&1/t==-1/0}function S0(t){return typeof t=="number"&&Number.isInteger(t)&&!zs(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function gn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?dd(t)?4:D0(t)?9007199254740991:10:z()}function Et(t,e){if(t===e)return!0;const n=gn(t);if(n!==gn(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Pr(t).isEqual(Pr(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=qt(r.timestampValue),o=qt(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return Fn(r.bytesValue).isEqual(Fn(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return Ee(r.geoPointValue.latitude)===Ee(s.geoPointValue.latitude)&&Ee(r.geoPointValue.longitude)===Ee(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Ee(r.integerValue)===Ee(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=Ee(r.doubleValue),o=Ee(s.doubleValue);return i===o?zs(i)===zs(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Pn(t.arrayValue.values||[],e.arrayValue.values||[],Et);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(Oc(i)!==Oc(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Et(i[a],o[a])))return!1;return!0}(t,e);default:return z()}}function Fr(t,e){return(t.values||[]).find(n=>Et(n,e))!==void 0}function jn(t,e){if(t===e)return 0;const n=gn(t),r=gn(e);if(n!==r)return se(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return se(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=Ee(s.integerValue||s.doubleValue),a=Ee(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return Mc(t.timestampValue,e.timestampValue);case 4:return Mc(Pr(t),Pr(e));case 5:return se(t.stringValue,e.stringValue);case 6:return function(s,i){const o=Fn(s),a=Fn(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=se(o[l],a[l]);if(c!==0)return c}return se(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=se(Ee(s.latitude),Ee(i.latitude));return o!==0?o:se(Ee(s.longitude),Ee(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=jn(o[l],a[l]);if(c)return c}return se(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===bs.mapValue&&i===bs.mapValue)return 0;if(s===bs.mapValue)return 1;if(i===bs.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),l=i.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let u=0;u<a.length&&u<c.length;++u){const f=se(a[u],c[u]);if(f!==0)return f;const p=jn(o[a[u]],l[c[u]]);if(p!==0)return p}return se(a.length,c.length)}(t.mapValue,e.mapValue);default:throw z()}}function Mc(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return se(t,e);const n=qt(t),r=qt(e),s=se(n.seconds,r.seconds);return s!==0?s:se(n.nanos,r.nanos)}function xn(t){return Ko(t)}function Ko(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=qt(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Fn(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,V.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=Ko(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${Ko(r.fields[a])}`;return i+"}"}(t.mapValue):z();var e,n}function Qo(t){return!!t&&"integerValue"in t}function Ja(t){return!!t&&"arrayValue"in t}function Pc(t){return!!t&&"nullValue"in t}function Fc(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ds(t){return!!t&&"mapValue"in t}function Tr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return wn(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Tr(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Tr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function D0(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.value=e}static empty(){return new rt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ds(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Tr(n)}setAll(e){let n=Ue.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Tr(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Ds(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Et(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ds(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){wn(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new rt(Tr(this.value))}}function gd(t){const e=[];return wn(t.fields,(n,r)=>{const s=new Ue([n]);if(Ds(r)){const i=gd(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new dt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,n,r,s,i,o){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Fe(e,0,X.min(),X.min(),rt.empty(),0)}static newFoundDocument(e,n,r){return new Fe(e,1,n,X.min(),r,0)}static newNoDocument(e,n){return new Fe(e,2,n,X.min(),rt.empty(),0)}static newUnknownDocument(e,n){return new Fe(e,3,n,X.min(),rt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Fe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fe(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function Bc(t,e=null,n=[],r=[],s=null,i=null,o=null){return new R0(t,e,n,r,s,i,o)}function Za(t){const e=Q(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+xn(s.value);var s}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),_i(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>xn(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>xn(r)).join(",")),e.ut=n}return e.ut}function x0(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${xn(r.value)}`;var r}).join(", ")}]`),_i(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>xn(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>xn(n)).join(",")),`Target(${e})`}function el(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!j0(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],r=e.filters[s],n.op!==r.op||!n.field.isEqual(r.field)||!Et(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$c(t.startAt,e.startAt)&&$c(t.endAt,e.endAt)}function Wo(t){return V.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class st extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,r):new N0(e,n,r):n==="array-contains"?new M0(e,r):n==="in"?new P0(e,r):n==="not-in"?new F0(e,r):n==="array-contains-any"?new B0(e,r):new st(e,n,r)}static ct(e,n,r){return n==="in"?new O0(e,r):new L0(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(jn(n,this.value)):n!==null&&gn(this.value)===gn(n)&&this.at(jn(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return z()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class N0 extends st{constructor(e,n,r){super(e,n,r),this.key=V.fromName(r.referenceValue)}matches(e){const n=V.comparator(e.key,this.key);return this.at(n)}}class O0 extends st{constructor(e,n){super(e,"in",n),this.keys=md("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class L0 extends st{constructor(e,n){super(e,"not-in",n),this.keys=md("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function md(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>V.fromName(r.referenceValue))}class M0 extends st{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ja(n)&&Fr(n.arrayValue,this.value)}}class P0 extends st{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Fr(this.value.arrayValue,n)}}class F0 extends st{constructor(e,n){super(e,"not-in",n)}matches(e){if(Fr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Fr(this.value.arrayValue,n)}}class B0 extends st{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ja(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Fr(this.value.arrayValue,r))}}class Ks{constructor(e,n){this.position=e,this.inclusive=n}}class kr{constructor(e,n="asc"){this.field=e,this.dir=n}}function j0(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function jc(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=V.comparator(V.fromName(o.referenceValue),n.key):r=jn(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function $c(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Et(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.lt=null,this.ft=null,this.startAt,this.endAt}}function $0(t,e,n,r,s,i,o,a){return new Ei(t,e,n,r,s,i,o,a)}function Ti(t){return new Ei(t)}function V0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function U0(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function q0(t){for(const e of t.filters)if(e.ht())return e.field;return null}function G0(t){return t.collectionGroup!==null}function Br(t){const e=Q(t);if(e.lt===null){e.lt=[];const n=q0(e),r=U0(e);if(n!==null&&r===null)n.isKeyField()||e.lt.push(new kr(n)),e.lt.push(new kr(Ue.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new kr(Ue.keyField(),i))}}}return e.lt}function mn(t){const e=Q(t);if(!e.ft)if(e.limitType==="F")e.ft=Bc(e.path,e.collectionGroup,Br(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Br(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new kr(i.field,o))}const r=e.endAt?new Ks(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Ks(e.startAt.position,e.startAt.inclusive):null;e.ft=Bc(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.ft}function H0(t,e,n){return new Ei(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ki(t,e){return el(mn(t),mn(e))&&t.limitType===e.limitType}function yd(t){return`${Za(mn(t))}|lt:${t.limitType}`}function Xo(t){return`Query(target=${x0(mn(t))}; limitType=${t.limitType})`}function tl(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):V.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of n.explicitOrderBy)if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=jc(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,Br(n),r)||n.endAt&&!function(s,i,o){const a=jc(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,Br(n),r))}(t,e)}function z0(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function vd(t){return(e,n)=>{let r=!1;for(const s of Br(t)){const i=K0(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function K0(t,e,n){const r=t.field.isKeyField()?V.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),l=o.data.field(s);return a!==null&&l!==null?jn(a,l):z()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return z()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zs(e)?"-0":e}}function wd(t){return{integerValue:""+t}}function Q0(t,e){return S0(e)?wd(e):bd(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(){this._=void 0}}function W0(t,e,n){return t instanceof Qs?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof $n?Ed(t,e):t instanceof Vn?Td(t,e):function(r,s){const i=_d(r,s),o=Vc(i)+Vc(r._t);return Qo(i)&&Qo(r._t)?wd(o):bd(r.wt,o)}(t,e)}function X0(t,e,n){return t instanceof $n?Ed(t,e):t instanceof Vn?Td(t,e):n}function _d(t,e){return t instanceof Ws?Qo(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class Qs extends Ci{}class $n extends Ci{constructor(e){super(),this.elements=e}}function Ed(t,e){const n=kd(e);for(const r of t.elements)n.some(s=>Et(s,r))||n.push(r);return{arrayValue:{values:n}}}class Vn extends Ci{constructor(e){super(),this.elements=e}}function Td(t,e){let n=kd(e);for(const r of t.elements)n=n.filter(s=>!Et(s,r));return{arrayValue:{values:n}}}class Ws extends Ci{constructor(e,n){super(),this.wt=e,this._t=n}}function Vc(t){return Ee(t.integerValue||t.doubleValue)}function kd(t){return Ja(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e,n){this.field=e,this.transform=n}}function Y0(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof $n&&r instanceof $n||n instanceof Vn&&r instanceof Vn?Pn(n.elements,r.elements,Et):n instanceof Ws&&r instanceof Ws?Et(n._t,r._t):n instanceof Qs&&r instanceof Qs}(t.transform,e.transform)}class J0{constructor(e,n){this.version=e,this.transformResults=n}}class mt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new mt}static exists(e){return new mt(void 0,e)}static updateTime(e){return new mt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rs(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ii{}function Id(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Sd(t.key,mt.none()):new Jr(t.key,t.data,mt.none());{const n=t.data,r=rt.empty();let s=new Se(Ue.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Xt(t.key,r,new dt(s.toArray()),mt.none())}}function Z0(t,e,n){t instanceof Jr?function(r,s,i){const o=r.value.clone(),a=qc(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Xt?function(r,s,i){if(!Rs(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=qc(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(Ad(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function Cr(t,e,n,r){return t instanceof Jr?function(s,i,o,a){if(!Rs(s.precondition,i))return o;const l=s.value.clone(),c=Gc(s.fieldTransforms,a,i);return l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Xt?function(s,i,o,a){if(!Rs(s.precondition,i))return o;const l=Gc(s.fieldTransforms,a,i),c=i.data;return c.setAll(Ad(s)),c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(s,i,o){return Rs(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function e1(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=_d(r.transform,s||null);i!=null&&(n===null&&(n=rt.empty()),n.set(r.field,i))}return n||null}function Uc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Pn(n,r,(s,i)=>Y0(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Jr extends Ii{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Xt extends Ii{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ad(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function qc(t,e,n){const r=new Map;ue(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,X0(o,a,n[s]))}return r}function Gc(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,W0(i,o,e))}return r}class Sd extends Ii{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class t1 extends Ii{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _e,ee;function r1(t){switch(t){default:return z();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function Dd(t){if(t===void 0)return Vt("GRPC error has no .code"),R.UNKNOWN;switch(t){case _e.OK:return R.OK;case _e.CANCELLED:return R.CANCELLED;case _e.UNKNOWN:return R.UNKNOWN;case _e.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case _e.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case _e.INTERNAL:return R.INTERNAL;case _e.UNAVAILABLE:return R.UNAVAILABLE;case _e.UNAUTHENTICATED:return R.UNAUTHENTICATED;case _e.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case _e.NOT_FOUND:return R.NOT_FOUND;case _e.ALREADY_EXISTS:return R.ALREADY_EXISTS;case _e.PERMISSION_DENIED:return R.PERMISSION_DENIED;case _e.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case _e.ABORTED:return R.ABORTED;case _e.OUT_OF_RANGE:return R.OUT_OF_RANGE;case _e.UNIMPLEMENTED:return R.UNIMPLEMENTED;case _e.DATA_LOSS:return R.DATA_LOSS;default:return z()}}(ee=_e||(_e={}))[ee.OK=0]="OK",ee[ee.CANCELLED=1]="CANCELLED",ee[ee.UNKNOWN=2]="UNKNOWN",ee[ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ee[ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ee[ee.NOT_FOUND=5]="NOT_FOUND",ee[ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",ee[ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",ee[ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",ee[ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ee[ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ee[ee.ABORTED=10]="ABORTED",ee[ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",ee[ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",ee[ee.INTERNAL=13]="INTERNAL",ee[ee.UNAVAILABLE=14]="UNAVAILABLE",ee[ee.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){wn(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return fd(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s1=new De(V.comparator);function Rt(){return s1}const Rd=new De(V.comparator);function yr(...t){let e=Rd;for(const n of t)e=e.insert(n.key,n);return e}function xd(t){let e=Rd;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function sn(){return Ir()}function Nd(){return Ir()}function Ir(){return new Yn(t=>t.toString(),(t,e)=>t.isEqual(e))}const i1=new De(V.comparator),o1=new Se(V.comparator);function Z(...t){let e=o1;for(const n of t)e=e.add(n);return e}const a1=new Se(se);function Od(){return a1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,Zr.createSynthesizedTargetChangeForCurrentChange(e,n)),new Ai(X.min(),r,Od(),Rt(),Z())}}class Zr{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Zr($e.EMPTY_BYTE_STRING,n,Z(),Z(),Z())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,n,r,s){this.gt=e,this.removedTargetIds=n,this.key=r,this.yt=s}}class Ld{constructor(e,n){this.targetId=e,this.It=n}}class Md{constructor(e,n,r=$e.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Hc{constructor(){this.Tt=0,this.Et=Kc(),this.At=$e.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=Z(),n=Z(),r=Z();return this.Et.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:z()}}),new Zr(this.At,this.Rt,e,n,r)}Dt(){this.bt=!1,this.Et=Kc()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class l1{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=Rt(),this.Bt=zc(),this.Lt=new Se(se)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const r=this.Qt(n);switch(e.state){case 0:this.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),r.Vt(e.resumeToken));break;default:z()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((r,s)=>{this.jt(s)&&n(s)})}zt(e){const n=e.targetId,r=e.It.count,s=this.Ht(n);if(s){const i=s.target;if(Wo(i))if(r===0){const o=new V(i.path);this.Kt(n,o,Fe.newNoDocument(o,X.min()))}else ue(r===1);else this.Jt(n)!==r&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&Wo(a.target)){const l=new V(a.target.path);this.$t.get(l)!==null||this.Xt(o,l)||this.Kt(o,l,Fe.newNoDocument(l,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let r=Z();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Ht(l);return!c||c.purpose===2||(a=!1,!1)}),a&&(r=r.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const s=new Ai(e,n,this.Lt,this.$t,r);return this.$t=Rt(),this.Bt=zc(),this.Lt=new Se(se),s}qt(e,n){if(!this.jt(e))return;const r=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,r),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,r){if(!this.jt(e))return;const s=this.Qt(e);this.Xt(e,n)?s.Ct(n,1):s.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),r&&(this.$t=this.$t.insert(n,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new Hc,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new Se(se),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||j("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new Hc),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function zc(){return new De(V.comparator)}function Kc(){return new De(V.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),u1=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class h1{constructor(e,n){this.databaseId=e,this.dt=n}}function Xs(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Pd(t,e){return t.dt?e.toBase64():e.toUint8Array()}function f1(t,e){return Xs(t,e.toTimestamp())}function It(t){return ue(!!t),X.fromTimestamp(function(e){const n=qt(e);return new Ae(n.seconds,n.nanos)}(t))}function nl(t,e){return function(n){return new ge(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function Fd(t){const e=ge.fromString(t);return ue($d(e)),e}function Yo(t,e){return nl(t.databaseId,e.path)}function wo(t,e){const n=Fd(e);if(n.get(1)!==t.databaseId.projectId)throw new U(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new U(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new V(Bd(n))}function Jo(t,e){return nl(t.databaseId,e)}function d1(t){const e=Fd(t);return e.length===4?ge.emptyPath():Bd(e)}function Zo(t){return new ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Bd(t){return ue(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Qc(t,e,n){return{name:Yo(t,e),fields:n.value.mapValue.fields}}function p1(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:z()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,c){return l.dt?(ue(c===void 0||typeof c=="string"),$e.fromBase64String(c||"")):(ue(c===void 0||c instanceof Uint8Array),$e.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?R.UNKNOWN:Dd(l.code);return new U(c,l.message||"")}(o);n=new Md(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=wo(t,r.document.name),i=It(r.document.updateTime),o=new rt({mapValue:{fields:r.document.fields}}),a=Fe.newFoundDocument(s,i,o),l=r.targetIds||[],c=r.removedTargetIds||[];n=new xs(l,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=wo(t,r.document),i=r.readTime?It(r.readTime):X.min(),o=Fe.newNoDocument(s,i),a=r.removedTargetIds||[];n=new xs([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=wo(t,r.document),i=r.removedTargetIds||[];n=new xs([],i,s,null)}else{if(!("filter"in e))return z();{e.filter;const r=e.filter;r.targetId;const s=r.count||0,i=new n1(s),o=r.targetId;n=new Ld(o,i)}}return n}function g1(t,e){let n;if(e instanceof Jr)n={update:Qc(t,e.key,e.value)};else if(e instanceof Sd)n={delete:Yo(t,e.key)};else if(e instanceof Xt)n={update:Qc(t,e.key,e.data),updateMask:C1(e.fieldMask)};else{if(!(e instanceof t1))return z();n={verify:Yo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Qs)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof $n)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Vn)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ws)return{fieldPath:i.field.canonicalString(),increment:o._t};throw z()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:f1(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:z()}(t,e.precondition)),n}function m1(t,e){return t&&t.length>0?(ue(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?It(r.updateTime):It(s);return i.isEqual(X.min())&&(i=It(s)),new J0(i,r.transformResults||[])}(n,e))):[]}function y1(t,e){return{documents:[Jo(t,e.path)]}}function v1(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Jo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Jo(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(l){if(l.length===0)return;const c=l.map(u=>function(f){if(f.op==="=="){if(Fc(f.value))return{unaryFilter:{field:An(f.field),op:"IS_NAN"}};if(Pc(f.value))return{unaryFilter:{field:An(f.field),op:"IS_NULL"}}}else if(f.op==="!="){if(Fc(f.value))return{unaryFilter:{field:An(f.field),op:"IS_NOT_NAN"}};if(Pc(f.value))return{unaryFilter:{field:An(f.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:An(f.field),op:E1(f.op),value:f.value}}}(u));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(e.filters);s&&(n.structuredQuery.where=s);const i=function(l){if(l.length!==0)return l.map(c=>function(u){return{field:An(u.field),direction:_1(u.dir)}}(c))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(l,c){return l.dt||_i(c)?c:{value:c}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function b1(t){let e=d1(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ue(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=jd(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(f){return new kr(Rn(f.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(f.direction))}(u)));let a=null;n.limit&&(a=function(u){let f;return f=typeof u=="object"?u.value:u,_i(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(u){const f=!!u.before,p=u.values||[];return new Ks(p,f)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const f=!u.before,p=u.values||[];return new Ks(p,f)}(n.endAt)),$0(e,s,o,i,a,"F",l,c)}function w1(t,e){const n=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return z()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function jd(t){return t?t.unaryFilter!==void 0?[k1(t)]:t.fieldFilter!==void 0?[T1(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>jd(e)).reduce((e,n)=>e.concat(n)):z():[]}function _1(t){return c1[t]}function E1(t){return u1[t]}function An(t){return{fieldPath:t.canonicalString()}}function Rn(t){return Ue.fromServerFormat(t.fieldPath)}function T1(t){return st.create(Rn(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return z()}}(t.fieldFilter.op),t.fieldFilter.value)}function k1(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Rn(t.unaryFilter.field);return st.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Rn(t.unaryFilter.field);return st.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Rn(t.unaryFilter.field);return st.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Rn(t.unaryFilter.field);return st.create(s,"!=",{nullValue:"NULL_VALUE"});default:return z()}}function C1(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function $d(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Z0(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Cr(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Cr(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Nd();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=Id(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Z())}isEqual(e){return this.batchId===e.batchId&&Pn(this.mutations,e.mutations,(n,r)=>Uc(n,r))&&Pn(this.baseMutations,e.baseMutations,(n,r)=>Uc(n,r))}}class rl{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ue(e.mutations.length===r.length);let s=i1;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new rl(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,n,r,s,i=X.min(),o=X.min(),a=$e.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new ln(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new ln(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new ln(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(e){this.ne=e}}function D1(t){const e=b1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?H0(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(){this.ze=new x1}addToCollectionParentIndex(e,n){return this.ze.add(n),x.resolve()}getCollectionParents(e,n){return x.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return x.resolve()}deleteFieldIndex(e,n){return x.resolve()}getDocumentsMatchingTarget(e,n){return x.resolve(null)}getIndexType(e,n){return x.resolve(0)}getFieldIndexes(e,n){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,n){return x.resolve(Ut.min())}getMinOffsetFromCollectionGroup(e,n){return x.resolve(Ut.min())}updateCollectionGroup(e,n,r){return x.resolve()}updateIndexEntries(e,n){return x.resolve()}}class x1{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Se(ge.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Se(ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new Un(0)}static Rn(){return new Un(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(){this.changes=new Yn(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Fe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?x.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.getBaseDocument(e,n,r))).next(s=>(r!==null&&Cr(r.mutation,s,dt.empty(),Ae.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Z()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Z()){const s=sn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=yr();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=sn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Z()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Rt();const o=Ir(),a=Ir();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Xt)?i=i.insert(c.key,c):u!==void 0&&(o.set(c.key,u.mutation.getFieldMask()),Cr(u.mutation,c,u.mutation.getFieldMask(),Ae.now()))}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var f;return a.set(c,new O1(u,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Ir();let s=new De((o,a)=>o-a),i=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||dt.empty();u=a.applyToLocalView(c,u),r.set(l,u);const f=(s.get(a.batchId)||Z()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,f=Nd();u.forEach(p=>{if(!i.has(p)){const d=Id(n.get(p),r.get(p));d!==null&&f.set(p,d),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return V.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):G0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):x.resolve(sn());let a=-1,l=i;return o.next(c=>x.forEach(c,(u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(u)?x.resolve():this.getBaseDocument(e,u,f).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Z())).next(u=>({batchId:a,changes:xd(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new V(n)).next(r=>{let s=yr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=yr();return this.indexManager.getCollectionParents(e,s).next(o=>x.forEach(o,a=>{const l=function(c,u){return new Ei(u,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(c=>{c.forEach((u,f)=>{i=i.insert(u,f)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(i=>{i.forEach((a,l)=>{const c=l.getKey();s.get(c)===null&&(s=s.insert(c,Fe.newInvalidDocument(c)))});let o=yr();return s.forEach((a,l)=>{const c=i.get(a);c!==void 0&&Cr(c.mutation,l,dt.empty(),Ae.now()),tl(n,l)&&(o=o.insert(a,l))}),o})}getBaseDocument(e,n,r){return r===null||r.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):x.resolve(Fe.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return x.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var r;return this.Jn.set(n.id,{id:(r=n).id,version:r.version,createTime:It(r.createTime)}),x.resolve()}getNamedQuery(e,n){return x.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(r){return{name:r.name,query:D1(r.bundledQuery),readTime:It(r.readTime)}}(n)),x.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(){this.overlays=new De(V.comparator),this.Xn=new Map}getOverlay(e,n){return x.resolve(this.overlays.get(n))}getOverlays(e,n){const r=sn();return x.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ie(e,n,i)}),x.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Xn.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(r)),x.resolve()}getOverlaysForCollection(e,n,r){const s=sn(),i=n.length+1,o=new V(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return x.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new De((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=sn(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=sn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return x.resolve(a)}ie(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Xn.get(s.largestBatchId).delete(r.key);this.Xn.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new A1(n,r));let i=this.Xn.get(n);i===void 0&&(i=Z(),this.Xn.set(n,i)),this.Xn.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(){this.Zn=new Se(xe.ts),this.es=new Se(xe.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const r=new xe(e,n);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.rs(new xe(e,n))}os(e,n){e.forEach(r=>this.removeReference(r,n))}us(e){const n=new V(new ge([])),r=new xe(n,e),s=new xe(n,e+1),i=[];return this.es.forEachInRange([r,s],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new V(new ge([])),r=new xe(n,e),s=new xe(n,e+1);let i=Z();return this.es.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new xe(e,0),r=this.Zn.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class xe{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return V.comparator(e.key,n.key)||se(e.ls,n.ls)}static ns(e,n){return se(e.ls,n.ls)||V.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new Se(xe.ts)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new I1(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.ds=this.ds.add(new xe(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,n){return x.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ws(r),i=s<0?0:s;return x.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new xe(n,0),s=new xe(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([r,s],o=>{const a=this._s(o.ls);i.push(a)}),x.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(se);return n.forEach(s=>{const i=new xe(s,0),o=new xe(s,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{r=r.add(a.ls)})}),x.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;V.isDocumentKey(i)||(i=i.child(""));const o=new xe(new V(i),0);let a=new Se(se);return this.ds.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.ls)),!0)},o),x.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(r=>{const s=this._s(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ue(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.ds;return x.forEach(n.mutations,s=>{const i=new xe(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,n){const r=new xe(n,0),s=this.ds.firstAfterOrEqual(r);return x.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e){this.ps=e,this.docs=new De(V.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ps(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return x.resolve(r?r.document.mutableCopy():Fe.newInvalidDocument(n))}getEntries(e,n){let r=Rt();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Fe.newInvalidDocument(s))}),x.resolve(r)}getAllFromCollection(e,n,r){let s=Rt();const i=new V(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:l}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||T0(E0(l),r)<=0||(s=s.insert(l.key,l.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,n,r,s){z()}Is(e,n){return x.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new j1(this)}getSize(e){return x.resolve(this.size)}}class j1 extends N1{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.zn.addEntry(e,s)):this.zn.removeEntry(r)}),x.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1{constructor(e){this.persistence=e,this.Ts=new Yn(n=>Za(n),el),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Es=0,this.As=new sl,this.targetCount=0,this.Rs=Un.An()}forEachTarget(e,n){return this.Ts.forEach((r,s)=>n(s)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Es&&(this.Es=n),x.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new Un(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,x.resolve()}updateTargetData(e,n){return this.vn(n),x.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),x.waitFor(i).next(()=>s)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,n){const r=this.Ts.get(n)||null;return x.resolve(r)}addMatchingKeys(e,n,r){return this.As.ss(n,r),x.resolve()}removeMatchingKeys(e,n,r){this.As.os(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),x.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),x.resolve()}getMatchingKeysForTargetId(e,n){const r=this.As.hs(n);return x.resolve(r)}containsKey(e,n){return x.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,n){this.bs={},this.overlays={},this.Ps=new Ya(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new $1(this),this.indexManager=new R1,this.remoteDocumentCache=function(r){return new B1(r)}(r=>this.referenceDelegate.Ss(r)),this.wt=new S1(n),this.Ds=new M1(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new P1,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.bs[e.toKey()];return r||(r=new F1(n,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,r){j("MemoryPersistence","Starting transaction:",e);const s=new U1(this.Ps.next());return this.referenceDelegate.Cs(),r(s).next(i=>this.referenceDelegate.xs(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ns(e,n){return x.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,n)))}}class U1 extends C0{constructor(e){super(),this.currentSequenceNumber=e}}class il{constructor(e){this.persistence=e,this.ks=new sl,this.Os=null}static Ms(e){return new il(e)}get Fs(){if(this.Os)return this.Os;throw z()}addReference(e,n,r){return this.ks.addReference(r,n),this.Fs.delete(r.toString()),x.resolve()}removeReference(e,n,r){return this.ks.removeReference(r,n),this.Fs.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),x.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(s=>this.Fs.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Fs.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Fs,r=>{const s=V.fromPath(r);return this.$s(e,s).next(i=>{i||n.removeEntry(s,X.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(r=>{r?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return x.or([()=>x.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Pi=r,this.vi=s}static Vi(e,n){let r=Z(),s=Z();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ol(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ci(e,n).next(i=>i||this.xi(e,n,s,r)).next(i=>i||this.Ni(e,n))}Ci(e,n){return x.resolve(null)}xi(e,n,r,s){return V0(n)||s.isEqual(X.min())?this.Ni(e,n):this.Di.getDocuments(e,r).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,r,s)?this.Ni(e,n):(xc()<=re.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xo(n)),this.Mi(e,o,n,_0(s,-1)))})}ki(e,n){let r=new Se(vd(e));return n.forEach((s,i)=>{tl(e,i)&&(r=r.add(i))}),r}Oi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ni(e,n){return xc()<=re.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Xo(n)),this.Di.getDocumentsMatchingQuery(e,n,Ut.min())}Mi(e,n,r,s){return this.Di.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e,n,r,s){this.persistence=e,this.Fi=n,this.wt=s,this.$i=new De(se),this.Bi=new Yn(i=>Za(i),el),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new L1(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function H1(t,e,n,r){return new G1(t,e,n,r)}async function Vd(t,e){const n=Q(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.qi(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=Z();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Ki:c,removedBatchIds:o,addedBatchIds:a}))})})}function z1(t,e){const n=Q(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const u=l.batch,f=u.keys();let p=x.resolve();return f.forEach(d=>{p=p.next(()=>c.getEntry(a,d)).next(h=>{const g=l.docVersions.get(d);ue(g!==null),h.version.compareTo(g)<0&&(u.applyToRemoteDocument(h,l),h.isValidDocument()&&(h.setReadTime(l.commitVersion),c.addEntry(h)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=Z();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Ud(t){const e=Q(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function K1(t,e){const n=Q(t),r=e.snapshotVersion;let s=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});s=n.$i;const a=[];e.targetChanges.forEach((u,f)=>{const p=s.get(f);if(!p)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,f).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,f)));let d=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(f)?d=d.withResumeToken($e.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):u.resumeToken.approximateByteSize()>0&&(d=d.withResumeToken(u.resumeToken,r)),s=s.insert(f,d),function(h,g,v){return h.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-h.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(p,d,u)&&a.push(n.Vs.updateTargetData(i,d))});let l=Rt(),c=Z();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(Q1(i,o,e.documentUpdates).next(u=>{l=u.Gi,c=u.Qi})),!r.isEqual(X.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(f=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return x.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.$i=s,i))}function Q1(t,e,n){let r=Z(),s=Z();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Rt();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(X.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):j("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Gi:o,Qi:s}})}function W1(t,e){const n=Q(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function X1(t,e){const n=Q(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Vs.getTargetData(r,e).next(i=>i?(s=i,x.resolve(s)):n.Vs.allocateTargetId(r).next(o=>(s=new ln(e,o,0,r.currentSequenceNumber),n.Vs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.$i.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.$i=n.$i.insert(r.targetId,r),n.Bi.set(e,r.targetId)),r})}async function ea(t,e,n){const r=Q(t),s=r.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Yr(o))throw o;j("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.$i=r.$i.remove(e),r.Bi.delete(s.target)}function Wc(t,e,n){const r=Q(t);let s=X.min(),i=Z();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const u=Q(a),f=u.Bi.get(c);return f!==void 0?x.resolve(u.$i.get(f)):u.Vs.getTargetData(l,c)}(r,o,mn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fi.getDocumentsMatchingQuery(o,e,n?s:X.min(),n?i:Z())).next(a=>(Y1(r,z0(e),a),{documents:a,ji:i})))}function Y1(t,e,n){let r=X.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Li.set(e,r)}class Xc{constructor(){this.activeTargetIds=Od()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class J1{constructor(){this.Fr=new Xc,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,r){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Xc,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){j("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){j("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,r,s,i){const o=this.oo(e,n);j("RestConnection","Sending: ",o,r);const a={};return this.uo(a,s,i),this.co(e,o,a,r).then(l=>(j("RestConnection","Received: ",l),l),l=>{throw Nc("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",r),l})}ao(e,n,r,s,i,o){return this.ro(e,n,r,s,i)}uo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Xn,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}oo(e,n){const r=eb[e];return`${this.so}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,r,s){return new Promise((i,o)=>{const a=new h0;a.listenOnce(l0.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case bo.NO_ERROR:const c=a.getResponseJson();j("Connection","XHR received:",JSON.stringify(c)),i(c);break;case bo.TIMEOUT:j("Connection",'RPC "'+e+'" timed out'),o(new U(R.DEADLINE_EXCEEDED,"Request time out"));break;case bo.HTTP_ERROR:const u=a.getStatus();if(j("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const f=a.getResponseJson().error;if(f&&f.status&&f.message){const p=function(d){const h=d.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(h)>=0?h:R.UNKNOWN}(f.status);o(new U(p,f.message))}else o(new U(R.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new U(R.UNAVAILABLE,"Connection failed."));break;default:z()}}finally{j("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(s);a.send(n,"POST",l,r,15)})}ho(e,n,r){const s=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=o0(),o=a0(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new u0({})),this.uo(a.initMessageHeaders,n,r),Eg()||Tg()||kg()||Cg()||Ig()||xh()||(a.httpHeadersOverwriteParam="$httpHeaders");const l=s.join("");j("Connection","Creating WebChannel: "+l,a);const c=i.createWebChannel(l,a);let u=!1,f=!1;const p=new tb({jr:h=>{f?j("Connection","Not sending because WebChannel is closed:",h):(u||(j("Connection","Opening WebChannel transport."),c.open(),u=!0),j("Connection","WebChannel sending:",h),c.send(h))},Wr:()=>c.close()}),d=(h,g,v)=>{h.listen(g,m=>{try{v(m)}catch(y){setTimeout(()=>{throw y},0)}})};return d(c,ys.EventType.OPEN,()=>{f||j("Connection","WebChannel transport opened.")}),d(c,ys.EventType.CLOSE,()=>{f||(f=!0,j("Connection","WebChannel transport closed"),p.eo())}),d(c,ys.EventType.ERROR,h=>{f||(f=!0,Nc("Connection","WebChannel transport errored:",h),p.eo(new U(R.UNAVAILABLE,"The operation could not be completed")))}),d(c,ys.EventType.MESSAGE,h=>{var g;if(!f){const v=h.data[0];ue(!!v);const m=v,y=m.error||((g=m[0])===null||g===void 0?void 0:g.error);if(y){j("Connection","WebChannel received error:",y);const E=y.status;let w=function(_){const C=_e[_];if(C!==void 0)return Dd(C)}(E),b=y.message;w===void 0&&(w=R.INTERNAL,b="Unknown error status: "+E+" with message "+y.message),f=!0,p.eo(new U(w,b)),c.close()}else j("Connection","WebChannel received:",v),p.no(v)}}),d(o,c0.STAT_EVENT,h=>{h.stat===Dc.PROXY?j("Connection","Detected buffering proxy"):h.stat===Dc.NOPROXY&&j("Connection","Detected no buffering proxy")}),setTimeout(()=>{p.Zr()},0),p}}function _o(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Si(t){return new h1(t,!0)}class qd{constructor(e,n,r=1e3,s=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=r,this.fo=s,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),s=Math.max(0,n-r);s>0&&j("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,s,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,n,r,s,i,o,a,l){this.js=e,this.Ao=r,this.Ro=s,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new qd(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===R.RESOURCE_EXHAUSTED?(Vt(n.toString()),Vt("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Po===n&&this.Uo(r,s)},r=>{e(()=>{const s=new U(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(s)})})}Uo(e,n){const r=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(s=>{r(()=>this.qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return j("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(j("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rb extends Gd{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=p1(this.wt,e),r=function(s){if(!("targetChange"in s))return X.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?X.min():i.readTime?It(i.readTime):X.min()}(e);return this.listener.Go(n,r)}Qo(e){const n={};n.database=Zo(this.wt),n.addTarget=function(s,i){let o;const a=i.target;return o=Wo(a)?{documents:y1(s,a)}:{query:v1(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=Pd(s,i.resumeToken):i.snapshotVersion.compareTo(X.min())>0&&(o.readTime=Xs(s,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const r=w1(this.wt,e);r&&(n.labels=r),this.Mo(n)}jo(e){const n={};n.database=Zo(this.wt),n.removeTarget=e,this.Mo(n)}}class sb extends Gd{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=m1(e.writeResults,e.commitTime),r=It(e.commitTime);return this.listener.Jo(r,n)}return ue(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=Zo(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>g1(this.wt,r))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=r,this.wt=s,this.Zo=!1}tu(){if(this.Zo)throw new U(R.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.bo.ro(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new U(R.UNKNOWN,s.toString())})}ao(e,n,r,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new U(R.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class ob{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(Vt(n),this.su=!1):j("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{r.enqueueAndForget(async()=>{_n(this)&&(j("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=Q(a);l.lu.add(4),await es(l),l._u.set("Unknown"),l.lu.delete(4),await Di(l)}(this))})}),this._u=new ob(r,s)}}async function Di(t){if(_n(t))for(const e of t.fu)await e(!0)}async function es(t){for(const e of t.fu)await e(!1)}function Hd(t,e){const n=Q(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),cl(n)?ll(n):Jn(n).Co()&&al(n,e))}function zd(t,e){const n=Q(t),r=Jn(n);n.hu.delete(e),r.Co()&&Kd(n,e),n.hu.size===0&&(r.Co()?r.ko():_n(n)&&n._u.set("Unknown"))}function al(t,e){t.wu.Nt(e.targetId),Jn(t).Qo(e)}function Kd(t,e){t.wu.Nt(e),Jn(t).jo(e)}function ll(t){t.wu=new l1({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),Jn(t).start(),t._u.iu()}function cl(t){return _n(t)&&!Jn(t).Do()&&t.hu.size>0}function _n(t){return Q(t).lu.size===0}function Qd(t){t.wu=void 0}async function lb(t){t.hu.forEach((e,n)=>{al(t,e)})}async function cb(t,e){Qd(t),cl(t)?(t._u.uu(e),ll(t)):t._u.set("Unknown")}async function ub(t,e,n){if(t._u.set("Online"),e instanceof Md&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.hu.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.hu.delete(o),r.wu.removeTarget(o))}(t,e)}catch(r){j("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ys(t,r)}else if(e instanceof xs?t.wu.Ut(e):e instanceof Ld?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(X.min()))try{const r=await Ud(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.wu.Yt(i);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=s.hu.get(l);c&&s.hu.set(l,c.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const l=s.hu.get(a);if(!l)return;s.hu.set(a,l.withResumeToken($e.EMPTY_BYTE_STRING,l.snapshotVersion)),Kd(s,a);const c=new ln(l.target,a,1,l.sequenceNumber);al(s,c)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){j("RemoteStore","Failed to raise snapshot:",r),await Ys(t,r)}}async function Ys(t,e,n){if(!Yr(e))throw e;t.lu.add(1),await es(t),t._u.set("Offline"),n||(n=()=>Ud(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{j("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await Di(t)})}function Wd(t,e){return e().catch(n=>Ys(t,n,e))}async function Ri(t){const e=Q(t),n=Gt(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;hb(e);)try{const s=await W1(e.localStore,r);if(s===null){e.au.length===0&&n.ko();break}r=s.batchId,fb(e,s)}catch(s){await Ys(e,s)}Xd(e)&&Yd(e)}function hb(t){return _n(t)&&t.au.length<10}function fb(t,e){t.au.push(e);const n=Gt(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function Xd(t){return _n(t)&&!Gt(t).Do()&&t.au.length>0}function Yd(t){Gt(t).start()}async function db(t){Gt(t).Xo()}async function pb(t){const e=Gt(t);for(const n of t.au)e.Ho(n.mutations)}async function gb(t,e,n){const r=t.au.shift(),s=rl.from(r,e,n);await Wd(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Ri(t)}async function mb(t,e){e&&Gt(t).zo&&await async function(n,r){if(s=r.code,r1(s)&&s!==R.ABORTED){const i=n.au.shift();Gt(n).No(),await Wd(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ri(n)}var s}(t,e),Xd(t)&&Yd(t)}async function Jc(t,e){const n=Q(t);n.asyncQueue.verifyOperationInProgress(),j("RemoteStore","RemoteStore received new credentials");const r=_n(n);n.lu.add(3),await es(n),r&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await Di(n)}async function yb(t,e){const n=Q(t);e?(n.lu.delete(2),await Di(n)):e||(n.lu.add(2),await es(n),n._u.set("Unknown"))}function Jn(t){return t.mu||(t.mu=function(e,n,r){const s=Q(e);return s.tu(),new rb(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:lb.bind(null,t),Jr:cb.bind(null,t),Go:ub.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),cl(t)?ll(t):t._u.set("Unknown")):(await t.mu.stop(),Qd(t))})),t.mu}function Gt(t){return t.gu||(t.gu=function(e,n,r){const s=Q(e);return s.tu(),new sb(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:db.bind(null,t),Jr:mb.bind(null,t),Yo:pb.bind(null,t),Jo:gb.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await Ri(t)):(await t.gu.stop(),t.au.length>0&&(j("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ft,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new ul(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new U(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hl(t,e){if(Vt("AsyncQueue",`${e}: ${t}`),Yr(t))return new U(R.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.comparator=e?(n,r)=>e(n,r)||V.comparator(n.key,r.key):(n,r)=>V.comparator(n.key,r.key),this.keyedMap=yr(),this.sortedSet=new De(this.comparator)}static emptySet(e){return new Nn(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Nn)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Nn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(){this.yu=new De(V.comparator)}track(e){const n=e.doc.key,r=this.yu.get(n);r?e.type!==0&&r.type===3?this.yu=this.yu.insert(n,e):e.type===3&&r.type!==1?this.yu=this.yu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.yu=this.yu.remove(n):e.type===1&&r.type===2?this.yu=this.yu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):z():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,r)=>{e.push(r)}),e}}class qn{constructor(e,n,r,s,i,o,a,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(e,n,r,s){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new qn(e,n,Nn.emptySet(n),i,r,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ki(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(){this.Iu=void 0,this.listeners=[]}}class bb{constructor(){this.queries=new Yn(e=>yd(e),ki),this.onlineState="Unknown",this.Tu=new Set}}async function Jd(t,e){const n=Q(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new vb),s)try{i.Iu=await n.onListen(r)}catch(o){const a=hl(o,`Initialization of query '${Xo(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&fl(n)}async function Zd(t,e){const n=Q(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function wb(t,e){const n=Q(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(s)&&(r=!0);o.Iu=s}}r&&fl(n)}function _b(t,e,n){const r=Q(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function fl(t){t.Tu.forEach(e=>{e.next()})}class ep{constructor(e,n,r){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new qn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Du||!r)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=qn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e){this.key=e}}class np{constructor(e){this.key=e}}class Eb{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=Z(),this.mutatedKeys=Z(),this.Lu=vd(e),this.Uu=new Nn(this.Lu)}get qu(){return this.Fu}Ku(e,n){const r=n?n.Gu:new Zc,s=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,f)=>{const p=s.get(u),d=tl(this.query,f)?f:null,h=!!p&&this.mutatedKeys.has(p.key),g=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let v=!1;p&&d?p.data.isEqual(d.data)?h!==g&&(r.track({type:3,doc:d}),v=!0):this.Qu(p,d)||(r.track({type:2,doc:d}),v=!0,(l&&this.Lu(d,l)>0||c&&this.Lu(d,c)<0)&&(a=!0)):!p&&d?(r.track({type:0,doc:d}),v=!0):p&&!d&&(r.track({type:1,doc:p}),v=!0,(l||c)&&(a=!0)),v&&(d?(o=o.add(d),i=g?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Uu:o,Gu:r,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((c,u)=>function(f,p){const d=h=>{switch(h){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return z()}};return d(f)-d(p)}(c.type,u.type)||this.Lu(c.doc,u.doc)),this.ju(r);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,l=a!==this.$u;return this.$u=a,i.length!==0||l?{snapshot:new qn(this.query,e.Uu,s,i,e.mutatedKeys,a===0,l,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new Zc,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=Z(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const n=[];return e.forEach(r=>{this.Bu.has(r)||n.push(new np(r))}),this.Bu.forEach(r=>{e.has(r)||n.push(new tp(r))}),n}Ju(e){this.Fu=e.ji,this.Bu=Z();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return qn.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class Tb{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class kb{constructor(e){this.key=e,this.Xu=!1}}class Cb{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new Yn(a=>yd(a),ki),this.ec=new Map,this.nc=new Set,this.sc=new De(V.comparator),this.ic=new Map,this.rc=new sl,this.oc={},this.uc=new Map,this.cc=Un.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function Ib(t,e){const n=Pb(t);let r,s;const i=n.tc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Yu();else{const o=await X1(n.localStore,mn(e));n.isPrimaryClient&&Hd(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await Ab(n,e,r,a==="current")}return s}async function Ab(t,e,n,r){t.hc=(u,f,p)=>async function(d,h,g,v){let m=h.view.Ku(g);m.Oi&&(m=await Wc(d.localStore,h.query,!1).then(({documents:w})=>h.view.Ku(w,m)));const y=v&&v.targetChanges.get(h.targetId),E=h.view.applyChanges(m,d.isPrimaryClient,y);return tu(d,h.targetId,E.zu),E.snapshot}(t,u,f,p);const s=await Wc(t.localStore,e,!0),i=new Eb(e,s.ji),o=i.Ku(s.documents),a=Zr.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),l=i.applyChanges(o,t.isPrimaryClient,a);tu(t,n,l.zu);const c=new Tb(e,n,i);return t.tc.set(e,c),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),l.snapshot}async function Sb(t,e){const n=Q(t),r=n.tc.get(e),s=n.ec.get(r.targetId);if(s.length>1)return n.ec.set(r.targetId,s.filter(i=>!ki(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await ea(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),zd(n.remoteStore,r.targetId),ta(n,r.targetId)}).catch(Xr)):(ta(n,r.targetId),await ea(n.localStore,r.targetId,!0))}async function Db(t,e,n){const r=Fb(t);try{const s=await function(i,o){const a=Q(i),l=Ae.now(),c=o.reduce((p,d)=>p.add(d.key),Z());let u,f;return a.persistence.runTransaction("Locally write mutations","readwrite",p=>{let d=Rt(),h=Z();return a.Ui.getEntries(p,c).next(g=>{d=g,d.forEach((v,m)=>{m.isValidDocument()||(h=h.add(v))})}).next(()=>a.localDocuments.getOverlayedDocuments(p,d)).next(g=>{u=g;const v=[];for(const m of o){const y=e1(m,u.get(m.key).overlayedDocument);y!=null&&v.push(new Xt(m.key,y,gd(y.value.mapValue),mt.exists(!0)))}return a.mutationQueue.addMutationBatch(p,l,v,o)}).next(g=>{f=g;const v=g.applyToLocalDocumentSet(u,h);return a.documentOverlayCache.saveOverlays(p,g.batchId,v)})}).then(()=>({batchId:f.batchId,changes:xd(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let l=i.oc[i.currentUser.toKey()];l||(l=new De(se)),l=l.insert(o,a),i.oc[i.currentUser.toKey()]=l}(r,s.batchId,n),await ts(r,s.changes),await Ri(r.remoteStore)}catch(s){const i=hl(s,"Failed to persist write");n.reject(i)}}async function rp(t,e){const n=Q(t);try{const r=await K1(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.ic.get(i);o&&(ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Xu=!0:s.modifiedDocuments.size>0?ue(o.Xu):s.removedDocuments.size>0&&(ue(o.Xu),o.Xu=!1))}),await ts(n,r,e)}catch(r){await Xr(r)}}function eu(t,e,n){const r=Q(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=Q(i);a.onlineState=o;let l=!1;a.queries.forEach((c,u)=>{for(const f of u.listeners)f.Eu(o)&&(l=!0)}),l&&fl(a)}(r.eventManager,e),s.length&&r.Zu.Go(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Rb(t,e,n){const r=Q(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.ic.get(e),i=s&&s.key;if(i){let o=new De(V.comparator);o=o.insert(i,Fe.newNoDocument(i,X.min()));const a=Z().add(i),l=new Ai(X.min(),new Map,new Se(se),o,a);await rp(r,l),r.sc=r.sc.remove(i),r.ic.delete(e),dl(r)}else await ea(r.localStore,e,!1).then(()=>ta(r,e,n)).catch(Xr)}async function xb(t,e){const n=Q(t),r=e.batch.batchId;try{const s=await z1(n.localStore,e);ip(n,r,null),sp(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ts(n,s)}catch(s){await Xr(s)}}async function Nb(t,e,n){const r=Q(t);try{const s=await function(i,o){const a=Q(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.mutationQueue.lookupMutationBatch(l,o).next(u=>(ue(u!==null),c=u.keys(),a.mutationQueue.removeMutationBatch(l,u))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>a.localDocuments.getDocuments(l,c))})}(r.localStore,e);ip(r,e,n),sp(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ts(r,s)}catch(s){await Xr(s)}}function sp(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function ip(t,e,n){const r=Q(t);let s=r.oc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.oc[r.currentUser.toKey()]=s}}function ta(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ec.get(e))t.tc.delete(r),n&&t.Zu.lc(r,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(r=>{t.rc.containsKey(r)||op(t,r)})}function op(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(zd(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),dl(t))}function tu(t,e,n){for(const r of n)r instanceof tp?(t.rc.addReference(r.key,e),Ob(t,r)):r instanceof np?(j("SyncEngine","Document no longer in limbo: "+r.key),t.rc.removeReference(r.key,e),t.rc.containsKey(r.key)||op(t,r.key)):z()}function Ob(t,e){const n=e.key,r=n.path.canonicalString();t.sc.get(n)||t.nc.has(r)||(j("SyncEngine","New document in limbo: "+n),t.nc.add(r),dl(t))}function dl(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new V(ge.fromString(e)),r=t.cc.next();t.ic.set(r,new kb(n)),t.sc=t.sc.insert(n,r),Hd(t.remoteStore,new ln(mn(Ti(n.path)),r,2,Ya.ot))}}async function ts(t,e,n){const r=Q(t),s=[],i=[],o=[];r.tc.isEmpty()||(r.tc.forEach((a,l)=>{o.push(r.hc(l,e,n).then(c=>{if(c){r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c.fromCache?"not-current":"current"),s.push(c);const u=ol.Vi(l.targetId,c);i.push(u)}}))}),await Promise.all(o),r.Zu.Go(s),await async function(a,l){const c=Q(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>x.forEach(l,f=>x.forEach(f.Pi,p=>c.persistence.referenceDelegate.addReference(u,f.targetId,p)).next(()=>x.forEach(f.vi,p=>c.persistence.referenceDelegate.removeReference(u,f.targetId,p)))))}catch(u){if(!Yr(u))throw u;j("LocalStore","Failed to update sequence numbers: "+u)}for(const u of l){const f=u.targetId;if(!u.fromCache){const p=c.$i.get(f),d=p.snapshotVersion,h=p.withLastLimboFreeSnapshotVersion(d);c.$i=c.$i.insert(f,h)}}}(r.localStore,i))}async function Lb(t,e){const n=Q(t);if(!n.currentUser.isEqual(e)){j("SyncEngine","User change. New user:",e.toKey());const r=await Vd(n.localStore,e);n.currentUser=e,function(s,i){s.uc.forEach(o=>{o.forEach(a=>{a.reject(new U(R.CANCELLED,i))})}),s.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ts(n,r.Ki)}}function Mb(t,e){const n=Q(t),r=n.ic.get(e);if(r&&r.Xu)return Z().add(r.key);{let s=Z();const i=n.ec.get(e);if(!i)return s;for(const o of i){const a=n.tc.get(o);s=s.unionWith(a.view.qu)}return s}}function Pb(t){const e=Q(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Mb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Rb.bind(null,e),e.Zu.Go=wb.bind(null,e.eventManager),e.Zu.lc=_b.bind(null,e.eventManager),e}function Fb(t){const e=Q(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xb.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Nb.bind(null,e),e}class Bb{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=Si(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return H1(this.persistence,new q1,e.initialUser,this.wt)}_c(e){return new V1(il.Ms,this.wt)}dc(e){return new J1}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class jb{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>eu(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Lb.bind(null,this.syncEngine),await yb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new bb}createDatastore(e){const n=Si(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new nb(s));var s;return function(i,o,a,l){return new ib(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>eu(this.syncEngine,a,0),o=Yc.V()?new Yc:new Z1,new ab(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,l,c){const u=new Cb(r,s,i,o,a,l);return c&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=Q(e);j("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await es(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=nt.UNAUTHENTICATED,this.clientId=hd.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{j("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(j("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new U(R.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ft;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=hl(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Vb(t,e){t.asyncQueue.verifyOperationInProgress(),j("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Vd(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function Ub(t,e){t.asyncQueue.verifyOperationInProgress();const n=await qb(t);j("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>Jc(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>Jc(e.remoteStore,i)),t.onlineComponents=e}async function qb(t){return t.offlineComponents||(j("FirestoreClient","Using default OfflineComponentProvider"),await Vb(t,new Bb)),t.offlineComponents}async function lp(t){return t.onlineComponents||(j("FirestoreClient","Using default OnlineComponentProvider"),await Ub(t,new jb)),t.onlineComponents}function Gb(t){return lp(t).then(e=>e.syncEngine)}async function na(t){const e=await lp(t),n=e.eventManager;return n.onListen=Ib.bind(null,e.syncEngine),n.onUnlisten=Sb.bind(null,e.syncEngine),n}function Hb(t,e,n={}){const r=new Ft;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,l){const c=new ap({next:f=>{i.enqueueAndForget(()=>Zd(s,u));const p=f.docs.has(o);!p&&f.fromCache?l.reject(new U(R.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&a&&a.source==="server"?l.reject(new U(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(f)},error:f=>l.reject(f)}),u=new ep(Ti(o.path),c,{includeMetadataChanges:!0,Du:!0});return Jd(s,u)}(await na(t),t.asyncQueue,e,n,r)),r.promise}const nu=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(t,e,n){if(!n)throw new U(R.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function zb(t,e,n,r){if(e===!0&&r===!0)throw new U(R.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ru(t){if(!V.isDocumentKey(t))throw new U(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function su(t){if(V.isDocumentKey(t))throw new U(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function pl(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":z()}function wt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new U(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=pl(t);throw new U(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new U(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new U(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,zb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,n,r){this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iu({}),this._settingsFrozen=!1,e instanceof Bn?this._databaseId=e:(this._app=e,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new U(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bn(s.options.projectId)}(e))}get app(){if(!this._app)throw new U(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new U(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iu(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new d0;switch(n.type){case"gapi":const r=n.client;return ue(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new m0(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new U(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=nu.get(e);n&&(j("ComponentProvider","Removing Datastore"),nu.delete(e),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Je(this.firestore,e,this._key)}}class xi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new xi(this.firestore,e,this._query)}}class Bt extends xi{constructor(e,n,r){super(e,n,Ti(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Je(this.firestore,null,new V(e))}withConverter(e){return new Bt(this.firestore,e,this._path)}}function Kb(t,e,...n){if(t=yt(t),cp("collection","path",e),t instanceof gl){const r=ge.fromString(e,...n);return su(r),new Bt(t,null,r)}{if(!(t instanceof Je||t instanceof Bt))throw new U(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ge.fromString(e,...n));return su(r),new Bt(t.firestore,null,r)}}function Xe(t,e,...n){if(t=yt(t),arguments.length===1&&(e=hd.I()),cp("doc","path",e),t instanceof gl){const r=ge.fromString(e,...n);return ru(r),new Je(t,null,new V(r))}{if(!(t instanceof Je||t instanceof Bt))throw new U(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ge.fromString(e,...n));return ru(r),new Je(t.firestore,t instanceof Bt?t.converter:null,new V(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new qd(this,"async_queue_retry"),this.Kc=()=>{const n=_o();n&&j("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=_o();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=_o();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new Ft;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!Yr(e))throw e;j("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{this.Bc=r,this.Lc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw Vt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Lc=!1,r))));return this.Oc=n,n}enqueueAfterDelay(e,n,r){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const s=ul.createAndSchedule(this,e,n,r,i=>this.Wc(i));return this.$c.push(s),s}Gc(){this.Bc&&z()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function ou(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class yn extends gl{constructor(e,n,r){super(e,n,r),this.type="firestore",this._queue=new Qb,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||up(this),this._firestoreClient.terminate()}}function Wb(t=Bh()){return $r(t,"firestore").getImmediate()}function ml(t){return t._firestoreClient||up(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function up(t){var e;const n=t._freezeSettings(),r=function(s,i,o,a){return new A0(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new $b(t._authCredentials,t._appCheckCredentials,t._queue,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new U(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ue(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gn($e.fromBase64String(e))}catch(n){throw new U(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Gn($e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new U(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new U(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb=/^__.*__$/;class Yb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Xt(e,this.data,this.fieldMask,n,this.fieldTransforms):new Jr(e,this.data,n,this.fieldTransforms)}}class hp{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Xt(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function fp(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw z()}}class Oi{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Oi(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.sa(e),s}ia(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.Xc(),s}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Js(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(fp(this.Zc)&&Xb.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class Jb{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=r||Si(e)}aa(e,n,r,s=!1){return new Oi({Zc:e,methodName:n,ca:r,path:Ue.emptyPath(),na:!1,ua:s},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function vl(t){const e=t._freezeSettings(),n=Si(t._databaseId);return new Jb(t._databaseId,!!e.ignoreUndefinedProperties,n)}function dp(t,e,n,r,s,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,s);bl("Data must be an object, but it was:",o,r);const a=gp(r,o);let l,c;if(i.merge)l=new dt(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const f of i.mergeFields){const p=ra(e,f,n);if(!o.contains(p))throw new U(R.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);yp(u,p)||u.push(p)}l=new dt(u),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new Yb(new rt(a),l,c)}class Li extends ns{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Li}}function pp(t,e,n){return new Oi({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class Zb extends ns{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=pp(this,e,!0),r=this.ha.map(i=>Zn(i,n)),s=new $n(r);return new Cd(e.path,s)}isEqual(e){return this===e}}class ew extends ns{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=pp(this,e,!0),r=this.ha.map(i=>Zn(i,n)),s=new Vn(r);return new Cd(e.path,s)}isEqual(e){return this===e}}function tw(t,e,n,r){const s=t.aa(1,e,n);bl("Data must be an object, but it was:",s,r);const i=[],o=rt.empty();wn(r,(l,c)=>{const u=wl(e,l,n);c=yt(c);const f=s.ia(u);if(c instanceof Li)i.push(u);else{const p=Zn(c,f);p!=null&&(i.push(u),o.set(u,p))}});const a=new dt(i);return new hp(o,a,s.fieldTransforms)}function nw(t,e,n,r,s,i){const o=t.aa(1,e,n),a=[ra(e,r,n)],l=[s];if(i.length%2!=0)throw new U(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(ra(e,i[p])),l.push(i[p+1]);const c=[],u=rt.empty();for(let p=a.length-1;p>=0;--p)if(!yp(c,a[p])){const d=a[p];let h=l[p];h=yt(h);const g=o.ia(d);if(h instanceof Li)c.push(d);else{const v=Zn(h,g);v!=null&&(c.push(d),u.set(d,v))}}const f=new dt(c);return new hp(u,f,o.fieldTransforms)}function Zn(t,e){if(mp(t=yt(t)))return bl("Unsupported field value:",e,t),gp(t,e);if(t instanceof ns)return function(n,r){if(!fp(r.Zc))throw r.oa(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=Zn(o,r.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=yt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Q0(r.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Ae.fromDate(n);return{timestampValue:Xs(r.wt,s)}}if(n instanceof Ae){const s=new Ae(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Xs(r.wt,s)}}if(n instanceof yl)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Gn)return{bytesValue:Pd(r.wt,n._byteString)};if(n instanceof Je){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:nl(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.oa(`Unsupported field value: ${pl(n)}`)}(t,e)}function gp(t,e){const n={};return fd(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wn(t,(r,s)=>{const i=Zn(s,e.ea(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function mp(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ae||t instanceof yl||t instanceof Gn||t instanceof Je||t instanceof ns)}function bl(t,e,n){if(!mp(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=pl(n);throw r==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+r)}}function ra(t,e,n){if((e=yt(e))instanceof Ni)return e._internalPath;if(typeof e=="string")return wl(t,e);throw Js("Field path arguments must be of type string or ",t,!1,void 0,n)}const rw=new RegExp("[~\\*/\\[\\]]");function wl(t,e,n){if(e.search(rw)>=0)throw Js(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ni(...e.split("."))._internalPath}catch{throw Js(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Js(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new U(R.INVALID_ARGUMENT,a+t+l)}function yp(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new sw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(bp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class sw extends vp{data(){return super.data()}}function bp(t,e){return typeof e=="string"?wl(t,e):e instanceof Ni?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wp extends vp{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ns(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(bp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Ns extends wp{data(e={}){return super.data(e)}}class iw{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new vr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ns(this._firestore,this._userDataWriter,r.key,r,new vr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new U(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new Ns(r._firestore,r._userDataWriter,o.doc.key,o.doc,new vr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new Ns(r._firestore,r._userDataWriter,o.doc.key,o.doc,new vr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let l=-1,c=-1;return o.type!==0&&(l=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),c=i.indexOf(o.doc.key)),{type:ow(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function ow(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return z()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new U(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{convertValue(e,n="none"){switch(gn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ee(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Fn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw z()}}convertObject(e,n){const r={};return wn(e.fields,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new yl(Ee(e.latitude),Ee(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=pd(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Pr(e));default:return null}}convertTimestamp(e){const n=qt(e);return new Ae(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ge.fromString(e);ue($d(r));const s=new Bn(r.get(1),r.get(3)),i=new V(r.popFirst(5));return s.isEqual(n)||Vt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _l(t){t=wt(t,Je);const e=wt(t.firestore,yn);return Hb(ml(e),t._key).then(n=>Tp(e,t,n))}class Ep extends lw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Je(this.firestore,null,n)}}function on(t,e,n){t=wt(t,Je);const r=wt(t.firestore,yn),s=_p(t.converter,e,n);return El(r,[dp(vl(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,mt.none())])}function sa(t,e,n,...r){t=wt(t,Je);const s=wt(t.firestore,yn),i=vl(s);let o;return o=typeof(e=yt(e))=="string"||e instanceof Ni?nw(i,"updateDoc",t._key,e,n,r):tw(i,"updateDoc",t._key,e),El(s,[o.toMutation(t._key,mt.exists(!0))])}function cw(t,e){const n=wt(t.firestore,yn),r=Xe(t),s=_p(t.converter,e);return El(n,[dp(vl(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,mt.exists(!1))]).then(()=>r)}function uw(t,...e){var n,r,s;t=yt(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||ou(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(ou(e[o])){const f=e[o];e[o]=(n=f.next)===null||n===void 0?void 0:n.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,u;if(t instanceof Je)c=wt(t.firestore,yn),u=Ti(t._key.path),l={next:f=>{e[o]&&e[o](Tp(c,t,f))},error:e[o+1],complete:e[o+2]};else{const f=wt(t,xi);c=wt(f.firestore,yn),u=f._query;const p=new Ep(c);l={next:d=>{e[o]&&e[o](new iw(c,p,f,d))},error:e[o+1],complete:e[o+2]},aw(t._query)}return function(f,p,d,h){const g=new ap(h),v=new ep(p,g,d);return f.asyncQueue.enqueueAndForget(async()=>Jd(await na(f),v)),()=>{g.Tc(),f.asyncQueue.enqueueAndForget(async()=>Zd(await na(f),v))}}(ml(c),u,a,l)}function El(t,e){return function(n,r){const s=new Ft;return n.asyncQueue.enqueueAndForget(async()=>Db(await Gb(n),r,s)),s.promise}(ml(t),e)}function Tp(t,e,n){const r=n.docs.get(e._key),s=new Ep(t);return new wp(t,s,e._key,r,new vr(n.hasPendingWrites,n.fromCache),e.converter)}function hw(...t){return new Zb("arrayUnion",t)}function fw(...t){return new ew("arrayRemove",t)}(function(t,e=!0){(function(n){Xn=n})(Rm),$t(new St("firestore",(n,{options:r})=>{const s=n.getProvider("app").getImmediate(),i=new yn(s,new p0(n.getProvider("auth-internal")),new v0(n.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),i._setSettings(r),i},"PUBLIC")),bt(Rc,"3.4.12",t),bt(Rc,"3.4.12","esm2017")})();const dw={apiKey:"AIzaSyAwCY1tRAE0m9SrlSXSVh6im8NJDYGmd8g",authDomain:"scrumik.firebaseapp.com",projectId:"scrumik",storageBucket:"scrumik.appspot.com",messagingSenderId:"480092253511",appId:"1:480092253511:web:6774f2fec537fd6a9a3062",measurementId:"G-KMNHLLXP8N"},kp=xm(dw);nv(kp);const Ye=Wb(kp),pw=[{text:"1",emoji:!1},{text:"2",emoji:!1},{text:"3",emoji:!1},{text:"5",emoji:!1},{text:"8",emoji:!1},{text:"13",emoji:!1},{text:"21",emoji:!1},{text:"34",emoji:!1},{text:"55",emoji:!1},{text:"\u2615",emoji:!0},{text:"\u{1F92F}",emoji:!0},{text:"\u{1F52D}",emoji:!0},{text:"\u2754",emoji:!0}],gw=(t,e,n)=>uw(Xe(t,"room",e),n),mw=async(t,e)=>{try{return(await cw(Kb(t,"room"),e)).id}catch(n){throw console.error("Error adding document: ",n),n}},yw=async(t,e,n)=>{const r=Xe(t,"room",e),s=await _l(r);if(s.exists()){const i=s.get("password");return i.passCode==""?!0:i.passCode===n||i.leaderCode===n}else throw new Error("No such document!")};function vw(t){let e,n,r,s,i,o,a;return{c(){e=A("div"),n=A("h2"),n.textContent="Create Room",r=L(),s=A("form"),s.innerHTML=`<label><span class="text-sm font-bold block mb-2">Room Name</span> 
      <input type="text" name="name" placeholder="Enter a room name" autocomplete="off" required="" class="mb-4 form-input"/></label> 
    <label><span class="text-sm font-bold block mb-2">Passcode</span> 
      <input type="text" name="passCode" autocomplete="off" placeholder="Optional passcode to join room" class="mb-4 form-input"/></label> 
    <label><span class="text-sm font-bold block mb-2">Leader Passcode</span> 
      <input type="text" name="leaderCode" autocomplete="off" placeholder="If not set, will be the same as passcode" class="mb-4 form-input"/></label> 
    <button type="submit" value="create" class="block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded">Create Room</button>`,I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(e,"class",i=`${t[0]} p-6 bg-white`)},m(l,c){B(l,e,c),k(e,n),k(e,r),k(e,s),t[3](s),o||(a=Y(s,"submit",Ht(vn(t[2]))),o=!0)},p(l,[c]){c&1&&i!==(i=`${l[0]} p-6 bg-white`)&&I(e,"class",i)},i:J,o:J,d(l){l&&F(e),t[3](null),o=!1,a()}}}function bw(t,e,n){let{class:r=""}=e,s;const i=async()=>{const a=new FormData(s),l={info:{name:a.get("name")},password:{passCode:a.get("passCode"),leaderCode:a.get("leaderCode")},cards:pw};l.password.leaderCode==""&&(l.password.leaderCode=l.password.passCode);try{const c=await mw(Ye,l);va(`/room/${c}?password=${l.password.leaderCode}`)}catch(c){console.error(c)}};function o(a){Ln[a?"unshift":"push"](()=>{s=a,n(1,s)})}return t.$$set=a=>{"class"in a&&n(0,r=a.class)},[r,s,i,o]}class ww extends et{constructor(e){super(),Ze(this,e,bw,vw,He,{class:0})}}function _w(t){var y;let e,n,r,s,i,o,a,l,c,u,f,p,d=((y=t[2])!=null?y:"")+"",h,g,v,m;return{c(){e=A("div"),n=A("h2"),n.textContent="Join Room",r=L(),s=A("form"),i=A("label"),i.innerHTML=`<span class="text-sm font-bold block mb-2">Room ID</span> 
      <input type="text" name="roomID" placeholder="Room ID" required="" class="mb-4 form-input"/>`,o=L(),a=A("label"),a.innerHTML=`<span class="text-sm font-bold block mb-2">Password</span> 
      <input type="password" name="passCode" placeholder="Leave it empty if don&#39;t need password" class="mb-4 form-input"/>`,l=L(),c=A("div"),u=A("button"),u.textContent="Join",f=L(),p=A("button"),h=ce(d),I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(u,"type","submit"),u.value="join",I(u,"class","border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(p,"type","button"),I(p,"class","border border-black bg-white text-black hover:bg-red-500 hover:text-white font-bold py-1 px-3 rounded"),_t(p,"invisible",!t[2]),I(c,"class","block"),I(e,"class",g=`${t[0]} p-6 bg-white`)},m(E,w){B(E,e,w),k(e,n),k(e,r),k(e,s),k(s,i),k(s,o),k(s,a),k(s,l),k(s,c),k(c,u),k(c,f),k(c,p),k(p,h),t[5](s),v||(m=[Y(p,"click",t[4]),Y(s,"submit",Ht(vn(t[3])))],v=!0)},p(E,[w]){var b;w&4&&d!==(d=((b=E[2])!=null?b:"")+"")&&ye(h,d),w&4&&_t(p,"invisible",!E[2]),w&1&&g!==(g=`${E[0]} p-6 bg-white`)&&I(e,"class",g)},i:J,o:J,d(E){E&&F(e),t[5](null),v=!1,Ge(m)}}}function Ew(t,e,n){let{class:r=""}=e,s,i;const o=async()=>{const c=new FormData(s),u=c.get("roomID"),f=c.get("password");try{if(!await yw(Ye,u,f))throw new Error("Passcode is not correct");va(`/room/${u}?password=${f}`)}catch(p){n(2,i=p.message)}},a=()=>n(2,i="");function l(c){Ln[c?"unshift":"push"](()=>{s=c,n(1,s)})}return t.$$set=c=>{"class"in c&&n(0,r=c.class)},[r,s,i,o,a,l]}class Tw extends et{constructor(e){super(),Ze(this,e,Ew,_w,He,{class:0})}}const Tl=jr(null),Eo=()=>{const t=rs();Tl.set(t)},vt=jr(!1),an=jr(!1);var ws,kw=new Uint8Array(16);function Cw(){if(!ws&&(ws=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ws))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ws(kw)}const Iw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Aw(t){return typeof t=="string"&&Iw.test(t)}var Me=[];for(var To=0;To<256;++To)Me.push((To+256).toString(16).substr(1));function Sw(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(Me[t[e+0]]+Me[t[e+1]]+Me[t[e+2]]+Me[t[e+3]]+"-"+Me[t[e+4]]+Me[t[e+5]]+"-"+Me[t[e+6]]+Me[t[e+7]]+"-"+Me[t[e+8]]+Me[t[e+9]]+"-"+Me[t[e+10]]+Me[t[e+11]]+Me[t[e+12]]+Me[t[e+13]]+Me[t[e+14]]+Me[t[e+15]]).toLowerCase();if(!Aw(n))throw TypeError("Stringified UUID is invalid");return n}function Dw(t,e,n){t=t||{};var r=t.random||(t.rng||Cw)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var s=0;s<16;++s)e[n+s]=r[s];return e}return Sw(r)}const kl="room",Cl="id",ia=(t,e,n=!0)=>{let r=rs();if(!r)r=[e];else{let s;r=r.filter(i=>i.id!=t?!0:(s=i,!1)),n&&(s={...s,...e}),r.push(s)}localStorage.setItem(kl,JSON.stringify(r))},rs=()=>{const t=localStorage.getItem(kl);return t==null?null:JSON.parse(t)},Cp=t=>{var r;const e=rs();if(e==null)return;const n=e.find(s=>s.id==t);return(r=n==null?void 0:n.password)!=null?r:""},Rw=t=>{const e=rs();if(e==null)return;const n=e.find(r=>r.id==t);return n==null?void 0:n.name},Ip=t=>{const e=rs();if(e==null)return;const n=e.filter(r=>r.id!==t);localStorage.setItem(kl,JSON.stringify(n)),Tl.set(n)},Ap=()=>{const t=localStorage.getItem(Cl);return t==null?null:JSON.parse(t)},Sp=t=>{const e=Dw(),n={id:e,nick:t};return localStorage.setItem(Cl,JSON.stringify(n)),{id:e,nick:t}},Dp=(t,e)=>{const n={id:t,nick:e};localStorage.setItem(Cl,JSON.stringify(n))},au=t=>{t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296};class xw{constructor(e){this.dictionaries=void 0,this.length=void 0,this.separator=void 0,this.style=void 0,this.seed=void 0;const{length:n,separator:r,dictionaries:s,style:i,seed:o}=e;this.dictionaries=s,this.separator=r,this.length=n,this.style=i,this.seed=o}generate(){if(!this.dictionaries)throw new Error('Cannot find any dictionary. Please provide at least one, or leave the "dictionary" field empty in the config object');if(this.length<=0)throw new Error("Invalid length provided");if(this.length>this.dictionaries.length)throw new Error(`The length cannot be bigger than the number of dictionaries.
Length provided: ${this.length}. Number of dictionaries provided: ${this.dictionaries.length}`);let e=this.seed;return this.dictionaries.slice(0,this.length).reduce((n,r)=>{let s;e?(s=(o=>{if(typeof o=="string"){const a=o.split("").map(c=>c.charCodeAt(0)).reduce((c,u)=>c+u,1),l=Math.floor(Number(a));return au(l)}return au(o)})(e),e=4294967296*s):s=Math.random();let i=r[Math.floor(s*r.length)]||"";if(this.style==="lowerCase")i=i.toLowerCase();else if(this.style==="capital"){const[o,...a]=i.split("");i=o.toUpperCase()+a.join("")}else this.style==="upperCase"&&(i=i.toUpperCase());return n?`${n}${this.separator}${i}`:`${i}`},"")}}const lu={separator:"_",dictionaries:[]},Nw=t=>{const e=[...t&&t.dictionaries||lu.dictionaries],n={...lu,...t,length:t&&t.length||e.length,dictionaries:e};if(!t||!t.dictionaries||!t.dictionaries.length)throw new Error('A "dictionaries" array must be provided. This is a breaking change introduced starting from Unique Name Generator v4. Read more about the breaking change here: https://github.com/andreasonny83/unique-names-generator#migration-guide');return new xw(n).generate()};var Ow=["aardvark","aardwolf","albatross","alligator","alpaca","amphibian","anaconda","angelfish","anglerfish","ant","anteater","antelope","antlion","ape","aphid","armadillo","asp","baboon","badger","bandicoot","barnacle","barracuda","basilisk","bass","bat","bear","beaver","bedbug","bee","beetle","bird","bison","blackbird","boa","boar","bobcat","bobolink","bonobo","booby","bovid","bug","butterfly","buzzard","camel","canid","canidae","capybara","cardinal","caribou","carp","cat","caterpillar","catfish","catshark","cattle","centipede","cephalopod","chameleon","cheetah","chickadee","chicken","chimpanzee","chinchilla","chipmunk","cicada","clam","clownfish","cobra","cockroach","cod","condor","constrictor","coral","cougar","cow","coyote","crab","crane","crawdad","crayfish","cricket","crocodile","crow","cuckoo","damselfly","deer","dingo","dinosaur","dog","dolphin","donkey","dormouse","dove","dragon","dragonfly","duck","eagle","earthworm","earwig","echidna","eel","egret","elephant","elk","emu","ermine","falcon","felidae","ferret","finch","firefly","fish","flamingo","flea","fly","flyingfish","fowl","fox","frog","galliform","gamefowl","gayal","gazelle","gecko","gerbil","gibbon","giraffe","goat","goldfish","goose","gopher","gorilla","grasshopper","grouse","guan","guanaco","guineafowl","gull","guppy","haddock","halibut","hamster","hare","harrier","hawk","hedgehog","heron","herring","hippopotamus","hookworm","hornet","horse","hoverfly","hummingbird","hyena","iguana","impala","jackal","jaguar","jay","jellyfish","junglefowl","kangaroo","kingfisher","kite","kiwi","koala","koi","krill","ladybug","lamprey","landfowl","lark","leech","lemming","lemur","leopard","leopon","limpet","lion","lizard","llama","lobster","locust","loon","louse","lungfish","lynx","macaw","mackerel","magpie","mammal","manatee","mandrill","marlin","marmoset","marmot","marsupial","marten","mastodon","meadowlark","meerkat","mink","minnow","mite","mockingbird","mole","mollusk","mongoose","monkey","moose","mosquito","moth","mouse","mule","muskox","narwhal","newt","nightingale","ocelot","octopus","opossum","orangutan","orca","ostrich","otter","owl","ox","panda","panther","parakeet","parrot","parrotfish","partridge","peacock","peafowl","pelican","penguin","perch","pheasant","pig","pigeon","pike","pinniped","piranha","planarian","platypus","pony","porcupine","porpoise","possum","prawn","primate","ptarmigan","puffin","puma","python","quail","quelea","quokka","rabbit","raccoon","rat","rattlesnake","raven","reindeer","reptile","rhinoceros","roadrunner","rodent","rook","rooster","roundworm","sailfish","salamander","salmon","sawfish","scallop","scorpion","seahorse","shark","sheep","shrew","shrimp","silkworm","silverfish","skink","skunk","sloth","slug","smelt","snail","snake","snipe","sole","sparrow","spider","spoonbill","squid","squirrel","starfish","stingray","stoat","stork","sturgeon","swallow","swan","swift","swordfish","swordtail","tahr","takin","tapir","tarantula","tarsier","termite","tern","thrush","tick","tiger","tiglon","toad","tortoise","toucan","trout","tuna","turkey","turtle","tyrannosaurus","unicorn","urial","vicuna","viper","vole","vulture","wallaby","walrus","warbler","wasp","weasel","whale","whippet","whitefish","wildcat","wildebeest","wildfowl","wolf","wolverine","wombat","woodpecker","worm","wren","xerinae","yak","zebra"],Lw=["amaranth","amber","amethyst","apricot","aqua","aquamarine","azure","beige","black","blue","blush","bronze","brown","chocolate","coffee","copper","coral","crimson","cyan","emerald","fuchsia","gold","gray","green","harlequin","indigo","ivory","jade","lavender","lime","magenta","maroon","moccasin","olive","orange","peach","pink","plum","purple","red","rose","salmon","sapphire","scarlet","silver","tan","teal","tomato","turquoise","violet","white","yellow"];const Mw={dictionaries:[Lw,Ow],separator:"-",length:2},Zs=()=>Nw(Mw);function cu(t){let e,n,r;return{c(){e=A("button"),e.textContent="Save",I(e,"class","px-2 h-7 border-l border-b border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){B(s,e,i),n||(r=Y(e,"click",t[3]),n=!0)},p:J,d(s){s&&F(e),n=!1,r()}}}function Pw(t){let e,n;return{c(){e=A("span"),n=ce(t[2]),I(e,"class","font-bold text-xl px-2")},m(r,s){B(r,e,s),k(e,n)},p(r,s){s&4&&ye(n,r[2])},d(r){r&&F(e)}}}function Fw(t){let e,n,r,s,i,o;return{c(){e=A("form"),n=A("input"),r=L(),s=A("button"),s.textContent="Generate Name",I(n,"class","bg-gray-100 border border-gray-200 flex-1 px-2 text-xl font-bold"),I(n,"type","text"),I(s,"class","bg-white border border-black px-2 text-xl hover:bg-nl hover:text-white"),I(s,"type","button")},m(a,l){B(a,e,l),k(e,n),On(n,t[2]),k(e,r),k(e,s),i||(o=[Y(n,"input",t[5]),Y(s,"click",t[6]),Y(e,"submit",Ht(vn(t[3])))],i=!0)},p(a,l){l&4&&n.value!==a[2]&&On(n,a[2])},d(a){a&&F(e),i=!1,Ge(o)}}}function Bw(t){let e,n,r,s,i,o=t[1]?"Cancel":"Edit Nickname",a,l,c,u,f,p,d,h=t[1]&&cu(t);function g(y,E){return y[1]?Fw:Pw}let v=g(t),m=v(t);return{c(){e=A("div"),n=A("div"),r=A("div"),h&&h.c(),s=L(),i=A("button"),a=ce(o),c=L(),u=A("div"),m.c(),I(i,"class",l=`float-right px-2 h-7 border-l border-b border-black self-end hover:text-white ${t[1]?"hover:bg-red-500":"hover:bg-nl"}`),I(n,"class","float-right"),I(u,"class","py-6 pl-4 pr-6"),I(e,"class",f=`${t[0]} bg-white`)},m(y,E){B(y,e,E),k(e,n),k(n,r),h&&h.m(r,null),k(r,s),k(r,i),k(i,a),k(e,c),k(e,u),m.m(u,null),p||(d=Y(i,"click",t[4]),p=!0)},p(y,[E]){y[1]?h?h.p(y,E):(h=cu(y),h.c(),h.m(r,s)):h&&(h.d(1),h=null),E&2&&o!==(o=y[1]?"Cancel":"Edit Nickname")&&ye(a,o),E&2&&l!==(l=`float-right px-2 h-7 border-l border-b border-black self-end hover:text-white ${y[1]?"hover:bg-red-500":"hover:bg-nl"}`)&&I(i,"class",l),v===(v=g(y))&&m?m.p(y,E):(m.d(1),m=v(y),m&&(m.c(),m.m(u,null))),E&1&&f!==(f=`${y[0]} bg-white`)&&I(e,"class",f)},i:J,o:J,d(y){y&&F(e),h&&h.d(),m.d(),p=!1,d()}}}function jw(t,e,n){var f;let r=!1,{class:s=""}=e,{id:i,nick:o}=(f=Ap())!=null?f:Sp(Zs());const a=()=>{Dp(i,o),n(1,r=!1)},l=()=>{n(1,r=!r)};function c(){o=this.value,n(2,o)}const u=()=>n(2,o=Zs());return t.$$set=p=>{"class"in p&&n(0,s=p.class)},[s,r,o,a,l,c,u]}class $w extends et{constructor(e){super(),Ze(this,e,jw,Bw,He,{class:0})}}const Vw=t=>window.confirm(t);function uu(t,e,n){const r=t.slice();return r[3]=e[n],r}function Uw(t){let e;return{c(){e=A("p"),e.textContent="No rooms yet",I(e,"class","italic")},m(n,r){B(n,e,r)},p:J,d(n){n&&F(e)}}}function qw(t){let e,n=[],r=new Map,s=t[1];const i=o=>o[3].id;for(let o=0;o<s.length;o+=1){let a=uu(t,s,o),l=i(a);r.set(l,n[o]=hu(l,a))}return{c(){e=A("ul");for(let o=0;o<n.length;o+=1)n[o].c()},m(o,a){B(o,e,a);for(let l=0;l<n.length;l+=1)n[l].m(e,null)},p(o,a){a&2&&(s=o[1],n=ma(n,a,i,1,o,s,r,e,Eh,hu,null,uu))},d(o){o&&F(e);for(let a=0;a<n.length;a+=1)n[a].d()}}}function hu(t,e){let n,r,s=e[3].name+"",i,o,a,l,c,u,f;function p(){return e[2](e[3])}return{key:t,first:null,c(){n=A("li"),r=A("a"),i=ce(s),a=L(),l=A("button"),l.textContent="delete",c=L(),I(r,"class","w-full leading-10 hover:bg-green-500 hover:text-white px-2"),I(r,"href",o=`/room/${e[3].id}`),I(l,"class","border-l border-black bg-white hover:bg-red-500 hover:text-white px-2"),I(n,"class","flex justify-between odd:bg-gray-100 even:bg-gray-200 first:border-t border-b border-black"),this.first=n},m(d,h){B(d,n,h),k(n,r),k(r,i),k(n,a),k(n,l),k(n,c),u||(f=[mh(Sh.call(null,r)),Y(l,"click",p)],u=!0)},p(d,h){e=d,h&2&&s!==(s=e[3].name+"")&&ye(i,s),h&2&&o!==(o=`/room/${e[3].id}`)&&I(r,"href",o)},d(d){d&&F(n),u=!1,Ge(f)}}}function Gw(t){let e,n,r,s,i;function o(c,u){return c[1]!=null&&c[1].length>0?qw:Uw}let a=o(t),l=a(t);return{c(){e=A("div"),n=A("h2"),n.textContent="Room List",r=L(),s=A("div"),l.c(),I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(e,"class",i=`${t[0]} p-6 bg-white`)},m(c,u){B(c,e,u),k(e,n),k(e,r),k(e,s),l.m(s,null)},p(c,[u]){a===(a=o(c))&&l?l.p(c,u):(l.d(1),l=a(c),l&&(l.c(),l.m(s,null))),u&1&&i!==(i=`${c[0]} p-6 bg-white`)&&I(e,"class",i)},i:J,o:J,d(c){c&&F(e),l.d()}}}function Hw(t,e,n){let r;jt(t,Tl,o=>n(1,r=o));let{class:s=""}=e;pa(()=>{Eo(),window.addEventListener("storage",Eo)}),ga(()=>{window.removeEventListener("storage",Eo)});const i=o=>{Vw(`Are you sure to delete? [${o.name}]`)&&Ip(o.id)};return t.$$set=o=>{"class"in o&&n(0,s=o.class)},[s,r,i]}class zw extends et{constructor(e){super(),Ze(this,e,Hw,Gw,He,{class:0})}}function fu(t){let e,n,r,s,i,o,a;return{c(){e=A("div"),n=A("span"),r=ce(t[0]),s=L(),i=A("button"),i.textContent="X",I(n,"class","p-2"),I(i,"class","border-l border-black bg-gray-200 hover:bg-nl px-2 float-right"),I(e,"class","border-t border-b sm:border border-black mb-3 bg-yellow-200")},m(l,c){B(l,e,c),k(e,n),k(n,r),k(e,s),k(e,i),o||(a=Y(i,"click",t[2]),o=!0)},p(l,c){c&1&&ye(r,l[0])},d(l){l&&F(e),o=!1,a()}}}function Kw(t){let e,n,r,s,i,o,a,l,c,u,f,p,d=t[0]&&fu(t);return s=new Tw({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),o=new zw({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),c=new $w({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),f=new ww({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),{c(){d&&d.c(),e=L(),n=A("div"),r=A("div"),Ne(s.$$.fragment),i=L(),Ne(o.$$.fragment),a=L(),l=A("div"),Ne(c.$$.fragment),u=L(),Ne(f.$$.fragment),I(r,"class","flex flex-1 flex-col gap-3"),I(l,"class","flex flex-1 flex-col gap-3"),I(n,"class","flex flex-1 gap-3 md:flex-row flex-col")},m(h,g){d&&d.m(h,g),B(h,e,g),B(h,n,g),k(n,r),Ce(s,r,null),k(r,i),Ce(o,r,null),k(n,a),k(n,l),Ce(c,l,null),k(l,u),Ce(f,l,null),p=!0},p(h,[g]){h[0]?d?d.p(h,g):(d=fu(h),d.c(),d.m(e.parentNode,e)):d&&(d.d(1),d=null)},i(h){p||(te(s.$$.fragment,h),te(o.$$.fragment,h),te(c.$$.fragment,h),te(f.$$.fragment,h),p=!0)},o(h){ie(s.$$.fragment,h),ie(o.$$.fragment,h),ie(c.$$.fragment,h),ie(f.$$.fragment,h),p=!1},d(h){d&&d.d(h),h&&F(e),h&&F(n),Ie(s),Ie(o),Ie(c),Ie(f)}}}function Qw(t,e,n){let r;jt(t,Ah,a=>n(1,r=a));let s="";const i=a=>{var u,f;const l=new URLSearchParams(a);n(0,s=(u=l.get("msg"))!=null?u:"");const c=(f=l.get("kickRoom"))!=null?f:"";c&&Ip(c)},o=()=>n(0,s="");return t.$$.update=()=>{t.$$.dirty&2&&i(r)},[s,r,o]}class Ww extends et{constructor(e){super(),Ze(this,e,Qw,Kw,He,{})}}function Xw(t){let e;return{c(){e=A("div"),e.textContent="What is that URL?",I(e,"class","border border-black bg-yellow-200 w-full text-center font-bold text-xl")},m(n,r){B(n,e,r)},p:J,i:J,o:J,d(n){n&&F(e)}}}class Yw extends et{constructor(e){super(),Ze(this,e,null,Xw,He,{})}}const Ar=async(t,e)=>{const r=(await _l(t)).get("password");return(r==null?void 0:r.leaderCode)==e?[!0,!0]:[!1,(r==null?void 0:r.passCode)==e]},du=async t=>(await _l(t)).get("password");var Oe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jw(){this.__data__=[],this.size=0}var Zw=Jw;function e_(t,e){return t===e||t!==t&&e!==e}var Rp=e_,t_=Rp;function n_(t,e){for(var n=t.length;n--;)if(t_(t[n][0],e))return n;return-1}var Mi=n_,r_=Mi,s_=Array.prototype,i_=s_.splice;function o_(t){var e=this.__data__,n=r_(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():i_.call(e,n,1),--this.size,!0}var a_=o_,l_=Mi;function c_(t){var e=this.__data__,n=l_(e,t);return n<0?void 0:e[n][1]}var u_=c_,h_=Mi;function f_(t){return h_(this.__data__,t)>-1}var d_=f_,p_=Mi;function g_(t,e){var n=this.__data__,r=p_(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var m_=g_,y_=Zw,v_=a_,b_=u_,w_=d_,__=m_;function er(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}er.prototype.clear=y_;er.prototype.delete=v_;er.prototype.get=b_;er.prototype.has=w_;er.prototype.set=__;var Pi=er,E_=Pi;function T_(){this.__data__=new E_,this.size=0}var k_=T_;function C_(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var I_=C_;function A_(t){return this.__data__.get(t)}var S_=A_;function D_(t){return this.__data__.has(t)}var R_=D_,x_=typeof Oe=="object"&&Oe&&Oe.Object===Object&&Oe,xp=x_,N_=xp,O_=typeof self=="object"&&self&&self.Object===Object&&self,L_=N_||O_||Function("return this")(),xt=L_,M_=xt,P_=M_.Symbol,Il=P_,pu=Il,Np=Object.prototype,F_=Np.hasOwnProperty,B_=Np.toString,dr=pu?pu.toStringTag:void 0;function j_(t){var e=F_.call(t,dr),n=t[dr];try{t[dr]=void 0;var r=!0}catch{}var s=B_.call(t);return r&&(e?t[dr]=n:delete t[dr]),s}var $_=j_,V_=Object.prototype,U_=V_.toString;function q_(t){return U_.call(t)}var G_=q_,gu=Il,H_=$_,z_=G_,K_="[object Null]",Q_="[object Undefined]",mu=gu?gu.toStringTag:void 0;function W_(t){return t==null?t===void 0?Q_:K_:mu&&mu in Object(t)?H_(t):z_(t)}var Fi=W_;function X_(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Op=X_,Y_=Fi,J_=Op,Z_="[object AsyncFunction]",eE="[object Function]",tE="[object GeneratorFunction]",nE="[object Proxy]";function rE(t){if(!J_(t))return!1;var e=Y_(t);return e==eE||e==tE||e==Z_||e==nE}var Lp=rE,sE=xt,iE=sE["__core-js_shared__"],oE=iE,ko=oE,yu=function(){var t=/[^.]+$/.exec(ko&&ko.keys&&ko.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function aE(t){return!!yu&&yu in t}var lE=aE,cE=Function.prototype,uE=cE.toString;function hE(t){if(t!=null){try{return uE.call(t)}catch{}try{return t+""}catch{}}return""}var Mp=hE,fE=Lp,dE=lE,pE=Op,gE=Mp,mE=/[\\^$.*+?()[\]{}|]/g,yE=/^\[object .+?Constructor\]$/,vE=Function.prototype,bE=Object.prototype,wE=vE.toString,_E=bE.hasOwnProperty,EE=RegExp("^"+wE.call(_E).replace(mE,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function TE(t){if(!pE(t)||dE(t))return!1;var e=fE(t)?EE:yE;return e.test(gE(t))}var kE=TE;function CE(t,e){return t==null?void 0:t[e]}var IE=CE,AE=kE,SE=IE;function DE(t,e){var n=SE(t,e);return AE(n)?n:void 0}var tr=DE,RE=tr,xE=xt,NE=RE(xE,"Map"),Al=NE,OE=tr,LE=OE(Object,"create"),Bi=LE,vu=Bi;function ME(){this.__data__=vu?vu(null):{},this.size=0}var PE=ME;function FE(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var BE=FE,jE=Bi,$E="__lodash_hash_undefined__",VE=Object.prototype,UE=VE.hasOwnProperty;function qE(t){var e=this.__data__;if(jE){var n=e[t];return n===$E?void 0:n}return UE.call(e,t)?e[t]:void 0}var GE=qE,HE=Bi,zE=Object.prototype,KE=zE.hasOwnProperty;function QE(t){var e=this.__data__;return HE?e[t]!==void 0:KE.call(e,t)}var WE=QE,XE=Bi,YE="__lodash_hash_undefined__";function JE(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=XE&&e===void 0?YE:e,this}var ZE=JE,eT=PE,tT=BE,nT=GE,rT=WE,sT=ZE;function nr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}nr.prototype.clear=eT;nr.prototype.delete=tT;nr.prototype.get=nT;nr.prototype.has=rT;nr.prototype.set=sT;var iT=nr,bu=iT,oT=Pi,aT=Al;function lT(){this.size=0,this.__data__={hash:new bu,map:new(aT||oT),string:new bu}}var cT=lT;function uT(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var hT=uT,fT=hT;function dT(t,e){var n=t.__data__;return fT(e)?n[typeof e=="string"?"string":"hash"]:n.map}var ji=dT,pT=ji;function gT(t){var e=pT(this,t).delete(t);return this.size-=e?1:0,e}var mT=gT,yT=ji;function vT(t){return yT(this,t).get(t)}var bT=vT,wT=ji;function _T(t){return wT(this,t).has(t)}var ET=_T,TT=ji;function kT(t,e){var n=TT(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var CT=kT,IT=cT,AT=mT,ST=bT,DT=ET,RT=CT;function rr(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}rr.prototype.clear=IT;rr.prototype.delete=AT;rr.prototype.get=ST;rr.prototype.has=DT;rr.prototype.set=RT;var Pp=rr,xT=Pi,NT=Al,OT=Pp,LT=200;function MT(t,e){var n=this.__data__;if(n instanceof xT){var r=n.__data__;if(!NT||r.length<LT-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new OT(r)}return n.set(t,e),this.size=n.size,this}var PT=MT,FT=Pi,BT=k_,jT=I_,$T=S_,VT=R_,UT=PT;function sr(t){var e=this.__data__=new FT(t);this.size=e.size}sr.prototype.clear=BT;sr.prototype.delete=jT;sr.prototype.get=$T;sr.prototype.has=VT;sr.prototype.set=UT;var qT=sr,GT="__lodash_hash_undefined__";function HT(t){return this.__data__.set(t,GT),this}var zT=HT;function KT(t){return this.__data__.has(t)}var QT=KT,WT=Pp,XT=zT,YT=QT;function ei(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new WT;++e<n;)this.add(t[e])}ei.prototype.add=ei.prototype.push=XT;ei.prototype.has=YT;var JT=ei;function ZT(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var ek=ZT;function tk(t,e){return t.has(e)}var nk=tk,rk=JT,sk=ek,ik=nk,ok=1,ak=2;function lk(t,e,n,r,s,i){var o=n&ok,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=i.get(t),u=i.get(e);if(c&&u)return c==e&&u==t;var f=-1,p=!0,d=n&ak?new rk:void 0;for(i.set(t,e),i.set(e,t);++f<a;){var h=t[f],g=e[f];if(r)var v=o?r(g,h,f,e,t,i):r(h,g,f,t,e,i);if(v!==void 0){if(v)continue;p=!1;break}if(d){if(!sk(e,function(m,y){if(!ik(d,y)&&(h===m||s(h,m,n,r,i)))return d.push(y)})){p=!1;break}}else if(!(h===g||s(h,g,n,r,i))){p=!1;break}}return i.delete(t),i.delete(e),p}var Fp=lk,ck=xt,uk=ck.Uint8Array,hk=uk;function fk(t){var e=-1,n=Array(t.size);return t.forEach(function(r,s){n[++e]=[s,r]}),n}var dk=fk;function pk(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var gk=pk,wu=Il,_u=hk,mk=Rp,yk=Fp,vk=dk,bk=gk,wk=1,_k=2,Ek="[object Boolean]",Tk="[object Date]",kk="[object Error]",Ck="[object Map]",Ik="[object Number]",Ak="[object RegExp]",Sk="[object Set]",Dk="[object String]",Rk="[object Symbol]",xk="[object ArrayBuffer]",Nk="[object DataView]",Eu=wu?wu.prototype:void 0,Co=Eu?Eu.valueOf:void 0;function Ok(t,e,n,r,s,i,o){switch(n){case Nk:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case xk:return!(t.byteLength!=e.byteLength||!i(new _u(t),new _u(e)));case Ek:case Tk:case Ik:return mk(+t,+e);case kk:return t.name==e.name&&t.message==e.message;case Ak:case Dk:return t==e+"";case Ck:var a=vk;case Sk:var l=r&wk;if(a||(a=bk),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;r|=_k,o.set(t,e);var u=yk(a(t),a(e),r,s,i,o);return o.delete(t),u;case Rk:if(Co)return Co.call(t)==Co.call(e)}return!1}var Lk=Ok;function Mk(t,e){for(var n=-1,r=e.length,s=t.length;++n<r;)t[s+n]=e[n];return t}var Pk=Mk,Fk=Array.isArray,Sl=Fk,Bk=Pk,jk=Sl;function $k(t,e,n){var r=e(t);return jk(t)?r:Bk(r,n(t))}var Vk=$k;function Uk(t,e){for(var n=-1,r=t==null?0:t.length,s=0,i=[];++n<r;){var o=t[n];e(o,n,t)&&(i[s++]=o)}return i}var qk=Uk;function Gk(){return[]}var Hk=Gk,zk=qk,Kk=Hk,Qk=Object.prototype,Wk=Qk.propertyIsEnumerable,Tu=Object.getOwnPropertySymbols,Xk=Tu?function(t){return t==null?[]:(t=Object(t),zk(Tu(t),function(e){return Wk.call(t,e)}))}:Kk,Yk=Xk;function Jk(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var Zk=Jk;function eC(t){return t!=null&&typeof t=="object"}var $i=eC,tC=Fi,nC=$i,rC="[object Arguments]";function sC(t){return nC(t)&&tC(t)==rC}var iC=sC,ku=iC,oC=$i,Bp=Object.prototype,aC=Bp.hasOwnProperty,lC=Bp.propertyIsEnumerable,cC=ku(function(){return arguments}())?ku:function(t){return oC(t)&&aC.call(t,"callee")&&!lC.call(t,"callee")},uC=cC,ti={exports:{}};function hC(){return!1}var fC=hC;(function(t,e){var n=xt,r=fC,s=e&&!e.nodeType&&e,i=s&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===s,a=o?n.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||r;t.exports=c})(ti,ti.exports);var dC=9007199254740991,pC=/^(?:0|[1-9]\d*)$/;function gC(t,e){var n=typeof t;return e=e==null?dC:e,!!e&&(n=="number"||n!="symbol"&&pC.test(t))&&t>-1&&t%1==0&&t<e}var mC=gC,yC=9007199254740991;function vC(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=yC}var jp=vC,bC=Fi,wC=jp,_C=$i,EC="[object Arguments]",TC="[object Array]",kC="[object Boolean]",CC="[object Date]",IC="[object Error]",AC="[object Function]",SC="[object Map]",DC="[object Number]",RC="[object Object]",xC="[object RegExp]",NC="[object Set]",OC="[object String]",LC="[object WeakMap]",MC="[object ArrayBuffer]",PC="[object DataView]",FC="[object Float32Array]",BC="[object Float64Array]",jC="[object Int8Array]",$C="[object Int16Array]",VC="[object Int32Array]",UC="[object Uint8Array]",qC="[object Uint8ClampedArray]",GC="[object Uint16Array]",HC="[object Uint32Array]",he={};he[FC]=he[BC]=he[jC]=he[$C]=he[VC]=he[UC]=he[qC]=he[GC]=he[HC]=!0;he[EC]=he[TC]=he[MC]=he[kC]=he[PC]=he[CC]=he[IC]=he[AC]=he[SC]=he[DC]=he[RC]=he[xC]=he[NC]=he[OC]=he[LC]=!1;function zC(t){return _C(t)&&wC(t.length)&&!!he[bC(t)]}var KC=zC;function QC(t){return function(e){return t(e)}}var WC=QC,oa={exports:{}};(function(t,e){var n=xp,r=e&&!e.nodeType&&e,s=r&&!0&&t&&!t.nodeType&&t,i=s&&s.exports===r,o=i&&n.process,a=function(){try{var l=s&&s.require&&s.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(oa,oa.exports);var XC=KC,YC=WC,Cu=oa.exports,Iu=Cu&&Cu.isTypedArray,JC=Iu?YC(Iu):XC,$p=JC,ZC=Zk,eI=uC,tI=Sl,nI=ti.exports,rI=mC,sI=$p,iI=Object.prototype,oI=iI.hasOwnProperty;function aI(t,e){var n=tI(t),r=!n&&eI(t),s=!n&&!r&&nI(t),i=!n&&!r&&!s&&sI(t),o=n||r||s||i,a=o?ZC(t.length,String):[],l=a.length;for(var c in t)(e||oI.call(t,c))&&!(o&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||rI(c,l)))&&a.push(c);return a}var lI=aI,cI=Object.prototype;function uI(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||cI;return t===n}var hI=uI;function fI(t,e){return function(n){return t(e(n))}}var dI=fI,pI=dI,gI=pI(Object.keys,Object),mI=gI,yI=hI,vI=mI,bI=Object.prototype,wI=bI.hasOwnProperty;function _I(t){if(!yI(t))return vI(t);var e=[];for(var n in Object(t))wI.call(t,n)&&n!="constructor"&&e.push(n);return e}var EI=_I,TI=Lp,kI=jp;function CI(t){return t!=null&&kI(t.length)&&!TI(t)}var II=CI,AI=lI,SI=EI,DI=II;function RI(t){return DI(t)?AI(t):SI(t)}var xI=RI,NI=Vk,OI=Yk,LI=xI;function MI(t){return NI(t,LI,OI)}var PI=MI,Au=PI,FI=1,BI=Object.prototype,jI=BI.hasOwnProperty;function $I(t,e,n,r,s,i){var o=n&FI,a=Au(t),l=a.length,c=Au(e),u=c.length;if(l!=u&&!o)return!1;for(var f=l;f--;){var p=a[f];if(!(o?p in e:jI.call(e,p)))return!1}var d=i.get(t),h=i.get(e);if(d&&h)return d==e&&h==t;var g=!0;i.set(t,e),i.set(e,t);for(var v=o;++f<l;){p=a[f];var m=t[p],y=e[p];if(r)var E=o?r(y,m,p,e,t,i):r(m,y,p,t,e,i);if(!(E===void 0?m===y||s(m,y,n,r,i):E)){g=!1;break}v||(v=p=="constructor")}if(g&&!v){var w=t.constructor,b=e.constructor;w!=b&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof b=="function"&&b instanceof b)&&(g=!1)}return i.delete(t),i.delete(e),g}var VI=$I,UI=tr,qI=xt,GI=UI(qI,"DataView"),HI=GI,zI=tr,KI=xt,QI=zI(KI,"Promise"),WI=QI,XI=tr,YI=xt,JI=XI(YI,"Set"),ZI=JI,e2=tr,t2=xt,n2=e2(t2,"WeakMap"),r2=n2,aa=HI,la=Al,ca=WI,ua=ZI,ha=r2,Vp=Fi,ir=Mp,Su="[object Map]",s2="[object Object]",Du="[object Promise]",Ru="[object Set]",xu="[object WeakMap]",Nu="[object DataView]",i2=ir(aa),o2=ir(la),a2=ir(ca),l2=ir(ua),c2=ir(ha),Zt=Vp;(aa&&Zt(new aa(new ArrayBuffer(1)))!=Nu||la&&Zt(new la)!=Su||ca&&Zt(ca.resolve())!=Du||ua&&Zt(new ua)!=Ru||ha&&Zt(new ha)!=xu)&&(Zt=function(t){var e=Vp(t),n=e==s2?t.constructor:void 0,r=n?ir(n):"";if(r)switch(r){case i2:return Nu;case o2:return Su;case a2:return Du;case l2:return Ru;case c2:return xu}return e});var u2=Zt,Io=qT,h2=Fp,f2=Lk,d2=VI,Ou=u2,Lu=Sl,Mu=ti.exports,p2=$p,g2=1,Pu="[object Arguments]",Fu="[object Array]",_s="[object Object]",m2=Object.prototype,Bu=m2.hasOwnProperty;function y2(t,e,n,r,s,i){var o=Lu(t),a=Lu(e),l=o?Fu:Ou(t),c=a?Fu:Ou(e);l=l==Pu?_s:l,c=c==Pu?_s:c;var u=l==_s,f=c==_s,p=l==c;if(p&&Mu(t)){if(!Mu(e))return!1;o=!0,u=!1}if(p&&!u)return i||(i=new Io),o||p2(t)?h2(t,e,n,r,s,i):f2(t,e,l,n,r,s,i);if(!(n&g2)){var d=u&&Bu.call(t,"__wrapped__"),h=f&&Bu.call(e,"__wrapped__");if(d||h){var g=d?t.value():t,v=h?e.value():e;return i||(i=new Io),s(g,v,n,r,i)}}return p?(i||(i=new Io),d2(t,e,n,r,s,i)):!1}var v2=y2,b2=v2,ju=$i;function Up(t,e,n,r,s){return t===e?!0:t==null||e==null||!ju(t)&&!ju(e)?t!==t&&e!==e:b2(t,e,n,r,Up,s)}var w2=Up,_2=w2;function E2(t,e){return _2(t,e)}var T2=E2;function k2(t){let e,n,r,s,i,o,a,l,c;return{c(){e=A("button"),n=A("button"),n.textContent="-",r=L(),s=A("span"),i=ce(t[0]),I(n,"class","h-6 w-6 bg-white hover:bg-red-500 border-l border-b border-black absolute top-0 right-0"),_t(n,"hidden",!t[2]),I(s,"class",o=`${t[1]?"font-emoji":""} text-5xl pointer-events-none`),I(e,"class",a=`${t[3]} h-36 w-28 bg-white ${t[2]?"hover:bg-yellow-200":"hover:bg-nl"} border border-black flex items-center justify-center relative`)},m(u,f){B(u,e,f),k(e,n),k(e,r),k(e,s),k(s,i),l||(c=[Y(n,"click",Ht(t[5])),Y(e,"click",t[4])],l=!0)},p(u,[f]){f&4&&_t(n,"hidden",!u[2]),f&1&&ye(i,u[0]),f&2&&o!==(o=`${u[1]?"font-emoji":""} text-5xl pointer-events-none`)&&I(s,"class",o),f&12&&a!==(a=`${u[3]} h-36 w-28 bg-white ${u[2]?"hover:bg-yellow-200":"hover:bg-nl"} border border-black flex items-center justify-center relative`)&&I(e,"class",a)},i:J,o:J,d(u){u&&F(e),l=!1,Ge(c)}}}function C2(t,e,n){let{text:r=""}=e,{emoji:s=!1}=e,{editMode:i=!1}=e,{class:o=""}=e;const a=yh(),l=()=>{a("click",{text:r,emoji:s})},c=()=>{a("delete")};return t.$$set=u=>{"text"in u&&n(0,r=u.text),"emoji"in u&&n(1,s=u.emoji),"editMode"in u&&n(2,i=u.editMode),"class"in u&&n(3,o=u.class)},[r,s,i,o,l,c]}class Vi extends et{constructor(e){super(),Ze(this,e,C2,k2,He,{text:0,emoji:1,editMode:2,class:3})}}const qp=(t,e)=>isNaN(+t)&&isNaN(+e)?t.localeCompare(e):isNaN(+t)?1:isNaN(+e)?-1:+t-+e;function $u(t,e,n){const r=t.slice();return r[24]=e[n],r}function Vu(t,e,n){const r=t.slice();return r[21]=e[n],r[23]=n,r}function Uu(t){let e,n,r;return{c(){e=A("button"),e.textContent="Save",I(e,"class","px-2 bg-white h-7 border-l border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){B(s,e,i),n||(r=Y(e,"click",t[9]),n=!0)},p:J,d(s){s&&F(e),n=!1,r()}}}function I2(t){let e,n,r,s=[],i=new Map,o,a,l,c=t[0].sort(t[19]);const u=f=>f[24].text;for(let f=0;f<c.length;f+=1){let p=$u(t,c,f),d=u(p);i.set(d,s[f]=qu(d,p))}return{c(){e=A("button"),e.textContent="Clear Vote",n=L(),r=A("div");for(let f=0;f<s.length;f+=1)s[f].c();I(e,"class","w-full border border-black hover:bg-nl hover:text-white mb-4"),I(r,"class","grid justify-between auto-fill-col gap-2 svelte-9d72rf")},m(f,p){B(f,e,p),B(f,n,p),B(f,r,p);for(let d=0;d<s.length;d+=1)s[d].m(r,null);o=!0,a||(l=Y(e,"click",t[18]),a=!0)},p(f,p){p&129&&(c=f[0].sort(f[19]),zt(),s=ma(s,p,u,1,f,c,i,r,og,qu,null,$u),Kt())},i(f){if(!o){for(let p=0;p<c.length;p+=1)te(s[p]);o=!0}},o(f){for(let p=0;p<s.length;p+=1)ie(s[p]);o=!1},d(f){f&&F(e),f&&F(n),f&&F(r);for(let p=0;p<s.length;p+=1)s[p].d();a=!1,l()}}}function A2(t){let e,n,r,s,i=t[5],o=[];for(let l=0;l<i.length;l+=1)o[l]=Gu(Vu(t,i,l));const a=l=>ie(o[l],1,1,()=>{o[l]=null});return r=new Vi({props:{class:"bg-yellow-200 hover:bg-indigo-400",text:"+"}}),r.$on("click",t[17]),{c(){e=A("div");for(let l=0;l<o.length;l+=1)o[l].c();n=L(),Ne(r.$$.fragment),I(e,"class","grid justify-between auto-fill-col gap-2 svelte-9d72rf")},m(l,c){B(l,e,c);for(let u=0;u<o.length;u+=1)o[u].m(e,null);k(e,n),Ce(r,e,null),s=!0},p(l,c){if(c&36){i=l[5];let u;for(u=0;u<i.length;u+=1){const f=Vu(l,i,u);o[u]?(o[u].p(f,c),te(o[u],1)):(o[u]=Gu(f),o[u].c(),te(o[u],1),o[u].m(e,n))}for(zt(),u=i.length;u<o.length;u+=1)a(u);Kt()}},i(l){if(!s){for(let c=0;c<i.length;c+=1)te(o[c]);te(r.$$.fragment,l),s=!0}},o(l){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)ie(o[c]);ie(r.$$.fragment,l),s=!1},d(l){l&&F(e),tg(o,l),Ie(r)}}}function qu(t,e){let n,r,s;return r=new Vi({props:{text:e[24].text,emoji:e[24].emoji}}),r.$on("click",e[7]),{key:t,first:null,c(){n=Hn(),Ne(r.$$.fragment),this.first=n},m(i,o){B(i,n,o),Ce(r,i,o),s=!0},p(i,o){e=i;const a={};o&1&&(a.text=e[24].text),o&1&&(a.emoji=e[24].emoji),r.$set(a)},i(i){s||(te(r.$$.fragment,i),s=!0)},o(i){ie(r.$$.fragment,i),s=!1},d(i){i&&F(n),Ie(r,i)}}}function Gu(t){let e,n;function r(){return t[16](t[23])}return e=new Vi({props:{class:"bg-white",text:t[21].text,emoji:t[21].emoji,editMode:t[2]}}),e.$on("delete",r),{c(){Ne(e.$$.fragment)},m(s,i){Ce(e,s,i),n=!0},p(s,i){t=s;const o={};i&32&&(o.text=t[21].text),i&32&&(o.emoji=t[21].emoji),i&4&&(o.editMode=t[2]),e.$set(o)},i(s){n||(te(e.$$.fragment,s),n=!0)},o(s){ie(e.$$.fragment,s),n=!1},d(s){Ie(e,s)}}}function S2(t){let e,n,r,s,i=t[2]?"Cancel":"Edit",o,a,l,c,u,f,p,d,h,g,v,m,y,E,w,b,_,C,T,D,P,S,q,O,H,N,me,ne,$,oe,fe,W=t[2]&&Uu(t);p=new Vi({props:{class:"bg-white",text:t[4].text,emoji:t[4].emoji}});const de=[A2,I2],ke=[];function ht(K,we){return K[2]?0:1}return N=ht(t),me=ke[N]=de[N](t),{c(){e=A("div"),n=A("div"),W&&W.c(),r=L(),s=A("button"),o=ce(i),l=L(),c=A("div"),u=A("div"),f=A("div"),Ne(p.$$.fragment),d=L(),h=A("div"),g=A("form"),v=A("label"),m=A("span"),m.textContent="Card Text",y=L(),E=A("input"),w=L(),b=A("label"),_=A("span"),_.textContent="Icon",C=L(),T=A("input"),D=L(),P=A("button"),P.textContent="New Card",S=L(),q=A("button"),q.textContent="Cancel",O=L(),H=A("div"),me.c(),I(s,"class",a=fs(`float-right px-2 bg-white h-7 border-l border-black self-end hover:text-white ${t[2]?"hover:bg-red-500":"hover:bg-nl"}`)+" svelte-9d72rf"),I(n,"class","w-full stripe-black border-b border-black flex flex-wrap justify-end box-content"),I(m,"class","text-sm font-bold block mb-2"),I(E,"type","text"),I(E,"name","cardText"),I(E,"placeholder","&MF"),I(E,"autocomplete","off"),E.required=!0,I(E,"class","mb-2 form-input"),I(_,"class","text-sm font-bold block pr-4"),I(T,"type","checkbox"),I(T,"name","icon"),I(b,"class","flex mb-4"),I(P,"type","submit"),P.value="create",I(P,"class","border border-black bg-white text-black hover:bg-green-500 hover:text-white font-bold py-1 px-3 rounded"),I(q,"type","button"),I(q,"class","border border-black bg-white text-black hover:bg-red-500 hover:text-white font-bold py-1 px-3 rounded"),I(h,"class","bg-white"),I(f,"class","p-2 h-full border border-black bg-white flex justify-around gap-2 items-center"),I(u,"class","p-6 absolute bg-gray-300 bg-opacity-90 w-full h-full z-10"),_t(u,"hidden",!t[3]),I(H,"class","p-2"),I(c,"class","relative"),I(e,"class",ne=fs(`${t[1]} relative`)+" svelte-9d72rf")},m(K,we){B(K,e,we),k(e,n),W&&W.m(n,null),k(n,r),k(n,s),k(s,o),k(e,l),k(e,c),k(c,u),k(u,f),Ce(p,f,null),k(f,d),k(f,h),k(h,g),k(g,v),k(v,m),k(v,y),k(v,E),On(E,t[4].text),k(g,w),k(g,b),k(b,_),k(b,C),k(b,T),T.checked=t[4].emoji,k(g,D),k(g,P),k(g,S),k(g,q),k(c,O),k(c,H),ke[N].m(H,null),$=!0,oe||(fe=[Y(s,"click",t[12]),Y(E,"input",t[13]),Y(T,"change",t[14]),Y(q,"click",t[15]),Y(g,"submit",Ht(vn(t[8])))],oe=!0)},p(K,[we]){K[2]?W?W.p(K,we):(W=Uu(K),W.c(),W.m(n,r)):W&&(W.d(1),W=null),(!$||we&4)&&i!==(i=K[2]?"Cancel":"Edit")&&ye(o,i),(!$||we&4&&a!==(a=fs(`float-right px-2 bg-white h-7 border-l border-black self-end hover:text-white ${K[2]?"hover:bg-red-500":"hover:bg-nl"}`)+" svelte-9d72rf"))&&I(s,"class",a);const Nt={};we&16&&(Nt.text=K[4].text),we&16&&(Nt.emoji=K[4].emoji),p.$set(Nt),we&16&&E.value!==K[4].text&&On(E,K[4].text),we&16&&(T.checked=K[4].emoji),we&8&&_t(u,"hidden",!K[3]);let ve=N;N=ht(K),N===ve?ke[N].p(K,we):(zt(),ie(ke[ve],1,1,()=>{ke[ve]=null}),Kt(),me=ke[N],me?me.p(K,we):(me=ke[N]=de[N](K),me.c()),te(me,1),me.m(H,null)),(!$||we&2&&ne!==(ne=fs(`${K[1]} relative`)+" svelte-9d72rf"))&&I(e,"class",ne)},i(K){$||(te(p.$$.fragment,K),te(me),$=!0)},o(K){ie(p.$$.fragment,K),ie(me),$=!1},d(K){K&&F(e),W&&W.d(),Ie(p),ke[N].d(),oe=!1,Ge(fe)}}}function D2(t,e,n){let r;jt(t,an,T=>n(20,r=T));let{cardDeck:s=[]}=e,{class:i=""}=e,{id:o=""}=e,{nickID:a=""}=e,l=!1,c=!1;const u={text:"X",emoji:!1};let f={...u},p;const d=T=>{if(r)return;const D=Xe(Ye,"room",o);on(D,{people:{[a]:{card:T.detail}}},{merge:!0})},h=()=>{n(5,p=[...p,{text:f.text,emoji:f.emoji}]),n(3,c=!1),n(4,f={...u})},g=async()=>{const T=Xe(Ye,"room",o);let D=p.slice(),P=[];for(const S of s){const q=D.length;D=D.filter(O=>!T2(O,S)),D.length==q&&(P=[...P,S])}try{await sa(T,{cards:fw(...P)}),await sa(T,{cards:hw(...D)})}catch(S){console.error(S)}n(3,c=!1),n(4,f={...u}),n(2,l=!1)},v=()=>{l?(n(3,c=!1),n(4,f={...u})):n(5,p=s.slice()),n(2,l=!l)};function m(){f.text=this.value,n(4,f)}function y(){f.emoji=this.checked,n(4,f)}const E=()=>{n(3,c=!1),n(4,f={...u})},w=T=>{n(5,p=[...p.filter((D,P)=>P!==T)])},b=()=>{n(3,c=!0)},_=()=>d({detail:""}),C=(T,D)=>qp(T.text,D.text);return t.$$set=T=>{"cardDeck"in T&&n(0,s=T.cardDeck),"class"in T&&n(1,i=T.class),"id"in T&&n(10,o=T.id),"nickID"in T&&n(11,a=T.nickID)},[s,i,l,c,f,p,u,d,h,g,o,a,v,m,y,E,w,b,_,C]}class R2 extends et{constructor(e){super(),Ze(this,e,D2,S2,He,{cardDeck:0,class:1,id:10,nickID:11})}}var Gp={},Dl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.QRMath=t.QRUtil=t.QRMaskPattern=t.QRErrorCorrectLevel=t.QRCodeModel=void 0;function e(d,h,g){var v=r(h),m=d-1,y=0;switch(g){case t.QRErrorCorrectLevel.L:y=p[m][0];break;case t.QRErrorCorrectLevel.M:y=p[m][1];break;case t.QRErrorCorrectLevel.Q:y=p[m][2];break;case t.QRErrorCorrectLevel.H:y=p[m][3];break}return v<=y}function n(d,h){for(var g=1,v=r(d),m=0,y=p.length;m<y;m++){var E=0;switch(h){case t.QRErrorCorrectLevel.L:E=p[m][0];break;case t.QRErrorCorrectLevel.M:E=p[m][1];break;case t.QRErrorCorrectLevel.Q:E=p[m][2];break;case t.QRErrorCorrectLevel.H:E=p[m][3];break}if(v<=E)break;g++}if(g>p.length)throw new Error("Too long data");return g}function r(d){var h=encodeURI(d).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return h.length+(h.length!=Number(d)?3:0)}var s=function(){function d(h){this.mode=o.MODE_8BIT_BYTE,this.parsedData=[],this.data=h;for(var g=[],v=0,m=this.data.length;v<m;v++){var y=[],E=this.data.charCodeAt(v);E>65536?(y[0]=240|(E&1835008)>>>18,y[1]=128|(E&258048)>>>12,y[2]=128|(E&4032)>>>6,y[3]=128|E&63):E>2048?(y[0]=224|(E&61440)>>>12,y[1]=128|(E&4032)>>>6,y[2]=128|E&63):E>128?(y[0]=192|(E&1984)>>>6,y[1]=128|E&63):y[0]=E,g.push(y)}this.parsedData=Array.prototype.concat.apply([],g),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return d.prototype.getLength=function(){return this.parsedData.length},d.prototype.write=function(h){for(var g=0,v=this.parsedData.length;g<v;g++)h.put(this.parsedData[g],8)},d}(),i=function(){function d(h,g){h===void 0&&(h=-1),g===void 0&&(g=t.QRErrorCorrectLevel.L),this.moduleCount=0,this.dataList=[],this.typeNumber=h,this.errorCorrectLevel=g,this.moduleCount=0,this.dataList=[]}return d.prototype.addData=function(h){if(this.typeNumber<=0)this.typeNumber=n(h,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error("Invalid QR version: "+this.typeNumber);if(!e(this.typeNumber,h,this.errorCorrectLevel))throw new Error("Data is too long for QR version: "+this.typeNumber)}var g=new s(h);this.dataList.push(g),this.dataCache=void 0},d.prototype.isDark=function(h,g){if(h<0||this.moduleCount<=h||g<0||this.moduleCount<=g)throw new Error(h+","+g);return this.modules[h][g]},d.prototype.getModuleCount=function(){return this.moduleCount},d.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},d.prototype.makeImpl=function(h,g){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var v=0;v<this.moduleCount;v++){this.modules[v]=new Array(this.moduleCount);for(var m=0;m<this.moduleCount;m++)this.modules[v][m]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(h,g),this.typeNumber>=7&&this.setupTypeNumber(h),this.dataCache==null&&(this.dataCache=d.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,g)},d.prototype.setupPositionProbePattern=function(h,g){for(var v=-1;v<=7;v++)if(!(h+v<=-1||this.moduleCount<=h+v))for(var m=-1;m<=7;m++)g+m<=-1||this.moduleCount<=g+m||(0<=v&&v<=6&&(m==0||m==6)||0<=m&&m<=6&&(v==0||v==6)||2<=v&&v<=4&&2<=m&&m<=4?this.modules[h+v][g+m]=!0:this.modules[h+v][g+m]=!1)},d.prototype.getBestMaskPattern=function(){if(Number.isInteger(this.maskPattern)&&Object.values(t.QRMaskPattern).includes(this.maskPattern))return this.maskPattern;for(var h=0,g=0,v=0;v<8;v++){this.makeImpl(!0,v);var m=a.getLostPoint(this);(v==0||h>m)&&(h=m,g=v)}return g},d.prototype.setupTimingPattern=function(){for(var h=8;h<this.moduleCount-8;h++)this.modules[h][6]==null&&(this.modules[h][6]=h%2==0);for(var g=8;g<this.moduleCount-8;g++)this.modules[6][g]==null&&(this.modules[6][g]=g%2==0)},d.prototype.setupPositionAdjustPattern=function(){for(var h=a.getPatternPosition(this.typeNumber),g=0;g<h.length;g++)for(var v=0;v<h.length;v++){var m=h[g],y=h[v];if(this.modules[m][y]==null)for(var E=-2;E<=2;E++)for(var w=-2;w<=2;w++)E==-2||E==2||w==-2||w==2||E==0&&w==0?this.modules[m+E][y+w]=!0:this.modules[m+E][y+w]=!1}},d.prototype.setupTypeNumber=function(h){for(var g=a.getBCHTypeNumber(this.typeNumber),v=0;v<18;v++){var m=!h&&(g>>v&1)==1;this.modules[Math.floor(v/3)][v%3+this.moduleCount-8-3]=m}for(var v=0;v<18;v++){var m=!h&&(g>>v&1)==1;this.modules[v%3+this.moduleCount-8-3][Math.floor(v/3)]=m}},d.prototype.setupTypeInfo=function(h,g){for(var v=this.errorCorrectLevel<<3|g,m=a.getBCHTypeInfo(v),y=0;y<15;y++){var E=!h&&(m>>y&1)==1;y<6?this.modules[y][8]=E:y<8?this.modules[y+1][8]=E:this.modules[this.moduleCount-15+y][8]=E}for(var y=0;y<15;y++){var E=!h&&(m>>y&1)==1;y<8?this.modules[8][this.moduleCount-y-1]=E:y<9?this.modules[8][15-y-1+1]=E:this.modules[8][15-y-1]=E}this.modules[this.moduleCount-8][8]=!h},d.prototype.mapData=function(h,g){for(var v=-1,m=this.moduleCount-1,y=7,E=0,w=this.moduleCount-1;w>0;w-=2)for(w==6&&w--;;){for(var b=0;b<2;b++)if(this.modules[m][w-b]==null){var _=!1;E<h.length&&(_=(h[E]>>>y&1)==1);var C=a.getMask(g,m,w-b);C&&(_=!_),this.modules[m][w-b]=_,y--,y==-1&&(E++,y=7)}if(m+=v,m<0||this.moduleCount<=m){m-=v,v=-v;break}}},d.createData=function(h,g,v){for(var m=u.getRSBlocks(h,g),y=new f,E=0;E<v.length;E++){var w=v[E];y.put(w.mode,4),y.put(w.getLength(),a.getLengthInBits(w.mode,h)),w.write(y)}for(var b=0,E=0;E<m.length;E++)b+=m[E].dataCount;if(y.getLengthInBits()>b*8)throw new Error("code length overflow. ("+y.getLengthInBits()+">"+b*8+")");for(y.getLengthInBits()+4<=b*8&&y.put(0,4);y.getLengthInBits()%8!=0;)y.putBit(!1);for(;!(y.getLengthInBits()>=b*8||(y.put(d.PAD0,8),y.getLengthInBits()>=b*8));)y.put(d.PAD1,8);return d.createBytes(y,m)},d.createBytes=function(h,g){for(var v=0,m=0,y=0,E=new Array(g.length),w=new Array(g.length),b=0;b<g.length;b++){var _=g[b].dataCount,C=g[b].totalCount-_;m=Math.max(m,_),y=Math.max(y,C),E[b]=new Array(_);for(var T=0;T<E[b].length;T++)E[b][T]=255&h.buffer[T+v];v+=_;var D=a.getErrorCorrectPolynomial(C),P=new c(E[b],D.getLength()-1),S=P.mod(D);w[b]=new Array(D.getLength()-1);for(var T=0;T<w[b].length;T++){var q=T+S.getLength()-w[b].length;w[b][T]=q>=0?S.get(q):0}}for(var O=0,T=0;T<g.length;T++)O+=g[T].totalCount;for(var H=new Array(O),N=0,T=0;T<m;T++)for(var b=0;b<g.length;b++)T<E[b].length&&(H[N++]=E[b][T]);for(var T=0;T<y;T++)for(var b=0;b<g.length;b++)T<w[b].length&&(H[N++]=w[b][T]);return H},d.PAD0=236,d.PAD1=17,d}();t.QRCodeModel=i,t.QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var o={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};t.QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var a=function(){function d(){}return d.getBCHTypeInfo=function(h){for(var g=h<<10;d.getBCHDigit(g)-d.getBCHDigit(d.G15)>=0;)g^=d.G15<<d.getBCHDigit(g)-d.getBCHDigit(d.G15);return(h<<10|g)^d.G15_MASK},d.getBCHTypeNumber=function(h){for(var g=h<<12;d.getBCHDigit(g)-d.getBCHDigit(d.G18)>=0;)g^=d.G18<<d.getBCHDigit(g)-d.getBCHDigit(d.G18);return h<<12|g},d.getBCHDigit=function(h){for(var g=0;h!=0;)g++,h>>>=1;return g},d.getPatternPosition=function(h){return d.PATTERN_POSITION_TABLE[h-1]},d.getMask=function(h,g,v){switch(h){case t.QRMaskPattern.PATTERN000:return(g+v)%2==0;case t.QRMaskPattern.PATTERN001:return g%2==0;case t.QRMaskPattern.PATTERN010:return v%3==0;case t.QRMaskPattern.PATTERN011:return(g+v)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(g/2)+Math.floor(v/3))%2==0;case t.QRMaskPattern.PATTERN101:return g*v%2+g*v%3==0;case t.QRMaskPattern.PATTERN110:return(g*v%2+g*v%3)%2==0;case t.QRMaskPattern.PATTERN111:return(g*v%3+(g+v)%2)%2==0;default:throw new Error("bad maskPattern:"+h)}},d.getErrorCorrectPolynomial=function(h){for(var g=new c([1],0),v=0;v<h;v++)g=g.multiply(new c([1,l.gexp(v)],0));return g},d.getLengthInBits=function(h,g){if(1<=g&&g<10)switch(h){case o.MODE_NUMBER:return 10;case o.MODE_ALPHA_NUM:return 9;case o.MODE_8BIT_BYTE:return 8;case o.MODE_KANJI:return 8;default:throw new Error("mode:"+h)}else if(g<27)switch(h){case o.MODE_NUMBER:return 12;case o.MODE_ALPHA_NUM:return 11;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 10;default:throw new Error("mode:"+h)}else if(g<41)switch(h){case o.MODE_NUMBER:return 14;case o.MODE_ALPHA_NUM:return 13;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 12;default:throw new Error("mode:"+h)}else throw new Error("type:"+g)},d.getLostPoint=function(h){for(var g=h.getModuleCount(),v=0,m=0;m<g;m++)for(var y=0;y<g;y++){for(var E=0,w=h.isDark(m,y),b=-1;b<=1;b++)if(!(m+b<0||g<=m+b))for(var _=-1;_<=1;_++)y+_<0||g<=y+_||b==0&&_==0||w==h.isDark(m+b,y+_)&&E++;E>5&&(v+=3+E-5)}for(var m=0;m<g-1;m++)for(var y=0;y<g-1;y++){var C=0;h.isDark(m,y)&&C++,h.isDark(m+1,y)&&C++,h.isDark(m,y+1)&&C++,h.isDark(m+1,y+1)&&C++,(C==0||C==4)&&(v+=3)}for(var m=0;m<g;m++)for(var y=0;y<g-6;y++)h.isDark(m,y)&&!h.isDark(m,y+1)&&h.isDark(m,y+2)&&h.isDark(m,y+3)&&h.isDark(m,y+4)&&!h.isDark(m,y+5)&&h.isDark(m,y+6)&&(v+=40);for(var y=0;y<g;y++)for(var m=0;m<g-6;m++)h.isDark(m,y)&&!h.isDark(m+1,y)&&h.isDark(m+2,y)&&h.isDark(m+3,y)&&h.isDark(m+4,y)&&!h.isDark(m+5,y)&&h.isDark(m+6,y)&&(v+=40);for(var T=0,y=0;y<g;y++)for(var m=0;m<g;m++)h.isDark(m,y)&&T++;var D=Math.abs(100*T/g/g-50)/5;return v+=D*10,v},d.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],d.G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,d.G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,d.G15_MASK=1<<14|1<<12|1<<10|1<<4|1<<1,d}();t.QRUtil=a;var l=function(){function d(){}return d.glog=function(h){if(h<1)throw new Error("glog("+h+")");return d.LOG_TABLE[h]},d.gexp=function(h){for(;h<0;)h+=255;for(;h>=256;)h-=255;return d.EXP_TABLE[h]},d.EXP_TABLE=new Array(256),d.LOG_TABLE=new Array(256),d._constructor=function(){for(var h=0;h<8;h++)d.EXP_TABLE[h]=1<<h;for(var h=8;h<256;h++)d.EXP_TABLE[h]=d.EXP_TABLE[h-4]^d.EXP_TABLE[h-5]^d.EXP_TABLE[h-6]^d.EXP_TABLE[h-8];for(var h=0;h<255;h++)d.LOG_TABLE[d.EXP_TABLE[h]]=h}(),d}();t.QRMath=l;var c=function(){function d(h,g){if(h.length==null)throw new Error(h.length+"/"+g);for(var v=0;v<h.length&&h[v]==0;)v++;this.num=new Array(h.length-v+g);for(var m=0;m<h.length-v;m++)this.num[m]=h[m+v]}return d.prototype.get=function(h){return this.num[h]},d.prototype.getLength=function(){return this.num.length},d.prototype.multiply=function(h){for(var g=new Array(this.getLength()+h.getLength()-1),v=0;v<this.getLength();v++)for(var m=0;m<h.getLength();m++)g[v+m]^=l.gexp(l.glog(this.get(v))+l.glog(h.get(m)));return new d(g,0)},d.prototype.mod=function(h){if(this.getLength()-h.getLength()<0)return this;for(var g=l.glog(this.get(0))-l.glog(h.get(0)),v=new Array(this.getLength()),m=0;m<this.getLength();m++)v[m]=this.get(m);for(var m=0;m<h.getLength();m++)v[m]^=l.gexp(l.glog(h.get(m))+g);return new d(v,0).mod(h)},d}(),u=function(){function d(h,g){this.totalCount=h,this.dataCount=g}return d.getRSBlocks=function(h,g){var v=d.getRsBlockTable(h,g);if(v==null)throw new Error("bad rs block @ typeNumber:"+h+"/errorCorrectLevel:"+g);for(var m=v.length/3,y=[],E=0;E<m;E++)for(var w=v[E*3+0],b=v[E*3+1],_=v[E*3+2],C=0;C<w;C++)y.push(new d(b,_));return y},d.getRsBlockTable=function(h,g){switch(g){case t.QRErrorCorrectLevel.L:return d.RS_BLOCK_TABLE[(h-1)*4+0];case t.QRErrorCorrectLevel.M:return d.RS_BLOCK_TABLE[(h-1)*4+1];case t.QRErrorCorrectLevel.Q:return d.RS_BLOCK_TABLE[(h-1)*4+2];case t.QRErrorCorrectLevel.H:return d.RS_BLOCK_TABLE[(h-1)*4+3];default:return}},d.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],d}(),f=function(){function d(){this.buffer=[],this.length=0}return d.prototype.get=function(h){var g=Math.floor(h/8);return(this.buffer[g]>>>7-h%8&1)==1},d.prototype.put=function(h,g){for(var v=0;v<g;v++)this.putBit((h>>>g-v-1&1)==1)},d.prototype.getLengthInBits=function(){return this.length},d.prototype.putBit=function(h){var g=Math.floor(this.length/8);this.buffer.length<=g&&this.buffer.push(0),h&&(this.buffer[g]|=128>>>this.length%8),this.length++},d}(),p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]]})(Dl);var Ui={},ss={};const x2="bold|bolder|lighter|[1-9]00",N2="italic|oblique",O2="small-caps",L2="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",M2="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",Hu=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,P2=new RegExp(`(${x2}) +`,"i"),F2=new RegExp(`(${N2}) +`,"i"),B2=new RegExp(`(${O2}) +`,"i"),j2=new RegExp(`(${L2}) +`,"i"),$2=new RegExp(`([\\d\\.]+)(${M2}) *((?:${Hu})( *, *(?:${Hu}))*)`),Ao={},V2=16;var U2=t=>{if(Ao[t])return Ao[t];const e=$2.exec(t);if(!e)return;const n={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(e[1]),unit:e[2],family:e[3].replace(/["']/g,"").replace(/ *, */g,",")};let r,s,i,o;const a=t.substring(0,e.index);switch((r=P2.exec(a))&&(n.weight=r[1]),(s=F2.exec(a))&&(n.style=s[1]),(i=B2.exec(a))&&(n.variant=i[1]),(o=j2.exec(a))&&(n.stretch=o[1]),n.unit){case"pt":n.size/=.75;break;case"pc":n.size*=16;break;case"in":n.size*=96;break;case"cm":n.size*=96/2.54;break;case"mm":n.size*=96/25.4;break;case"%":break;case"em":case"rem":n.size*=V2/.75;break;case"q":n.size*=96/25.4/4;break}return Ao[t]=n};const q2=U2;ss.parseFont=q2;ss.createCanvas=function(t,e){return Object.assign(document.createElement("canvas"),{width:t,height:e})};ss.createImageData=function(t,e,n){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(t);case 2:return new ImageData(t,e);default:return new ImageData(t,e,n)}};ss.loadImage=function(t,e){return new Promise(function(n,r){const s=Object.assign(document.createElement("img"),e);function i(){s.onload=null,s.onerror=null}s.onload=function(){i(),n(s)},s.onerror=function(){i(),r(new Error('Failed to load the image "'+t+'"'))},s.src=t})};var Hp={},zp={},At={};Object.defineProperty(At,"__esModule",{value:!0});At.loop=At.conditional=At.parse=void 0;var G2=function t(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;if(Array.isArray(n))n.forEach(function(o){return t(e,o,r,s)});else if(typeof n=="function")n(e,r,s,t);else{var i=Object.keys(n)[0];Array.isArray(n[i])?(s[i]={},t(e,n[i],r,s[i])):s[i]=n[i](e,r,s,t)}return r};At.parse=G2;var H2=function(e,n){return function(r,s,i,o){n(r,s,i)&&o(r,e,s,i)}};At.conditional=H2;var z2=function(e,n){return function(r,s,i,o){for(var a=[],l=r.pos;n(r,s,i);){var c={};if(o(r,e,s,c),r.pos===l)break;l=r.pos,a.push(c)}return a}};At.loop=z2;var be={};Object.defineProperty(be,"__esModule",{value:!0});be.readBits=be.readArray=be.readUnsigned=be.readString=be.peekBytes=be.readBytes=be.peekByte=be.readByte=be.buildStream=void 0;var K2=function(e){return{data:e,pos:0}};be.buildStream=K2;var Kp=function(){return function(e){return e.data[e.pos++]}};be.readByte=Kp;var Q2=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(n){return n.data[n.pos+e]}};be.peekByte=Q2;var qi=function(e){return function(n){return n.data.subarray(n.pos,n.pos+=e)}};be.readBytes=qi;var W2=function(e){return function(n){return n.data.subarray(n.pos,n.pos+e)}};be.peekBytes=W2;var X2=function(e){return function(n){return Array.from(qi(e)(n)).map(function(r){return String.fromCharCode(r)}).join("")}};be.readString=X2;var Y2=function(e){return function(n){var r=qi(2)(n);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};be.readUnsigned=Y2;var J2=function(e,n){return function(r,s,i){for(var o=typeof n=="function"?n(r,s,i):n,a=qi(e),l=new Array(o),c=0;c<o;c++)l[c]=a(r);return l}};be.readArray=J2;var Z2=function(e,n,r){for(var s=0,i=0;i<r;i++)s+=e[n+i]&&Math.pow(2,r-i-1);return s},eA=function(e){return function(n){for(var r=Kp()(n),s=new Array(8),i=0;i<8;i++)s[7-i]=!!(r&1<<i);return Object.keys(e).reduce(function(o,a){var l=e[a];return l.length?o[a]=Z2(s,l.index,l.length):o[a]=s[l.index],o},{})}};be.readBits=eA;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=At,n=be,r={blocks:function(p){for(var d=0,h=[],g=p.data.length,v=0,m=(0,n.readByte)()(p);m!==d&&m;m=(0,n.readByte)()(p)){if(p.pos+m>=g){var y=g-p.pos;h.push((0,n.readBytes)(y)(p)),v+=y;break}h.push((0,n.readBytes)(m)(p)),v+=m}for(var E=new Uint8Array(v),w=0,b=0;b<h.length;b++)E.set(h[b],w),w+=h[b].length;return E}},s=(0,e.conditional)({gce:[{codes:(0,n.readBytes)(2)},{byteSize:(0,n.readByte)()},{extras:(0,n.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,n.readUnsigned)(!0)},{transparentColorIndex:(0,n.readByte)()},{terminator:(0,n.readByte)()}]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===249}),i=(0,e.conditional)({image:[{code:(0,n.readByte)()},{descriptor:[{left:(0,n.readUnsigned)(!0)},{top:(0,n.readUnsigned)(!0)},{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{lct:(0,n.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,n.readArray)(3,function(f,p,d){return Math.pow(2,d.descriptor.lct.size+1)})},function(f,p,d){return d.descriptor.lct.exists}),{data:[{minCodeSize:(0,n.readByte)()},r]}]},function(f){return(0,n.peekByte)()(f)===44}),o=(0,e.conditional)({text:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{preData:function(p,d,h){return(0,n.readBytes)(h.text.blockSize)(p)}},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===1}),a=(0,e.conditional)({application:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{id:function(p,d,h){return(0,n.readString)(h.blockSize)(p)}},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===255}),l=(0,e.conditional)({comment:[{codes:(0,n.readBytes)(2)},r]},function(f){var p=(0,n.peekBytes)(2)(f);return p[0]===33&&p[1]===254}),c=[{header:[{signature:(0,n.readString)(3)},{version:(0,n.readString)(3)}]},{lsd:[{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{gct:(0,n.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,n.readByte)()},{pixelAspectRatio:(0,n.readByte)()}]},(0,e.conditional)({gct:(0,n.readArray)(3,function(f,p){return Math.pow(2,p.lsd.gct.size+1)})},function(f,p){return p.lsd.gct.exists}),{frames:(0,e.loop)([s,a,l,i,o],function(f){var p=(0,n.peekByte)()(f);return p===33||p===44})}],u=c;t.default=u})(zp);var Gi={};Object.defineProperty(Gi,"__esModule",{value:!0});Gi.deinterlace=void 0;Gi.deinterlace=function(t,e){for(var n=new Array(t.length),r=t.length/e,s=function(u,f){var p=t.slice(f*e,(f+1)*e);n.splice.apply(n,[u*e,e].concat(p))},i=[0,4,2,1],o=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=i[l];c<r;c+=o[l])s(c,a),a++;return n};var Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});Hi.lzw=void 0;Hi.lzw=function(t,e,n){var r=4096,s=-1,i=n,o,a,l,c,u,f,p,b,d,h,w,g,_,C,D,T,v=new Array(n),m=new Array(r),y=new Array(r),E=new Array(r+1);for(g=t,a=1<<g,u=a+1,o=a+2,p=s,c=g+1,l=(1<<c)-1,d=0;d<a;d++)m[d]=0,y[d]=d;var w,b,_,C,T,D;for(w=b=_=C=T=D=0,h=0;h<i;){if(C===0){if(b<c){w+=e[D]<<b,b+=8,D++;continue}if(d=w&l,w>>=c,b-=c,d>o||d==u)break;if(d==a){c=g+1,l=(1<<c)-1,o=a+2,p=s;continue}if(p==s){E[C++]=y[d],p=d,_=d;continue}for(f=d,d==o&&(E[C++]=_,d=p);d>a;)E[C++]=y[d],d=m[d];_=y[d]&255,E[C++]=_,o<r&&(m[o]=p,y[o]=_,o++,(o&l)===0&&o<r&&(c++,l+=o)),p=f}C--,v[T++]=E[C],h++}for(h=T;h<i;h++)v[h]=0;return v};(function(t){var e=Oe&&Oe.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(t,"__esModule",{value:!0}),t.decompressFrames=t.decompressFrame=t.parseGIF=void 0;var n=e(zp),r=At,s=be,i=Gi,o=Hi;t.parseGIF=function(l){var c=new Uint8Array(l);return r.parse(s.buildStream(c),n.default)};var a=function(l){for(var c=l.pixels.length,u=new Uint8ClampedArray(c*4),f=0;f<c;f++){var p=f*4,d=l.pixels[f],h=l.colorTable[d];u[p]=h[0],u[p+1]=h[1],u[p+2]=h[2],u[p+3]=d!==l.transparentIndex?255:0}return u};t.decompressFrame=function(l,c,u){if(!l.image){console.warn("gif frame does not have associated image.");return}var f=l.image,p=f.descriptor.width*f.descriptor.height,d=o.lzw(f.data.minCodeSize,f.data.blocks,p);f.descriptor.lct.interlaced&&(d=i.deinterlace(d,f.descriptor.width));var h={pixels:d,dims:{top:l.image.descriptor.top,left:l.image.descriptor.left,width:l.image.descriptor.width,height:l.image.descriptor.height}};return f.descriptor.lct&&f.descriptor.lct.exists?h.colorTable=f.lct:h.colorTable=c,l.gce&&(h.delay=(l.gce.delay||10)*10,h.disposalType=l.gce.extras.disposal,l.gce.extras.transparentColorGiven&&(h.transparentIndex=l.gce.transparentColorIndex)),u&&(h.patch=a(h)),h},t.decompressFrames=function(l,c){return l.frames.filter(function(u){return u.image}).map(function(u){return t.decompressFrame(u,l.gct,c)})}})(Hp);var tA=100,Re=256,zu=Re-1,Mt=4,Qp=16,Rl=1<<Qp,Wp=10,xl=10,nA=Rl>>xl,rA=Rl<<Wp-xl,sA=Re>>3,fa=6,iA=1<<fa,oA=sA*iA,aA=30,Xp=10,Es=1<<Xp,Yp=8,Ku=1<<Yp,lA=Xp+Yp,Sn=1<<lA,Qu=499,Wu=491,Xu=487,Jp=503,cA=3*Jp;function uA(t,e){var n,r,s,i,o;function a(){n=[],r=new Int32Array(256),s=new Int32Array(Re),i=new Int32Array(Re),o=new Int32Array(Re>>3);var m,y;for(m=0;m<Re;m++)y=(m<<Mt+8)/Re,n[m]=new Float64Array([y,y,y,0]),i[m]=Rl/Re,s[m]=0}function l(){for(var m=0;m<Re;m++)n[m][0]>>=Mt,n[m][1]>>=Mt,n[m][2]>>=Mt,n[m][3]=m}function c(m,y,E,w,b){n[y][0]-=m*(n[y][0]-E)/Es,n[y][1]-=m*(n[y][1]-w)/Es,n[y][2]-=m*(n[y][2]-b)/Es}function u(m,y,E,w,b){for(var _=Math.abs(y-m),C=Math.min(y+m,Re),T=y+1,D=y-1,P=1,S,q;T<C||D>_;)q=o[P++],T<C&&(S=n[T++],S[0]-=q*(S[0]-E)/Sn,S[1]-=q*(S[1]-w)/Sn,S[2]-=q*(S[2]-b)/Sn),D>_&&(S=n[D--],S[0]-=q*(S[0]-E)/Sn,S[1]-=q*(S[1]-w)/Sn,S[2]-=q*(S[2]-b)/Sn)}function f(m,y,E){var w=2147483647,b=w,_=-1,C=_,T,D,P,S,q;for(T=0;T<Re;T++)D=n[T],P=Math.abs(D[0]-m)+Math.abs(D[1]-y)+Math.abs(D[2]-E),P<w&&(w=P,_=T),S=P-(s[T]>>Qp-Mt),S<b&&(b=S,C=T),q=i[T]>>xl,i[T]-=q,s[T]+=q<<Wp;return i[_]+=nA,s[_]-=rA,C}function p(){var m,y,E,w,b,_,C=0,T=0;for(m=0;m<Re;m++){for(E=n[m],b=m,_=E[1],y=m+1;y<Re;y++)w=n[y],w[1]<_&&(b=y,_=w[1]);if(w=n[b],m!=b&&(y=w[0],w[0]=E[0],E[0]=y,y=w[1],w[1]=E[1],E[1]=y,y=w[2],w[2]=E[2],E[2]=y,y=w[3],w[3]=E[3],E[3]=y),_!=C){for(r[C]=T+m>>1,y=C+1;y<_;y++)r[y]=m;C=_,T=m}}for(r[C]=T+zu>>1,y=C+1;y<256;y++)r[y]=zu}function d(m,y,E){for(var w,b,_,C=1e3,T=-1,D=r[y],P=D-1;D<Re||P>=0;)D<Re&&(b=n[D],_=b[1]-y,_>=C?D=Re:(D++,_<0&&(_=-_),w=b[0]-m,w<0&&(w=-w),_+=w,_<C&&(w=b[2]-E,w<0&&(w=-w),_+=w,_<C&&(C=_,T=b[3])))),P>=0&&(b=n[P],_=y-b[1],_>=C?P=-1:(P--,_<0&&(_=-_),w=b[0]-m,w<0&&(w=-w),_+=w,_<C&&(w=b[2]-E,w<0&&(w=-w),_+=w,_<C&&(C=_,T=b[3]))));return T}function h(){var m,y=t.length,E=30+(e-1)/3,w=y/(3*e),b=~~(w/tA),_=Es,C=oA,T=C>>fa;for(T<=1&&(T=0),m=0;m<T;m++)o[m]=_*((T*T-m*m)*Ku/(T*T));var D;y<cA?(e=1,D=3):y%Qu!==0?D=3*Qu:y%Wu!==0?D=3*Wu:y%Xu!==0?D=3*Xu:D=3*Jp;var P,S,q,O,H=0;for(m=0;m<w;)if(P=(t[H]&255)<<Mt,S=(t[H+1]&255)<<Mt,q=(t[H+2]&255)<<Mt,O=f(P,S,q),c(_,O,P,S,q),T!==0&&u(T,O,P,S,q),H+=D,H>=y&&(H-=y),m++,b===0&&(b=1),m%b===0)for(_-=_/E,C-=C/aA,T=C>>fa,T<=1&&(T=0),O=0;O<T;O++)o[O]=_*((T*T-O*O)*Ku/(T*T))}function g(){a(),h(),l(),p()}this.buildColormap=g;function v(){for(var m=[],y=[],E=0;E<Re;E++)y[n[E][3]]=E;for(var w=0,b=0;b<Re;b++){var _=y[b];m[w++]=n[_][0],m[w++]=n[_][1],m[w++]=n[_][2]}return m}this.getColormap=v,this.lookupRGB=d}var hA=uA,Yu=-1,Ts=12,pr=5003,fA=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function dA(t,e,n,r){var s=Math.max(2,r),i=new Uint8Array(256),o=new Int32Array(pr),a=new Int32Array(pr),l,c=0,u,f=0,p,d=!1,h,g,v,m,y,E;function w(O,H){i[u++]=O,u>=254&&D(H)}function b(O){_(pr),f=g+2,d=!0,q(g,O)}function _(O){for(var H=0;H<O;++H)o[H]=-1}function C(O,H){var N,me,ne,$,oe,fe,W;for(h=O,d=!1,E=h,p=P(E),g=1<<O-1,v=g+1,f=g+2,u=0,$=S(),W=0,N=pr;N<65536;N*=2)++W;W=8-W,fe=pr,_(fe),q(g,H);e:for(;(me=S())!=Yu;){if(N=(me<<Ts)+$,ne=me<<W^$,o[ne]===N){$=a[ne];continue}else if(o[ne]>=0){oe=fe-ne,ne===0&&(oe=1);do if((ne-=oe)<0&&(ne+=fe),o[ne]===N){$=a[ne];continue e}while(o[ne]>=0)}q($,H),$=me,f<1<<Ts?(a[ne]=f++,o[ne]=N):b(H)}q($,H),q(v,H)}function T(O){O.writeByte(s),m=t*e,y=0,C(s+1,O),O.writeByte(0)}function D(O){u>0&&(O.writeByte(u),O.writeBytes(i,0,u),u=0)}function P(O){return(1<<O)-1}function S(){if(m===0)return Yu;--m;var O=n[y++];return O&255}function q(O,H){for(l&=fA[c],c>0?l|=O<<c:l=O,c+=E;c>=8;)w(l&255,H),l>>=8,c-=8;if((f>p||d)&&(d?(p=P(E=h),d=!1):(++E,E==Ts?p=1<<Ts:p=P(E))),O==v){for(;c>0;)w(l&255,H),l>>=8,c-=8;D(H)}}this.encode=T}var pA=dA,gA=hA,mA=pA;function it(){this.page=-1,this.pages=[],this.newPage()}it.pageSize=4096;it.charMap={};for(var ks=0;ks<256;ks++)it.charMap[ks]=String.fromCharCode(ks);it.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(it.pageSize),this.cursor=0};it.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var n=0;n<it.pageSize;n++)t+=it.charMap[this.pages[e][n]];return t};it.prototype.toFlattenUint8Array=function(){for(var t=[],e=0;e<this.pages.length;e++)if(e===this.pages.length-1){var n=Uint8Array.from(this.pages[e].slice(0,this.cursor));t.push(n)}else t.push(this.pages[e]);var r=new Uint8Array(t.reduce(function(s,i){return s+i.length},0));return t.reduce(function(s,i){return r.set(i,s),s+i.length},0),r};it.prototype.writeByte=function(t){this.cursor>=it.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t};it.prototype.writeUTFBytes=function(t){for(var e=t.length,n=0;n<e;n++)this.writeByte(t.charCodeAt(n))};it.prototype.writeBytes=function(t,e,n){for(var r=n||t.length,s=e||0;s<r;s++)this.writeByte(t[s])};function le(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new it}le.prototype.setDelay=function(t){this.delay=Math.round(t/10)};le.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)};le.prototype.setDispose=function(t){t>=0&&(this.dispose=t)};le.prototype.setRepeat=function(t){this.repeat=t};le.prototype.setTransparent=function(t){this.transparent=t};le.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};le.prototype.finish=function(){this.out.writeByte(59)};le.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t};le.prototype.setDither=function(t){t===!0&&(t="FloydSteinberg"),this.dither=t};le.prototype.setGlobalPalette=function(t){this.globalPalette=t};le.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};le.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};le.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new gA(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};le.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var n=0,r=0;r<e;r++){var s=this.findClosestRGB(this.pixels[n++]&255,this.pixels[n++]&255,this.pixels[n++]&255);this.usedEntry[s]=!0,this.indexedPixels[r]=s}};le.prototype.ditherPixels=function(t,e){var n={FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],Stucki:[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]};if(!t||!n[t])throw"Unknown dithering kernel: "+t;var r=n[t],s=0,i=this.height,o=this.width,a=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var c=0;c<i;c++){e&&(l=l*-1);for(var u=l==1?0:o-1,f=l==1?o:0;u!==f;u+=l){s=c*o+u;var p=s*3,d=a[p],h=a[p+1],g=a[p+2];p=this.findClosestRGB(d,h,g),this.usedEntry[p]=!0,this.indexedPixels[s]=p,p*=3;for(var v=this.colorTab[p],m=this.colorTab[p+1],y=this.colorTab[p+2],E=d-v,w=h-m,b=g-y,_=l==1?0:r.length-1,C=l==1?r.length:0;_!==C;_+=l){var T=r[_][1],D=r[_][2];if(T+u>=0&&T+u<o&&D+c>=0&&D+c<i){var P=r[_][0];p=s+T+D*o,p*=3,a[p]=Math.max(0,Math.min(255,a[p]+E*P)),a[p+1]=Math.max(0,Math.min(255,a[p+1]+w*P)),a[p+2]=Math.max(0,Math.min(255,a[p+2]+b*P))}}}}};le.prototype.findClosest=function(t,e){return this.findClosestRGB((t&16711680)>>16,(t&65280)>>8,t&255,e)};le.prototype.findClosestRGB=function(t,e,n,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,n);for(var s=0,i=256*256*256,o=this.colorTab.length,a=0,l=0;a<o;l++){var c=t-(this.colorTab[a++]&255),u=e-(this.colorTab[a++]&255),f=n-(this.colorTab[a++]&255),p=c*c+u*u+f*f;(!r||this.usedEntry[l])&&p<i&&(i=p,s=l)}return s};le.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var n=this.image,r=0,s=0,i=0;i<e;i++)for(var o=0;o<t;o++)this.pixels[s++]=n[r++],this.pixels[s++]=n[r++],this.pixels[s++]=n[r++],r++};le.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var t,e;this.transparent===null?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=this.dispose&7),e<<=2,this.out.writeByte(0|e|0|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};le.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)};le.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};le.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};le.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=3*256-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)};le.prototype.writeShort=function(t){this.out.writeByte(t&255),this.out.writeByte(t>>8&255)};le.prototype.writePixels=function(){var t=new mA(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)};le.prototype.stream=function(){return this.out};var yA=le,ni=Oe&&Oe.__assign||function(){return ni=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},ni.apply(this,arguments)},vA=Oe&&Oe.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(f){o(f)}}function l(u){try{c(r.throw(u))}catch(f){o(f)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})},bA=Oe&&Oe.__generator||function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,s=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],s=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},wA=Oe&&Oe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ui,"__esModule",{value:!0});Ui.AwesomeQR=void 0;var gt=ss,Ju=Hp,Cs=Dl,_A=wA(yA),Is=.4,EA=function(){function t(e){var n=Object.assign({},e);if(Object.keys(t.defaultOptions).forEach(function(r){r in n||Object.defineProperty(n,r,{value:t.defaultOptions[r],enumerable:!0,writable:!0})}),n.components?typeof n.components=="object"&&Object.keys(t.defaultComponentOptions).forEach(function(r){r in n.components?Object.defineProperty(n.components,r,{value:ni(ni({},t.defaultComponentOptions[r]),n.components[r]),enumerable:!0,writable:!0}):Object.defineProperty(n.components,r,{value:t.defaultComponentOptions[r],enumerable:!0,writable:!0})}):n.components=t.defaultComponentOptions,n.dotScale!==null&&n.dotScale!==void 0){if(n.dotScale<=0||n.dotScale>1)throw new Error("dotScale should be in range (0, 1].");n.components.data.scale=n.dotScale,n.components.timing.scale=n.dotScale,n.components.alignment.scale=n.dotScale}this.options=n,this.canvas=gt.createCanvas(e.size,e.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new Cs.QRCodeModel(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}return t.prototype.draw=function(){var e=this;return new Promise(function(n){return e._draw().then(n)})},t.prototype._clear=function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},t._prepareRoundedCornerClip=function(e,n,r,s,i,o){e.beginPath(),e.moveTo(n,r),e.arcTo(n+s,r,n+s,r+i,o),e.arcTo(n+s,r+i,n,r+i,o),e.arcTo(n,r+i,n,r,o),e.arcTo(n,r,n+s,r,o),e.closePath()},t._getAverageRGB=function(e){var n=5,r={r:0,g:0,b:0},s,i,o=-4,a={r:0,g:0,b:0},l=0;i=e.naturalHeight||e.height,s=e.naturalWidth||e.width;var c=gt.createCanvas(s,i),u=c.getContext("2d");if(!u)return r;u.drawImage(e,0,0);var f;try{f=u.getImageData(0,0,s,i)}catch{return r}for(;(o+=n*4)<f.data.length;)f.data[o]>200||f.data[o+1]>200||f.data[o+2]>200||(++l,a.r+=f.data[o],a.g+=f.data[o+1],a.b+=f.data[o+2]);return a.r=~~(a.r/l),a.g=~~(a.g/l),a.b=~~(a.b/l),a},t._drawDot=function(e,n,r,s,i,o){i===void 0&&(i=0),o===void 0&&(o=1),e.fillRect((n+i)*s,(r+i)*s,o*s,o*s)},t._drawAlignProtector=function(e,n,r,s){e.clearRect((n-2)*s,(r-2)*s,5*s,5*s),e.fillRect((n-2)*s,(r-2)*s,5*s,5*s)},t._drawAlign=function(e,n,r,s,i,o,a,l){i===void 0&&(i=0),o===void 0&&(o=1);var c=e.fillStyle;e.fillStyle=a,new Array(4).fill(0).map(function(u,f){t._drawDot(e,n-2+f,r-2,s,i,o),t._drawDot(e,n+2,r-2+f,s,i,o),t._drawDot(e,n+2-f,r+2,s,i,o),t._drawDot(e,n-2,r+2-f,s,i,o)}),t._drawDot(e,n,r,s,i,o),l||(e.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map(function(u,f){t._drawDot(e,n-1+f,r-1,s,i,o),t._drawDot(e,n+1,r-1+f,s,i,o),t._drawDot(e,n+1-f,r+1,s,i,o),t._drawDot(e,n-1,r+1-f,s,i,o)})),e.fillStyle=c},t.prototype._draw=function(){var e,n,r,s,i,o,a,l,c,u,f,p,d,h,g,v,m,y,E;return vA(this,void 0,void 0,function(){var w,b,_,C,T,D,P,S,q,O,H,N,me,ne,$,oe,fe,W,de,ke,ht,ae,K,we,Nt,ve,En,zi,ze,tt,Ki,Tn,Nl,pt,ae,Qi,Wi,Ol,ot,Ll,ae,Tt,at,lt,is,Xi,ae,Yi,Ml,Ji,Pl,ae,Tt,at,lt,Fl,or,Ot,ar,Lt,lr,os,Bl,kt,kn,cr,Cn,Zi,as,jl,$l,eo,Vl;return bA(this,function(ur){switch(ur.label){case 0:if(w=(e=this.qrCode)===null||e===void 0?void 0:e.moduleCount,b=this.options.size,_=this.options.margin,(_<0||_*2>=b)&&(_=0),C=Math.ceil(_),T=b-2*_,D=this.options.whiteMargin,P=this.options.backgroundDimming,S=Math.ceil(T/w),q=S*w,O=q+2*C,H=gt.createCanvas(O,O),N=H.getContext("2d"),this._clear(),N.save(),N.translate(C,C),me=gt.createCanvas(O,O),ne=me.getContext("2d"),$=null,oe=[],!this.options.gifBackground)return[3,1];if(fe=Ju.parseGIF(this.options.gifBackground),$=fe,oe=Ju.decompressFrames(fe,!0),this.options.autoColor){for(W=0,de=0,ke=0,ht=0,ae=0;ae<oe[0].colorTable.length;ae++)K=oe[0].colorTable[ae],!(K[0]>200||K[1]>200||K[2]>200)&&(K[0]===0&&K[1]===0&&K[2]===0||(ht++,W+=K[0],de+=K[1],ke+=K[2]));W=~~(W/ht),de=~~(de/ht),ke=~~(ke/ht),this.options.colorDark="rgb("+W+","+de+","+ke+")"}return[3,4];case 1:return this.options.backgroundImage?[4,gt.loadImage(this.options.backgroundImage)]:[3,3];case 2:return we=ur.sent(),this.options.autoColor&&(Nt=t._getAverageRGB(we),this.options.colorDark="rgb("+Nt.r+","+Nt.g+","+Nt.b+")"),ne.drawImage(we,0,0,we.width,we.height,0,0,O,O),ne.rect(0,0,O,O),ne.fillStyle=P,ne.fill(),[3,4];case 3:ne.rect(0,0,O,O),ne.fillStyle=this.options.colorLight,ne.fill(),ur.label=4;case 4:for(ve=Cs.QRUtil.getPatternPosition(this.qrCode.typeNumber),En=((r=(n=this.options.components)===null||n===void 0?void 0:n.data)===null||r===void 0?void 0:r.scale)||Is,zi=(1-En)*.5,ze=0;ze<w;ze++)for(tt=0;tt<w;tt++){for(Ki=this.qrCode.isDark(ze,tt),Tn=tt<8&&(ze<8||ze>=w-8)||tt>=w-8&&ze<8,Nl=ze==6&&tt>=8&&tt<=w-8||tt==6&&ze>=8&&ze<=w-8,pt=Tn||Nl,ae=1;ae<ve.length-1;ae++)pt=pt||ze>=ve[ae]-2&&ze<=ve[ae]+2&&tt>=ve[ae]-2&&tt<=ve[ae]+2;Qi=tt*S+(pt?0:zi*S),Wi=ze*S+(pt?0:zi*S),N.strokeStyle=Ki?this.options.colorDark:this.options.colorLight,N.lineWidth=.5,N.fillStyle=Ki?this.options.colorDark:"rgba(255, 255, 255, 0.6)",ve.length===0?pt||N.fillRect(Qi,Wi,(pt?1:En)*S,(pt?1:En)*S):(Ol=tt<w-4&&tt>=w-4-5&&ze<w-4&&ze>=w-4-5,!pt&&!Ol&&N.fillRect(Qi,Wi,(pt?1:En)*S,(pt?1:En)*S))}if(ot=ve[ve.length-1],Ll="rgba(255, 255, 255, 0.6)",N.fillStyle=Ll,N.fillRect(0,0,8*S,8*S),N.fillRect(0,(w-8)*S,8*S,8*S),N.fillRect((w-8)*S,0,8*S,8*S),!((i=(s=this.options.components)===null||s===void 0?void 0:s.timing)===null||i===void 0)&&i.protectors&&(N.fillRect(8*S,6*S,(w-8-8)*S,S),N.fillRect(6*S,8*S,S,(w-8-8)*S)),!((a=(o=this.options.components)===null||o===void 0?void 0:o.cornerAlignment)===null||a===void 0)&&a.protectors&&t._drawAlignProtector(N,ot,ot,S),!((c=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||c===void 0)&&c.protectors){for(ae=0;ae<ve.length;ae++)for(Tt=0;Tt<ve.length;Tt++)if(at=ve[Tt],lt=ve[ae],!(at===6&&(lt===6||lt===ot))){if(lt===6&&(at===6||at===ot))continue;if(at===ot&&lt===ot)continue;t._drawAlignProtector(N,at,lt,S)}}for(N.fillStyle=this.options.colorDark,N.fillRect(0,0,7*S,S),N.fillRect((w-7)*S,0,7*S,S),N.fillRect(0,6*S,7*S,S),N.fillRect((w-7)*S,6*S,7*S,S),N.fillRect(0,(w-7)*S,7*S,S),N.fillRect(0,(w-7+6)*S,7*S,S),N.fillRect(0,0,S,7*S),N.fillRect(6*S,0,S,7*S),N.fillRect((w-7)*S,0,S,7*S),N.fillRect((w-7+6)*S,0,S,7*S),N.fillRect(0,(w-7)*S,S,7*S),N.fillRect(6*S,(w-7)*S,S,7*S),N.fillRect(2*S,2*S,3*S,3*S),N.fillRect((w-7+2)*S,2*S,3*S,3*S),N.fillRect(2*S,(w-7+2)*S,3*S,3*S),is=((f=(u=this.options.components)===null||u===void 0?void 0:u.timing)===null||f===void 0?void 0:f.scale)||Is,Xi=(1-is)*.5,ae=0;ae<w-8;ae+=2)t._drawDot(N,8+ae,6,S,Xi,is),t._drawDot(N,6,8+ae,S,Xi,is);for(Yi=((d=(p=this.options.components)===null||p===void 0?void 0:p.cornerAlignment)===null||d===void 0?void 0:d.scale)||Is,Ml=(1-Yi)*.5,t._drawAlign(N,ot,ot,S,Ml,Yi,this.options.colorDark,((g=(h=this.options.components)===null||h===void 0?void 0:h.cornerAlignment)===null||g===void 0?void 0:g.protectors)||!1),Ji=((m=(v=this.options.components)===null||v===void 0?void 0:v.alignment)===null||m===void 0?void 0:m.scale)||Is,Pl=(1-Ji)*.5,ae=0;ae<ve.length;ae++)for(Tt=0;Tt<ve.length;Tt++)if(at=ve[Tt],lt=ve[ae],!(at===6&&(lt===6||lt===ot))){if(lt===6&&(at===6||at===ot))continue;if(at===ot&&lt===ot)continue;t._drawAlign(N,at,lt,S,Pl,Ji,this.options.colorDark,((E=(y=this.options.components)===null||y===void 0?void 0:y.alignment)===null||E===void 0?void 0:E.protectors)||!1)}return D&&(N.fillStyle="#FFFFFF",N.fillRect(-C,-C,O,C),N.fillRect(-C,q,O,C),N.fillRect(q,-C,C,O),N.fillRect(-C,-C,C,O)),this.options.logoImage?[4,gt.loadImage(this.options.logoImage)]:[3,6];case 5:Fl=ur.sent(),or=this.options.logoScale,Ot=this.options.logoMargin,ar=this.options.logoCornerRadius,(or<=0||or>=1)&&(or=.2),Ot<0&&(Ot=0),ar<0&&(ar=0),Lt=q*or,lr=.5*(O-Lt),os=lr,N.restore(),N.fillStyle="#FFFFFF",N.save(),t._prepareRoundedCornerClip(N,lr-Ot,os-Ot,Lt+2*Ot,Lt+2*Ot,ar+Ot),N.clip(),Bl=N.globalCompositeOperation,N.globalCompositeOperation="destination-out",N.fill(),N.globalCompositeOperation=Bl,N.restore(),N.save(),t._prepareRoundedCornerClip(N,lr,os,Lt,Lt,ar),N.clip(),N.drawImage(Fl,lr,os,Lt,Lt),N.restore(),N.save(),N.translate(C,C),ur.label=6;case 6:if($){if(oe.forEach(function(Yt){kt||(kt=new _A.default(b,b),kt.setDelay(Yt.delay),kt.setRepeat(0));var ls=Yt.dims,cs=ls.width,us=ls.height;kn||(kn=gt.createCanvas(cs,us),cr=kn.getContext("2d"),cr.rect(0,0,kn.width,kn.height),cr.fillStyle="#ffffff",cr.fill()),(!Cn||!as||cs!==Cn.width||us!==Cn.height)&&(Cn=gt.createCanvas(cs,us),Zi=Cn.getContext("2d"),as=Zi.createImageData(cs,us)),as.data.set(Yt.patch),Zi.putImageData(as,0,0),cr.drawImage(Cn,Yt.dims.left,Yt.dims.top);var Ul=gt.createCanvas(O,O),hr=Ul.getContext("2d");hr.drawImage(kn,0,0,O,O),hr.rect(0,0,O,O),hr.fillStyle=P,hr.fill(),hr.drawImage(H,0,0,O,O);var to=gt.createCanvas(b,b),ql=to.getContext("2d");ql.drawImage(Ul,0,0,b,b),kt.addFrame(ql.getImageData(0,0,to.width,to.height).data)}),!kt)throw new Error("No frames.");return kt.finish(),Zu(this.canvas)?(jl=kt.stream().toFlattenUint8Array(),$l=jl.reduce(function(Yt,ls){return Yt+String.fromCharCode(ls)},""),[2,Promise.resolve("data:image/gif;base64,"+window.btoa($l))]):[2,Promise.resolve(Buffer.from(kt.stream().toFlattenUint8Array()))]}else return ne.drawImage(H,0,0,O,O),N.drawImage(me,-C,-C,O,O),eo=gt.createCanvas(b,b),Vl=eo.getContext("2d"),Vl.drawImage(H,0,0,b,b),this.canvas=eo,Zu(this.canvas)?[2,Promise.resolve(this.canvas.toDataURL())]:[2,Promise.resolve(this.canvas.toBuffer())]}})})},t.CorrectLevel=Cs.QRErrorCorrectLevel,t.defaultComponentOptions={data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}},t.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"#ffffff",correctLevel:Cs.QRErrorCorrectLevel.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:t.defaultComponentOptions,autoColor:!0},t}();Ui.AwesomeQR=EA;function Zu(t){try{return t instanceof HTMLElement}catch{return typeof t=="object"&&t.nodeType===1&&typeof t.style=="object"&&typeof t.ownerDocument=="object"}}(function(t){var e=Oe&&Oe.__createBinding||(Object.create?function(s,i,o,a){a===void 0&&(a=o),Object.defineProperty(s,a,{enumerable:!0,get:function(){return i[o]}})}:function(s,i,o,a){a===void 0&&(a=o),s[a]=i[o]}),n=Oe&&Oe.__exportStar||function(s,i){for(var o in s)o!=="default"&&!i.hasOwnProperty(o)&&e(i,s,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(Dl,t);var r=Ui;Object.defineProperty(t,"AwesomeQR",{enumerable:!0,get:function(){return r.AwesomeQR}})})(Gp);const eh=async(t,e=300)=>await new Gp.AwesomeQR({text:t,size:e}).draw();function th(t){let e,n,r;return{c(){e=A("button"),e.textContent="Leader Link",I(e,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7")},m(s,i){B(s,e,i),n||(r=Y(e,"click",t[25]),n=!0)},p:J,d(s){s&&F(e),n=!1,r()}}}function nh(t){let e;function n(i,o){if(i[8]=="pass")return kA;if(i[8]=="link")return TA}let r=n(t),s=r&&r(t);return{c(){e=A("div"),s&&s.c(),I(e,"class","block border-b border-black bg-yellow-200 relative")},m(i,o){B(i,e,o),s&&s.m(e,null)},p(i,o){r===(r=n(i))&&s?s.p(i,o):(s&&s.d(1),s=r&&r(i),s&&(s.c(),s.m(e,null)))},d(i){i&&F(e),s&&s.d()}}}function TA(t){let e,n,r,s,i,o,a,l,c,u,f,p,d,h,g,v,m,y;return{c(){e=A("div"),n=A("img"),s=L(),i=A("div"),o=A("div"),a=A("span"),l=ce(t[10]),c=L(),u=A("button"),u.textContent="X",f=L(),p=A("div"),d=A("div"),h=A("input"),g=L(),v=A("button"),v.textContent="Copy",I(n,"alt","qrcode"),Hl(n.src,r=t[11])||I(n,"src",r),I(a,"class","inline-block px-2 leading-7"),I(u,"class","px-2 h-7 float-right border-l border-black hover:bg-red-500 hover:text-white"),I(o,"class","bg-gray-100 border-b border-black w-full"),I(h,"class","bg-white w-full h-7 text-ellipsis inline-block flex-1 px-2"),I(h,"type","text"),h.readOnly=!0,I(h,"alt",t[9]),h.value=t[9],I(v,"class","float-right border-l border-black bg-gray-100 hover:text-white hover:bg-nl px-2 h-7"),I(d,"class","flex-1 border-black border-t border-b flex"),I(p,"class","flex items-center flex-1"),I(i,"class","flex flex-1 border-l border-black flex-col"),I(e,"class","flex flex-row flex-wrap")},m(E,w){B(E,e,w),k(e,n),k(e,s),k(e,i),k(i,o),k(o,a),k(a,l),k(o,c),k(o,u),k(i,f),k(i,p),k(p,d),k(d,h),k(d,g),k(d,v),m||(y=[Y(u,"click",t[14]),Y(v,"click",t[26])],m=!0)},p(E,w){w&2048&&!Hl(n.src,r=E[11])&&I(n,"src",r),w&1024&&ye(l,E[10]),w&512&&I(h,"alt",E[9]),w&512&&h.value!==E[9]&&(h.value=E[9])},d(E){E&&F(e),m=!1,Ge(y)}}}function kA(t){let e,n,r,s,i,o,a,l,c,u,f,p;return{c(){e=A("button"),e.textContent="X",n=L(),r=A("form"),s=A("label"),s.innerHTML=`<span class="text-sm font-bold block mb-2">Passcode for leader</span> 
            <input type="text" name="passCode" autocomplete="off" placeholder="Password to join room" class="mb-4 form-input"/>`,i=L(),o=A("div"),a=A("button"),a.textContent="Try Switch Leader",l=L(),c=A("span"),u=ce(t[10]),I(e,"class","px-2 h-7 bg-gray-100 border-b border-l border-black hover:bg-red-500 hover:text-white absolute top-0 right-0"),I(a,"type","submit"),a.value="create",I(a,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-2"),I(c,"class","flex-1 bg-red-500 text-white block px-2 leading-loose"),I(o,"class","flex gap-2 justify-between"),I(r,"class","p-2")},m(d,h){B(d,e,h),B(d,n,h),B(d,r,h),k(r,s),k(r,i),k(r,o),k(o,a),k(o,l),k(o,c),k(c,u),f||(p=[Y(e,"click",t[14]),Y(r,"submit",Ht(vn(t[16])))],f=!0)},p(d,h){h&1024&&ye(u,d[10])},d(d){d&&F(e),d&&F(n),d&&F(r),f=!1,Ge(p)}}}function CA(t){var a;let e,n=((a=t[2])==null?void 0:a.name)+"",r,s,i,o;return{c(){e=A("h2"),r=ce(n),s=L(),i=A("span"),o=ce(t[1]),I(e,"class","font-semibold leading-tight text-3xl")},m(l,c){B(l,e,c),k(e,r),B(l,s,c),B(l,i,c),k(i,o)},p(l,c){var u;c&4&&n!==(n=((u=l[2])==null?void 0:u.name)+"")&&ye(r,n),c&2&&ye(o,l[1])},d(l){l&&F(e),l&&F(s),l&&F(i)}}}function IA(t){let e,n,r,s,i,o,a,l,c,u,f,p,d,h,g,v,m,y,E,w,b,_=t[13]&&rh(t),C=t[6]&&sh(t);return{c(){e=A("form"),n=A("label"),r=A("span"),r.textContent="Room Name",s=L(),i=A("input"),a=L(),l=A("label"),c=A("span"),c.textContent="Nick",u=L(),f=A("input"),d=L(),h=A("button"),h.textContent="Generate",g=L(),_&&_.c(),v=L(),m=A("div"),y=A("button"),y.textContent="Save",E=L(),C&&C.c(),I(r,"class","text-sm font-bold mb-2"),I(i,"type","text"),I(i,"name","roomName"),I(i,"placeholder","Enter a room name"),I(i,"autocomplete","off"),i.value=o=t[12].roomName,i.required=!0,I(i,"class","mb-4 form-input"),I(n,"class","inline-block w-full"),I(c,"class","text-sm font-bold mb-2"),I(f,"type","text"),I(f,"name","nick"),I(f,"placeholder","Marcus Antonius"),I(f,"autocomplete","off"),f.value=p=t[12].nick,f.required=!0,I(f,"class","mb-4 form-input float-right"),I(h,"type","button"),I(h,"class","underline hover:bg-nl hover:text-white"),I(l,"class","inline-block w-full"),I(y,"type","submit"),y.value="save",I(y,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(m,"class","flex gap-2 justify-between")},m(T,D){B(T,e,D),k(e,n),k(n,r),k(n,s),k(n,i),k(e,a),k(e,l),k(l,c),k(l,u),k(l,f),t[27](f),k(l,d),k(l,h),k(e,g),_&&_.m(e,null),k(e,v),k(e,m),k(m,y),k(m,E),C&&C.m(m,null),t[29](e),w||(b=[Y(h,"click",t[28]),Y(e,"submit",Ht(vn(t[18])))],w=!0)},p(T,D){D&4096&&o!==(o=T[12].roomName)&&i.value!==o&&(i.value=o),D&4096&&p!==(p=T[12].nick)&&f.value!==p&&(f.value=p),T[13]?_?_.p(T,D):(_=rh(T),_.c(),_.m(e,v)):_&&(_.d(1),_=null),T[6]?C?C.p(T,D):(C=sh(T),C.c(),C.m(m,null)):C&&(C.d(1),C=null)},d(T){T&&F(e),t[27](null),_&&_.d(),C&&C.d(),t[29](null),w=!1,Ge(b)}}}function rh(t){let e,n,r,s,i,o,a,l,c,u,f,p,d;return{c(){e=A("hr"),n=L(),r=A("label"),s=A("span"),s.textContent="Passcode",i=L(),o=A("input"),l=L(),c=A("label"),u=A("span"),u.textContent="Leader Passcode",f=L(),p=A("input"),I(e,"class","block py-2 px-2"),I(s,"class","text-sm font-bold mb-2"),I(o,"type","text"),I(o,"name","passCode"),I(o,"autocomplete","off"),o.value=a=t[12].passCode,I(o,"placeholder","Optional passcode to join room"),I(o,"class","mb-4 form-input"),I(r,"class","inline-block w-full"),I(u,"class","text-sm font-bold mb-2"),I(p,"type","text"),I(p,"name","leaderCode"),I(p,"autocomplete","off"),p.value=d=t[12].leaderCode,I(p,"placeholder","Optional passcode to be leader"),I(p,"class","mb-4 form-input"),I(c,"class","inline-block w-full")},m(h,g){B(h,e,g),B(h,n,g),B(h,r,g),k(r,s),k(r,i),k(r,o),B(h,l,g),B(h,c,g),k(c,u),k(c,f),k(c,p)},p(h,g){g&4096&&a!==(a=h[12].passCode)&&o.value!==a&&(o.value=a),g&4096&&d!==(d=h[12].leaderCode)&&p.value!==d&&(p.value=d)},d(h){h&&F(e),h&&F(n),h&&F(r),h&&F(l),h&&F(c)}}}function sh(t){let e,n;return{c(){e=A("span"),n=ce(t[6]),I(e,"class","flex-1 bg-red-500 text-white block px-2 leading-loose")},m(r,s){B(r,e,s),k(e,n)},p(r,s){s&64&&ye(n,r[6])},d(r){r&&F(e)}}}function AA(t){let e,n,r,s=t[13]?"Leader - switch":"User - switch",i,o,a,l,c=t[3]?"Cancel":"Edit",u,f,p,d,h,g,v,m,y,E,w=t[13]&&th(t),b=t[7]&&nh(t);function _(D,P){return D[3]?IA:CA}let C=_(t),T=C(t);return{c(){e=A("div"),n=A("div"),r=A("button"),i=ce(s),o=L(),a=A("div"),l=A("button"),u=ce(c),f=L(),p=A("button"),p.textContent="Invite Link",d=L(),w&&w.c(),h=L(),b&&b.c(),g=L(),v=A("div"),T.c(),I(r,"class","h-7 flex-1 px-2 text-left hover:bg-nl hover:text-white"),I(l,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7"),I(p,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7"),I(n,"class","flex justify-between w-full border-b border-black"),I(v,"class","p-2"),I(e,"class",m=`${t[0]}`)},m(D,P){B(D,e,P),k(e,n),k(n,r),k(r,i),k(n,o),k(n,a),k(a,l),k(l,u),k(a,f),k(a,p),k(a,d),w&&w.m(a,null),k(e,h),b&&b.m(e,null),k(e,g),k(e,v),T.m(v,null),y||(E=[Y(r,"click",t[15]),Y(l,"click",t[23]),Y(p,"click",t[24])],y=!0)},p(D,[P]){P&8192&&s!==(s=D[13]?"Leader - switch":"User - switch")&&ye(i,s),P&8&&c!==(c=D[3]?"Cancel":"Edit")&&ye(u,c),D[13]?w?w.p(D,P):(w=th(D),w.c(),w.m(a,null)):w&&(w.d(1),w=null),D[7]?b?b.p(D,P):(b=nh(D),b.c(),b.m(e,g)):b&&(b.d(1),b=null),C===(C=_(D))&&T?T.p(D,P):(T.d(1),T=C(D),T&&(T.c(),T.m(v,null))),P&1&&m!==(m=`${D[0]}`)&&I(e,"class",m)},i:J,o:J,d(D){D&&F(e),w&&w.d(),b&&b.d(),T.d(),y=!1,Ge(E)}}}function SA(t,e,n){let r;jt(t,vt,$=>n(13,r=$));let{class:s=""}=e,{id:i=""}=e,{nick:o=""}=e,{nickID:a=""}=e,{info:l=null}=e,c=!1,u,f,p="",d=!1,h="",g="",v="",m="";const y=()=>{n(7,d=!1),n(8,h=""),n(9,g=""),n(10,v=""),n(11,m="")},E=async()=>{const $=Cp(i),oe=Xe(Ye,"room",i),[fe]=await Ar(oe,$);if(r){if(fe){vt.set(!1);const de=await du(oe);ia(i,{password:de.passCode,id:i});return}vt.set(!1)}else{if(!fe){n(8,h="pass"),n(10,v="Password is incorrect"),n(7,d=!0);return}vt.set(!0)}},w=async $=>{const oe=Xe(Ye,"room",i),[fe]=await Ar(oe,$);if(!fe){n(10,v="Password is incorrect");return}vt.set(!0),ia(i,{password:$,id:i}),y()},b=$=>{n(10,v="");const W=$.currentTarget.elements.namedItem("passCode").value;w(W)},_={roomName:"",nick:"",passCode:"",leaderCode:""},C=()=>{n(12,_.roomName=l.name,_),n(12,_.nick=o,_),n(12,_.passCode="",_),n(12,_.leaderCode="",_)},T=async()=>{n(6,p="");const $=new FormData(u),oe={},fe=["roomName","nick"];vt&&fe.push("passCode","leaderCode");for(const de of fe)oe[de]=$.get(de);const W={};for(const[de,ke]of Object.entries(oe))_[de]!==ke&&(W[de]=ke);if(!vt&&("passCode"in W||"leaderCode"in W)){n(6,p="leader can change passwords");return}if(Object.keys(W).length>0){const de={};for(const[ht,K]of Object.entries(W))switch(ht){case"roomName":de.info={name:K};break;case"nick":de.people={[a]:{nick:K}};break;case"passCode":de.password={...de.password,passCode:K};break;case"leaderCode":de.password={...de.password,leaderCode:K};break}const ke=Xe(Ye,"room",i);try{await on(ke,de,{merge:!0}),n(3,c=!1)}catch(ht){n(6,p=ht)}}},D=async($=!1)=>{const oe=await du(Xe(Ye,"room",i));let fe=oe==null?void 0:oe.passCode;$&&(fe=oe==null?void 0:oe.leaderCode);let W=`${window.location.origin}/#/room/${i}`;return fe&&(W+=`?password=${fe}`),W},P=$=>{navigator.clipboard.writeText($)},S=()=>{n(3,c=!c),c&&C()},q=async()=>{n(9,g=await D(!0)),n(10,v="Selected Invite link"),n(8,h="link"),n(11,m=await eh(g)),n(7,d=!0)},O=async()=>{n(9,g=await D(!0)),n(10,v="Selected Leader link"),n(8,h="link"),n(11,m=await eh(g)),n(7,d=!0)},H=()=>{P(g)};function N($){Ln[$?"unshift":"push"](()=>{f=$,n(5,f)})}const me=()=>n(5,f.value=Zs(),f);function ne($){Ln[$?"unshift":"push"](()=>{u=$,n(4,u)})}return t.$$set=$=>{"class"in $&&n(0,s=$.class),"id"in $&&n(21,i=$.id),"nick"in $&&n(1,o=$.nick),"nickID"in $&&n(22,a=$.nickID),"info"in $&&n(2,l=$.info)},[s,o,l,c,u,f,p,d,h,g,v,m,_,r,y,E,b,C,T,D,P,i,a,S,q,O,H,N,me,ne]}class DA extends et{constructor(e){super(),Ze(this,e,SA,AA,He,{class:0,id:21,nick:1,nickID:22,info:2})}}function ih(t,e,n){const r=t.slice();return r[18]=e[n],r}function oh(t){let e,n,r;return{c(){e=A("input"),I(e,"class","bg-gray-200 flex-1 px-2"),I(e,"type","text")},m(s,i){B(s,e,i),On(e,t[1]),n||(r=Y(e,"input",t[14]),n=!0)},p(s,i){i&2&&e.value!==s[1]&&On(e,s[1])},d(s){s&&F(e),n=!1,r()}}}function ah(t){let e,n,r;return{c(){e=A("button"),e.textContent="Save",I(e,"class","px-2 h-7 border-l border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){B(s,e,i),n||(r=Y(e,"click",t[8]),n=!0)},p:J,d(s){s&&F(e),n=!1,r()}}}function lh(t){let e,n,r,s,i,o,a,l,c,u,f,p=Object.keys(t[0]).length+"",d,h,g,v=[],m=new Map,y,E,w=Object.keys(t[0]).sort(t[16]);const b=_=>_[18];for(let _=0;_<w.length;_+=1){let C=ih(t,w,_),T=b(C);m.set(T,v[_]=uh(T,C))}return{c(){e=A("div"),n=A("div"),r=A("button"),r.textContent="Clear Votes",s=L(),i=A("button"),i.textContent="Show Results",o=L(),a=A("span"),l=A("span"),c=ce(t[5]),f=ce("/"),d=ce(p),h=L(),g=A("table");for(let _=0;_<v.length;_+=1)v[_].c();I(r,"class","px-2 h-7 border border-black hover:bg-nl hover:text-white"),I(i,"class","px-2 h-7 border border-black hover:bg-nl hover:text-white"),_t(i,"invisible",!t[6]),I(l,"class",u=`${t[5]!=Object.keys(t[0]).length?"text-red-500":""}`),I(a,"class","text-xl font-bold"),I(e,"class","flex items-center justify-between mb-4"),I(g,"class","w-full")},m(_,C){B(_,e,C),k(e,n),k(n,r),k(n,s),k(n,i),k(e,o),k(e,a),k(a,l),k(l,c),k(a,f),k(a,d),B(_,h,C),B(_,g,C);for(let T=0;T<v.length;T+=1)v[T].m(g,null);y||(E=[Y(r,"click",t[11]),Y(i,"click",t[12])],y=!0)},p(_,C){C&64&&_t(i,"invisible",!_[6]),C&32&&ye(c,_[5]),C&33&&u!==(u=`${_[5]!=Object.keys(_[0]).length?"text-red-500":""}`)&&I(l,"class",u),C&1&&p!==(p=Object.keys(_[0]).length+"")&&ye(d,p),C&1753&&(w=Object.keys(_[0]).sort(_[16]),v=ma(v,C,b,1,_,w,m,g,Eh,uh,null,ih))},d(_){_&&F(e),_&&F(h),_&&F(g);for(let C=0;C<v.length;C+=1)v[C].d();y=!1,Ge(E)}}}function ch(t){let e,n,r;function s(){return t[17](t[18])}return{c(){e=A("button"),e.textContent="X",I(e,"class","bg-white border-l border-r border-black hover:bg-red-500 absolute top-0 right-0 h-full text-2xl px-2")},m(i,o){B(i,e,o),n||(r=Y(e,"click",s),n=!0)},p(i,o){t=i},d(i){i&&F(e),n=!1,r()}}}function uh(t,e){var v,m,y,E;let n,r,s=((v=e[0][e[18]])==null?void 0:v.nick)+"",i,o,a,l,c=(e[7]?(E=(y=(m=e[0][e[18]])==null?void 0:m.card)==null?void 0:y.text)!=null?E:"-":"\u{1F7E7}")+"",u,f,p,d,h,g=e[6]&&e[3]&&ch(e);return{key:t,first:null,c(){var w,b,_,C,T;n=A("tr"),r=A("td"),i=ce(s),o=A("span"),o.textContent="$",a=L(),l=A("td"),u=ce(c),f=L(),g&&g.c(),d=L(),I(o,"class","float-right pr-2"),_t(o,"invisible",!((w=e[0][e[18]])!=null&&w.isLeader)),I(r,"class","text-left w-1/2 text-2xl"),I(l,"class",p=`${((_=(b=e[0][e[18]])==null?void 0:b.card)==null?void 0:_.emoji)||!e[7]?"font-emoji":""} text-center text-4xl py-1 border border-r-0 border-black relative`),I(n,"class",h=`odd:bg-gray-100 border-b border-black first:border-t ${(T=(C=e[0][e[18]])==null?void 0:C.card)!=null&&T.text?"":"bg-yellow-100"} ${e[4][e[18]]?"stripe-gray":""}`),this.first=n},m(w,b){B(w,n,b),k(n,r),k(r,i),k(r,o),k(n,a),k(n,l),k(l,u),k(l,f),g&&g.m(l,null),k(n,d)},p(w,b){var _,C,T,D,P,S,q,O,H;e=w,b&1&&s!==(s=((_=e[0][e[18]])==null?void 0:_.nick)+"")&&ye(i,s),b&1&&_t(o,"invisible",!((C=e[0][e[18]])!=null&&C.isLeader)),b&129&&c!==(c=(e[7]?(P=(D=(T=e[0][e[18]])==null?void 0:T.card)==null?void 0:D.text)!=null?P:"-":"\u{1F7E7}")+"")&&ye(u,c),e[6]&&e[3]?g?g.p(e,b):(g=ch(e),g.c(),g.m(l,null)):g&&(g.d(1),g=null),b&129&&p!==(p=`${((q=(S=e[0][e[18]])==null?void 0:S.card)==null?void 0:q.emoji)||!e[7]?"font-emoji":""} text-center text-4xl py-1 border border-r-0 border-black relative`)&&I(l,"class",p),b&17&&h!==(h=`odd:bg-gray-100 border-b border-black first:border-t ${(H=(O=e[0][e[18]])==null?void 0:O.card)!=null&&H.text?"":"bg-yellow-100"} ${e[4][e[18]]?"stripe-gray":""}`)&&I(n,"class",h)},d(w){w&&F(n),g&&g.d()}}}function RA(t){let e,n,r,s,i=(t[3]?"":t[1])+"",o,a,l,c,u,f,p=t[3]?"Cancel":"Edit",d,h,g,v,m,y,E,w=t[3]&&oh(t),b=t[3]&&ah(t),_=t[0]&&lh(t);return{c(){e=A("div"),n=A("div"),r=A("span"),s=ce("Voting - "),o=ce(i),a=L(),w&&w.c(),l=L(),c=A("div"),b&&b.c(),u=L(),f=A("button"),d=ce(p),g=L(),v=A("div"),_&&_.c(),I(r,"class","px-2"),I(f,"class",h=`float-right px-2 h-7 border-l border-black self-end hover:text-white ${t[3]?"hover:bg-red-500":"hover:bg-nl"}`),I(n,"class","border-b border-black h-7 flex flex-wrap justify-between box-content"),I(v,"class","p-2"),I(e,"class",m=`${t[2]} relative`)},m(C,T){B(C,e,T),k(e,n),k(n,r),k(r,s),k(r,o),k(n,a),w&&w.m(n,null),k(n,l),k(n,c),b&&b.m(c,null),k(c,u),k(c,f),k(f,d),k(e,g),k(e,v),_&&_.m(v,null),y||(E=Y(f,"click",t[15]),y=!0)},p(C,[T]){T&10&&i!==(i=(C[3]?"":C[1])+"")&&ye(o,i),C[3]?w?w.p(C,T):(w=oh(C),w.c(),w.m(n,l)):w&&(w.d(1),w=null),C[3]?b?b.p(C,T):(b=ah(C),b.c(),b.m(c,u)):b&&(b.d(1),b=null),T&8&&p!==(p=C[3]?"Cancel":"Edit")&&ye(d,p),T&8&&h!==(h=`float-right px-2 h-7 border-l border-black self-end hover:text-white ${C[3]?"hover:bg-red-500":"hover:bg-nl"}`)&&I(f,"class",h),C[0]?_?_.p(C,T):(_=lh(C),_.c(),_.m(v,null)):_&&(_.d(1),_=null),T&4&&m!==(m=`${C[2]} relative`)&&I(e,"class",m)},i:J,o:J,d(C){C&&F(e),w&&w.d(),b&&b.d(),_&&_.d(),y=!1,E()}}}function xA(t,e,n){let r,s,i;jt(t,vt,b=>n(6,s=b)),jt(t,an,b=>n(7,i=b));let{class:o=""}=e,{id:a=""}=e,{description:l=""}=e,{people:c=null}=e,u=!1;const f=()=>{const b=Xe(Ye,"room",a);if(on(b,{info:{description:l}},{merge:!0}),s){const _={};Object.keys(c).forEach(C=>{p[C]||(_[C]=c[C])}),sa(b,{people:_})}n(3,u=!1),n(4,p={})};let p={};const d=b=>{n(4,p[b]=!0,p)},h=b=>{delete p[b],n(4,p={...p})},g=()=>{if(c){Object.keys(c).forEach(_=>{c[_].card&&(n(0,c[_].card.text=null,c),n(0,c[_].card.emoji=!1,c))});const b=Xe(Ye,"room",a);on(b,{people:c,show:!1},{merge:!0}),an.set(!1)}else{const b=Xe(Ye,"room",a);on(b,{show:!1},{merge:!0}),an.set(!1)}},v=()=>{if(!s)return;const b=Xe(Ye,"room",a);on(b,{show:!0},{merge:!0}),an.set(!0)};function m(){l=this.value,n(1,l)}const y=()=>{n(3,u=!u),n(4,p={})},E=(b,_)=>qp(c[b].nick,c[_].nick),w=b=>p[b]?h(b):d(b);return t.$$set=b=>{"class"in b&&n(2,o=b.class),"id"in b&&n(13,a=b.id),"description"in b&&n(1,l=b.description),"people"in b&&n(0,c=b.people)},t.$$.update=()=>{t.$$.dirty&1&&n(5,r=c?Object.keys(c).reduce((b,_)=>{var T;const C=(T=c[_].card)!=null&&T.text?1:0;return b+C},0):0)},[c,l,o,u,p,r,s,i,f,d,h,g,v,a,m,y,E,w]}class NA extends et{constructor(e){super(),Ze(this,e,xA,RA,He,{class:2,id:13,description:1,people:0})}}function OA(t){var c,u;let e,n,r,s,i,o,a,l;return n=new NA({props:{id:t[0],description:(u=(c=t[1])==null?void 0:c.description)!=null?u:"",people:t[3],class:"flex-1 bg-white border-black border-t border-b sm:border"}}),i=new DA({props:{id:t[0],info:t[1],nick:t[2],nickID:t[5],class:"bg-white border-black border-t border-b sm:border h-fit"}}),a=new R2({props:{id:t[0],nickID:t[5],cardDeck:t[4],class:"flex-1 bg-white border-black border-t border-b sm:border h-fit"}}),{c(){e=A("div"),Ne(n.$$.fragment),r=L(),s=A("div"),Ne(i.$$.fragment),o=L(),Ne(a.$$.fragment),I(s,"class","flex flex-1 flex-col gap-2"),I(e,"class","flex flex-col xl:flex-row gap-2")},m(f,p){B(f,e,p),Ce(n,e,null),k(e,r),k(e,s),Ce(i,s,null),k(s,o),Ce(a,s,null),l=!0},p(f,[p]){var v,m;const d={};p&1&&(d.id=f[0]),p&2&&(d.description=(m=(v=f[1])==null?void 0:v.description)!=null?m:""),p&8&&(d.people=f[3]),n.$set(d);const h={};p&1&&(h.id=f[0]),p&2&&(h.info=f[1]),p&4&&(h.nick=f[2]),i.$set(h);const g={};p&1&&(g.id=f[0]),p&16&&(g.cardDeck=f[4]),a.$set(g)},i(f){l||(te(n.$$.fragment,f),te(i.$$.fragment,f),te(a.$$.fragment,f),l=!0)},o(f){ie(n.$$.fragment,f),ie(i.$$.fragment,f),ie(a.$$.fragment,f),l=!1},d(f){f&&F(e),Ie(n),Ie(i),Ie(a)}}}function LA(t,e,n){var d;let r;jt(t,vt,h=>n(9,r=h));let{id:s=""}=e,{password:i=""}=e,{checkLeader:o=!1}=e,a=null,{id:l,nick:c}=(d=Ap())!=null?d:Sp(Zs()),u=null,f=[],p=null;return pa(async()=>{const h=Xe(Ye,"room",s);vt.set(o);let g=Rw(s);await on(h,{people:{[l]:{nick:c,points:"",isLeader:o}}},{merge:!0}),p=gw(Ye,s,v=>{var w,b,_;n(1,a=v.get("info")),n(3,u=v.get("people"));const m=v.get("password"),y=v.get("cards");if(n(4,f=(w=y==null?void 0:y.sort((C,T)=>C.text.localeCompare(T.text)))!=null?w:[]),an.set(v.get("show")),!u[l]){va("/?msg=You%20have%20been%20kicked!!&kickRoom=");return}((b=u[l])==null?void 0:b.nick)!=c&&(n(2,c=(_=u[l])==null?void 0:_.nick),c&&Dp(l,c));const E={};(a==null?void 0:a.name)!=g&&(g=a==null?void 0:a.name,E.name=g),r&&m.leaderCode!=i&&(n(6,i=m.leaderCode),E.password=i),!r&&m.passCode!=i&&(n(6,i=m.passCode),E.password=i),Object.keys(E).length&&ia(s,{...E,id:s}),Object.keys(u).every(C=>{var T;return(T=u[C].card)==null?void 0:T.text})&&an.set(!0)})}),ga(()=>{p!=null&&p()}),t.$$set=h=>{"id"in h&&n(0,s=h.id),"password"in h&&n(6,i=h.password),"checkLeader"in h&&n(7,o=h.checkLeader)},[s,a,c,u,f,l,i,o]}class MA extends et{constructor(e){super(),Ze(this,e,LA,OA,He,{id:0,password:6,checkLeader:7})}}function hh(t){let e,n,r,s;const i=[FA,PA],o=[];function a(l,c){return l[3]?1:0}return e=a(t),n=o[e]=i[e](t),{c(){n.c(),r=Hn()},m(l,c){o[e].m(l,c),B(l,r,c),s=!0},p(l,c){let u=e;e=a(l),e===u?o[e].p(l,c):(zt(),ie(o[u],1,1,()=>{o[u]=null}),Kt(),n=o[e],n?n.p(l,c):(n=o[e]=i[e](l),n.c()),te(n,1),n.m(r.parentNode,r))},i(l){s||(te(n),s=!0)},o(l){ie(n),s=!1},d(l){o[e].d(l),l&&F(r)}}}function PA(t){let e,n;return e=new MA({props:{id:t[0].id,checkLeader:t[5],password:t[1]}}),{c(){Ne(e.$$.fragment)},m(r,s){Ce(e,r,s),n=!0},p(r,s){const i={};s&1&&(i.id=r[0].id),s&32&&(i.checkLeader=r[5]),s&2&&(i.password=r[1]),e.$set(i)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ie(e.$$.fragment,r),n=!1},d(r){Ie(e,r)}}}function FA(t){let e,n,r,s,i,o,a,l,c,u,f,p,d=t[2]&&fh();return{c(){e=A("div"),n=A("div"),r=A("span"),r.textContent="password not correct!",s=L(),i=A("form"),o=A("label"),o.innerHTML=`<span class="text-sm font-bold block mb-2">Passcode</span> 
            <input type="text" name="passCode" autocomplete="off" placeholder="Password to join room" class="mb-4 form-input"/>`,a=L(),l=A("div"),c=A("button"),c.textContent="Login",u=L(),d&&d.c(),I(r,"class","block mb-4 text-xl font-bold bg-black text-white px-2 py-1"),I(c,"type","submit"),c.value="create",I(c,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(l,"class","flex gap-2 justify-between"),I(n,"class","p-6 bg-white border border-black"),I(e,"class","flex items-center justify-center")},m(h,g){B(h,e,g),k(e,n),k(n,r),k(n,s),k(n,i),k(i,o),k(i,a),k(i,l),k(l,c),k(l,u),d&&d.m(l,null),f||(p=Y(i,"submit",Ht(vn(t[6]))),f=!0)},p(h,g){h[2]?d||(d=fh(),d.c(),d.m(l,null)):d&&(d.d(1),d=null)},i:J,o:J,d(h){h&&F(e),d&&d.d(),f=!1,p()}}}function fh(t){let e;return{c(){e=A("span"),e.textContent="Wrong!",I(e,"class","flex-1 bg-red-500 text-white block px-2 leading-loose")},m(n,r){B(n,e,r)},d(n){n&&F(e)}}}function BA(t){let e,n,r=t[4]&&hh(t);return{c(){r&&r.c(),e=Hn()},m(s,i){r&&r.m(s,i),B(s,e,i),n=!0},p(s,[i]){s[4]?r?(r.p(s,i),i&16&&te(r,1)):(r=hh(s),r.c(),te(r,1),r.m(e.parentNode,e)):r&&(zt(),ie(r,1,1,()=>{r=null}),Kt())},i(s){n||(te(r),n=!0)},o(s){ie(r),n=!1},d(s){r&&r.d(s),s&&F(e)}}}function jA(t,e,n){let r;jt(t,Ah,d=>n(7,r=d));let{params:s={}}=e,i="",o=!1,a=!1,l=!1,c=!1;const u=(d,h=!1)=>{var v;if(!h&&!l||(d=d.replace(" ",""),d==""))return;console.log("called",d);const g=new URLSearchParams(d);return n(1,i=(v=g.get("password"))!=null?v:""),window.history.replaceState({},"",window.location.pathname+window.location.hash.replace("?"+d,"")),i},f=async(d,h,g=!1)=>{if(!g&&!l)return;n(2,o=!1);const v=Xe(Ye,"room",d),m=Cp(d);let[y,E]=await Ar(v,m),w=m;if(!E)[y,E]=await Ar(v,h),w=h;else if(!y){const b=E;[y,E]=await Ar(v,h),E?w=h:E=b}if(!E){n(2,o=!0);return}return n(5,c=y),n(1,i=w),n(3,a=!0),a},p=d=>{const v=d.currentTarget.elements.namedItem("passCode").value;f(s.id,v)};return pa(async()=>{const d=u(r,!0);n(3,a=await f(s.id,d,!0)),n(4,l=!0)}),t.$$set=d=>{"params"in d&&n(0,s=d.params)},t.$$.update=()=>{t.$$.dirty&128&&u(r),t.$$.dirty&3&&f(s.id,i)},[s,i,o,a,l,c,p,r]}class $A extends et{constructor(e){super(),Ze(this,e,jA,BA,He,{params:0})}}function VA(t){let e,n,r,s,i,o;return r=new yg({props:{class:"px-2 border-nl border-b-2 mb-3"}}),i=new pg({props:{routes:t[0]}}),{c(){e=A("div"),n=A("div"),Ne(r.$$.fragment),s=L(),Ne(i.$$.fragment),I(n,"class","container mx-auto border-black"),I(e,"class","bg-gray-100 h-full")},m(a,l){B(a,e,l),k(e,n),Ce(r,n,null),k(n,s),Ce(i,n,null),o=!0},p:J,i(a){o||(te(r.$$.fragment,a),te(i.$$.fragment,a),o=!0)},o(a){ie(r.$$.fragment,a),ie(i.$$.fragment,a),o=!1},d(a){a&&F(e),Ie(r),Ie(i)}}}function UA(t){return[{"/":Ww,"/room/:id":$A,"*":Yw}]}class qA extends et{constructor(e){super(),Ze(this,e,UA,VA,He,{})}}new qA({target:document.body});

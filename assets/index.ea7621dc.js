const hp=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};hp();function Y(){}function Ru(t,e){for(const n in e)t[n]=e[n];return t}function Nu(t){return t()}function yl(){return Object.create(null)}function rt(t){t.forEach(Nu)}function zo(t){return typeof t=="function"}function Ve(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ls;function vl(t,e){return ls||(ls=document.createElement("a")),ls.href=e,t===ls.href}function fp(t){return Object.keys(t).length===0}function xu(t,...e){if(t==null)return Y;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Qn(t,e,n){t.$$.on_destroy.push(xu(e,n))}function Yt(t){return t==null?"":t}function Mu(t){return t&&zo(t.destroy)?t.destroy:Y}function T(t,e){t.appendChild(e)}function H(t,e,n){t.insertBefore(e,n||null)}function q(t){t.parentNode.removeChild(t)}function S(t){return document.createElement(t)}function wl(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ce(t){return document.createTextNode(t)}function P(){return ce(" ")}function yn(){return ce("")}function te(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function Wn(t){return function(e){return e.preventDefault(),t.call(this,e)}}function vn(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function I(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function dp(t){return Array.from(t.childNodes)}function ge(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Ln(t,e){t.value=e==null?"":e}let cs;function pp(){if(cs===void 0){cs=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{cs=!0}}return cs}function gp(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");const r=S("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const s=pp();let i;return s?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=te(window,"message",o=>{o.source===r.contentWindow&&e()})):(r.src="about:blank",r.onload=()=>{i=te(r.contentWindow,"resize",e)}),T(t,r),()=>{(s||i&&r.contentWindow)&&i(),q(r)}}function On(t,e,n){t.classList[n?"add":"remove"](e)}function mp(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,r,e),s}let Ir;function yr(t){Ir=t}function Js(){if(!Ir)throw new Error("Function called outside component initialization");return Ir}function wn(t){Js().$$.on_mount.push(t)}function yp(t){Js().$$.after_update.push(t)}function bn(t){Js().$$.on_destroy.push(t)}function Lu(){const t=Js();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const i=mp(e,n,{cancelable:r});return s.slice().forEach(o=>{o.call(t,i)}),!i.defaultPrevented}return!0}}function bl(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const dr=[],Pn=[],ks=[],_l=[],Ou=Promise.resolve();let fo=!1;function Pu(){fo||(fo=!0,Ou.then(Bu))}function Fu(){return Pu(),Ou}function Ds(t){ks.push(t)}const zi=new Set;let us=0;function Bu(){const t=Ir;do{for(;us<dr.length;){const e=dr[us];us++,yr(e),vp(e.$$)}for(yr(null),dr.length=0,us=0;Pn.length;)Pn.pop()();for(let e=0;e<ks.length;e+=1){const n=ks[e];zi.has(n)||(zi.add(n),n())}ks.length=0}while(dr.length);for(;_l.length;)_l.pop()();fo=!1,zi.clear(),yr(t)}function vp(t){if(t.fragment!==null){t.update(),rt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ds)}}const Ts=new Set;let Zt;function xt(){Zt={r:0,c:[],p:Zt}}function Mt(){Zt.r||rt(Zt.c),Zt=Zt.p}function ee(t,e){t&&t.i&&(Ts.delete(t),t.i(e))}function re(t,e,n,r){if(t&&t.o){if(Ts.has(t))return;Ts.add(t),Zt.c.push(()=>{Ts.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function ju(t,e){t.d(1),e.delete(t.key)}function Vu(t,e){re(t,1,1,()=>{e.delete(t.key)})}function Zs(t,e,n,r,s,i,o,a,l,c,u,d){let p=t.length,f=i.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const w=[],g=new Map,v=new Map;for(h=f;h--;){const b=d(s,i,h),C=n(b);let E=o.get(C);E?r&&E.p(b,e):(E=c(C,b),E.c()),g.set(C,w[h]=E),C in m&&v.set(C,Math.abs(h-m[C]))}const k=new Set,_=new Set;function y(b){ee(b,1),b.m(a,u),o.set(b.key,b),u=b.first,f--}for(;p&&f;){const b=w[f-1],C=t[p-1],E=b.key,D=C.key;b===C?(u=b.first,p--,f--):g.has(D)?!o.has(E)||k.has(E)?y(b):_.has(D)?p--:v.get(E)>v.get(D)?(_.add(E),y(b)):(k.add(D),p--):(l(C,o),p--)}for(;p--;){const b=t[p];g.has(b.key)||l(b,o)}for(;f;)y(w[f-1]);return w}function Uu(t,e){const n={},r={},s={$$scope:1};let i=t.length;for(;i--;){const o=t[i],a=e[i];if(a){for(const l in o)l in a||(r[l]=1);for(const l in a)s[l]||(n[l]=a[l],s[l]=1);t[i]=a}else for(const l in o)s[l]=1}for(const o in r)o in n||(n[o]=void 0);return n}function $u(t){return typeof t=="object"&&t!==null?t:{}}function Ie(t){t&&t.c()}function _e(t,e,n,r){const{fragment:s,on_mount:i,on_destroy:o,after_update:a}=t.$$;s&&s.m(e,n),r||Ds(()=>{const l=i.map(Nu).filter(zo);o?o.push(...l):rt(l),t.$$.on_mount=[]}),a.forEach(Ds)}function Ee(t,e){const n=t.$$;n.fragment!==null&&(rt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function wp(t,e){t.$$.dirty[0]===-1&&(dr.push(t),Pu(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ze(t,e,n,r,s,i,o,a=[-1]){const l=Ir;yr(t);const c=t.$$={fragment:null,ctx:null,props:i,update:Y,not_equal:s,bound:yl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:yl(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(d,p,...f)=>{const h=f.length?f[0]:p;return c.ctx&&s(c.ctx[d],c.ctx[d]=h)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](h),u&&wp(t,d)),p}):[],c.update(),u=!0,rt(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){const d=dp(e.target);c.fragment&&c.fragment.l(d),d.forEach(q)}else c.fragment&&c.fragment.c();e.intro&&ee(t.$$.fragment),_e(t,e.target,e.anchor,e.customElement),Bu()}yr(l)}class He{$destroy(){Ee(this,1),this.$destroy=Y}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!fp(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Sn=[];function qu(t,e){return{subscribe:Pr(t,e).subscribe}}function Pr(t,e=Y){let n;const r=new Set;function s(a){if(Ve(t,a)&&(t=a,n)){const l=!Sn.length;for(const c of r)c[1](),Sn.push(c,t);if(l){for(let c=0;c<Sn.length;c+=2)Sn[c][0](Sn[c+1]);Sn.length=0}}}function i(a){s(a(t))}function o(a,l=Y){const c=[a,l];return r.add(c),r.size===1&&(n=e(s)||Y),a(t),()=>{r.delete(c),r.size===0&&(n(),n=null)}}return{set:s,update:i,subscribe:o}}function zu(t,e,n){const r=!Array.isArray(t),s=r?[t]:t,i=e.length<2;return qu(n,o=>{let a=!1;const l=[];let c=0,u=Y;const d=()=>{if(c)return;u();const f=e(r?l[0]:l,o);i?o(f):u=zo(f)?f:Y},p=s.map((f,h)=>xu(f,m=>{l[h]=m,c&=~(1<<h),a&&d()},()=>{c|=1<<h}));return a=!0,d(),function(){rt(p),u()}})}function bp(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,r,s,i,o=[],a="",l=t.split("/");for(l[0]||l.shift();s=l.shift();)n=s[0],n==="*"?(o.push("wild"),a+="/(.*)"):n===":"?(r=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~r?r:~i?i:s.length)),a+=!!~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~r?"?":"")+"\\"+s.substring(i))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+(e?"(?=$|/)":"/?$"),"i")}}function _p(t){let e,n,r;const s=[t[2]];var i=t[0];function o(a){let l={};for(let c=0;c<s.length;c+=1)l=Ru(l,s[c]);return{props:l}}return i&&(e=new i(o()),e.$on("routeEvent",t[7])),{c(){e&&Ie(e.$$.fragment),n=yn()},m(a,l){e&&_e(e,a,l),H(a,n,l),r=!0},p(a,l){const c=l&4?Uu(s,[$u(a[2])]):{};if(i!==(i=a[0])){if(e){xt();const u=e;re(u.$$.fragment,1,0,()=>{Ee(u,1)}),Mt()}i?(e=new i(o()),e.$on("routeEvent",a[7]),Ie(e.$$.fragment),ee(e.$$.fragment,1),_e(e,n.parentNode,n)):e=null}else i&&e.$set(c)},i(a){r||(e&&ee(e.$$.fragment,a),r=!0)},o(a){e&&re(e.$$.fragment,a),r=!1},d(a){a&&q(n),e&&Ee(e,a)}}}function Ep(t){let e,n,r;const s=[{params:t[1]},t[2]];var i=t[0];function o(a){let l={};for(let c=0;c<s.length;c+=1)l=Ru(l,s[c]);return{props:l}}return i&&(e=new i(o()),e.$on("routeEvent",t[6])),{c(){e&&Ie(e.$$.fragment),n=yn()},m(a,l){e&&_e(e,a,l),H(a,n,l),r=!0},p(a,l){const c=l&6?Uu(s,[l&2&&{params:a[1]},l&4&&$u(a[2])]):{};if(i!==(i=a[0])){if(e){xt();const u=e;re(u.$$.fragment,1,0,()=>{Ee(u,1)}),Mt()}i?(e=new i(o()),e.$on("routeEvent",a[6]),Ie(e.$$.fragment),ee(e.$$.fragment,1),_e(e,n.parentNode,n)):e=null}else i&&e.$set(c)},i(a){r||(e&&ee(e.$$.fragment,a),r=!0)},o(a){e&&re(e.$$.fragment,a),r=!1},d(a){a&&q(n),e&&Ee(e,a)}}}function kp(t){let e,n,r,s;const i=[Ep,_p],o=[];function a(l,c){return l[1]?0:1}return e=a(t),n=o[e]=i[e](t),{c(){n.c(),r=yn()},m(l,c){o[e].m(l,c),H(l,r,c),s=!0},p(l,[c]){let u=e;e=a(l),e===u?o[e].p(l,c):(xt(),re(o[u],1,1,()=>{o[u]=null}),Mt(),n=o[e],n?n.p(l,c):(n=o[e]=i[e](l),n.c()),ee(n,1),n.m(r.parentNode,r))},i(l){s||(ee(n),s=!0)},o(l){re(n),s=!1},d(l){o[e].d(l),l&&q(r)}}}function El(){const t=window.location.href.indexOf("#/");let e=t>-1?window.location.href.substr(t+1):"/";const n=e.indexOf("?");let r="";return n>-1&&(r=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:r}}const Ho=qu(null,function(e){e(El());const n=()=>{e(El())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});zu(Ho,t=>t.location);const Hu=zu(Ho,t=>t.querystring),kl=Pr(void 0);async function Go(t){if(!t||t.length<1||t.charAt(0)!="/"&&t.indexOf("#/")!==0)throw Error("Invalid parameter location");await Fu(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0,void 0),window.location.hash=(t.charAt(0)=="#"?"":"#")+t}function Gu(t,e){if(e=Il(e),!t||!t.tagName||t.tagName.toLowerCase()!="a")throw Error('Action "link" can only be used with <a> tags');return Tl(t,e),{update(n){n=Il(n),Tl(t,n)}}}function Tl(t,e){let n=e.href||t.getAttribute("href");if(n&&n.charAt(0)=="/")n="#"+n;else if(!n||n.length<2||n.slice(0,2)!="#/")throw Error('Invalid value for "href" attribute: '+n);t.setAttribute("href",n),t.addEventListener("click",r=>{r.preventDefault(),e.disabled||Tp(r.currentTarget.getAttribute("href"))})}function Il(t){return t&&typeof t=="string"?{href:t}:t||{}}function Tp(t){history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0,void 0),window.location.hash=t}function Ip(t,e,n){let{routes:r={}}=e,{prefix:s=""}=e,{restoreScrollState:i=!1}=e;class o{constructor(y,b){if(!b||typeof b!="function"&&(typeof b!="object"||b._sveltesparouter!==!0))throw Error("Invalid component object");if(!y||typeof y=="string"&&(y.length<1||y.charAt(0)!="/"&&y.charAt(0)!="*")||typeof y=="object"&&!(y instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:C,keys:E}=bp(y);this.path=y,typeof b=="object"&&b._sveltesparouter===!0?(this.component=b.component,this.conditions=b.conditions||[],this.userData=b.userData,this.props=b.props||{}):(this.component=()=>Promise.resolve(b),this.conditions=[],this.props={}),this._pattern=C,this._keys=E}match(y){if(s){if(typeof s=="string")if(y.startsWith(s))y=y.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const D=y.match(s);if(D&&D[0])y=y.substr(D[0].length)||"/";else return null}}const b=this._pattern.exec(y);if(b===null)return null;if(this._keys===!1)return b;const C={};let E=0;for(;E<this._keys.length;){try{C[this._keys[E]]=decodeURIComponent(b[E+1]||"")||null}catch{C[this._keys[E]]=null}E++}return C}async checkConditions(y){for(let b=0;b<this.conditions.length;b++)if(!await this.conditions[b](y))return!1;return!0}}const a=[];r instanceof Map?r.forEach((_,y)=>{a.push(new o(y,_))}):Object.keys(r).forEach(_=>{a.push(new o(_,r[_]))});let l=null,c=null,u={};const d=Lu();async function p(_,y){await Fu(),d(_,y)}let f=null,h=null;i&&(h=_=>{_.state&&_.state.__svelte_spa_router_scrollY?f=_.state:f=null},window.addEventListener("popstate",h),yp(()=>{f?window.scrollTo(f.__svelte_spa_router_scrollX,f.__svelte_spa_router_scrollY):window.scrollTo(0,0)}));let m=null,w=null;const g=Ho.subscribe(async _=>{m=_;let y=0;for(;y<a.length;){const b=a[y].match(_.location);if(!b){y++;continue}const C={route:a[y].path,location:_.location,querystring:_.querystring,userData:a[y].userData,params:b&&typeof b=="object"&&Object.keys(b).length?b:null};if(!await a[y].checkConditions(C)){n(0,l=null),w=null,p("conditionsFailed",C);return}p("routeLoading",Object.assign({},C));const E=a[y].component;if(w!=E){E.loading?(n(0,l=E.loading),w=E,n(1,c=E.loadingParams),n(2,u={}),p("routeLoaded",Object.assign({},C,{component:l,name:l.name,params:c}))):(n(0,l=null),w=null);const D=await E();if(_!=m)return;n(0,l=D&&D.default||D),w=E}b&&typeof b=="object"&&Object.keys(b).length?n(1,c=b):n(1,c=null),n(2,u=a[y].props),p("routeLoaded",Object.assign({},C,{component:l,name:l.name,params:c})).then(()=>{kl.set(c)});return}n(0,l=null),w=null,kl.set(void 0)});bn(()=>{g(),h&&window.removeEventListener("popstate",h)});function v(_){bl.call(this,t,_)}function k(_){bl.call(this,t,_)}return t.$$set=_=>{"routes"in _&&n(3,r=_.routes),"prefix"in _&&n(4,s=_.prefix),"restoreScrollState"in _&&n(5,i=_.restoreScrollState)},t.$$.update=()=>{t.$$.dirty&32&&(history.scrollRestoration=i?"manual":"auto")},[l,c,u,r,s,i,v,k]}class Cp extends He{constructor(e){super(),ze(this,e,Ip,kp,Ve,{routes:3,prefix:4,restoreScrollState:5})}}function Sp(t){let e,n,r,s,i,o,a,l,c,u,d;return{c(){e=S("div"),n=S("a"),r=ce(t[0]),s=P(),i=S("span"),o=ce(t[1]),a=P(),l=S("div"),l.innerHTML='<a href="https://github.com/rytsh/scrumik" target="_blank" class="hover:text-nl border-l border-white pl-4 pr-2">github</a>',I(n,"href","/"),I(n,"class","appearance-none text-xl font-bold mr-4 hover:text-nl"),I(l,"class","flex-grow text-right"),I(e,"class",c=`${t[2]} bg-black text-white flex items-center`)},m(p,f){H(p,e,f),T(e,n),T(n,r),T(e,s),T(e,i),T(i,o),T(e,a),T(e,l),u||(d=Mu(Gu.call(null,n)),u=!0)},p(p,[f]){f&1&&ge(r,p[0]),f&2&&ge(o,p[1]),f&4&&c!==(c=`${p[2]} bg-black text-white flex items-center`)&&I(e,"class",c)},i:Y,o:Y,d(p){p&&q(e),u=!1,d()}}}function Ap(t,e,n){let{title:r="scrumik"}=e,{message:s="scrum poker tool"}=e,{class:i=""}=e;return t.$$set=o=>{"title"in o&&n(0,r=o.title),"message"in o&&n(1,s=o.message),"class"in o&&n(2,i=o.class)},[r,s,i]}class Dp extends He{constructor(e){super(),ze(this,e,Ap,Sp,Ve,{title:0,message:1,class:2})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ku=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Rp=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Np={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,d=(i&3)<<4|a>>4;let p=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(p=64)),r.push(n[u],n[d],n[p],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ku(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Rp(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const d=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||d==null)throw Error();const p=i<<2|a>>4;if(r.push(p),c!==64){const f=a<<4&240|c>>2;if(r.push(f),d!==64){const h=c<<6&192|d;r.push(h)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},xp=function(t){const e=Ku(t);return Np.encodeByteArray(e,!0)},Qu=function(t){return xp(t).replace(/\./g,"")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Lp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ei())}function Wu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Op(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Pp(){return ei().indexOf("Electron/")>=0}function Fp(){const t=ei();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Bp(){return ei().indexOf("MSAppHost/")>=0}function Xu(){return typeof indexedDB=="object"}function Yu(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function jp(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="FirebaseError";class Xn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Vp,Object.setPrototypeOf(this,Xn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ti.prototype.create)}}class ti{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Up(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Xn(s,a,r)}}function Up(t,e){return t.replace($p,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const $p=/\{\$([^}]+)}/g;function Rs(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Cl(i)&&Cl(o)){if(!Rs(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Cl(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qp=1e3,zp=2,Hp=4*60*60*1e3,Gp=.5;function Sl(t,e=qp,n=zp){const r=e*Math.pow(n,t),s=Math.round(Gp*r*(Math.random()-.5)*2);return Math.min(Hp,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t){return t&&t._delegate?t._delegate:t}class Dt{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Mp;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Wp(e))try{this.getOrInitializeService({instanceIdentifier:Jt})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Jt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jt){return this.instances.has(e)}getOptions(e=Jt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Qp(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Jt){return this.component?this.component.multipleInstances?e:Jt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Qp(t){return t===Jt?void 0:t}function Wp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Kp(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ie||(ie={}));const Yp={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},Jp=ie.INFO,Zp={[ie.DEBUG]:"log",[ie.VERBOSE]:"log",[ie.INFO]:"info",[ie.WARN]:"warn",[ie.ERROR]:"error"},eg=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Zp[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ko{constructor(e){this.name=e,this._logLevel=Jp,this._logHandler=eg,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Yp[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ie.DEBUG,...e),this._logHandler(this,ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ie.VERBOSE,...e),this._logHandler(this,ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ie.INFO,...e),this._logHandler(this,ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ie.WARN,...e),this._logHandler(this,ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ie.ERROR,...e),this._logHandler(this,ie.ERROR,...e)}}const tg=(t,e)=>e.some(n=>t instanceof n);let Al,Dl;function ng(){return Al||(Al=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function rg(){return Dl||(Dl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ju=new WeakMap,po=new WeakMap,Zu=new WeakMap,Hi=new WeakMap,Qo=new WeakMap;function sg(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Bt(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Ju.set(n,t)}).catch(()=>{}),Qo.set(e,t),e}function ig(t){if(po.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});po.set(t,e)}let go={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return po.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Zu.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Bt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function og(t){go=t(go)}function ag(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Gi(this),e,...n);return Zu.set(r,e.sort?e.sort():[e]),Bt(r)}:rg().includes(t)?function(...e){return t.apply(Gi(this),e),Bt(Ju.get(this))}:function(...e){return Bt(t.apply(Gi(this),e))}}function lg(t){return typeof t=="function"?ag(t):(t instanceof IDBTransaction&&ig(t),tg(t,ng())?new Proxy(t,go):t)}function Bt(t){if(t instanceof IDBRequest)return sg(t);if(Hi.has(t))return Hi.get(t);const e=lg(t);return e!==t&&(Hi.set(t,e),Qo.set(e,t)),e}const Gi=t=>Qo.get(t);function eh(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Bt(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Bt(o.result),l.oldVersion,l.newVersion,Bt(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const cg=["get","getKey","getAll","getAllKeys","count"],ug=["put","add","delete","clear"],Ki=new Map;function Rl(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ki.get(e))return Ki.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=ug.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||cg.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return Ki.set(e,i),i}og(t=>({...t,get:(e,n,r)=>Rl(e,n)||t.get(e,n,r),has:(e,n)=>!!Rl(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(fg(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function fg(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const mo="@firebase/app",Nl="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wo=new Ko("@firebase/app"),dg="@firebase/app-compat",pg="@firebase/analytics-compat",gg="@firebase/analytics",mg="@firebase/app-check-compat",yg="@firebase/app-check",vg="@firebase/auth",wg="@firebase/auth-compat",bg="@firebase/database",_g="@firebase/database-compat",Eg="@firebase/functions",kg="@firebase/functions-compat",Tg="@firebase/installations",Ig="@firebase/installations-compat",Cg="@firebase/messaging",Sg="@firebase/messaging-compat",Ag="@firebase/performance",Dg="@firebase/performance-compat",Rg="@firebase/remote-config",Ng="@firebase/remote-config-compat",xg="@firebase/storage",Mg="@firebase/storage-compat",Lg="@firebase/firestore",Og="@firebase/firestore-compat",Pg="firebase",Fg="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th="[DEFAULT]",Bg={[mo]:"fire-core",[dg]:"fire-core-compat",[gg]:"fire-analytics",[pg]:"fire-analytics-compat",[yg]:"fire-app-check",[mg]:"fire-app-check-compat",[vg]:"fire-auth",[wg]:"fire-auth-compat",[bg]:"fire-rtdb",[_g]:"fire-rtdb-compat",[Eg]:"fire-fn",[kg]:"fire-fn-compat",[Tg]:"fire-iid",[Ig]:"fire-iid-compat",[Cg]:"fire-fcm",[Sg]:"fire-fcm-compat",[Ag]:"fire-perf",[Dg]:"fire-perf-compat",[Rg]:"fire-rc",[Ng]:"fire-rc-compat",[xg]:"fire-gcs",[Mg]:"fire-gcs-compat",[Lg]:"fire-fst",[Og]:"fire-fst-compat","fire-js":"fire-js",[Pg]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns=new Map,yo=new Map;function jg(t,e){try{t.container.addComponent(e)}catch(n){Wo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ut(t){const e=t.name;if(yo.has(e))return Wo.debug(`There were multiple attempts to register component ${e}.`),!1;yo.set(e,t);for(const n of Ns.values())jg(n,t);return!0}function Fr(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},ln=new ti("app","Firebase",Vg);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Dt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ln.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g=Fg;function qg(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:th,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw ln.create("bad-app-name",{appName:String(r)});const s=Ns.get(r);if(s){if(Rs(t,s.options)&&Rs(n,s.config))return s;throw ln.create("duplicate-app",{appName:r})}const i=new Xp(r);for(const a of yo.values())i.addComponent(a);const o=new Ug(t,n,i);return Ns.set(r,o),o}function nh(t=th){const e=Ns.get(t);if(!e)throw ln.create("no-app",{appName:t});return e}function wt(t,e,n){var r;let s=(r=Bg[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wo.warn(a.join(" "));return}Ut(new Dt(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg="firebase-heartbeat-database",Hg=1,Cr="firebase-heartbeat-store";let Qi=null;function rh(){return Qi||(Qi=eh(zg,Hg,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Cr)}}}).catch(t=>{throw ln.create("storage-open",{originalErrorMessage:t.message})})),Qi}async function Gg(t){var e;try{return(await rh()).transaction(Cr).objectStore(Cr).get(sh(t))}catch(n){throw ln.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function xl(t,e){var n;try{const s=(await rh()).transaction(Cr,"readwrite");return await s.objectStore(Cr).put(e,sh(t)),s.done}catch(r){throw ln.create("storage-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message})}}function sh(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg=1024,Qg=30*24*60*60*1e3;class Wg{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Yg(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ml();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=Qg}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ml(),{heartbeatsToSend:n,unsentEntries:r}=Xg(this._heartbeatsCache.heartbeats),s=Qu(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Ml(){return new Date().toISOString().substring(0,10)}function Xg(t,e=Kg){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ll(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ll(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Yg{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xu()?Yu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Gg(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return xl(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return xl(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ll(t){return Qu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(t){Ut(new Dt("platform-logger",e=>new hg(e),"PRIVATE")),Ut(new Dt("heartbeat",e=>new Wg(e),"PRIVATE")),wt(mo,Nl,t),wt(mo,Nl,"esm2017"),wt("fire-js","")}Jg("");var Zg="firebase",em="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wt(Zg,em,"app");const ih="@firebase/installations",Xo="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh=1e4,ah=`w:${Xo}`,lh="FIS_v2",tm="https://firebaseinstallations.googleapis.com/v1",nm=60*60*1e3,rm="installations",sm="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},cn=new ti(rm,sm,im);function ch(t){return t instanceof Xn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uh({projectId:t}){return`${tm}/projects/${t}/installations`}function hh(t){return{token:t.token,requestStatus:2,expiresIn:am(t.expiresIn),creationTime:Date.now()}}async function fh(t,e){const r=(await e.json()).error;return cn.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function dh({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function om(t,{refreshToken:e}){const n=dh(t);return n.append("Authorization",lm(e)),n}async function ph(t){const e=await t();return e.status>=500&&e.status<600?t():e}function am(t){return Number(t.replace("s","000"))}function lm(t){return`${lh} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cm({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=uh(t),s=dh(t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:n,authVersion:lh,appId:t.appId,sdkVersion:ah},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await ph(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:hh(c.authToken)}}else throw await fh("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function um(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hm=/^[cdef][\w-]{21}$/,vo="";function fm(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=dm(t);return hm.test(n)?n:vo}catch{return vo}}function dm(t){return um(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=new Map;function yh(t,e){const n=ni(t);vh(n,e),pm(n,e)}function vh(t,e){const n=mh.get(t);if(!!n)for(const r of n)r(e)}function pm(t,e){const n=gm();n&&n.postMessage({key:t,fid:e}),mm()}let en=null;function gm(){return!en&&"BroadcastChannel"in self&&(en=new BroadcastChannel("[Firebase] FID Change"),en.onmessage=t=>{vh(t.data.key,t.data.fid)}),en}function mm(){mh.size===0&&en&&(en.close(),en=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ym="firebase-installations-database",vm=1,un="firebase-installations-store";let Wi=null;function Yo(){return Wi||(Wi=eh(ym,vm,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(un)}}})),Wi}async function xs(t,e){const n=ni(t),s=(await Yo()).transaction(un,"readwrite"),i=s.objectStore(un),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&yh(t,e.fid),e}async function wh(t){const e=ni(t),r=(await Yo()).transaction(un,"readwrite");await r.objectStore(un).delete(e),await r.done}async function ri(t,e){const n=ni(t),s=(await Yo()).transaction(un,"readwrite"),i=s.objectStore(un),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&yh(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(t){let e;const n=await ri(t.appConfig,r=>{const s=wm(r),i=bm(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===vo?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function wm(t){const e=t||{fid:fm(),registrationStatus:0};return bh(e)}function bm(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(cn.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=_m(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:Em(t)}:{installationEntry:e}}async function _m(t,e){try{const n=await cm(t,e);return xs(t.appConfig,n)}catch(n){throw ch(n)&&n.customData.serverCode===409?await wh(t.appConfig):await xs(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function Em(t){let e=await Ol(t.appConfig);for(;e.registrationStatus===1;)await gh(100),e=await Ol(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Jo(t);return r||n}return e}function Ol(t){return ri(t,e=>{if(!e)throw cn.create("installation-not-found");return bh(e)})}function bh(t){return km(t)?{fid:t.fid,registrationStatus:0}:t}function km(t){return t.registrationStatus===1&&t.registrationTime+oh<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tm({appConfig:t,heartbeatServiceProvider:e},n){const r=Im(t,n),s=om(t,n),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:ah,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await ph(()=>fetch(r,a));if(l.ok){const c=await l.json();return hh(c)}else throw await fh("Generate Auth Token",l)}function Im(t,{fid:e}){return`${uh(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zo(t,e=!1){let n;const r=await ri(t.appConfig,i=>{if(!_h(i))throw cn.create("not-registered");const o=i.authToken;if(!e&&Am(o))return i;if(o.requestStatus===1)return n=Cm(t,e),i;{if(!navigator.onLine)throw cn.create("app-offline");const a=Rm(i);return n=Sm(t,a),a}});return n?await n:r.authToken}async function Cm(t,e){let n=await Pl(t.appConfig);for(;n.authToken.requestStatus===1;)await gh(100),n=await Pl(t.appConfig);const r=n.authToken;return r.requestStatus===0?Zo(t,e):r}function Pl(t){return ri(t,e=>{if(!_h(e))throw cn.create("not-registered");const n=e.authToken;return Nm(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Sm(t,e){try{const n=await Tm(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await xs(t.appConfig,r),n}catch(n){if(ch(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await wh(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await xs(t.appConfig,r)}throw n}}function _h(t){return t!==void 0&&t.registrationStatus===2}function Am(t){return t.requestStatus===2&&!Dm(t)}function Dm(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+nm}function Rm(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function Nm(t){return t.requestStatus===1&&t.requestTime+oh<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xm(t){const e=t,{installationEntry:n,registrationPromise:r}=await Jo(e);return r?r.catch(console.error):Zo(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mm(t,e=!1){const n=t;return await Lm(n),(await Zo(n,e)).token}async function Lm(t){const{registrationPromise:e}=await Jo(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(t){if(!t||!t.options)throw Xi("App Configuration");if(!t.name)throw Xi("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Xi(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Xi(t){return cn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh="installations",Pm="installations-internal",Fm=t=>{const e=t.getProvider("app").getImmediate(),n=Om(e),r=Fr(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},Bm=t=>{const e=t.getProvider("app").getImmediate(),n=Fr(e,Eh).getImmediate();return{getId:()=>xm(n),getToken:s=>Mm(n,s)}};function jm(){Ut(new Dt(Eh,Fm,"PUBLIC")),Ut(new Dt(Pm,Bm,"PRIVATE"))}jm();wt(ih,Xo);wt(ih,Xo,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms="analytics",Vm="firebase_id",Um="origin",$m=60*1e3,qm="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",kh="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const at=new Ko("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function zm(t,e){const n=document.createElement("script");n.src=`${kh}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function Hm(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Gm(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const l=(await Th(n)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(a){at.error(a)}t("config",s,i)}async function Km(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await Th(n);for(const l of o){const c=a.find(d=>d.measurementId===l),u=c&&e[c.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){at.error(i)}}function Qm(t,e,n,r){async function s(i,o,a){try{i==="event"?await Km(t,e,n,o,a):i==="config"?await Gm(t,e,n,r,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(l){at.error(l)}}return s}function Wm(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=Qm(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function Xm(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(kh))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},ht=new ti("analytics","Analytics",Ym);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jm=30,Zm=1e3;class e0{constructor(e={},n=Zm){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Ih=new e0;function t0(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function n0(t){var e;const{appId:n,apiKey:r}=t,s={method:"GET",headers:t0(r)},i=qm.replace("{app-id}",n),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw ht.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function r0(t,e=Ih,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw ht.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw ht.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new o0;return setTimeout(async()=>{a.abort()},n!==void 0?n:$m),Ch({appId:r,apiKey:s,measurementId:i},o,a,e)}async function Ch(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=Ih){var i,o;const{appId:a,measurementId:l}=t;try{await s0(r,e)}catch(c){if(l)return at.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${(i=c)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:l};throw c}try{const c=await n0(t);return s.deleteThrottleMetadata(a),c}catch(c){const u=c;if(!i0(u)){if(s.deleteThrottleMetadata(a),l)return at.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:l};throw c}const d=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?Sl(n,s.intervalMillis,Jm):Sl(n,s.intervalMillis),p={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return s.setThrottleMetadata(a,p),at.debug(`Calling attemptFetch again in ${d} millis`),Ch(t,p,r,s)}}function s0(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(ht.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function i0(t){if(!(t instanceof Xn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class o0{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function a0(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o=Object.assign(Object.assign({},r),{send_to:i});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l0(){var t;if(Xu())try{await Yu()}catch(e){return at.warn(ht.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return at.warn(ht.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function c0(t,e,n,r,s,i,o){var a;const l=r0(t);l.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&at.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>at.error(f)),e.push(l);const c=l0().then(f=>{if(f)return r.getId()}),[u,d]=await Promise.all([l,c]);Xm()||zm(i,u.measurementId),s("js",new Date);const p=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return p[Um]="firebase",p.update=!0,d!=null&&(p[Vm]=d),s("config",u.measurementId,p),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e){this.app=e}_delete(){return delete vr[this.app.options.appId],Promise.resolve()}}let vr={},Fl=[];const Bl={};let Yi="dataLayer",h0="gtag",jl,Sh,Vl=!1;function f0(){const t=[];if(Wu()&&t.push("This is a browser extension environment."),jp()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=ht.create("invalid-analytics-context",{errorInfo:e});at.warn(n.message)}}function d0(t,e,n){f0();const r=t.options.appId;if(!r)throw ht.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)at.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ht.create("no-api-key");if(vr[r]!=null)throw ht.create("already-exists",{id:r});if(!Vl){Hm(Yi);const{wrappedGtag:i,gtagCore:o}=Wm(vr,Fl,Bl,Yi,h0);Sh=i,jl=o,Vl=!0}return vr[r]=c0(t,Fl,Bl,e,jl,Yi,n),new u0(t)}function p0(t=nh()){t=mt(t);const e=Fr(t,Ms);return e.isInitialized()?e.getImmediate():g0(t)}function g0(t,e={}){const n=Fr(t,Ms);if(n.isInitialized()){const s=n.getImmediate();if(Rs(e,n.getOptions()))return s;throw ht.create("already-initialized")}return n.initialize({options:e})}function m0(t,e,n,r){t=mt(t),a0(Sh,vr[t.app.options.appId],e,n,r).catch(s=>at.error(s))}const Ul="@firebase/analytics",$l="0.8.0";function y0(){Ut(new Dt(Ms,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return d0(r,s,n)},"PUBLIC")),Ut(new Dt("analytics-internal",t,"PRIVATE")),wt(Ul,$l),wt(Ul,$l,"esm2017");function t(e){try{const n=e.getProvider(Ms).getImmediate();return{logEvent:(r,s,i)=>m0(n,r,s,i)}}catch(n){throw ht.create("interop-component-reg-failed",{reason:n})}}}y0();var v0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},O,ea=ea||{},G=v0||self;function Ls(){}function wo(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Br(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function w0(t){return Object.prototype.hasOwnProperty.call(t,Ji)&&t[Ji]||(t[Ji]=++b0)}var Ji="closure_uid_"+(1e9*Math.random()>>>0),b0=0;function _0(t,e,n){return t.call.apply(t.bind,arguments)}function E0(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Fe(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Fe=_0:Fe=E0,Fe.apply(null,arguments)}function hs(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ue(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function Gt(){this.s=this.s,this.o=this.o}var k0=0;Gt.prototype.s=!1;Gt.prototype.na=function(){!this.s&&(this.s=!0,this.M(),k0!=0)&&w0(this)};Gt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ah=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Dh=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const r=t.length,s=typeof t=="string"?t.split(""):t;for(let i=0;i<r;i++)i in s&&e.call(n,s[i],i,t)};function T0(t){e:{var e=gy;const n=t.length,r=typeof t=="string"?t.split(""):t;for(let s=0;s<n;s++)if(s in r&&e.call(void 0,r[s],s,t)){e=s;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function ql(t){return Array.prototype.concat.apply([],arguments)}function ta(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Os(t){return/^[\s\xa0]*$/.test(t)}var zl=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ge(t,e){return t.indexOf(e)!=-1}function Zi(t,e){return t<e?-1:t>e?1:0}var Ke;e:{var Hl=G.navigator;if(Hl){var Gl=Hl.userAgent;if(Gl){Ke=Gl;break e}}Ke=""}function na(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Rh(t){const e={};for(const n in t)e[n]=t[n];return e}var Kl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Nh(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<Kl.length;i++)n=Kl[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ra(t){return ra[" "](t),t}ra[" "]=Ls;function I0(t){var e=A0;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var C0=Ge(Ke,"Opera"),Fn=Ge(Ke,"Trident")||Ge(Ke,"MSIE"),xh=Ge(Ke,"Edge"),bo=xh||Fn,Mh=Ge(Ke,"Gecko")&&!(Ge(Ke.toLowerCase(),"webkit")&&!Ge(Ke,"Edge"))&&!(Ge(Ke,"Trident")||Ge(Ke,"MSIE"))&&!Ge(Ke,"Edge"),S0=Ge(Ke.toLowerCase(),"webkit")&&!Ge(Ke,"Edge");function Lh(){var t=G.document;return t?t.documentMode:void 0}var Ps;e:{var eo="",to=function(){var t=Ke;if(Mh)return/rv:([^\);]+)(\)|;)/.exec(t);if(xh)return/Edge\/([\d\.]+)/.exec(t);if(Fn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(S0)return/WebKit\/(\S+)/.exec(t);if(C0)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(to&&(eo=to?to[1]:""),Fn){var no=Lh();if(no!=null&&no>parseFloat(eo)){Ps=String(no);break e}}Ps=eo}var A0={};function D0(){return I0(function(){let t=0;const e=zl(String(Ps)).split("."),n=zl("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var s=e[o]||"",i=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s[0].length==0&&i[0].length==0)break;t=Zi(s[1].length==0?0:parseInt(s[1],10),i[1].length==0?0:parseInt(i[1],10))||Zi(s[2].length==0,i[2].length==0)||Zi(s[2],i[2]),s=s[3],i=i[3]}while(t==0)}return 0<=t})}var _o;if(G.document&&Fn){var Ql=Lh();_o=Ql||parseInt(Ps,10)||void 0}else _o=void 0;var R0=_o,N0=function(){if(!G.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{G.addEventListener("test",Ls,e),G.removeEventListener("test",Ls,e)}catch{}return t}();function qe(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}qe.prototype.h=function(){this.defaultPrevented=!0};function Sr(t,e){if(qe.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Mh){e:{try{ra(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:x0[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Sr.Z.h.call(this)}}Ue(Sr,qe);var x0={2:"touch",3:"pen",4:"mouse"};Sr.prototype.h=function(){Sr.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var jr="closure_listenable_"+(1e6*Math.random()|0),M0=0;function L0(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=s,this.key=++M0,this.ca=this.fa=!1}function si(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function ii(t){this.src=t,this.g={},this.h=0}ii.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=ko(t,e,r,s);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new L0(e,this.src,i,!!r,s),e.fa=n,t.push(e)),e};function Eo(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=Ah(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(si(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function ko(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==r)return s}return-1}var sa="closure_lm_"+(1e6*Math.random()|0),ro={};function Oh(t,e,n,r,s){if(r&&r.once)return Fh(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)Oh(t,e[i],n,r,s);return null}return n=aa(n),t&&t[jr]?t.N(e,n,Br(r)?!!r.capture:!!r,s):Ph(t,e,n,!1,r,s)}function Ph(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Br(s)?!!s.capture:!!s,a=oa(t);if(a||(t[sa]=a=new ii(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=O0(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)N0||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(jh(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function O0(){function t(n){return e.call(t.src,t.listener,n)}var e=P0;return t}function Fh(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)Fh(t,e[i],n,r,s);return null}return n=aa(n),t&&t[jr]?t.O(e,n,Br(r)?!!r.capture:!!r,s):Ph(t,e,n,!0,r,s)}function Bh(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)Bh(t,e[i],n,r,s);else r=Br(r)?!!r.capture:!!r,n=aa(n),t&&t[jr]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=ko(i,n,r,s),-1<n&&(si(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=oa(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ko(e,n,r,s)),(n=-1<t?e[t]:null)&&ia(n))}function ia(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[jr])Eo(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(jh(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=oa(e))?(Eo(n,t),n.h==0&&(n.src=null,e[sa]=null)):si(t)}}}function jh(t){return t in ro?ro[t]:ro[t]="on"+t}function P0(t,e){if(t.ca)t=!0;else{e=new Sr(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&ia(t),t=n.call(r,e)}return t}function oa(t){return t=t[sa],t instanceof ii?t:null}var so="__closure_events_fn_"+(1e9*Math.random()>>>0);function aa(t){return typeof t=="function"?t:(t[so]||(t[so]=function(e){return t.handleEvent(e)}),t[so])}function Me(){Gt.call(this),this.i=new ii(this),this.P=this,this.I=null}Ue(Me,Gt);Me.prototype[jr]=!0;Me.prototype.removeEventListener=function(t,e,n,r){Bh(this,t,e,n,r)};function Be(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new qe(e,t);else if(e instanceof qe)e.target=e.target||t;else{var s=e;e=new qe(r,t),Nh(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=fs(o,r,!0,e)&&s}if(o=e.g=t,s=fs(o,r,!0,e)&&s,s=fs(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=fs(o,r,!1,e)&&s}Me.prototype.M=function(){if(Me.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)si(n[r]);delete t.g[e],t.h--}}this.I=null};Me.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Me.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function fs(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,l=o.ia||o.src;o.fa&&Eo(t.i,o),s=a.call(l,r)!==!1&&s}}return s&&!r.defaultPrevented}var la=G.JSON.stringify;function F0(){var t=Uh;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class B0{constructor(){this.h=this.g=null}add(e,n){const r=Vh.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var Vh=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new j0,t=>t.reset());class j0{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function V0(t){G.setTimeout(()=>{throw t},0)}function ca(t,e){To||U0(),Io||(To(),Io=!0),Uh.add(t,e)}var To;function U0(){var t=G.Promise.resolve(void 0);To=function(){t.then($0)}}var Io=!1,Uh=new B0;function $0(){for(var t;t=F0();){try{t.h.call(t.g)}catch(n){V0(n)}var e=Vh;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Io=!1}function oi(t,e){Me.call(this),this.h=t||1,this.g=e||G,this.j=Fe(this.kb,this),this.l=Date.now()}Ue(oi,Me);O=oi.prototype;O.da=!1;O.S=null;O.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Be(this,"tick"),this.da&&(ua(this),this.start()))}};O.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function ua(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}O.M=function(){oi.Z.M.call(this),ua(this),delete this.g};function ha(t,e,n){if(typeof t=="function")n&&(t=Fe(t,n));else if(t&&typeof t.handleEvent=="function")t=Fe(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:G.setTimeout(t,e||0)}function $h(t){t.g=ha(()=>{t.g=null,t.i&&(t.i=!1,$h(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class q0 extends Gt{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:$h(this)}M(){super.M(),this.g&&(G.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ar(t){Gt.call(this),this.h=t,this.g={}}Ue(Ar,Gt);var Wl=[];function qh(t,e,n,r){Array.isArray(n)||(n&&(Wl[0]=n.toString()),n=Wl);for(var s=0;s<n.length;s++){var i=Oh(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function zh(t){na(t.g,function(e,n){this.g.hasOwnProperty(n)&&ia(e)},t),t.g={}}Ar.prototype.M=function(){Ar.Z.M.call(this),zh(this)};Ar.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ai(){this.g=!0}ai.prototype.Aa=function(){this.g=!1};function z0(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");o=2<=d.length&&d[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function H0(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function Rn(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+K0(t,n)+(r?" "+r:"")})}function G0(t,e){t.info(function(){return"TIMEOUT: "+e})}ai.prototype.info=function(){};function K0(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return la(n)}catch{return e}}var _n={},Xl=null;function li(){return Xl=Xl||new Me}_n.Ma="serverreachability";function Hh(t){qe.call(this,_n.Ma,t)}Ue(Hh,qe);function Dr(t){const e=li();Be(e,new Hh(e))}_n.STAT_EVENT="statevent";function Gh(t,e){qe.call(this,_n.STAT_EVENT,t),this.stat=e}Ue(Gh,qe);function Qe(t){const e=li();Be(e,new Gh(e,t))}_n.Na="timingevent";function Kh(t,e){qe.call(this,_n.Na,t),this.size=e}Ue(Kh,qe);function Vr(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return G.setTimeout(function(){t()},e)}var ci={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Qh={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function fa(){}fa.prototype.h=null;function Yl(t){return t.h||(t.h=t.i())}function Wh(){}var Ur={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function da(){qe.call(this,"d")}Ue(da,qe);function pa(){qe.call(this,"c")}Ue(pa,qe);var Co;function ui(){}Ue(ui,fa);ui.prototype.g=function(){return new XMLHttpRequest};ui.prototype.i=function(){return{}};Co=new ui;function $r(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Ar(this),this.P=Q0,t=bo?125:void 0,this.W=new oi(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Xh}function Xh(){this.i=null,this.g="",this.h=!1}var Q0=45e3,So={},Fs={};O=$r.prototype;O.setTimeout=function(t){this.P=t};function Ao(t,e,n){t.K=1,t.v=fi(Rt(e)),t.s=n,t.U=!0,Yh(t,null)}function Yh(t,e){t.F=Date.now(),qr(t),t.A=Rt(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),sf(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Xh,t.g=If(t.l,n?e:null,!t.s),0<t.O&&(t.L=new q0(Fe(t.Ia,t,t.g),t.O)),qh(t.V,t.g,"readystatechange",t.gb),e=t.H?Rh(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Dr(),z0(t.j,t.u,t.A,t.m,t.X,t.s)}O.gb=function(t){t=t.target;const e=this.L;e&&Ct(t)==3?e.l():this.Ia(t)};O.Ia=function(t){try{if(t==this.g)e:{const u=Ct(this.g);var e=this.g.Da();const d=this.g.ba();if(!(3>u)&&(u!=3||bo||this.g&&(this.h.h||this.g.ga()||tc(this.g)))){this.I||u!=4||e==7||(e==8||0>=d?Dr(3):Dr(2)),hi(this);var n=this.g.ba();this.N=n;t:if(Jh(this)){var r=tc(this.g);t="";var s=r.length,i=Ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){tn(this),wr(this);var o="";break t}this.h.i=new G.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,H0(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Os(a)){var c=a;break t}}c=null}if(n=c)Rn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Do(this,n);else{this.i=!1,this.o=3,Qe(12),tn(this),wr(this);break e}}this.U?(Zh(this,u,o),bo&&this.i&&u==3&&(qh(this.V,this.W,"tick",this.fb),this.W.start())):(Rn(this.j,this.m,o,null),Do(this,o)),u==4&&tn(this),this.i&&!this.I&&(u==4?_f(this.l,this):(this.i=!1,qr(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,Qe(12)):(this.o=0,Qe(13)),tn(this),wr(this)}}}catch{}finally{}};function Jh(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function Zh(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=W0(t,n),s==Fs){e==4&&(t.o=4,Qe(14),r=!1),Rn(t.j,t.m,null,"[Incomplete Response]");break}else if(s==So){t.o=4,Qe(15),Rn(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Rn(t.j,t.m,s,null),Do(t,s);Jh(t)&&s!=Fs&&s!=So&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,Qe(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),ka(e),e.L=!0,Qe(11))):(Rn(t.j,t.m,n,"[Invalid Chunked Response]"),tn(t),wr(t))}O.fb=function(){if(this.g){var t=Ct(this.g),e=this.g.ga();this.C<e.length&&(hi(this),Zh(this,t,e),this.i&&t!=4&&qr(this))}};function W0(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Fs:(n=Number(e.substring(n,r)),isNaN(n)?So:(r+=1,r+n>e.length?Fs:(e=e.substr(r,n),t.C=r+n,e)))}O.cancel=function(){this.I=!0,tn(this)};function qr(t){t.Y=Date.now()+t.P,ef(t,t.P)}function ef(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Vr(Fe(t.eb,t),e)}function hi(t){t.B&&(G.clearTimeout(t.B),t.B=null)}O.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(G0(this.j,this.A),this.K!=2&&(Dr(),Qe(17)),tn(this),this.o=2,wr(this)):ef(this,this.Y-t)};function wr(t){t.l.G==0||t.I||_f(t.l,t)}function tn(t){hi(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,ua(t.W),zh(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Do(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||Ro(n.i,t))){if(n.I=t.N,!t.J&&Ro(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Us(n),gi(n);else break e;Ea(n),Qe(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&n.A==0&&!n.v&&(n.v=Vr(Fe(n.ab,n),6e3));if(1>=lf(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else nn(n,11)}else if((t.J||n.g==t)&&Us(n),!Os(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.U=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.J=c[1],n.la=c[2];const u=c[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const d=c[4];d!=null&&(n.za=d,n.h.info("SVER="+n.za));const p=c[5];p!=null&&typeof p=="number"&&0<p&&(r=1.5*p,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const h=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var i=r.i;!i.g&&(Ge(h,"spdy")||Ge(h,"quic")||Ge(h,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(ya(i,i.h),i.h=null))}if(r.D){const m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.sa=m,de(r.F,r.D,m))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var o=t;if(r.oa=Tf(r,r.H?r.la:null,r.W),o.J){cf(r.i,o);var a=o,l=r.K;l&&a.setTimeout(l),a.B&&(hi(a),qr(a)),r.g=o}else wf(r);0<n.l.length&&mi(n)}else c[0]!="stop"&&c[0]!="close"||nn(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?nn(n,7):_a(n):c[0]!="noop"&&n.j&&n.j.wa(c),n.A=0)}}Dr(4)}catch{}}function X0(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(wo(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function ga(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(wo(t)||typeof t=="string")Dh(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(wo(t)||typeof t=="string"){n=[];for(var r=t.length,s=0;s<r;s++)n.push(s)}else for(s in n=[],r=0,t)n[r++]=s;r=X0(t),s=r.length;for(var i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}}function Yn(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Yn)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}O=Yn.prototype;O.R=function(){ma(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};O.T=function(){return ma(this),this.g.concat()};function ma(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];hn(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)r=t.g[e],hn(s,r)||(t.g[n++]=r,s[r]=1),e++;t.g.length=n}}O.get=function(t,e){return hn(this.h,t)?this.h[t]:e};O.set=function(t,e){hn(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};O.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var s=n[r],i=this.get(s);t.call(e,i,s,this)}};function hn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var tf=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Y0(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function fn(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof fn){this.g=e!==void 0?e:t.g,Bs(this,t.j),this.s=t.s,js(this,t.i),Vs(this,t.m),this.l=t.l,e=t.h;var n=new Rr;n.i=e.i,e.g&&(n.g=new Yn(e.g),n.h=e.h),Jl(this,n),this.o=t.o}else t&&(n=String(t).match(tf))?(this.g=!!e,Bs(this,n[1]||"",!0),this.s=br(n[2]||""),js(this,n[3]||"",!0),Vs(this,n[4]),this.l=br(n[5]||"",!0),Jl(this,n[6]||"",!0),this.o=br(n[7]||"")):(this.g=!!e,this.h=new Rr(null,this.g))}fn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(pr(e,Zl,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(pr(e,Zl,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(pr(n,n.charAt(0)=="/"?ny:ty,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",pr(n,sy)),t.join("")};function Rt(t){return new fn(t)}function Bs(t,e,n){t.j=n?br(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function js(t,e,n){t.i=n?br(e,!0):e}function Vs(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Jl(t,e,n){e instanceof Rr?(t.h=e,iy(t.h,t.g)):(n||(e=pr(e,ry)),t.h=new Rr(e,t.g))}function de(t,e,n){t.h.set(e,n)}function fi(t){return de(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function J0(t){return t instanceof fn?Rt(t):new fn(t,void 0)}function Z0(t,e,n,r){var s=new fn(null,void 0);return t&&Bs(s,t),e&&js(s,e),n&&Vs(s,n),r&&(s.l=r),s}function br(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function pr(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,ey),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ey(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Zl=/[#\/\?@]/g,ty=/[#\?:]/g,ny=/[#\?]/g,ry=/[#\?@]/g,sy=/#/g;function Rr(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Kt(t){t.g||(t.g=new Yn,t.h=0,t.i&&Y0(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}O=Rr.prototype;O.add=function(t,e){Kt(this),this.i=null,t=Jn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function nf(t,e){Kt(t),e=Jn(t,e),hn(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,hn(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&ma(t)))}function rf(t,e){return Kt(t),e=Jn(t,e),hn(t.g.h,e)}O.forEach=function(t,e){Kt(this),this.g.forEach(function(n,r){Dh(n,function(s){t.call(e,s,r,this)},this)},this)};O.T=function(){Kt(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var s=t[r],i=0;i<s.length;i++)n.push(e[r]);return n};O.R=function(t){Kt(this);var e=[];if(typeof t=="string")rf(this,t)&&(e=ql(e,this.g.get(Jn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=ql(e,t[n])}return e};O.set=function(t,e){return Kt(this),this.i=null,t=Jn(this,t),rf(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};O.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function sf(t,e,n){nf(t,e),0<n.length&&(t.i=null,t.g.set(Jn(t,e),ta(n)),t.h+=n.length)}O.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],s=encodeURIComponent(String(r));r=this.R(r);for(var i=0;i<r.length;i++){var o=s;r[i]!==""&&(o+="="+encodeURIComponent(String(r[i]))),t.push(o)}}return this.i=t.join("&")};function Jn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function iy(t,e){e&&!t.j&&(Kt(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(nf(this,r),sf(this,s,n))},t)),t.j=e}var oy=class{constructor(t,e){this.h=t,this.g=e}};function of(t){this.l=t||ay,G.PerformanceNavigationTiming?(t=G.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(G.g&&G.g.Ea&&G.g.Ea()&&G.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var ay=10;function af(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function lf(t){return t.h?1:t.g?t.g.size:0}function Ro(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function ya(t,e){t.g?t.g.add(e):t.h=e}function cf(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}of.prototype.cancel=function(){if(this.i=uf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function uf(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return ta(t.i)}function va(){}va.prototype.stringify=function(t){return G.JSON.stringify(t,void 0)};va.prototype.parse=function(t){return G.JSON.parse(t,void 0)};function ly(){this.g=new va}function cy(t,e,n){const r=n||"";try{ga(t,function(s,i){let o=s;Br(s)&&(o=la(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function uy(t,e){const n=new ai;if(G.Image){const r=new Image;r.onload=hs(ds,n,r,"TestLoadImage: loaded",!0,e),r.onerror=hs(ds,n,r,"TestLoadImage: error",!1,e),r.onabort=hs(ds,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=hs(ds,n,r,"TestLoadImage: timeout",!1,e),G.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function ds(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function zr(t){this.l=t.$b||null,this.j=t.ib||!1}Ue(zr,fa);zr.prototype.g=function(){return new di(this.l,this.j)};zr.prototype.i=function(t){return function(){return t}}({});function di(t,e){Me.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=wa,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ue(di,Me);var wa=0;O=di.prototype;O.open=function(t,e){if(this.readyState!=wa)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Nr(this)};O.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||G).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};O.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Hr(this)),this.readyState=wa};O.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Nr(this)),this.g&&(this.readyState=3,Nr(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof G.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;hf(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function hf(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}O.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Hr(this):Nr(this),this.readyState==3&&hf(this)}};O.Ua=function(t){this.g&&(this.response=this.responseText=t,Hr(this))};O.Ta=function(t){this.g&&(this.response=t,Hr(this))};O.ha=function(){this.g&&Hr(this)};function Hr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Nr(t)}O.setRequestHeader=function(t,e){this.v.append(t,e)};O.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};O.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Nr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var hy=G.JSON.parse;function ke(t){Me.call(this),this.headers=new Yn,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ff,this.K=this.L=!1}Ue(ke,Me);var ff="",fy=/^https?$/i,dy=["POST","PUT"];O=ke.prototype;O.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Co.g(),this.C=this.u?Yl(this.u):Yl(Co),this.g.onreadystatechange=Fe(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){ec(this,i);return}t=n||"";const s=new Yn(this.headers);r&&ga(r,function(i,o){s.set(o,i)}),r=T0(s.T()),n=G.FormData&&t instanceof G.FormData,!(0<=Ah(dy,e))||r||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{gf(this),0<this.B&&((this.K=py(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Fe(this.pa,this)):this.A=ha(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){ec(this,i)}};function py(t){return Fn&&D0()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function gy(t){return t.toLowerCase()=="content-type"}O.pa=function(){typeof ea<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Be(this,"timeout"),this.abort(8))};function ec(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,df(t),pi(t)}function df(t){t.D||(t.D=!0,Be(t,"complete"),Be(t,"error"))}O.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Be(this,"complete"),Be(this,"abort"),pi(this))};O.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),pi(this,!0)),ke.Z.M.call(this)};O.Fa=function(){this.s||(this.F||this.v||this.l?pf(this):this.cb())};O.cb=function(){pf(this)};function pf(t){if(t.h&&typeof ea<"u"&&(!t.C[1]||Ct(t)!=4||t.ba()!=2)){if(t.v&&Ct(t)==4)ha(t.Fa,0,t);else if(Be(t,"readystatechange"),Ct(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(tf)[1]||null;if(!s&&G.self&&G.self.location){var i=G.self.location.protocol;s=i.substr(0,i.length-1)}r=!fy.test(s?s.toLowerCase():"")}n=r}if(n)Be(t,"complete"),Be(t,"success");else{t.m=6;try{var o=2<Ct(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",df(t)}}finally{pi(t)}}}}function pi(t,e){if(t.g){gf(t);const n=t.g,r=t.C[0]?Ls:null;t.g=null,t.C=null,e||Be(t,"ready");try{n.onreadystatechange=r}catch{}}}function gf(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(G.clearTimeout(t.A),t.A=null)}function Ct(t){return t.g?t.g.readyState:0}O.ba=function(){try{return 2<Ct(this)?this.g.status:-1}catch{return-1}};O.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};O.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),hy(e)}};function tc(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case ff:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}O.Da=function(){return this.m};O.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function my(t){let e="";return na(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function ba(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=my(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):de(t,e,n))}function ur(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function mf(t){this.za=0,this.l=[],this.h=new ai,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=ur("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=ur("baseRetryDelayMs",5e3,t),this.$a=ur("retryDelaySeedMs",1e4,t),this.Ya=ur("forwardChannelMaxRetries",2,t),this.ra=ur("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new of(t&&t.concurrentRequestLimit),this.Ca=new ly,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}O=mf.prototype;O.ma=8;O.G=1;function _a(t){if(yf(t),t.G==3){var e=t.V++,n=Rt(t.F);de(n,"SID",t.J),de(n,"RID",e),de(n,"TYPE","terminate"),Gr(t,n),e=new $r(t,t.h,e,void 0),e.K=2,e.v=fi(Rt(n)),n=!1,G.navigator&&G.navigator.sendBeacon&&(n=G.navigator.sendBeacon(e.v.toString(),"")),!n&&G.Image&&(new Image().src=e.v,n=!0),n||(e.g=If(e.l,null),e.g.ea(e.v)),e.F=Date.now(),qr(e)}kf(t)}O.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function gi(t){t.g&&(ka(t),t.g.cancel(),t.g=null)}function yf(t){gi(t),t.u&&(G.clearTimeout(t.u),t.u=null),Us(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&G.clearTimeout(t.m),t.m=null)}function io(t,e){t.l.push(new oy(t.Za++,e)),t.G==3&&mi(t)}function mi(t){af(t.i)||t.m||(t.m=!0,ca(t.Ha,t),t.C=0)}function yy(t,e){return lf(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Vr(Fe(t.Ha,t,e),Ef(t,t.C)),t.C++,!0)}O.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new $r(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=Rh(i),Nh(i,this.P)):i=this.P),this.o===null&&(s.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var r=this.l[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=vf(this,s,e),n=Rt(this.F),de(n,"RID",t),de(n,"CVER",22),this.D&&de(n,"X-HTTP-Session-Id",this.D),Gr(this,n),this.o&&i&&ba(n,this.o,i),ya(this.i,s),this.Ra&&de(n,"TYPE","init"),this.ja?(de(n,"$req",e),de(n,"SID","null"),s.$=!0,Ao(s,n,null)):Ao(s,n,e),this.G=2}}else this.G==3&&(t?nc(this,t):this.l.length==0||af(this.i)||nc(this))};function nc(t,e){var n;e?n=e.m:n=t.V++;const r=Rt(t.F);de(r,"SID",t.J),de(r,"RID",n),de(r,"AID",t.U),Gr(t,r),t.o&&t.s&&ba(r,t.o,t.s),n=new $r(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=vf(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),ya(t.i,n),Ao(n,r,e)}function Gr(t,e){t.j&&ga({},function(n,r){de(e,r,n)})}function vf(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Fe(t.j.Oa,t.j,t):null;e:{var s=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let l=0;l<n;l++){let c=s[l].h;const u=s[l].g;if(c-=i,0>c)i=Math.max(0,s[l].h-100),a=!1;else try{cy(u,o,"req"+c+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,r}function wf(t){t.g||t.u||(t.Y=1,ca(t.Ga,t),t.A=0)}function Ea(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Vr(Fe(t.Ga,t),Ef(t,t.A)),t.A++,!0)}O.Ga=function(){if(this.u=null,bf(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Vr(Fe(this.bb,this),t)}};O.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Qe(10),gi(this),bf(this))};function ka(t){t.B!=null&&(G.clearTimeout(t.B),t.B=null)}function bf(t){t.g=new $r(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=Rt(t.oa);de(e,"RID","rpc"),de(e,"SID",t.J),de(e,"CI",t.N?"0":"1"),de(e,"AID",t.U),Gr(t,e),de(e,"TYPE","xmlhttp"),t.o&&t.s&&ba(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=fi(Rt(e)),n.s=null,n.U=!0,Yh(n,t)}O.ab=function(){this.v!=null&&(this.v=null,gi(this),Ea(this),Qe(19))};function Us(t){t.v!=null&&(G.clearTimeout(t.v),t.v=null)}function _f(t,e){var n=null;if(t.g==e){Us(t),ka(t),t.g=null;var r=2}else if(Ro(t.i,e))n=e.D,cf(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=li(),Be(r,new Kh(r,n)),mi(t)}else wf(t);else if(s=e.o,s==3||s==0&&0<t.I||!(r==1&&yy(t,e)||r==2&&Ea(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:nn(t,5);break;case 4:nn(t,10);break;case 3:nn(t,6);break;default:nn(t,2)}}}function Ef(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function nn(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=Fe(t.jb,t);n||(n=new fn("//www.google.com/images/cleardot.gif"),G.location&&G.location.protocol=="http"||Bs(n,"https"),fi(n)),uy(n.toString(),r)}else Qe(2);t.G=0,t.j&&t.j.va(e),kf(t),yf(t)}O.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Qe(2)):(this.h.info("Failed to ping google.com"),Qe(1))};function kf(t){t.G=0,t.I=-1,t.j&&((uf(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,ta(t.l),t.l.length=0),t.j.ua())}function Tf(t,e,n){let r=J0(n);if(r.i!="")e&&js(r,e+"."+r.i),Vs(r,r.m);else{const s=G.location;r=Z0(s.protocol,e?e+"."+s.hostname:s.hostname,+s.port,n)}return t.aa&&na(t.aa,function(s,i){de(r,i,s)}),e=t.D,n=t.sa,e&&n&&de(r,e,n),de(r,"VER",t.ma),Gr(t,r),r}function If(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new ke(new zr({ib:!0})):new ke(t.qa),e.L=t.H,e}function Cf(){}O=Cf.prototype;O.xa=function(){};O.wa=function(){};O.va=function(){};O.ua=function(){};O.Oa=function(){};function $s(){if(Fn&&!(10<=Number(R0)))throw Error("Environmental error: no available transport.")}$s.prototype.g=function(t,e){return new lt(t,e)};function lt(t,e){Me.call(this),this.g=new mf(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Os(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Os(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Zn(this)}Ue(lt,Me);lt.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),ca(Fe(t.hb,t,e))),Qe(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=Tf(t,null,t.W),mi(t)};lt.prototype.close=function(){_a(this.g)};lt.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,io(this.g,e)}else this.v?(e={},e.__data__=la(t),io(this.g,e)):io(this.g,t)};lt.prototype.M=function(){this.g.j=null,delete this.j,_a(this.g),delete this.g,lt.Z.M.call(this)};function Sf(t){da.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ue(Sf,da);function Af(){pa.call(this),this.status=1}Ue(Af,pa);function Zn(t){this.g=t}Ue(Zn,Cf);Zn.prototype.xa=function(){Be(this.g,"a")};Zn.prototype.wa=function(t){Be(this.g,new Sf(t))};Zn.prototype.va=function(t){Be(this.g,new Af)};Zn.prototype.ua=function(){Be(this.g,"b")};$s.prototype.createWebChannel=$s.prototype.g;lt.prototype.send=lt.prototype.u;lt.prototype.open=lt.prototype.m;lt.prototype.close=lt.prototype.close;ci.NO_ERROR=0;ci.TIMEOUT=8;ci.HTTP_ERROR=6;Qh.COMPLETE="complete";Wh.EventType=Ur;Ur.OPEN="a";Ur.CLOSE="b";Ur.ERROR="c";Ur.MESSAGE="d";Me.prototype.listen=Me.prototype.N;ke.prototype.listenOnce=ke.prototype.O;ke.prototype.getLastError=ke.prototype.La;ke.prototype.getLastErrorCode=ke.prototype.Da;ke.prototype.getStatus=ke.prototype.ba;ke.prototype.getResponseJson=ke.prototype.Qa;ke.prototype.getResponseText=ke.prototype.ga;ke.prototype.send=ke.prototype.ea;var vy=function(){return new $s},wy=function(){return li()},oo=ci,by=Qh,_y=_n,rc={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Ey=zr,ps=Wh,ky=ke;const sc="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ye.UNAUTHENTICATED=new Ye(null),Ye.GOOGLE_CREDENTIALS=new Ye("google-credentials-uid"),Ye.FIRST_PARTY=new Ye("first-party-uid"),Ye.MOCK_USER=new Ye("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let er="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn=new Ko("@firebase/firestore");function ic(){return dn.logLevel}function j(t,...e){if(dn.logLevel<=ie.DEBUG){const n=e.map(Ta);dn.debug(`Firestore (${er}): ${t}`,...n)}}function $t(t,...e){if(dn.logLevel<=ie.ERROR){const n=e.map(Ta);dn.error(`Firestore (${er}): ${t}`,...n)}}function oc(t,...e){if(dn.logLevel<=ie.WARN){const n=e.map(Ta);dn.warn(`Firestore (${er}): ${t}`,...n)}}function Ta(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(t="Unexpected state"){const e=`FIRESTORE (${er}) INTERNAL ASSERTION FAILED: `+t;throw $t(e),new Error(e)}function fe(t,e){t||Q()}function W(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends Xn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Iy{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ye.UNAUTHENTICATED))}shutdown(){}}class Cy{constructor(e){this.t=e,this.currentUser=Ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new jt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new jt,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new jt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(fe(typeof r.accessToken=="string"),new Ty(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return fe(e===null||typeof e=="string"),new Ye(e)}}class Sy{constructor(e,n,r){this.type="FirstParty",this.user=Ye.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const s=e.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class Ay{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new Sy(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(Ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Dy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ry{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const r=i=>{i.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?s(i):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(fe(typeof n.token=="string"),this.p=n.token,new Dy(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ny(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=Ny(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function oe(t,e){return t<e?-1:t>e?1:0}function Bn(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new $(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new $(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ce.fromMillis(Date.now())}static fromDate(e){return Ce.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ce(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?oe(this.nanoseconds,e.nanoseconds):oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.timestamp=e}static fromTimestamp(e){return new X(e)}static min(){return new X(new Ce(0,0))}static max(){return new X(new Ce(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,n,r){n===void 0?n=0:n>e.length&&Q(),r===void 0?r=e.length-n:r>e.length-n&&Q(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return xr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof xr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class pe extends xr{construct(e,n,r){return new pe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new $(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new pe(n)}static emptyPath(){return new pe([])}}const xy=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $e extends xr{construct(e,n,r){return new $e(e,n,r)}static isValidIdentifier(e){return xy.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$e.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new $e(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new $(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new $(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new $(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new $(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $e(n)}static emptyPath(){return new $e([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.path=e}static fromPath(e){return new V(pe.fromString(e))}static fromName(e){return new V(pe.fromString(e).popFirst(5))}static empty(){return new V(pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return pe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new V(new pe(e.slice()))}}function My(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=X.fromTimestamp(r===1e9?new Ce(n+1,0):new Ce(n,r));return new qt(s,V.empty(),e)}function Ly(t){return new qt(t.readTime,t.key,-1)}class qt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new qt(X.min(),V.empty(),-1)}static max(){return new qt(X.max(),V.empty(),-1)}}function Oy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=V.comparator(t.documentKey,e.documentKey),n!==0?n:oe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Py="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Fy{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kr(t){if(t.code!==N.FAILED_PRECONDITION||t.message!==Py)throw t;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new x((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof x?n:x.resolve(n)}catch(n){return x.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):x.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):x.reject(n)}static resolve(e){return new x((n,r)=>{n(e)})}static reject(e){return new x((n,r)=>{r(e)})}static waitFor(e){return new x((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},l=>r(l))}),o=!0,i===s&&n()})}static or(e){let n=x.resolve(!1);for(const r of e)n=n.next(s=>s?x.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new x((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new x((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Qr(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.it(r),this.rt=r=>n.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ac(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function En(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Rf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ia.ot=-1;class Ae{constructor(e,n){this.comparator=e,this.root=n||Oe.EMPTY}insert(e,n){return new Ae(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Oe.BLACK,null,null))}remove(e){return new Ae(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Oe.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gs(this.root,e,this.comparator,!1)}getReverseIterator(){return new gs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gs(this.root,e,this.comparator,!0)}}class gs{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Oe{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Oe.RED,this.left=s!=null?s:Oe.EMPTY,this.right=i!=null?i:Oe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Oe(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Oe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Oe.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Oe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Oe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Q();const e=this.left.check();if(e!==this.right.check())throw Q();return e+(this.isRed()?0:1)}}Oe.EMPTY=null,Oe.RED=!0,Oe.BLACK=!1;Oe.EMPTY=new class{constructor(){this.size=0}get key(){throw Q()}get value(){throw Q()}get color(){throw Q()}get left(){throw Q()}get right(){throw Q()}copy(t,e,n,r,s){return this}insert(t,e,n){return new Oe(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new lc(this.data.getIterator())}getIteratorFrom(e){return new lc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Se)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Se(this.comparator);return n.data=e,n}}class lc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.fields=e,e.sort($e.comparator)}static empty(){return new ft([])}unionWith(e){let n=new Se($e.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new ft(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Bn(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new je(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new je(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}je.EMPTY_BYTE_STRING=new je("");const By=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zt(t){if(fe(!!t),typeof t=="string"){let e=0;const n=By.exec(t);if(fe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:be(t.seconds),nanos:be(t.nanos)}}function be(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function jn(t){return typeof t=="string"?je.fromBase64String(t):je.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function xf(t){const e=t.mapValue.fields.__previous_value__;return Nf(e)?xf(e):e}function Mr(t){const e=zt(t.mapValue.fields.__local_write_time__.timestampValue);return new Ce(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,n,r,s,i,o,a,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class Vn{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Vn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Vn&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yi(t){return t==null}function qs(t){return t===0&&1/t==-1/0}function Vy(t){return typeof t=="number"&&Number.isInteger(t)&&!qs(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ms={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function pn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Nf(t)?4:Uy(t)?9007199254740991:10:Q()}function _t(t,e){if(t===e)return!0;const n=pn(t);if(n!==pn(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Mr(t).isEqual(Mr(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=zt(r.timestampValue),o=zt(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return jn(r.bytesValue).isEqual(jn(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return be(r.geoPointValue.latitude)===be(s.geoPointValue.latitude)&&be(r.geoPointValue.longitude)===be(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return be(r.integerValue)===be(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=be(r.doubleValue),o=be(s.doubleValue);return i===o?qs(i)===qs(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Bn(t.arrayValue.values||[],e.arrayValue.values||[],_t);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(ac(i)!==ac(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!_t(i[a],o[a])))return!1;return!0}(t,e);default:return Q()}}function Lr(t,e){return(t.values||[]).find(n=>_t(n,e))!==void 0}function Un(t,e){if(t===e)return 0;const n=pn(t),r=pn(e);if(n!==r)return oe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return oe(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=be(s.integerValue||s.doubleValue),a=be(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return cc(t.timestampValue,e.timestampValue);case 4:return cc(Mr(t),Mr(e));case 5:return oe(t.stringValue,e.stringValue);case 6:return function(s,i){const o=jn(s),a=jn(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=oe(o[l],a[l]);if(c!==0)return c}return oe(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=oe(be(s.latitude),be(i.latitude));return o!==0?o:oe(be(s.longitude),be(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=Un(o[l],a[l]);if(c)return c}return oe(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===ms.mapValue&&i===ms.mapValue)return 0;if(s===ms.mapValue)return 1;if(i===ms.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),l=i.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let u=0;u<a.length&&u<c.length;++u){const d=oe(a[u],c[u]);if(d!==0)return d;const p=Un(o[a[u]],l[c[u]]);if(p!==0)return p}return oe(a.length,c.length)}(t.mapValue,e.mapValue);default:throw Q()}}function cc(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return oe(t,e);const n=zt(t),r=zt(e),s=oe(n.seconds,r.seconds);return s!==0?s:oe(n.nanos,r.nanos)}function xn(t){return No(t)}function No(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=zt(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?jn(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,V.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=No(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${No(r.fields[a])}`;return i+"}"}(t.mapValue):Q();var e,n}function xo(t){return!!t&&"integerValue"in t}function Ca(t){return!!t&&"arrayValue"in t}function uc(t){return!!t&&"nullValue"in t}function hc(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Is(t){return!!t&&"mapValue"in t}function _r(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return En(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=_r(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=_r(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Uy(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.value=e}static empty(){return new Je({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Is(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=_r(n)}setAll(e){let n=$e.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=_r(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Is(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return _t(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Is(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){En(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Je(_r(this.value))}}function Mf(t){const e=[];return En(t.fields,(n,r)=>{const s=new $e([n]);if(Is(r)){const i=Mf(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ft(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e,n,r,s,i,o){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Pe(e,0,X.min(),X.min(),Je.empty(),0)}static newFoundDocument(e,n,r){return new Pe(e,1,n,X.min(),r,0)}static newNoDocument(e,n){return new Pe(e,2,n,X.min(),Je.empty(),0)}static newUnknownDocument(e,n){return new Pe(e,3,n,X.min(),Je.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Je.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Je.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pe(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function fc(t,e=null,n=[],r=[],s=null,i=null,o=null){return new $y(t,e,n,r,s,i,o)}function Sa(t){const e=W(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+xn(s.value);var s}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),yi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>xn(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>xn(r)).join(",")),e.ut=n}return e.ut}function qy(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${xn(r.value)}`;var r}).join(", ")}]`),yi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>xn(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>xn(n)).join(",")),`Target(${e})`}function Aa(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!Yy(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],r=e.filters[s],n.op!==r.op||!n.field.isEqual(r.field)||!_t(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!pc(t.startAt,e.startAt)&&pc(t.endAt,e.endAt)}function Mo(t){return V.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Ze extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,r):new zy(e,n,r):n==="array-contains"?new Ky(e,r):n==="in"?new Qy(e,r):n==="not-in"?new Wy(e,r):n==="array-contains-any"?new Xy(e,r):new Ze(e,n,r)}static ct(e,n,r){return n==="in"?new Hy(e,r):new Gy(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(Un(n,this.value)):n!==null&&pn(this.value)===pn(n)&&this.at(Un(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class zy extends Ze{constructor(e,n,r){super(e,n,r),this.key=V.fromName(r.referenceValue)}matches(e){const n=V.comparator(e.key,this.key);return this.at(n)}}class Hy extends Ze{constructor(e,n){super(e,"in",n),this.keys=Lf("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Gy extends Ze{constructor(e,n){super(e,"not-in",n),this.keys=Lf("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Lf(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>V.fromName(r.referenceValue))}class Ky extends Ze{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ca(n)&&Lr(n.arrayValue,this.value)}}class Qy extends Ze{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Lr(this.value.arrayValue,n)}}class Wy extends Ze{constructor(e,n){super(e,"not-in",n)}matches(e){if(Lr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Lr(this.value.arrayValue,n)}}class Xy extends Ze{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ca(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Lr(this.value.arrayValue,r))}}class zs{constructor(e,n){this.position=e,this.inclusive=n}}class Er{constructor(e,n="asc"){this.field=e,this.dir=n}}function Yy(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function dc(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=V.comparator(V.fromName(o.referenceValue),n.key):r=Un(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function pc(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!_t(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.lt=null,this.ft=null,this.startAt,this.endAt}}function Jy(t,e,n,r,s,i,o,a){return new vi(t,e,n,r,s,i,o,a)}function wi(t){return new vi(t)}function Zy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ev(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function tv(t){for(const e of t.filters)if(e.ht())return e.field;return null}function nv(t){return t.collectionGroup!==null}function Or(t){const e=W(t);if(e.lt===null){e.lt=[];const n=tv(e),r=ev(e);if(n!==null&&r===null)n.isKeyField()||e.lt.push(new Er(n)),e.lt.push(new Er($e.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Er($e.keyField(),i))}}}return e.lt}function gn(t){const e=W(t);if(!e.ft)if(e.limitType==="F")e.ft=fc(e.path,e.collectionGroup,Or(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Or(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new Er(i.field,o))}const r=e.endAt?new zs(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new zs(e.startAt.position,e.startAt.inclusive):null;e.ft=fc(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.ft}function rv(t,e,n){return new vi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bi(t,e){return Aa(gn(t),gn(e))&&t.limitType===e.limitType}function Of(t){return`${Sa(gn(t))}|lt:${t.limitType}`}function Lo(t){return`Query(target=${qy(gn(t))}; limitType=${t.limitType})`}function Da(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):V.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of n.explicitOrderBy)if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=dc(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,Or(n),r)||n.endAt&&!function(s,i,o){const a=dc(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,Or(n),r))}(t,e)}function sv(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Pf(t){return(e,n)=>{let r=!1;for(const s of Or(t)){const i=iv(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function iv(t,e,n){const r=t.field.isKeyField()?V.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),l=o.data.field(s);return a!==null&&l!==null?Un(a,l):Q()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Q()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ff(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qs(e)?"-0":e}}function Bf(t){return{integerValue:""+t}}function ov(t,e){return Vy(e)?Bf(e):Ff(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(){this._=void 0}}function av(t,e,n){return t instanceof Hs?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof $n?Vf(t,e):t instanceof qn?Uf(t,e):function(r,s){const i=jf(r,s),o=gc(i)+gc(r._t);return xo(i)&&xo(r._t)?Bf(o):Ff(r.wt,o)}(t,e)}function lv(t,e,n){return t instanceof $n?Vf(t,e):t instanceof qn?Uf(t,e):n}function jf(t,e){return t instanceof Gs?xo(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class Hs extends _i{}class $n extends _i{constructor(e){super(),this.elements=e}}function Vf(t,e){const n=$f(e);for(const r of t.elements)n.some(s=>_t(s,r))||n.push(r);return{arrayValue:{values:n}}}class qn extends _i{constructor(e){super(),this.elements=e}}function Uf(t,e){let n=$f(e);for(const r of t.elements)n=n.filter(s=>!_t(s,r));return{arrayValue:{values:n}}}class Gs extends _i{constructor(e,n){super(),this.wt=e,this._t=n}}function gc(t){return be(t.integerValue||t.doubleValue)}function $f(t){return Ca(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e,n){this.field=e,this.transform=n}}function cv(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof $n&&r instanceof $n||n instanceof qn&&r instanceof qn?Bn(n.elements,r.elements,_t):n instanceof Gs&&r instanceof Gs?_t(n._t,r._t):n instanceof Hs&&r instanceof Hs}(t.transform,e.transform)}class uv{constructor(e,n){this.version=e,this.transformResults=n}}class gt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gt}static exists(e){return new gt(void 0,e)}static updateTime(e){return new gt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cs(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ei{}function zf(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Gf(t.key,gt.none()):new Wr(t.key,t.data,gt.none());{const n=t.data,r=Je.empty();let s=new Se($e.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Qt(t.key,r,new ft(s.toArray()),gt.none())}}function hv(t,e,n){t instanceof Wr?function(r,s,i){const o=r.value.clone(),a=yc(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Qt?function(r,s,i){if(!Cs(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=yc(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(Hf(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function kr(t,e,n,r){return t instanceof Wr?function(s,i,o,a){if(!Cs(s.precondition,i))return o;const l=s.value.clone(),c=vc(s.fieldTransforms,a,i);return l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Qt?function(s,i,o,a){if(!Cs(s.precondition,i))return o;const l=vc(s.fieldTransforms,a,i),c=i.data;return c.setAll(Hf(s)),c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(s,i,o){return Cs(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function fv(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=jf(r.transform,s||null);i!=null&&(n===null&&(n=Je.empty()),n.set(r.field,i))}return n||null}function mc(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Bn(n,r,(s,i)=>cv(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Wr extends Ei{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Qt extends Ei{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Hf(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function yc(t,e,n){const r=new Map;fe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,lv(o,a,n[s]))}return r}function vc(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,av(i,o,e))}return r}class Gf extends Ei{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dv extends Ei{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we,Z;function gv(t){switch(t){default:return Q();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function Kf(t){if(t===void 0)return $t("GRPC error has no .code"),N.UNKNOWN;switch(t){case we.OK:return N.OK;case we.CANCELLED:return N.CANCELLED;case we.UNKNOWN:return N.UNKNOWN;case we.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case we.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case we.INTERNAL:return N.INTERNAL;case we.UNAVAILABLE:return N.UNAVAILABLE;case we.UNAUTHENTICATED:return N.UNAUTHENTICATED;case we.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case we.NOT_FOUND:return N.NOT_FOUND;case we.ALREADY_EXISTS:return N.ALREADY_EXISTS;case we.PERMISSION_DENIED:return N.PERMISSION_DENIED;case we.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case we.ABORTED:return N.ABORTED;case we.OUT_OF_RANGE:return N.OUT_OF_RANGE;case we.UNIMPLEMENTED:return N.UNIMPLEMENTED;case we.DATA_LOSS:return N.DATA_LOSS;default:return Q()}}(Z=we||(we={}))[Z.OK=0]="OK",Z[Z.CANCELLED=1]="CANCELLED",Z[Z.UNKNOWN=2]="UNKNOWN",Z[Z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Z[Z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Z[Z.NOT_FOUND=5]="NOT_FOUND",Z[Z.ALREADY_EXISTS=6]="ALREADY_EXISTS",Z[Z.PERMISSION_DENIED=7]="PERMISSION_DENIED",Z[Z.UNAUTHENTICATED=16]="UNAUTHENTICATED",Z[Z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Z[Z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Z[Z.ABORTED=10]="ABORTED",Z[Z.OUT_OF_RANGE=11]="OUT_OF_RANGE",Z[Z.UNIMPLEMENTED=12]="UNIMPLEMENTED",Z[Z.INTERNAL=13]="INTERNAL",Z[Z.UNAVAILABLE=14]="UNAVAILABLE",Z[Z.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){En(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Rf(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv=new Ae(V.comparator);function Nt(){return mv}const Qf=new Ae(V.comparator);function gr(...t){let e=Qf;for(const n of t)e=e.insert(n.key,n);return e}function Wf(t){let e=Qf;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function rn(){return Tr()}function Xf(){return Tr()}function Tr(){return new tr(t=>t.toString(),(t,e)=>t.isEqual(e))}const yv=new Ae(V.comparator),vv=new Se(V.comparator);function J(...t){let e=vv;for(const n of t)e=e.add(n);return e}const wv=new Se(oe);function Yf(){return wv}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,Xr.createSynthesizedTargetChangeForCurrentChange(e,n)),new ki(X.min(),r,Yf(),Nt(),J())}}class Xr{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Xr(je.EMPTY_BYTE_STRING,n,J(),J(),J())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,n,r,s){this.gt=e,this.removedTargetIds=n,this.key=r,this.yt=s}}class Jf{constructor(e,n){this.targetId=e,this.It=n}}class Zf{constructor(e,n,r=je.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class wc{constructor(){this.Tt=0,this.Et=_c(),this.At=je.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=J(),n=J(),r=J();return this.Et.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:Q()}}),new Xr(this.At,this.Rt,e,n,r)}Dt(){this.bt=!1,this.Et=_c()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class bv{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=Nt(),this.Bt=bc(),this.Lt=new Se(oe)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const r=this.Qt(n);switch(e.state){case 0:this.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),r.Vt(e.resumeToken));break;default:Q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((r,s)=>{this.jt(s)&&n(s)})}zt(e){const n=e.targetId,r=e.It.count,s=this.Ht(n);if(s){const i=s.target;if(Mo(i))if(r===0){const o=new V(i.path);this.Kt(n,o,Pe.newNoDocument(o,X.min()))}else fe(r===1);else this.Jt(n)!==r&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&Mo(a.target)){const l=new V(a.target.path);this.$t.get(l)!==null||this.Xt(o,l)||this.Kt(o,l,Pe.newNoDocument(l,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let r=J();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Ht(l);return!c||c.purpose===2||(a=!1,!1)}),a&&(r=r.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const s=new ki(e,n,this.Lt,this.$t,r);return this.$t=Nt(),this.Bt=bc(),this.Lt=new Se(oe),s}qt(e,n){if(!this.jt(e))return;const r=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,r),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,r){if(!this.jt(e))return;const s=this.Qt(e);this.Xt(e,n)?s.Ct(n,1):s.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),r&&(this.$t=this.$t.insert(n,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new wc,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new Se(oe),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||j("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new wc),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function bc(){return new Ae(V.comparator)}function _c(){return new Ae(V.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Ev=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class kv{constructor(e,n){this.databaseId=e,this.dt=n}}function Ks(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ed(t,e){return t.dt?e.toBase64():e.toUint8Array()}function Tv(t,e){return Ks(t,e.toTimestamp())}function St(t){return fe(!!t),X.fromTimestamp(function(e){const n=zt(e);return new Ce(n.seconds,n.nanos)}(t))}function Ra(t,e){return function(n){return new pe(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function td(t){const e=pe.fromString(t);return fe(sd(e)),e}function Oo(t,e){return Ra(t.databaseId,e.path)}function ao(t,e){const n=td(e);if(n.get(1)!==t.databaseId.projectId)throw new $(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new $(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new V(nd(n))}function Po(t,e){return Ra(t.databaseId,e)}function Iv(t){const e=td(t);return e.length===4?pe.emptyPath():nd(e)}function Fo(t){return new pe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nd(t){return fe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ec(t,e,n){return{name:Oo(t,e),fields:n.value.mapValue.fields}}function Cv(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Q()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,c){return l.dt?(fe(c===void 0||typeof c=="string"),je.fromBase64String(c||"")):(fe(c===void 0||c instanceof Uint8Array),je.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?N.UNKNOWN:Kf(l.code);return new $(c,l.message||"")}(o);n=new Zf(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ao(t,r.document.name),i=St(r.document.updateTime),o=new Je({mapValue:{fields:r.document.fields}}),a=Pe.newFoundDocument(s,i,o),l=r.targetIds||[],c=r.removedTargetIds||[];n=new Ss(l,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ao(t,r.document),i=r.readTime?St(r.readTime):X.min(),o=Pe.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Ss([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ao(t,r.document),i=r.removedTargetIds||[];n=new Ss([],i,s,null)}else{if(!("filter"in e))return Q();{e.filter;const r=e.filter;r.targetId;const s=r.count||0,i=new pv(s),o=r.targetId;n=new Jf(o,i)}}return n}function Sv(t,e){let n;if(e instanceof Wr)n={update:Ec(t,e.key,e.value)};else if(e instanceof Gf)n={delete:Oo(t,e.key)};else if(e instanceof Qt)n={update:Ec(t,e.key,e.data),updateMask:Fv(e.fieldMask)};else{if(!(e instanceof dv))return Q();n={verify:Oo(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Hs)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof $n)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof qn)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Gs)return{fieldPath:i.field.canonicalString(),increment:o._t};throw Q()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:Tv(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Q()}(t,e.precondition)),n}function Av(t,e){return t&&t.length>0?(fe(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?St(r.updateTime):St(s);return i.isEqual(X.min())&&(i=St(s)),new uv(i,r.transformResults||[])}(n,e))):[]}function Dv(t,e){return{documents:[Po(t,e.path)]}}function Rv(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Po(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Po(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(l){if(l.length===0)return;const c=l.map(u=>function(d){if(d.op==="=="){if(hc(d.value))return{unaryFilter:{field:An(d.field),op:"IS_NAN"}};if(uc(d.value))return{unaryFilter:{field:An(d.field),op:"IS_NULL"}}}else if(d.op==="!="){if(hc(d.value))return{unaryFilter:{field:An(d.field),op:"IS_NOT_NAN"}};if(uc(d.value))return{unaryFilter:{field:An(d.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:An(d.field),op:Lv(d.op),value:d.value}}}(u));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(e.filters);s&&(n.structuredQuery.where=s);const i=function(l){if(l.length!==0)return l.map(c=>function(u){return{field:An(u.field),direction:Mv(u.dir)}}(c))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(l,c){return l.dt||yi(c)?c:{value:c}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function Nv(t){let e=Iv(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){fe(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=rd(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(d){return new Er(Nn(d.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction))}(u)));let a=null;n.limit&&(a=function(u){let d;return d=typeof u=="object"?u.value:u,yi(d)?null:d}(n.limit));let l=null;n.startAt&&(l=function(u){const d=!!u.before,p=u.values||[];return new zs(p,d)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const d=!u.before,p=u.values||[];return new zs(p,d)}(n.endAt)),Jy(e,s,o,i,a,"F",l,c)}function xv(t,e){const n=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Q()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function rd(t){return t?t.unaryFilter!==void 0?[Pv(t)]:t.fieldFilter!==void 0?[Ov(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>rd(e)).reduce((e,n)=>e.concat(n)):Q():[]}function Mv(t){return _v[t]}function Lv(t){return Ev[t]}function An(t){return{fieldPath:t.canonicalString()}}function Nn(t){return $e.fromServerFormat(t.fieldPath)}function Ov(t){return Ze.create(Nn(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Q()}}(t.fieldFilter.op),t.fieldFilter.value)}function Pv(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Nn(t.unaryFilter.field);return Ze.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Nn(t.unaryFilter.field);return Ze.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Nn(t.unaryFilter.field);return Ze.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Nn(t.unaryFilter.field);return Ze.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Q()}}function Fv(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sd(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&hv(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=kr(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=kr(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Xf();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const l=zf(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),J())}isEqual(e){return this.batchId===e.batchId&&Bn(this.mutations,e.mutations,(n,r)=>mc(n,r))&&Bn(this.baseMutations,e.baseMutations,(n,r)=>mc(n,r))}}class Na{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){fe(e.mutations.length===r.length);let s=yv;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Na(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,n,r,s,i=X.min(),o=X.min(),a=je.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new an(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new an(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new an(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e){this.ne=e}}function Uv(t){const e=Nv({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?rv(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(){this.ze=new qv}addToCollectionParentIndex(e,n){return this.ze.add(n),x.resolve()}getCollectionParents(e,n){return x.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return x.resolve()}deleteFieldIndex(e,n){return x.resolve()}getDocumentsMatchingTarget(e,n){return x.resolve(null)}getIndexType(e,n){return x.resolve(0)}getFieldIndexes(e,n){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,n){return x.resolve(qt.min())}getMinOffsetFromCollectionGroup(e,n){return x.resolve(qt.min())}updateCollectionGroup(e,n,r){return x.resolve()}updateIndexEntries(e,n){return x.resolve()}}class qv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Se(pe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Se(pe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new zn(0)}static Rn(){return new zn(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(){this.changes=new tr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Pe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?x.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.getBaseDocument(e,n,r))).next(s=>(r!==null&&kr(r.mutation,s,ft.empty(),Ce.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,J()).next(()=>r))}getLocalViewOfDocuments(e,n,r=J()){const s=rn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=gr();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=rn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,J()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Nt();const o=Tr(),a=Tr();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Qt)?i=i.insert(c.key,c):u!==void 0&&(o.set(c.key,u.mutation.getFieldMask()),kr(u.mutation,c,u.mutation.getFieldMask(),Ce.now()))}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var d;return a.set(c,new Hv(u,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Tr();let s=new Ae((o,a)=>o-a),i=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||ft.empty();u=a.applyToLocalView(c,u),r.set(l,u);const d=(s.get(a.batchId)||J()).add(l);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,d=Xf();u.forEach(p=>{if(!i.has(p)){const f=zf(n.get(p),r.get(p));f!==null&&d.set(p,f),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return V.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):nv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):x.resolve(rn());let a=-1,l=i;return o.next(c=>x.forEach(c,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(u)?x.resolve():this.getBaseDocument(e,u,d).next(p=>{l=l.insert(u,p)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,J())).next(u=>({batchId:a,changes:Wf(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new V(n)).next(r=>{let s=gr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=gr();return this.indexManager.getCollectionParents(e,s).next(o=>x.forEach(o,a=>{const l=function(c,u){return new vi(u,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(c=>{c.forEach((u,d)=>{i=i.insert(u,d)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(i=>{i.forEach((a,l)=>{const c=l.getKey();s.get(c)===null&&(s=s.insert(c,Pe.newInvalidDocument(c)))});let o=gr();return s.forEach((a,l)=>{const c=i.get(a);c!==void 0&&kr(c.mutation,l,ft.empty(),Ce.now()),Da(n,l)&&(o=o.insert(a,l))}),o})}getBaseDocument(e,n,r){return r===null||r.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):x.resolve(Pe.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return x.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var r;return this.Jn.set(n.id,{id:(r=n).id,version:r.version,createTime:St(r.createTime)}),x.resolve()}getNamedQuery(e,n){return x.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(r){return{name:r.name,query:Uv(r.bundledQuery),readTime:St(r.readTime)}}(n)),x.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(){this.overlays=new Ae(V.comparator),this.Xn=new Map}getOverlay(e,n){return x.resolve(this.overlays.get(n))}getOverlays(e,n){const r=rn();return x.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ie(e,n,i)}),x.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Xn.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(r)),x.resolve()}getOverlaysForCollection(e,n,r){const s=rn(),i=n.length+1,o=new V(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return x.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ae((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=rn(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=rn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return x.resolve(a)}ie(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Xn.get(s.largestBatchId).delete(r.key);this.Xn.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new jv(n,r));let i=this.Xn.get(n);i===void 0&&(i=J(),this.Xn.set(n,i)),this.Xn.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(){this.Zn=new Se(Ne.ts),this.es=new Se(Ne.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const r=new Ne(e,n);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.rs(new Ne(e,n))}os(e,n){e.forEach(r=>this.removeReference(r,n))}us(e){const n=new V(new pe([])),r=new Ne(n,e),s=new Ne(n,e+1),i=[];return this.es.forEachInRange([r,s],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new V(new pe([])),r=new Ne(n,e),s=new Ne(n,e+1);let i=J();return this.es.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ne(e,0),r=this.Zn.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ne{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return V.comparator(e.key,n.key)||oe(e.ls,n.ls)}static ns(e,n){return oe(e.ls,n.ls)||V.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new Se(Ne.ts)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Bv(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.ds=this.ds.add(new Ne(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,n){return x.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ws(r),i=s<0?0:s;return x.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ne(n,0),s=new Ne(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([r,s],o=>{const a=this._s(o.ls);i.push(a)}),x.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(oe);return n.forEach(s=>{const i=new Ne(s,0),o=new Ne(s,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{r=r.add(a.ls)})}),x.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;V.isDocumentKey(i)||(i=i.child(""));const o=new Ne(new V(i),0);let a=new Se(oe);return this.ds.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.ls)),!0)},o),x.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(r=>{const s=this._s(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){fe(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.ds;return x.forEach(n.mutations,s=>{const i=new Ne(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,n){const r=new Ne(n,0),s=this.ds.firstAfterOrEqual(r);return x.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(e){this.ps=e,this.docs=new Ae(V.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ps(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return x.resolve(r?r.document.mutableCopy():Pe.newInvalidDocument(n))}getEntries(e,n){let r=Nt();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Pe.newInvalidDocument(s))}),x.resolve(r)}getAllFromCollection(e,n,r){let s=Nt();const i=new V(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:l}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||Oy(Ly(l),r)<=0||(s=s.insert(l.key,l.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,n,r,s){Q()}Is(e,n){return x.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Yv(this)}getSize(e){return x.resolve(this.size)}}class Yv extends zv{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.zn.addEntry(e,s)):this.zn.removeEntry(r)}),x.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(e){this.persistence=e,this.Ts=new tr(n=>Sa(n),Aa),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Es=0,this.As=new xa,this.targetCount=0,this.Rs=zn.An()}forEachTarget(e,n){return this.Ts.forEach((r,s)=>n(s)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Es&&(this.Es=n),x.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new zn(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,x.resolve()}updateTargetData(e,n){return this.vn(n),x.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),x.waitFor(i).next(()=>s)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,n){const r=this.Ts.get(n)||null;return x.resolve(r)}addMatchingKeys(e,n,r){return this.As.ss(n,r),x.resolve()}removeMatchingKeys(e,n,r){this.As.os(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),x.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),x.resolve()}getMatchingKeysForTargetId(e,n){const r=this.As.hs(n);return x.resolve(r)}containsKey(e,n){return x.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e,n){this.bs={},this.overlays={},this.Ps=new Ia(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new Jv(this),this.indexManager=new $v,this.remoteDocumentCache=function(r){return new Xv(r)}(r=>this.referenceDelegate.Ss(r)),this.wt=new Vv(n),this.Ds=new Kv(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Qv,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.bs[e.toKey()];return r||(r=new Wv(n,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,r){j("MemoryPersistence","Starting transaction:",e);const s=new e1(this.Ps.next());return this.referenceDelegate.Cs(),r(s).next(i=>this.referenceDelegate.xs(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ns(e,n){return x.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,n)))}}class e1 extends Fy{constructor(e){super(),this.currentSequenceNumber=e}}class Ma{constructor(e){this.persistence=e,this.ks=new xa,this.Os=null}static Ms(e){return new Ma(e)}get Fs(){if(this.Os)return this.Os;throw Q()}addReference(e,n,r){return this.ks.addReference(r,n),this.Fs.delete(r.toString()),x.resolve()}removeReference(e,n,r){return this.ks.removeReference(r,n),this.Fs.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),x.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(s=>this.Fs.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Fs.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Fs,r=>{const s=V.fromPath(r);return this.$s(e,s).next(i=>{i||n.removeEntry(s,X.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(r=>{r?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return x.or([()=>x.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Pi=r,this.vi=s}static Vi(e,n){let r=J(),s=J();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new La(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ci(e,n).next(i=>i||this.xi(e,n,s,r)).next(i=>i||this.Ni(e,n))}Ci(e,n){return x.resolve(null)}xi(e,n,r,s){return Zy(n)||s.isEqual(X.min())?this.Ni(e,n):this.Di.getDocuments(e,r).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,r,s)?this.Ni(e,n):(ic()<=ie.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Lo(n)),this.Mi(e,o,n,My(s,-1)))})}ki(e,n){let r=new Se(Pf(e));return n.forEach((s,i)=>{Da(e,i)&&(r=r.add(i))}),r}Oi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ni(e,n){return ic()<=ie.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Lo(n)),this.Di.getDocumentsMatchingQuery(e,n,qt.min())}Mi(e,n,r,s){return this.Di.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e,n,r,s){this.persistence=e,this.Fi=n,this.wt=s,this.$i=new Ae(oe),this.Bi=new tr(i=>Sa(i),Aa),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Gv(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function r1(t,e,n,r){return new n1(t,e,n,r)}async function id(t,e){const n=W(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.qi(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=J();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Ki:c,removedBatchIds:o,addedBatchIds:a}))})})}function s1(t,e){const n=W(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const u=l.batch,d=u.keys();let p=x.resolve();return d.forEach(f=>{p=p.next(()=>c.getEntry(a,f)).next(h=>{const m=l.docVersions.get(f);fe(m!==null),h.version.compareTo(m)<0&&(u.applyToRemoteDocument(h,l),h.isValidDocument()&&(h.setReadTime(l.commitVersion),c.addEntry(h)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=J();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function od(t){const e=W(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function i1(t,e){const n=W(t),r=e.snapshotVersion;let s=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});s=n.$i;const a=[];e.targetChanges.forEach((u,d)=>{const p=s.get(d);if(!p)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,d).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,d)));let f=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(d)?f=f.withResumeToken(je.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),s=s.insert(d,f),function(h,m,w){return h.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-h.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(p,f,u)&&a.push(n.Vs.updateTargetData(i,f))});let l=Nt(),c=J();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(o1(i,o,e.documentUpdates).next(u=>{l=u.Gi,c=u.Qi})),!r.isEqual(X.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(d=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return x.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(n.$i=s,i))}function o1(t,e,n){let r=J(),s=J();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Nt();return n.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(X.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):j("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Gi:o,Qi:s}})}function a1(t,e){const n=W(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function l1(t,e){const n=W(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Vs.getTargetData(r,e).next(i=>i?(s=i,x.resolve(s)):n.Vs.allocateTargetId(r).next(o=>(s=new an(e,o,0,r.currentSequenceNumber),n.Vs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.$i.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.$i=n.$i.insert(r.targetId,r),n.Bi.set(e,r.targetId)),r})}async function Bo(t,e,n){const r=W(t),s=r.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Qr(o))throw o;j("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.$i=r.$i.remove(e),r.Bi.delete(s.target)}function kc(t,e,n){const r=W(t);let s=X.min(),i=J();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const u=W(a),d=u.Bi.get(c);return d!==void 0?x.resolve(u.$i.get(d)):u.Vs.getTargetData(l,c)}(r,o,gn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.Fi.getDocumentsMatchingQuery(o,e,n?s:X.min(),n?i:J())).next(a=>(c1(r,sv(e),a),{documents:a,ji:i})))}function c1(t,e,n){let r=X.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Li.set(e,r)}class Tc{constructor(){this.activeTargetIds=Yf()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class u1{constructor(){this.Fr=new Tc,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,r){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Tc,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){j("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){j("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,r,s,i){const o=this.oo(e,n);j("RestConnection","Sending: ",o,r);const a={};return this.uo(a,s,i),this.co(e,o,a,r).then(l=>(j("RestConnection","Received: ",l),l),l=>{throw oc("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",r),l})}ao(e,n,r,s,i,o){return this.ro(e,n,r,s,i)}uo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+er,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}oo(e,n){const r=f1[e];return`${this.so}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,r,s){return new Promise((i,o)=>{const a=new ky;a.listenOnce(by.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case oo.NO_ERROR:const c=a.getResponseJson();j("Connection","XHR received:",JSON.stringify(c)),i(c);break;case oo.TIMEOUT:j("Connection",'RPC "'+e+'" timed out'),o(new $(N.DEADLINE_EXCEEDED,"Request time out"));break;case oo.HTTP_ERROR:const u=a.getStatus();if(j("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const d=a.getResponseJson().error;if(d&&d.status&&d.message){const p=function(f){const h=f.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(h)>=0?h:N.UNKNOWN}(d.status);o(new $(p,d.message))}else o(new $(N.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new $(N.UNAVAILABLE,"Connection failed."));break;default:Q()}}finally{j("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(s);a.send(n,"POST",l,r,15)})}ho(e,n,r){const s=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=vy(),o=wy(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new Ey({})),this.uo(a.initMessageHeaders,n,r),Lp()||Op()||Pp()||Fp()||Bp()||Wu()||(a.httpHeadersOverwriteParam="$httpHeaders");const l=s.join("");j("Connection","Creating WebChannel: "+l,a);const c=i.createWebChannel(l,a);let u=!1,d=!1;const p=new d1({jr:h=>{d?j("Connection","Not sending because WebChannel is closed:",h):(u||(j("Connection","Opening WebChannel transport."),c.open(),u=!0),j("Connection","WebChannel sending:",h),c.send(h))},Wr:()=>c.close()}),f=(h,m,w)=>{h.listen(m,g=>{try{w(g)}catch(v){setTimeout(()=>{throw v},0)}})};return f(c,ps.EventType.OPEN,()=>{d||j("Connection","WebChannel transport opened.")}),f(c,ps.EventType.CLOSE,()=>{d||(d=!0,j("Connection","WebChannel transport closed"),p.eo())}),f(c,ps.EventType.ERROR,h=>{d||(d=!0,oc("Connection","WebChannel transport errored:",h),p.eo(new $(N.UNAVAILABLE,"The operation could not be completed")))}),f(c,ps.EventType.MESSAGE,h=>{var m;if(!d){const w=h.data[0];fe(!!w);const g=w,v=g.error||((m=g[0])===null||m===void 0?void 0:m.error);if(v){j("Connection","WebChannel received error:",v);const k=v.status;let _=function(b){const C=we[b];if(C!==void 0)return Kf(C)}(k),y=v.message;_===void 0&&(_=N.INTERNAL,y="Unknown error status: "+k+" with message "+v.message),d=!0,p.eo(new $(_,y)),c.close()}else j("Connection","WebChannel received:",w),p.no(w)}}),f(o,_y.STAT_EVENT,h=>{h.stat===rc.PROXY?j("Connection","Detected buffering proxy"):h.stat===rc.NOPROXY&&j("Connection","Detected no buffering proxy")}),setTimeout(()=>{p.Zr()},0),p}}function lo(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(t){return new kv(t,!0)}class ad{constructor(e,n,r=1e3,s=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=r,this.fo=s,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),s=Math.max(0,n-r);s>0&&j("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,s,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n,r,s,i,o,a,l){this.js=e,this.Ao=r,this.Ro=s,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new ad(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===N.RESOURCE_EXHAUSTED?($t(n.toString()),$t("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Po===n&&this.Uo(r,s)},r=>{e(()=>{const s=new $(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(s)})})}Uo(e,n){const r=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(s=>{r(()=>this.qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return j("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(j("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class g1 extends ld{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=Cv(this.wt,e),r=function(s){if(!("targetChange"in s))return X.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?X.min():i.readTime?St(i.readTime):X.min()}(e);return this.listener.Go(n,r)}Qo(e){const n={};n.database=Fo(this.wt),n.addTarget=function(s,i){let o;const a=i.target;return o=Mo(a)?{documents:Dv(s,a)}:{query:Rv(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=ed(s,i.resumeToken):i.snapshotVersion.compareTo(X.min())>0&&(o.readTime=Ks(s,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const r=xv(this.wt,e);r&&(n.labels=r),this.Mo(n)}jo(e){const n={};n.database=Fo(this.wt),n.removeTarget=e,this.Mo(n)}}class m1 extends ld{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(fe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=Av(e.writeResults,e.commitTime),r=St(e.commitTime);return this.listener.Jo(r,n)}return fe(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=Fo(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Sv(this.wt,r))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=r,this.wt=s,this.Zo=!1}tu(){if(this.Zo)throw new $(N.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.bo.ro(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $(N.UNKNOWN,s.toString())})}ao(e,n,r,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $(N.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class v1{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?($t(n),this.su=!1):j("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{r.enqueueAndForget(async()=>{kn(this)&&(j("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=W(a);l.lu.add(4),await Yr(l),l._u.set("Unknown"),l.lu.delete(4),await Ii(l)}(this))})}),this._u=new v1(r,s)}}async function Ii(t){if(kn(t))for(const e of t.fu)await e(!0)}async function Yr(t){for(const e of t.fu)await e(!1)}function cd(t,e){const n=W(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),Fa(n)?Pa(n):nr(n).Co()&&Oa(n,e))}function ud(t,e){const n=W(t),r=nr(n);n.hu.delete(e),r.Co()&&hd(n,e),n.hu.size===0&&(r.Co()?r.ko():kn(n)&&n._u.set("Unknown"))}function Oa(t,e){t.wu.Nt(e.targetId),nr(t).Qo(e)}function hd(t,e){t.wu.Nt(e),nr(t).jo(e)}function Pa(t){t.wu=new bv({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),nr(t).start(),t._u.iu()}function Fa(t){return kn(t)&&!nr(t).Do()&&t.hu.size>0}function kn(t){return W(t).lu.size===0}function fd(t){t.wu=void 0}async function b1(t){t.hu.forEach((e,n)=>{Oa(t,e)})}async function _1(t,e){fd(t),Fa(t)?(t._u.uu(e),Pa(t)):t._u.set("Unknown")}async function E1(t,e,n){if(t._u.set("Online"),e instanceof Zf&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.hu.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.hu.delete(o),r.wu.removeTarget(o))}(t,e)}catch(r){j("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qs(t,r)}else if(e instanceof Ss?t.wu.Ut(e):e instanceof Jf?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(X.min()))try{const r=await od(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.wu.Yt(i);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=s.hu.get(l);c&&s.hu.set(l,c.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const l=s.hu.get(a);if(!l)return;s.hu.set(a,l.withResumeToken(je.EMPTY_BYTE_STRING,l.snapshotVersion)),hd(s,a);const c=new an(l.target,a,1,l.sequenceNumber);Oa(s,c)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){j("RemoteStore","Failed to raise snapshot:",r),await Qs(t,r)}}async function Qs(t,e,n){if(!Qr(e))throw e;t.lu.add(1),await Yr(t),t._u.set("Offline"),n||(n=()=>od(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{j("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await Ii(t)})}function dd(t,e){return e().catch(n=>Qs(t,n,e))}async function Ci(t){const e=W(t),n=Ht(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;k1(e);)try{const s=await a1(e.localStore,r);if(s===null){e.au.length===0&&n.ko();break}r=s.batchId,T1(e,s)}catch(s){await Qs(e,s)}pd(e)&&gd(e)}function k1(t){return kn(t)&&t.au.length<10}function T1(t,e){t.au.push(e);const n=Ht(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function pd(t){return kn(t)&&!Ht(t).Do()&&t.au.length>0}function gd(t){Ht(t).start()}async function I1(t){Ht(t).Xo()}async function C1(t){const e=Ht(t);for(const n of t.au)e.Ho(n.mutations)}async function S1(t,e,n){const r=t.au.shift(),s=Na.from(r,e,n);await dd(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Ci(t)}async function A1(t,e){e&&Ht(t).zo&&await async function(n,r){if(s=r.code,gv(s)&&s!==N.ABORTED){const i=n.au.shift();Ht(n).No(),await dd(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await Ci(n)}var s}(t,e),pd(t)&&gd(t)}async function Cc(t,e){const n=W(t);n.asyncQueue.verifyOperationInProgress(),j("RemoteStore","RemoteStore received new credentials");const r=kn(n);n.lu.add(3),await Yr(n),r&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await Ii(n)}async function D1(t,e){const n=W(t);e?(n.lu.delete(2),await Ii(n)):e||(n.lu.add(2),await Yr(n),n._u.set("Unknown"))}function nr(t){return t.mu||(t.mu=function(e,n,r){const s=W(e);return s.tu(),new g1(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:b1.bind(null,t),Jr:_1.bind(null,t),Go:E1.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),Fa(t)?Pa(t):t._u.set("Unknown")):(await t.mu.stop(),fd(t))})),t.mu}function Ht(t){return t.gu||(t.gu=function(e,n,r){const s=W(e);return s.tu(),new m1(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:I1.bind(null,t),Jr:A1.bind(null,t),Yo:C1.bind(null,t),Jo:S1.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await Ci(t)):(await t.gu.stop(),t.au.length>0&&(j("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new jt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Ba(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ja(t,e){if($t("AsyncQueue",`${e}: ${t}`),Qr(t))return new $(N.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.comparator=e?(n,r)=>e(n,r)||V.comparator(n.key,r.key):(n,r)=>V.comparator(n.key,r.key),this.keyedMap=gr(),this.sortedSet=new Ae(this.comparator)}static emptySet(e){return new Mn(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mn)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Mn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(){this.yu=new Ae(V.comparator)}track(e){const n=e.doc.key,r=this.yu.get(n);r?e.type!==0&&r.type===3?this.yu=this.yu.insert(n,e):e.type===3&&r.type!==1?this.yu=this.yu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.yu=this.yu.remove(n):e.type===1&&r.type===2?this.yu=this.yu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):Q():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,r)=>{e.push(r)}),e}}class Hn{constructor(e,n,r,s,i,o,a,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(e,n,r,s){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Hn(e,n,Mn.emptySet(n),i,r,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bi(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(){this.Iu=void 0,this.listeners=[]}}class N1{constructor(){this.queries=new tr(e=>Of(e),bi),this.onlineState="Unknown",this.Tu=new Set}}async function md(t,e){const n=W(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new R1),s)try{i.Iu=await n.onListen(r)}catch(o){const a=ja(o,`Initialization of query '${Lo(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&Va(n)}async function yd(t,e){const n=W(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function x1(t,e){const n=W(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(s)&&(r=!0);o.Iu=s}}r&&Va(n)}function M1(t,e,n){const r=W(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function Va(t){t.Tu.forEach(e=>{e.next()})}class vd{constructor(e,n,r){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Hn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Du||!r)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Hn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e){this.key=e}}class bd{constructor(e){this.key=e}}class L1{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=J(),this.mutatedKeys=J(),this.Lu=Pf(e),this.Uu=new Mn(this.Lu)}get qu(){return this.Fu}Ku(e,n){const r=n?n.Gu:new Sc,s=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,d)=>{const p=s.get(u),f=Da(this.query,d)?d:null,h=!!p&&this.mutatedKeys.has(p.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let w=!1;p&&f?p.data.isEqual(f.data)?h!==m&&(r.track({type:3,doc:f}),w=!0):this.Qu(p,f)||(r.track({type:2,doc:f}),w=!0,(l&&this.Lu(f,l)>0||c&&this.Lu(f,c)<0)&&(a=!0)):!p&&f?(r.track({type:0,doc:f}),w=!0):p&&!f&&(r.track({type:1,doc:p}),w=!0,(l||c)&&(a=!0)),w&&(f?(o=o.add(f),i=m?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Uu:o,Gu:r,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((c,u)=>function(d,p){const f=h=>{switch(h){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q()}};return f(d)-f(p)}(c.type,u.type)||this.Lu(c.doc,u.doc)),this.ju(r);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,l=a!==this.$u;return this.$u=a,i.length!==0||l?{snapshot:new Hn(this.query,e.Uu,s,i,e.mutatedKeys,a===0,l,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new Sc,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=J(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const n=[];return e.forEach(r=>{this.Bu.has(r)||n.push(new bd(r))}),this.Bu.forEach(r=>{e.has(r)||n.push(new wd(r))}),n}Ju(e){this.Fu=e.ji,this.Bu=J();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Hn.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class O1{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class P1{constructor(e){this.key=e,this.Xu=!1}}class F1{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new tr(a=>Of(a),bi),this.ec=new Map,this.nc=new Set,this.sc=new Ae(V.comparator),this.ic=new Map,this.rc=new xa,this.oc={},this.uc=new Map,this.cc=zn.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function B1(t,e){const n=Q1(t);let r,s;const i=n.tc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Yu();else{const o=await l1(n.localStore,gn(e));n.isPrimaryClient&&cd(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await j1(n,e,r,a==="current")}return s}async function j1(t,e,n,r){t.hc=(u,d,p)=>async function(f,h,m,w){let g=h.view.Ku(m);g.Oi&&(g=await kc(f.localStore,h.query,!1).then(({documents:_})=>h.view.Ku(_,g)));const v=w&&w.targetChanges.get(h.targetId),k=h.view.applyChanges(g,f.isPrimaryClient,v);return Dc(f,h.targetId,k.zu),k.snapshot}(t,u,d,p);const s=await kc(t.localStore,e,!0),i=new L1(e,s.ji),o=i.Ku(s.documents),a=Xr.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),l=i.applyChanges(o,t.isPrimaryClient,a);Dc(t,n,l.zu);const c=new O1(e,n,i);return t.tc.set(e,c),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),l.snapshot}async function V1(t,e){const n=W(t),r=n.tc.get(e),s=n.ec.get(r.targetId);if(s.length>1)return n.ec.set(r.targetId,s.filter(i=>!bi(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Bo(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),ud(n.remoteStore,r.targetId),jo(n,r.targetId)}).catch(Kr)):(jo(n,r.targetId),await Bo(n.localStore,r.targetId,!0))}async function U1(t,e,n){const r=W1(t);try{const s=await function(i,o){const a=W(i),l=Ce.now(),c=o.reduce((p,f)=>p.add(f.key),J());let u,d;return a.persistence.runTransaction("Locally write mutations","readwrite",p=>{let f=Nt(),h=J();return a.Ui.getEntries(p,c).next(m=>{f=m,f.forEach((w,g)=>{g.isValidDocument()||(h=h.add(w))})}).next(()=>a.localDocuments.getOverlayedDocuments(p,f)).next(m=>{u=m;const w=[];for(const g of o){const v=fv(g,u.get(g.key).overlayedDocument);v!=null&&w.push(new Qt(g.key,v,Mf(v.value.mapValue),gt.exists(!0)))}return a.mutationQueue.addMutationBatch(p,l,w,o)}).next(m=>{d=m;const w=m.applyToLocalDocumentSet(u,h);return a.documentOverlayCache.saveOverlays(p,m.batchId,w)})}).then(()=>({batchId:d.batchId,changes:Wf(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let l=i.oc[i.currentUser.toKey()];l||(l=new Ae(oe)),l=l.insert(o,a),i.oc[i.currentUser.toKey()]=l}(r,s.batchId,n),await Jr(r,s.changes),await Ci(r.remoteStore)}catch(s){const i=ja(s,"Failed to persist write");n.reject(i)}}async function _d(t,e){const n=W(t);try{const r=await i1(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.ic.get(i);o&&(fe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Xu=!0:s.modifiedDocuments.size>0?fe(o.Xu):s.removedDocuments.size>0&&(fe(o.Xu),o.Xu=!1))}),await Jr(n,r,e)}catch(r){await Kr(r)}}function Ac(t,e,n){const r=W(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=W(i);a.onlineState=o;let l=!1;a.queries.forEach((c,u)=>{for(const d of u.listeners)d.Eu(o)&&(l=!0)}),l&&Va(a)}(r.eventManager,e),s.length&&r.Zu.Go(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function $1(t,e,n){const r=W(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.ic.get(e),i=s&&s.key;if(i){let o=new Ae(V.comparator);o=o.insert(i,Pe.newNoDocument(i,X.min()));const a=J().add(i),l=new ki(X.min(),new Map,new Se(oe),o,a);await _d(r,l),r.sc=r.sc.remove(i),r.ic.delete(e),Ua(r)}else await Bo(r.localStore,e,!1).then(()=>jo(r,e,n)).catch(Kr)}async function q1(t,e){const n=W(t),r=e.batch.batchId;try{const s=await s1(n.localStore,e);kd(n,r,null),Ed(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Jr(n,s)}catch(s){await Kr(s)}}async function z1(t,e,n){const r=W(t);try{const s=await function(i,o){const a=W(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.mutationQueue.lookupMutationBatch(l,o).next(u=>(fe(u!==null),c=u.keys(),a.mutationQueue.removeMutationBatch(l,u))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>a.localDocuments.getDocuments(l,c))})}(r.localStore,e);kd(r,e,n),Ed(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Jr(r,s)}catch(s){await Kr(s)}}function Ed(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function kd(t,e,n){const r=W(t);let s=r.oc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.oc[r.currentUser.toKey()]=s}}function jo(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ec.get(e))t.tc.delete(r),n&&t.Zu.lc(r,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(r=>{t.rc.containsKey(r)||Td(t,r)})}function Td(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(ud(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),Ua(t))}function Dc(t,e,n){for(const r of n)r instanceof wd?(t.rc.addReference(r.key,e),H1(t,r)):r instanceof bd?(j("SyncEngine","Document no longer in limbo: "+r.key),t.rc.removeReference(r.key,e),t.rc.containsKey(r.key)||Td(t,r.key)):Q()}function H1(t,e){const n=e.key,r=n.path.canonicalString();t.sc.get(n)||t.nc.has(r)||(j("SyncEngine","New document in limbo: "+n),t.nc.add(r),Ua(t))}function Ua(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new V(pe.fromString(e)),r=t.cc.next();t.ic.set(r,new P1(n)),t.sc=t.sc.insert(n,r),cd(t.remoteStore,new an(gn(wi(n.path)),r,2,Ia.ot))}}async function Jr(t,e,n){const r=W(t),s=[],i=[],o=[];r.tc.isEmpty()||(r.tc.forEach((a,l)=>{o.push(r.hc(l,e,n).then(c=>{if(c){r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c.fromCache?"not-current":"current"),s.push(c);const u=La.Vi(l.targetId,c);i.push(u)}}))}),await Promise.all(o),r.Zu.Go(s),await async function(a,l){const c=W(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>x.forEach(l,d=>x.forEach(d.Pi,p=>c.persistence.referenceDelegate.addReference(u,d.targetId,p)).next(()=>x.forEach(d.vi,p=>c.persistence.referenceDelegate.removeReference(u,d.targetId,p)))))}catch(u){if(!Qr(u))throw u;j("LocalStore","Failed to update sequence numbers: "+u)}for(const u of l){const d=u.targetId;if(!u.fromCache){const p=c.$i.get(d),f=p.snapshotVersion,h=p.withLastLimboFreeSnapshotVersion(f);c.$i=c.$i.insert(d,h)}}}(r.localStore,i))}async function G1(t,e){const n=W(t);if(!n.currentUser.isEqual(e)){j("SyncEngine","User change. New user:",e.toKey());const r=await id(n.localStore,e);n.currentUser=e,function(s,i){s.uc.forEach(o=>{o.forEach(a=>{a.reject(new $(N.CANCELLED,i))})}),s.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Jr(n,r.Ki)}}function K1(t,e){const n=W(t),r=n.ic.get(e);if(r&&r.Xu)return J().add(r.key);{let s=J();const i=n.ec.get(e);if(!i)return s;for(const o of i){const a=n.tc.get(o);s=s.unionWith(a.view.qu)}return s}}function Q1(t){const e=W(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=_d.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=K1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$1.bind(null,e),e.Zu.Go=x1.bind(null,e.eventManager),e.Zu.lc=M1.bind(null,e.eventManager),e}function W1(t){const e=W(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=q1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=z1.bind(null,e),e}class X1{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=Ti(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return r1(this.persistence,new t1,e.initialUser,this.wt)}_c(e){return new Zv(Ma.Ms,this.wt)}dc(e){return new u1}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Y1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ac(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=G1.bind(null,this.syncEngine),await D1(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new N1}createDatastore(e){const n=Ti(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new p1(s));var s;return function(i,o,a,l){return new y1(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>Ac(this.syncEngine,a,0),o=Ic.V()?new Ic:new h1,new w1(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,l,c){const u=new F1(r,s,i,o,a,l);return c&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=W(e);j("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await Yr(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ye.UNAUTHENTICATED,this.clientId=Df.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{j("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(j("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $(N.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ja(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Z1(t,e){t.asyncQueue.verifyOperationInProgress(),j("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await id(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function ew(t,e){t.asyncQueue.verifyOperationInProgress();const n=await tw(t);j("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>Cc(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>Cc(e.remoteStore,i)),t.onlineComponents=e}async function tw(t){return t.offlineComponents||(j("FirestoreClient","Using default OfflineComponentProvider"),await Z1(t,new X1)),t.offlineComponents}async function Cd(t){return t.onlineComponents||(j("FirestoreClient","Using default OnlineComponentProvider"),await ew(t,new Y1)),t.onlineComponents}function nw(t){return Cd(t).then(e=>e.syncEngine)}async function Vo(t){const e=await Cd(t),n=e.eventManager;return n.onListen=B1.bind(null,e.syncEngine),n.onUnlisten=V1.bind(null,e.syncEngine),n}function rw(t,e,n={}){const r=new jt;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,l){const c=new Id({next:d=>{i.enqueueAndForget(()=>yd(s,u));const p=d.docs.has(o);!p&&d.fromCache?l.reject(new $(N.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&a&&a.source==="server"?l.reject(new $(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),u=new vd(wi(o.path),c,{includeMetadataChanges:!0,Du:!0});return md(s,u)}(await Vo(t),t.asyncQueue,e,n,r)),r.promise}const Rc=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(t,e,n){if(!n)throw new $(N.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sw(t,e,n,r){if(e===!0&&r===!0)throw new $(N.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Nc(t){if(!V.isDocumentKey(t))throw new $(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function xc(t){if(V.isDocumentKey(t))throw new $(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function $a(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Q()}function bt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=$a(t);throw new $(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new $(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,sw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n,r){this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mc({}),this._settingsFrozen=!1,e instanceof Vn?this._databaseId=e:(this._app=e,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new $(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vn(s.options.projectId)}(e))}get app(){if(!this._app)throw new $(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new $(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mc(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Iy;switch(n.type){case"gapi":const r=n.client;return fe(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new Ay(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new $(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=Rc.get(e);n&&(j("ComponentProvider","Removing Datastore"),Rc.delete(e),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new We(this.firestore,e,this._key)}}class Si{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Si(this.firestore,e,this._query)}}class Vt extends Si{constructor(e,n,r){super(e,n,wi(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new We(this.firestore,null,new V(e))}withConverter(e){return new Vt(this.firestore,e,this._path)}}function iw(t,e,...n){if(t=mt(t),Sd("collection","path",e),t instanceof qa){const r=pe.fromString(e,...n);return xc(r),new Vt(t,null,r)}{if(!(t instanceof We||t instanceof Vt))throw new $(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(pe.fromString(e,...n));return xc(r),new Vt(t.firestore,null,r)}}function et(t,e,...n){if(t=mt(t),arguments.length===1&&(e=Df.I()),Sd("doc","path",e),t instanceof qa){const r=pe.fromString(e,...n);return Nc(r),new We(t,null,new V(r))}{if(!(t instanceof We||t instanceof Vt))throw new $(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(pe.fromString(e,...n));return Nc(r),new We(t.firestore,t instanceof Vt?t.converter:null,new V(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new ad(this,"async_queue_retry"),this.Kc=()=>{const n=lo();n&&j("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=lo();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=lo();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new jt;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!Qr(e))throw e;j("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{this.Bc=r,this.Lc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw $t("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Lc=!1,r))));return this.Oc=n,n}enqueueAfterDelay(e,n,r){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const s=Ba.createAndSchedule(this,e,n,r,i=>this.Wc(i));return this.$c.push(s),s}Gc(){this.Bc&&Q()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function Lc(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class mn extends qa{constructor(e,n,r){super(e,n,r),this.type="firestore",this._queue=new ow,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Ad(this),this._firestoreClient.terminate()}}function aw(t=nh()){return Fr(t,"firestore").getImmediate()}function za(t){return t._firestoreClient||Ad(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ad(t){var e;const n=t._freezeSettings(),r=function(s,i,o,a){return new jy(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new J1(t._authCredentials,t._appCheckCredentials,t._queue,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new $(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $e(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gn(je.fromBase64String(e))}catch(n){throw new $(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Gn(je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new $(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new $(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return oe(this._lat,e._lat)||oe(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw=/^__.*__$/;class cw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Qt(e,this.data,this.fieldMask,n,this.fieldTransforms):new Wr(e,this.data,n,this.fieldTransforms)}}class Dd{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Qt(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Rd(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q()}}class Di{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Di(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.sa(e),s}ia(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.Xc(),s}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Ws(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(Rd(this.Zc)&&lw.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class uw{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=r||Ti(e)}aa(e,n,r,s=!1){return new Di({Zc:e,methodName:n,ca:r,path:$e.emptyPath(),na:!1,ua:s},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function Ga(t){const e=t._freezeSettings(),n=Ti(t._databaseId);return new uw(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Nd(t,e,n,r,s,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,s);Ka("Data must be an object, but it was:",o,r);const a=Md(r,o);let l,c;if(i.merge)l=new ft(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const d of i.mergeFields){const p=Uo(e,d,n);if(!o.contains(p))throw new $(N.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Od(u,p)||u.push(p)}l=new ft(u),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new cw(new Je(a),l,c)}class Ri extends Zr{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ri}}function xd(t,e,n){return new Di({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class hw extends Zr{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=xd(this,e,!0),r=this.ha.map(i=>rr(i,n)),s=new $n(r);return new qf(e.path,s)}isEqual(e){return this===e}}class fw extends Zr{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=xd(this,e,!0),r=this.ha.map(i=>rr(i,n)),s=new qn(r);return new qf(e.path,s)}isEqual(e){return this===e}}function dw(t,e,n,r){const s=t.aa(1,e,n);Ka("Data must be an object, but it was:",s,r);const i=[],o=Je.empty();En(r,(l,c)=>{const u=Qa(e,l,n);c=mt(c);const d=s.ia(u);if(c instanceof Ri)i.push(u);else{const p=rr(c,d);p!=null&&(i.push(u),o.set(u,p))}});const a=new ft(i);return new Dd(o,a,s.fieldTransforms)}function pw(t,e,n,r,s,i){const o=t.aa(1,e,n),a=[Uo(e,r,n)],l=[s];if(i.length%2!=0)throw new $(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(Uo(e,i[p])),l.push(i[p+1]);const c=[],u=Je.empty();for(let p=a.length-1;p>=0;--p)if(!Od(c,a[p])){const f=a[p];let h=l[p];h=mt(h);const m=o.ia(f);if(h instanceof Ri)c.push(f);else{const w=rr(h,m);w!=null&&(c.push(f),u.set(f,w))}}const d=new ft(c);return new Dd(u,d,o.fieldTransforms)}function rr(t,e){if(Ld(t=mt(t)))return Ka("Unsupported field value:",e,t),Md(t,e);if(t instanceof Zr)return function(n,r){if(!Rd(r.Zc))throw r.oa(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=rr(o,r.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=mt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return ov(r.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Ce.fromDate(n);return{timestampValue:Ks(r.wt,s)}}if(n instanceof Ce){const s=new Ce(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ks(r.wt,s)}}if(n instanceof Ha)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Gn)return{bytesValue:ed(r.wt,n._byteString)};if(n instanceof We){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ra(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.oa(`Unsupported field value: ${$a(n)}`)}(t,e)}function Md(t,e){const n={};return Rf(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):En(t,(r,s)=>{const i=rr(s,e.ea(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Ld(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ce||t instanceof Ha||t instanceof Gn||t instanceof We||t instanceof Zr)}function Ka(t,e,n){if(!Ld(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=$a(n);throw r==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+r)}}function Uo(t,e,n){if((e=mt(e))instanceof Ai)return e._internalPath;if(typeof e=="string")return Qa(t,e);throw Ws("Field path arguments must be of type string or ",t,!1,void 0,n)}const gw=new RegExp("[~\\*/\\[\\]]");function Qa(t,e,n){if(e.search(gw)>=0)throw Ws(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ai(...e.split("."))._internalPath}catch{throw Ws(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ws(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new $(N.INVALID_ARGUMENT,a+t+l)}function Od(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new We(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new mw(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Fd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class mw extends Pd{data(){return super.data()}}function Fd(t,e){return typeof e=="string"?Qa(t,e):e instanceof Ai?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bd extends Pd{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new As(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Fd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class As extends Bd{data(e={}){return super.data(e)}}class yw{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new mr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new As(this._firestore,this._userDataWriter,r.key,r,new mr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new As(r._firestore,r._userDataWriter,o.doc.key,o.doc,new mr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new As(r._firestore,r._userDataWriter,o.doc.key,o.doc,new mr(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let l=-1,c=-1;return o.type!==0&&(l=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),c=i.indexOf(o.doc.key)),{type:vw(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function vw(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{convertValue(e,n="none"){switch(pn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(jn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Q()}}convertObject(e,n){const r={};return En(e.fields,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new Ha(be(e.latitude),be(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=xf(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Mr(e));default:return null}}convertTimestamp(e){const n=zt(e);return new Ce(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=pe.fromString(e);fe(sd(r));const s=new Vn(r.get(1),r.get(3)),i=new V(r.popFirst(5));return s.isEqual(n)||$t(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wa(t){t=bt(t,We);const e=bt(t.firestore,mn);return rw(za(e),t._key).then(n=>Ud(e,t,n))}class Vd extends bw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new We(this.firestore,null,n)}}function sn(t,e,n){t=bt(t,We);const r=bt(t.firestore,mn),s=jd(t.converter,e,n);return Xa(r,[Nd(Ga(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,gt.none())])}function $o(t,e,n,...r){t=bt(t,We);const s=bt(t.firestore,mn),i=Ga(s);let o;return o=typeof(e=mt(e))=="string"||e instanceof Ai?pw(i,"updateDoc",t._key,e,n,r):dw(i,"updateDoc",t._key,e),Xa(s,[o.toMutation(t._key,gt.exists(!0))])}function _w(t,e){const n=bt(t.firestore,mn),r=et(t),s=jd(t.converter,e);return Xa(n,[Nd(Ga(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,gt.exists(!1))]).then(()=>r)}function Ew(t,...e){var n,r,s;t=mt(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||Lc(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(Lc(e[o])){const d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(s=d.complete)===null||s===void 0?void 0:s.bind(d)}let l,c,u;if(t instanceof We)c=bt(t.firestore,mn),u=wi(t._key.path),l={next:d=>{e[o]&&e[o](Ud(c,t,d))},error:e[o+1],complete:e[o+2]};else{const d=bt(t,Si);c=bt(d.firestore,mn),u=d._query;const p=new Vd(c);l={next:f=>{e[o]&&e[o](new yw(c,p,d,f))},error:e[o+1],complete:e[o+2]},ww(t._query)}return function(d,p,f,h){const m=new Id(h),w=new vd(p,m,f);return d.asyncQueue.enqueueAndForget(async()=>md(await Vo(d),w)),()=>{m.Tc(),d.asyncQueue.enqueueAndForget(async()=>yd(await Vo(d),w))}}(za(c),u,a,l)}function Xa(t,e){return function(n,r){const s=new jt;return n.asyncQueue.enqueueAndForget(async()=>U1(await nw(n),r,s)),s.promise}(za(t),e)}function Ud(t,e,n){const r=n.docs.get(e._key),s=new Vd(t);return new Bd(t,s,e._key,r,new mr(n.hasPendingWrites,n.fromCache),e.converter)}function kw(...t){return new hw("arrayUnion",t)}function Tw(...t){return new fw("arrayRemove",t)}(function(t,e=!0){(function(n){er=n})($g),Ut(new Dt("firestore",(n,{options:r})=>{const s=n.getProvider("app").getImmediate(),i=new mn(s,new Cy(n.getProvider("auth-internal")),new Ry(n.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),i._setSettings(r),i},"PUBLIC")),wt(sc,"3.4.12",t),wt(sc,"3.4.12","esm2017")})();const Iw={apiKey:"AIzaSyAwCY1tRAE0m9SrlSXSVh6im8NJDYGmd8g",authDomain:"scrumik.firebaseapp.com",projectId:"scrumik",storageBucket:"scrumik.appspot.com",messagingSenderId:"480092253511",appId:"1:480092253511:web:6774f2fec537fd6a9a3062",measurementId:"G-KMNHLLXP8N"},$d=qg(Iw);p0($d);const tt=aw($d),Cw=[{text:"1",emoji:!1,id:"1"},{text:"2",emoji:!1,id:"2"},{text:"3",emoji:!1,id:"3"},{text:"5",emoji:!1,id:"5"},{text:"8",emoji:!1,id:"8"},{text:"13",emoji:!1,id:"13"},{text:"21",emoji:!1,id:"21"},{text:"34",emoji:!1,id:"34"},{text:"55",emoji:!1,id:"55"},{text:"\u2615",emoji:!0,id:"coffee"},{text:"\u{1F92F}",emoji:!0,id:"exploding-head"},{text:"\u{1F52D}",emoji:!0,id:"telescope"},{text:"\u2754",emoji:!0,id:"question"}],Sw=(t,e,n)=>Ew(et(t,"room",e),n),Aw=async(t,e)=>{try{return(await _w(iw(t,"room"),e)).id}catch(n){throw console.error("Error adding document: ",n),n}},Dw=async(t,e,n)=>{const r=et(t,"room",e),s=await Wa(r);if(s.exists()){const i=s.get("password");return i.passCode==""?!0:i.passCode===n}else throw new Error("No such document!")};function Rw(t){let e,n,r,s,i,o,a;return{c(){e=S("div"),n=S("h2"),n.textContent="Create Room",r=P(),s=S("form"),s.innerHTML=`<label><span class="text-sm font-bold block mb-2">Room Name</span> 
      <input type="text" name="name" placeholder="Enter a room name" autocomplete="off" required="" class="mb-4 form-input"/></label> 
    <label><span class="text-sm font-bold block mb-2">Passcode</span> 
      <input type="text" name="passCode" autocomplete="off" placeholder="Optional passcode to join room" class="mb-4 form-input"/></label> 
    <button type="submit" value="create" class="block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded">Create Room</button>`,I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(e,"class",i=`${t[0]} p-6 bg-white`)},m(l,c){H(l,e,c),T(e,n),T(e,r),T(e,s),t[3](s),o||(a=te(s,"submit",vn(Wn(t[2]))),o=!0)},p(l,[c]){c&1&&i!==(i=`${l[0]} p-6 bg-white`)&&I(e,"class",i)},i:Y,o:Y,d(l){l&&q(e),t[3](null),o=!1,a()}}}function Nw(t,e,n){let{class:r=""}=e,s;const i=async()=>{const a=new FormData(s),l={info:{name:a.get("name")},password:{passCode:a.get("passCode")},cards:Cw};try{let u=`/room/${await Aw(tt,l)}`;l.password.passCode&&(u+=`?password=${l.password.passCode}`),Go(u)}catch(c){console.error(c)}};function o(a){Pn[a?"unshift":"push"](()=>{s=a,n(1,s)})}return t.$$set=a=>{"class"in a&&n(0,r=a.class)},[r,s,i,o]}class xw extends He{constructor(e){super(),ze(this,e,Nw,Rw,Ve,{class:0})}}function Mw(t){var v;let e,n,r,s,i,o,a,l,c,u,d,p,f=((v=t[2])!=null?v:"")+"",h,m,w,g;return{c(){e=S("div"),n=S("h2"),n.textContent="Join Room",r=P(),s=S("form"),i=S("label"),i.innerHTML=`<span class="text-sm font-bold block mb-2">Room ID</span> 
      <input type="text" name="roomID" placeholder="Room ID" required="" class="mb-4 form-input"/>`,o=P(),a=S("label"),a.innerHTML=`<span class="text-sm font-bold block mb-2">Password</span> 
      <input type="password" name="passCode" placeholder="Leave it empty if don&#39;t need password" class="mb-4 form-input"/>`,l=P(),c=S("div"),u=S("button"),u.textContent="Join",d=P(),p=S("button"),h=ce(f),I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(u,"type","submit"),u.value="join",I(u,"class","border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(p,"type","button"),I(p,"class","border border-black bg-white text-black hover:bg-red-500 hover:text-white font-bold py-1 px-3 rounded"),On(p,"invisible",!t[2]),I(c,"class","block"),I(e,"class",m=`${t[0]} p-6 bg-white`)},m(k,_){H(k,e,_),T(e,n),T(e,r),T(e,s),T(s,i),T(s,o),T(s,a),T(s,l),T(s,c),T(c,u),T(c,d),T(c,p),T(p,h),t[5](s),w||(g=[te(p,"click",t[4]),te(s,"submit",vn(Wn(t[3])))],w=!0)},p(k,[_]){var y;_&4&&f!==(f=((y=k[2])!=null?y:"")+"")&&ge(h,f),_&4&&On(p,"invisible",!k[2]),_&1&&m!==(m=`${k[0]} p-6 bg-white`)&&I(e,"class",m)},i:Y,o:Y,d(k){k&&q(e),t[5](null),w=!1,rt(g)}}}function Lw(t,e,n){let{class:r=""}=e,s,i;const o=async()=>{const c=new FormData(s),u=c.get("roomID"),d=c.get("password");try{if(!await Dw(tt,u,d))throw new Error("Passcode is not correct");Go(`/room/${u}?password=${d}`)}catch(p){n(2,i=p.message)}},a=()=>n(2,i="");function l(c){Pn[c?"unshift":"push"](()=>{s=c,n(1,s)})}return t.$$set=c=>{"class"in c&&n(0,r=c.class)},[r,s,i,o,a,l]}class Ow extends He{constructor(e){super(),ze(this,e,Lw,Mw,Ve,{class:0})}}const Ya=Pr(null),co=()=>{const t=es();Ya.set(t)},on=Pr(!1),Ja=Pr(!1);var ys,Pw=new Uint8Array(16);function Fw(){if(!ys&&(ys=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ys))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ys(Pw)}const Bw=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function jw(t){return typeof t=="string"&&Bw.test(t)}var Le=[];for(var uo=0;uo<256;++uo)Le.push((uo+256).toString(16).substr(1));function Vw(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(Le[t[e+0]]+Le[t[e+1]]+Le[t[e+2]]+Le[t[e+3]]+"-"+Le[t[e+4]]+Le[t[e+5]]+"-"+Le[t[e+6]]+Le[t[e+7]]+"-"+Le[t[e+8]]+Le[t[e+9]]+"-"+Le[t[e+10]]+Le[t[e+11]]+Le[t[e+12]]+Le[t[e+13]]+Le[t[e+14]]+Le[t[e+15]]).toLowerCase();if(!jw(n))throw TypeError("Stringified UUID is invalid");return n}function qd(t,e,n){t=t||{};var r=t.random||(t.rng||Fw)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var s=0;s<16;++s)e[n+s]=r[s];return e}return Vw(r)}const Za="room",el="id",Uw=(t,e,n=!0)=>{let r=es();if(!r)r=[e];else{let s;r=r.filter(i=>i.id!=t?!0:(s=i,!1)),n&&(s={...s,...e}),r.push(s)}localStorage.setItem(Za,JSON.stringify(r))},es=()=>{const t=localStorage.getItem(Za);return t==null?null:JSON.parse(t)},$w=t=>{var r;const e=es();if(e==null)return"";const n=e.find(s=>s.id==t);return(r=n==null?void 0:n.password)!=null?r:""},qw=t=>{const e=es();if(e==null)return;const n=e.find(r=>r.id==t);return n==null?void 0:n.name},zd=t=>{const e=es();if(e==null)return;const n=e.filter(r=>r.id!==t);localStorage.setItem(Za,JSON.stringify(n)),Ya.set(n)},Hd=()=>{const t=localStorage.getItem(el);return t==null?null:JSON.parse(t)},Gd=t=>{const e=qd(),n={id:e,nick:t};return localStorage.setItem(el,JSON.stringify(n)),{id:e,nick:t}},Kd=(t,e)=>{const n={id:t,nick:e};localStorage.setItem(el,JSON.stringify(n))},Oc=t=>{t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296};class zw{constructor(e){this.dictionaries=void 0,this.length=void 0,this.separator=void 0,this.style=void 0,this.seed=void 0;const{length:n,separator:r,dictionaries:s,style:i,seed:o}=e;this.dictionaries=s,this.separator=r,this.length=n,this.style=i,this.seed=o}generate(){if(!this.dictionaries)throw new Error('Cannot find any dictionary. Please provide at least one, or leave the "dictionary" field empty in the config object');if(this.length<=0)throw new Error("Invalid length provided");if(this.length>this.dictionaries.length)throw new Error(`The length cannot be bigger than the number of dictionaries.
Length provided: ${this.length}. Number of dictionaries provided: ${this.dictionaries.length}`);let e=this.seed;return this.dictionaries.slice(0,this.length).reduce((n,r)=>{let s;e?(s=(o=>{if(typeof o=="string"){const a=o.split("").map(c=>c.charCodeAt(0)).reduce((c,u)=>c+u,1),l=Math.floor(Number(a));return Oc(l)}return Oc(o)})(e),e=4294967296*s):s=Math.random();let i=r[Math.floor(s*r.length)]||"";if(this.style==="lowerCase")i=i.toLowerCase();else if(this.style==="capital"){const[o,...a]=i.split("");i=o.toUpperCase()+a.join("")}else this.style==="upperCase"&&(i=i.toUpperCase());return n?`${n}${this.separator}${i}`:`${i}`},"")}}const Pc={separator:"_",dictionaries:[]},Hw=t=>{const e=[...t&&t.dictionaries||Pc.dictionaries],n={...Pc,...t,length:t&&t.length||e.length,dictionaries:e};if(!t||!t.dictionaries||!t.dictionaries.length)throw new Error('A "dictionaries" array must be provided. This is a breaking change introduced starting from Unique Name Generator v4. Read more about the breaking change here: https://github.com/andreasonny83/unique-names-generator#migration-guide');return new zw(n).generate()};var Gw=["aardvark","aardwolf","albatross","alligator","alpaca","amphibian","anaconda","angelfish","anglerfish","ant","anteater","antelope","antlion","ape","aphid","armadillo","asp","baboon","badger","bandicoot","barnacle","barracuda","basilisk","bass","bat","bear","beaver","bedbug","bee","beetle","bird","bison","blackbird","boa","boar","bobcat","bobolink","bonobo","booby","bovid","bug","butterfly","buzzard","camel","canid","canidae","capybara","cardinal","caribou","carp","cat","caterpillar","catfish","catshark","cattle","centipede","cephalopod","chameleon","cheetah","chickadee","chicken","chimpanzee","chinchilla","chipmunk","cicada","clam","clownfish","cobra","cockroach","cod","condor","constrictor","coral","cougar","cow","coyote","crab","crane","crawdad","crayfish","cricket","crocodile","crow","cuckoo","damselfly","deer","dingo","dinosaur","dog","dolphin","donkey","dormouse","dove","dragon","dragonfly","duck","eagle","earthworm","earwig","echidna","eel","egret","elephant","elk","emu","ermine","falcon","felidae","ferret","finch","firefly","fish","flamingo","flea","fly","flyingfish","fowl","fox","frog","galliform","gamefowl","gayal","gazelle","gecko","gerbil","gibbon","giraffe","goat","goldfish","goose","gopher","gorilla","grasshopper","grouse","guan","guanaco","guineafowl","gull","guppy","haddock","halibut","hamster","hare","harrier","hawk","hedgehog","heron","herring","hippopotamus","hookworm","hornet","horse","hoverfly","hummingbird","hyena","iguana","impala","jackal","jaguar","jay","jellyfish","junglefowl","kangaroo","kingfisher","kite","kiwi","koala","koi","krill","ladybug","lamprey","landfowl","lark","leech","lemming","lemur","leopard","leopon","limpet","lion","lizard","llama","lobster","locust","loon","louse","lungfish","lynx","macaw","mackerel","magpie","mammal","manatee","mandrill","marlin","marmoset","marmot","marsupial","marten","mastodon","meadowlark","meerkat","mink","minnow","mite","mockingbird","mole","mollusk","mongoose","monkey","moose","mosquito","moth","mouse","mule","muskox","narwhal","newt","nightingale","ocelot","octopus","opossum","orangutan","orca","ostrich","otter","owl","ox","panda","panther","parakeet","parrot","parrotfish","partridge","peacock","peafowl","pelican","penguin","perch","pheasant","pig","pigeon","pike","pinniped","piranha","planarian","platypus","pony","porcupine","porpoise","possum","prawn","primate","ptarmigan","puffin","puma","python","quail","quelea","quokka","rabbit","raccoon","rat","rattlesnake","raven","reindeer","reptile","rhinoceros","roadrunner","rodent","rook","rooster","roundworm","sailfish","salamander","salmon","sawfish","scallop","scorpion","seahorse","shark","sheep","shrew","shrimp","silkworm","silverfish","skink","skunk","sloth","slug","smelt","snail","snake","snipe","sole","sparrow","spider","spoonbill","squid","squirrel","starfish","stingray","stoat","stork","sturgeon","swallow","swan","swift","swordfish","swordtail","tahr","takin","tapir","tarantula","tarsier","termite","tern","thrush","tick","tiger","tiglon","toad","tortoise","toucan","trout","tuna","turkey","turtle","tyrannosaurus","unicorn","urial","vicuna","viper","vole","vulture","wallaby","walrus","warbler","wasp","weasel","whale","whippet","whitefish","wildcat","wildebeest","wildfowl","wolf","wolverine","wombat","woodpecker","worm","wren","xerinae","yak","zebra"],Kw=["amaranth","amber","amethyst","apricot","aqua","aquamarine","azure","beige","black","blue","blush","bronze","brown","chocolate","coffee","copper","coral","crimson","cyan","emerald","fuchsia","gold","gray","green","harlequin","indigo","ivory","jade","lavender","lime","magenta","maroon","moccasin","olive","orange","peach","pink","plum","purple","red","rose","salmon","sapphire","scarlet","silver","tan","teal","tomato","turquoise","violet","white","yellow"];const Qw={dictionaries:[Kw,Gw],separator:"-",length:2},Xs=()=>Hw(Qw);function Ww(t){let e,n,r,s;return{c(){e=S("span"),n=wl("svg"),r=wl("path"),I(r,"d",s=t[4][t[0]]),I(n,"xmlns","http://www.w3.org/2000/svg"),I(n,"width",t[2]),I(n,"height",t[1]),I(n,"viewBox","0 0 24 24"),I(e,"title",t[3]),I(e,"class",Yt(t[5]?t[5]:void 0)+" svelte-fnv3u2")},m(i,o){H(i,e,o),T(e,n),T(n,r)},p(i,[o]){o&17&&s!==(s=i[4][i[0]])&&I(r,"d",s),o&4&&I(n,"width",i[2]),o&2&&I(n,"height",i[1]),o&8&&I(e,"title",i[3])},i:Y,o:Y,d(i){i&&q(e)}}}function Xw(t,e,n){var r;(function(d){d.king="M16.896 10l-4.896-8-4.896 8-7.104-4 3 11v5h18v-5l3-11-7.104 4zm-11.896 10v-2h14v2h-14zm14.2-4h-14.4l-1.612-5.909 4.615 2.598 4.197-6.857 4.197 6.857 4.615-2.598-1.612 5.909z",d.reload="M22 3v18h-5v-2h3v-14h-6v3l-5.25-4 5.25-4v3h8zm-12 16h-6v-14h3v-2h-5v18h8v3l5.25-4-5.25-4v3z"})(r||(r={}));let{icon:s}=e,{height:i="24"}=e,{width:o="24"}=e,{class:a=void 0}=e,{position:l=void 0}=e,{title:c="icon"}=e;const u=[a,l].join(" ");return t.$$set=d=>{"icon"in d&&n(0,s=d.icon),"height"in d&&n(1,i=d.height),"width"in d&&n(2,o=d.width),"class"in d&&n(6,a=d.class),"position"in d&&n(7,l=d.position),"title"in d&&n(3,c=d.title)},[s,i,o,c,r,u,a,l]}class Yw extends He{constructor(e){super(),ze(this,e,Xw,Ww,Ve,{icon:0,height:1,width:2,class:6,position:7,title:3})}}function Fc(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 h-7 border-l border-b border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){H(s,e,i),n||(r=te(e,"click",t[4]),n=!0)},p:Y,d(s){s&&q(e),n=!1,r()}}}function Jw(t){let e,n;return{c(){e=S("span"),n=ce(t[2]),I(e,"class","font-bold text-xl px-2")},m(r,s){H(r,e,s),T(e,n)},p(r,s){s&4&&ge(n,r[2])},i:Y,o:Y,d(r){r&&q(e)}}}function Zw(t){let e,n,r,s,i,o,a,l;return i=new Yw({props:{icon:"reload",height:"1.75rem",title:"new name generate",class:"pointer-events-none"}}),{c(){e=S("form"),n=S("input"),r=P(),s=S("button"),Ie(i.$$.fragment),I(n,"class","bg-gray-100 border border-gray-200 px-2 text-xl font-bold"),I(n,"type","text"),I(s,"class","bg-white border border-black px-2 text-xl hover:bg-nl hover:text-white"),I(s,"type","button"),I(e,"class","flex items-center")},m(c,u){H(c,e,u),T(e,n),Ln(n,t[3]),T(e,r),T(e,s),_e(i,s,null),o=!0,a||(l=[te(n,"input",t[6]),te(s,"click",t[7]),te(e,"submit",vn(Wn(t[4])))],a=!0)},p(c,u){u&8&&n.value!==c[3]&&Ln(n,c[3])},i(c){o||(ee(i.$$.fragment,c),o=!0)},o(c){re(i.$$.fragment,c),o=!1},d(c){c&&q(e),Ee(i),a=!1,rt(l)}}}function eb(t){let e,n,r,s,i,o=t[1]?"Cancel":"Edit Nickname",a,l,c,u,d,p,f,h,m,w,g=t[1]&&Fc(t);const v=[Zw,Jw],k=[];function _(y,b){return y[1]?0:1}return d=_(t),p=k[d]=v[d](t),{c(){e=S("div"),n=S("div"),r=S("div"),g&&g.c(),s=P(),i=S("button"),a=ce(o),c=P(),u=S("div"),p.c(),I(i,"class",l=`float-right px-2 h-7 border-l border-b border-black self-end hover:text-white ${t[1]?"hover:bg-red-500":"hover:bg-nl"}`),I(n,"class","float-right"),I(u,"class","py-6 pl-4 pr-6"),I(e,"class",f=`${t[0]} bg-white`)},m(y,b){H(y,e,b),T(e,n),T(n,r),g&&g.m(r,null),T(r,s),T(r,i),T(i,a),T(e,c),T(e,u),k[d].m(u,null),h=!0,m||(w=te(i,"click",t[5]),m=!0)},p(y,[b]){y[1]?g?g.p(y,b):(g=Fc(y),g.c(),g.m(r,s)):g&&(g.d(1),g=null),(!h||b&2)&&o!==(o=y[1]?"Cancel":"Edit Nickname")&&ge(a,o),(!h||b&2&&l!==(l=`float-right px-2 h-7 border-l border-b border-black self-end hover:text-white ${y[1]?"hover:bg-red-500":"hover:bg-nl"}`))&&I(i,"class",l);let C=d;d=_(y),d===C?k[d].p(y,b):(xt(),re(k[C],1,1,()=>{k[C]=null}),Mt(),p=k[d],p?p.p(y,b):(p=k[d]=v[d](y),p.c()),ee(p,1),p.m(u,null)),(!h||b&1&&f!==(f=`${y[0]} bg-white`))&&I(e,"class",f)},i(y){h||(ee(p),h=!0)},o(y){re(p),h=!1},d(y){y&&q(e),g&&g.d(),k[d].d(),m=!1,w()}}}function tb(t,e,n){let r=!1,{class:s=""}=e,i="",o="",a="";const l=()=>{Kd(i,a),n(2,o=a),n(1,r=!1)},c=()=>{var h;const f=(h=Hd())!=null?h:Gd(Xs());i=f.id,n(2,o=f.nick)};wn(()=>{c(),window.addEventListener("storage",c)}),bn(()=>{window.removeEventListener("storage",c)});const u=()=>{n(1,r=!r),r&&n(3,a=o)};function d(){a=this.value,n(3,a)}const p=()=>n(3,a=Xs());return t.$$set=f=>{"class"in f&&n(0,s=f.class)},[s,r,o,a,l,u,d,p]}class nb extends He{constructor(e){super(),ze(this,e,tb,eb,Ve,{class:0})}}const rb=t=>window.confirm(t);function Bc(t,e,n){const r=t.slice();return r[3]=e[n],r}function sb(t){let e;return{c(){e=S("p"),e.textContent="No rooms yet",I(e,"class","italic")},m(n,r){H(n,e,r)},p:Y,d(n){n&&q(e)}}}function ib(t){let e,n=[],r=new Map,s=t[1];const i=o=>o[3].id;for(let o=0;o<s.length;o+=1){let a=Bc(t,s,o),l=i(a);r.set(l,n[o]=jc(l,a))}return{c(){e=S("ul");for(let o=0;o<n.length;o+=1)n[o].c()},m(o,a){H(o,e,a);for(let l=0;l<n.length;l+=1)n[l].m(e,null)},p(o,a){a&2&&(s=o[1],n=Zs(n,a,i,1,o,s,r,e,ju,jc,null,Bc))},d(o){o&&q(e);for(let a=0;a<n.length;a+=1)n[a].d()}}}function jc(t,e){let n,r,s=e[3].name+"",i,o,a,l,c,u,d;function p(){return e[2](e[3])}return{key:t,first:null,c(){n=S("li"),r=S("a"),i=ce(s),a=P(),l=S("button"),l.textContent="delete",c=P(),I(r,"class","w-full leading-10 hover:bg-green-500 hover:text-white px-2"),I(r,"href",o=`/room/${e[3].id}`),I(l,"class","border-l border-black bg-white hover:bg-red-500 hover:text-white px-2"),I(n,"class","flex justify-between odd:bg-gray-100 even:bg-gray-200 first:border-t border-b border-black"),this.first=n},m(f,h){H(f,n,h),T(n,r),T(r,i),T(n,a),T(n,l),T(n,c),u||(d=[Mu(Gu.call(null,r)),te(l,"click",p)],u=!0)},p(f,h){e=f,h&2&&s!==(s=e[3].name+"")&&ge(i,s),h&2&&o!==(o=`/room/${e[3].id}`)&&I(r,"href",o)},d(f){f&&q(n),u=!1,rt(d)}}}function ob(t){let e,n,r,s,i;function o(c,u){return c[1]!=null&&c[1].length>0?ib:sb}let a=o(t),l=a(t);return{c(){e=S("div"),n=S("h2"),n.textContent="Room List",r=P(),s=S("div"),l.c(),I(n,"class","font-semibold leading-tight mb-4 text-3xl"),I(e,"class",i=`${t[0]} p-6 bg-white`)},m(c,u){H(c,e,u),T(e,n),T(e,r),T(e,s),l.m(s,null)},p(c,[u]){a===(a=o(c))&&l?l.p(c,u):(l.d(1),l=a(c),l&&(l.c(),l.m(s,null))),u&1&&i!==(i=`${c[0]} p-6 bg-white`)&&I(e,"class",i)},i:Y,o:Y,d(c){c&&q(e),l.d()}}}function ab(t,e,n){let r;Qn(t,Ya,o=>n(1,r=o));let{class:s=""}=e;wn(()=>{co(),window.addEventListener("storage",co)}),bn(()=>{window.removeEventListener("storage",co)});const i=o=>{rb(`Are you sure to delete? [${o.name}]`)&&zd(o.id)};return t.$$set=o=>{"class"in o&&n(0,s=o.class)},[s,r,i]}class lb extends He{constructor(e){super(),ze(this,e,ab,ob,Ve,{class:0})}}function Vc(t){let e,n,r,s,i,o,a;return{c(){e=S("div"),n=S("span"),r=ce(t[0]),s=P(),i=S("button"),i.textContent="X",I(n,"class","p-2"),I(i,"class","border-l border-black bg-gray-200 hover:bg-nl px-2 float-right"),I(e,"class","border-t border-b sm:border border-black mb-3 bg-yellow-200")},m(l,c){H(l,e,c),T(e,n),T(n,r),T(e,s),T(e,i),o||(a=te(i,"click",t[2]),o=!0)},p(l,c){c&1&&ge(r,l[0])},d(l){l&&q(e),o=!1,a()}}}function cb(t){let e,n,r,s,i,o,a,l,c,u,d,p,f=t[0]&&Vc(t);return s=new Ow({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),o=new lb({props:{class:"flex-1 border-t border-b sm:border border-black h-fit"}}),c=new nb({props:{class:"border-t border-b sm:border border-black h-fit"}}),d=new xw({props:{class:"border-t border-b sm:border border-black h-fit"}}),{c(){f&&f.c(),e=P(),n=S("div"),r=S("div"),Ie(s.$$.fragment),i=P(),Ie(o.$$.fragment),a=P(),l=S("div"),Ie(c.$$.fragment),u=P(),Ie(d.$$.fragment),I(r,"class","flex flex-1 flex-col gap-3"),I(l,"class","flex flex-1 flex-col gap-3"),I(n,"class","flex flex-1 gap-3 md:flex-row flex-col")},m(h,m){f&&f.m(h,m),H(h,e,m),H(h,n,m),T(n,r),_e(s,r,null),T(r,i),_e(o,r,null),T(n,a),T(n,l),_e(c,l,null),T(l,u),_e(d,l,null),p=!0},p(h,[m]){h[0]?f?f.p(h,m):(f=Vc(h),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null)},i(h){p||(ee(s.$$.fragment,h),ee(o.$$.fragment,h),ee(c.$$.fragment,h),ee(d.$$.fragment,h),p=!0)},o(h){re(s.$$.fragment,h),re(o.$$.fragment,h),re(c.$$.fragment,h),re(d.$$.fragment,h),p=!1},d(h){f&&f.d(h),h&&q(e),h&&q(n),Ee(s),Ee(o),Ee(c),Ee(d)}}}function ub(t,e,n){let r;Qn(t,Hu,a=>n(1,r=a));let s="";const i=a=>{var u,d;const l=new URLSearchParams(a);n(0,s=(u=l.get("msg"))!=null?u:"");const c=(d=l.get("kickRoom"))!=null?d:"";c&&zd(c)},o=()=>n(0,s="");return t.$$.update=()=>{t.$$.dirty&2&&i(r)},[s,r,o]}class hb extends He{constructor(e){super(),ze(this,e,ub,cb,Ve,{})}}function fb(t){let e;return{c(){e=S("div"),e.textContent="What is that URL?",I(e,"class","border border-black bg-yellow-200 w-full text-center font-bold text-xl")},m(n,r){H(n,e,r)},p:Y,i:Y,o:Y,d(n){n&&q(e)}}}class db extends He{constructor(e){super(),ze(this,e,null,fb,Ve,{})}}const Uc=async(t,e)=>{const r=(await Wa(t)).get("password");return(r==null?void 0:r.passCode)==e},$c=async t=>(await Wa(t)).get("password"),qc=["Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M"],Kn={},Qd=(t,e)=>{if(typeof t=="string")return Kn[t]=[e,t],t;if(qc.length<=t)return;const n=qc[t];return Kn[n]=[e,n],n},Wd=t=>{delete Kn[t]},pb=t=>Kn[t]?Kn[t][1]:null,zc=t=>{if(!t.defaultPrevented){switch(t.key){case"Shift":Ja.set(!0);break;case pb(t.key):Kn[t.key][0]();break;default:return}t.preventDefault()}},Hc=t=>{if(!t.defaultPrevented){switch(t.key){case"Shift":Ja.set(!1);break;default:return}t.preventDefault()}};function Gc(t){let e,n;return{c(){e=S("span"),n=ce(t[0]),I(e,"class","h-6 w-6 bg-gray-200 border-r border-b border-black absolute top-0 left-0")},m(r,s){H(r,e,s),T(e,n)},p(r,s){s&1&&ge(n,r[0])},d(r){r&&q(e)}}}function gb(t){let e,n,r,s,i,o,a,l,c,u,d=!t[3]&&t[5]&&t[0]&&Gc(t);return{c(){e=S("button"),n=S("button"),n.textContent="-",r=P(),s=S("span"),i=ce(t[1]),a=P(),d&&d.c(),I(n,"class","h-6 w-6 bg-white hover:bg-red-500 border-l border-b border-black absolute top-0 right-0"),On(n,"hidden",!t[3]),I(s,"class",o=`${t[2]?"font-emoji":""} text-5xl pointer-events-none`),I(e,"class",l=`${t[4]} h-36 w-28 ${t[3]?"":"hover:bg-nl"} border border-black flex items-center justify-center relative`)},m(p,f){H(p,e,f),T(e,n),T(e,r),T(e,s),T(s,i),T(e,a),d&&d.m(e,null),c||(u=[te(n,"click",vn(t[7])),te(e,"click",t[6])],c=!0)},p(p,[f]){f&8&&On(n,"hidden",!p[3]),f&2&&ge(i,p[1]),f&4&&o!==(o=`${p[2]?"font-emoji":""} text-5xl pointer-events-none`)&&I(s,"class",o),!p[3]&&p[5]&&p[0]?d?d.p(p,f):(d=Gc(p),d.c(),d.m(e,null)):d&&(d.d(1),d=null),f&24&&l!==(l=`${p[4]} h-36 w-28 ${p[3]?"":"hover:bg-nl"} border border-black flex items-center justify-center relative`)&&I(e,"class",l)},i:Y,o:Y,d(p){p&&q(e),d&&d.d(),c=!1,rt(u)}}}function mb(t,e,n){let r;Qn(t,Ja,f=>n(5,r=f));let{text:s=""}=e,{emoji:i=!1}=e,{editMode:o=!1}=e,{class:a=""}=e,{index:l=-1}=e,{key:c=""}=e;const u=Lu(),d=()=>{u("click",{text:s,emoji:i})},p=()=>{u("delete")};return wn(()=>{l<0||n(0,c=Qd(l,d))}),bn(()=>{l<0||c&&Wd(c)}),t.$$set=f=>{"text"in f&&n(1,s=f.text),"emoji"in f&&n(2,i=f.emoji),"editMode"in f&&n(3,o=f.editMode),"class"in f&&n(4,a=f.class),"index"in f&&n(8,l=f.index),"key"in f&&n(0,c=f.key)},[c,s,i,o,a,r,d,p,l]}class Ni extends He{constructor(e){super(),ze(this,e,mb,gb,Ve,{text:1,emoji:2,editMode:3,class:4,index:8,key:0})}}const Xd=(t,e)=>isNaN(+t)&&isNaN(+e)?t.localeCompare(e):isNaN(+t)?1:isNaN(+e)?-1:+t-+e,ut=t=>t.id?t.id:t.text+t.emoji.toString();function Kc(t,e,n){const r=t.slice();return r[32]=e[n],r[34]=n,r}function Qc(t,e,n){const r=t.slice();return r[29]=e[n],r}function Wc(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 bg-white h-7 border-l border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){H(s,e,i),n||(r=te(e,"click",t[12]),n=!0)},p:Y,d(s){s&&q(e),n=!1,r()}}}function yb(t){let e,n=[],r=new Map,s,i=t[0].sort(t[25]);const o=a=>a[32].text;for(let a=0;a<i.length;a+=1){let l=Kc(t,i,a),c=o(l);r.set(c,n[a]=Xc(c,l))}return{c(){e=S("div");for(let a=0;a<n.length;a+=1)n[a].c();I(e,"class","grid justify-between auto-fill-col gap-2 svelte-9d72rf")},m(a,l){H(a,e,l);for(let c=0;c<n.length;c+=1)n[c].m(e,null);s=!0},p(a,l){l[0]&1025&&(i=a[0].sort(a[25]),xt(),n=Zs(n,l,o,1,a,i,r,e,Vu,Xc,null,Kc),Mt())},i(a){if(!s){for(let l=0;l<i.length;l+=1)ee(n[l]);s=!0}},o(a){for(let l=0;l<n.length;l+=1)re(n[l]);s=!1},d(a){a&&q(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function vb(t){let e,n=[],r=new Map,s,i,o,a=t[5];const l=c=>ut(c[29]);for(let c=0;c<a.length;c+=1){let u=Qc(t,a,c),d=l(u);r.set(d,n[c]=Yc(d,u))}return i=new Ni({props:{class:"bg-yellow-200 hover:bg-indigo-400",text:"+"}}),i.$on("click",t[24]),{c(){e=S("div");for(let c=0;c<n.length;c+=1)n[c].c();s=P(),Ie(i.$$.fragment),I(e,"class","grid justify-between auto-fill-col gap-2 svelte-9d72rf")},m(c,u){H(c,e,u);for(let d=0;d<n.length;d+=1)n[d].m(e,null);T(e,s),_e(i,e,null),o=!0},p(c,u){u[0]&57764&&(a=c[5],xt(),n=Zs(n,u,l,1,c,a,r,e,Vu,Yc,s,Qc),Mt())},i(c){if(!o){for(let u=0;u<a.length;u+=1)ee(n[u]);ee(i.$$.fragment,c),o=!0}},o(c){for(let u=0;u<n.length;u+=1)re(n[u]);re(i.$$.fragment,c),o=!1},d(c){c&&q(e);for(let u=0;u<n.length;u+=1)n[u].d();Ee(i)}}}function Xc(t,e){let n,r,s;return r=new Ni({props:{text:e[32].text,emoji:e[32].emoji,index:e[34]}}),r.$on("click",e[10]),{key:t,first:null,c(){n=yn(),Ie(r.$$.fragment),this.first=n},m(i,o){H(i,n,o),_e(r,i,o),s=!0},p(i,o){e=i;const a={};o[0]&1&&(a.text=e[32].text),o[0]&1&&(a.emoji=e[32].emoji),o[0]&1&&(a.index=e[34]),r.$set(a)},i(i){s||(ee(r.$$.fragment,i),s=!0)},o(i){re(r.$$.fragment,i),s=!1},d(i){i&&q(n),Ee(r,i)}}}function Yc(t,e){let n,r,s;function i(){return e[23](e[29])}return r=new Ni({props:{class:`${e[2]?`${e[7][ut(e[29])]?"stripe-gray":`${e[8][ut(e[29])]?"bg-indigo-200":"bg-gray-100"}`} cursor-not-allowed`:"bg-white"}`,text:e[29].text,emoji:e[29].emoji,editMode:e[2]}}),r.$on("delete",i),{key:t,first:null,c(){n=yn(),Ie(r.$$.fragment),this.first=n},m(o,a){H(o,n,a),_e(r,o,a),s=!0},p(o,a){e=o;const l={};a[0]&420&&(l.class=`${e[2]?`${e[7][ut(e[29])]?"stripe-gray":`${e[8][ut(e[29])]?"bg-indigo-200":"bg-gray-100"}`} cursor-not-allowed`:"bg-white"}`),a[0]&32&&(l.text=e[29].text),a[0]&32&&(l.emoji=e[29].emoji),a[0]&4&&(l.editMode=e[2]),r.$set(l)},i(o){s||(ee(r.$$.fragment,o),s=!0)},o(o){re(r.$$.fragment,o),s=!1},d(o){o&&q(n),Ee(r,o)}}}function wb(t){let e,n,r,s,i,o,a=t[2]?"Cancel":"Edit",l,c,u,d,p,f,h,m,w,g,v,k,_,y,b,C,E,D,L,A,U,M,B,R,F,z,Te,se,he,le,Xe,Lt,yt,ye,Et,Wt,ne=t[2]&&Wc(t);h=new Ni({props:{class:"bg-white",text:t[4].text,emoji:t[4].emoji}});const kt=[vb,yb],ct=[];function De(K,ve){return K[2]?0:1}return he=De(t),le=ct[he]=kt[he](t),{c(){e=S("div"),n=S("div"),r=S("button"),r.textContent="Clear My Vote",s=P(),ne&&ne.c(),i=P(),o=S("button"),l=ce(a),u=P(),d=S("div"),p=S("div"),f=S("div"),Ie(h.$$.fragment),m=P(),w=S("div"),g=S("form"),v=S("label"),k=S("span"),k.textContent="Card Text",_=P(),y=S("input"),b=P(),C=S("label"),E=S("span"),E.textContent="Use Noto-Emoji Font",D=P(),L=S("input"),A=P(),U=S("a"),U.textContent="Show Noto Emojies",M=P(),B=S("button"),B.textContent="New Card",R=P(),F=S("button"),F.textContent="Cancel",Te=P(),se=S("div"),le.c(),I(r,"class","flex-1 px-2 bg-white hover:bg-nl hover:text-white"),I(o,"class",c=Yt(`px-2 bg-white h-7 border-l border-black self-end hover:text-white ${t[2]?"hover:bg-red-500":"hover:bg-nl"}`)+" svelte-9d72rf"),I(n,"class","w-full border-b border-black flex flex-wrap justify-end box-content"),I(k,"class","text-sm font-bold block mb-2"),I(y,"type","text"),I(y,"name","cardText"),I(y,"placeholder","&MF"),I(y,"autocomplete","off"),y.required=!0,I(y,"class","mb-2 form-input"),I(E,"class","text-sm font-bold block pr-4"),I(L,"type","checkbox"),I(L,"name","icon"),I(C,"class","flex mb-4"),I(U,"href","https://glyphs.devusage.com/#/fonts/Noto%20Emoji"),I(U,"target","_blank"),I(U,"class","block mb-2 border-b border-t border-gray-600 hover:bg-yellow-200"),I(B,"type","submit"),B.value="create",I(B,"class","border border-black bg-white text-black hover:bg-green-500 hover:text-white font-bold py-1 px-3 rounded"),I(F,"type","button"),I(F,"class","border border-black bg-white text-black hover:bg-red-500 hover:text-white font-bold py-1 px-3 rounded"),I(w,"class","bg-white"),I(f,"class","p-2 h-full border border-black bg-white flex justify-around gap-2 items-center"),I(f,"style",z=`min-height: ${t[6]}px;`),I(p,"class","p-6 relative bg-gray-300 bg-opacity-90 w-full h-full z-10"),On(p,"hidden",!t[3]),I(se,"class",Xe=Yt(`${t[3]?"absolute top-0 left-0":"relative"} p-2 w-full`)+" svelte-9d72rf"),Ds(()=>t[26].call(se)),I(d,"class","relative"),I(e,"class",yt=Yt(`${t[1]} relative`)+" svelte-9d72rf")},m(K,ve){H(K,e,ve),T(e,n),T(n,r),T(n,s),ne&&ne.m(n,null),T(n,i),T(n,o),T(o,l),T(e,u),T(e,d),T(d,p),T(p,f),_e(h,f,null),T(f,m),T(f,w),T(w,g),T(g,v),T(v,k),T(v,_),T(v,y),Ln(y,t[4].text),T(g,b),T(g,C),T(C,E),T(C,D),T(C,L),L.checked=t[4].emoji,T(g,A),T(g,U),T(g,M),T(g,B),T(g,R),T(g,F),T(d,Te),T(d,se),ct[he].m(se,null),Lt=gp(se,t[26].bind(se)),ye=!0,Et||(Wt=[te(r,"click",t[18]),te(o,"click",t[19]),te(y,"input",t[20]),te(L,"change",t[21]),te(F,"click",t[22]),te(g,"submit",vn(Wn(t[11])))],Et=!0)},p(K,ve){K[2]?ne?ne.p(K,ve):(ne=Wc(K),ne.c(),ne.m(n,i)):ne&&(ne.d(1),ne=null),(!ye||ve[0]&4)&&a!==(a=K[2]?"Cancel":"Edit")&&ge(l,a),(!ye||ve[0]&4&&c!==(c=Yt(`px-2 bg-white h-7 border-l border-black self-end hover:text-white ${K[2]?"hover:bg-red-500":"hover:bg-nl"}`)+" svelte-9d72rf"))&&I(o,"class",c);const vt={};ve[0]&16&&(vt.text=K[4].text),ve[0]&16&&(vt.emoji=K[4].emoji),h.$set(vt),ve[0]&16&&y.value!==K[4].text&&Ln(y,K[4].text),ve[0]&16&&(L.checked=K[4].emoji),(!ye||ve[0]&64&&z!==(z=`min-height: ${K[6]}px;`))&&I(f,"style",z),ve[0]&8&&On(p,"hidden",!K[3]);let Tn=he;he=De(K),he===Tn?ct[he].p(K,ve):(xt(),re(ct[Tn],1,1,()=>{ct[Tn]=null}),Mt(),le=ct[he],le?le.p(K,ve):(le=ct[he]=kt[he](K),le.c()),ee(le,1),le.m(se,null)),(!ye||ve[0]&8&&Xe!==(Xe=Yt(`${K[3]?"absolute top-0 left-0":"relative"} p-2 w-full`)+" svelte-9d72rf"))&&I(se,"class",Xe),(!ye||ve[0]&2&&yt!==(yt=Yt(`${K[1]} relative`)+" svelte-9d72rf"))&&I(e,"class",yt)},i(K){ye||(ee(h.$$.fragment,K),ee(le),ye=!0)},o(K){re(h.$$.fragment,K),re(le),ye=!1},d(K){K&&q(e),ne&&ne.d(),Ee(h),ct[he].d(),Lt(),Et=!1,rt(Wt)}}}function bb(t,e,n){let r;Qn(t,on,F=>n(27,r=F));let{cardDeck:s=[]}=e,{class:i=""}=e,{id:o=""}=e,{nickID:a=""}=e,l=!1,c=!1;const u={text:"X",emoji:!1};let d={...u},p,f;const h=F=>{if(r)return;const z=et(tt,"room",o);sn(z,{people:{[a]:{card:F.detail}}},{merge:!0})},m=()=>{const F=qd(),z={text:d.text,emoji:d.emoji,id:F};n(5,p=[...p,z]),y(F,z),n(3,c=!1),n(4,d={...u})},w=async()=>{const F=et(tt,"room",o);try{await $o(F,{cards:Tw(...Object.values(g))}),await $o(F,{cards:kw(...Object.values(_))})}catch(z){console.error(z)}n(3,c=!1),n(4,d={...u}),n(7,g={}),n(8,_={}),n(2,l=!1)};let g={};const v=(F,z)=>{n(7,g[F]=z,g),n(7,g={...g})},k=F=>{delete g[F],n(7,g={...g})};let _={};const y=(F,z)=>{n(8,_[F]=z,_)},b=F=>{delete _[F],n(8,_={..._})};wn(()=>{Qd("Backspace",()=>h({detail:""}))}),bn(()=>{Wd("Backspace")});const C=()=>h({detail:""}),E=()=>{if(n(2,l=!l),l){n(5,p=s.slice());return}n(3,c=!1),n(4,d={...u}),n(7,g={}),n(8,_={})};function D(){d.text=this.value,n(4,d)}function L(){d.emoji=this.checked,n(4,d)}const A=()=>{n(3,c=!1),n(4,d={...u})},U=F=>{_[ut(F)]?(b(ut(F)),n(5,p=[...p.filter(z=>ut(z)!=ut(F))])):g[ut(F)]?k(ut(F)):v(ut(F),F)},M=()=>{n(3,c=!0)},B=(F,z)=>Xd(F.text,z.text);function R(){f=this.offsetHeight,n(6,f)}return t.$$set=F=>{"cardDeck"in F&&n(0,s=F.cardDeck),"class"in F&&n(1,i=F.class),"id"in F&&n(16,o=F.id),"nickID"in F&&n(17,a=F.nickID)},[s,i,l,c,d,p,f,g,_,u,h,m,w,v,k,b,o,a,C,E,D,L,A,U,M,B,R]}class _b extends He{constructor(e){super(),ze(this,e,bb,wb,Ve,{cardDeck:0,class:1,id:16,nickID:17},null,[-1,-1])}}var xe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yd={},tl={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.QRMath=t.QRUtil=t.QRMaskPattern=t.QRErrorCorrectLevel=t.QRCodeModel=void 0;function e(f,h,m){var w=r(h),g=f-1,v=0;switch(m){case t.QRErrorCorrectLevel.L:v=p[g][0];break;case t.QRErrorCorrectLevel.M:v=p[g][1];break;case t.QRErrorCorrectLevel.Q:v=p[g][2];break;case t.QRErrorCorrectLevel.H:v=p[g][3];break}return w<=v}function n(f,h){for(var m=1,w=r(f),g=0,v=p.length;g<v;g++){var k=0;switch(h){case t.QRErrorCorrectLevel.L:k=p[g][0];break;case t.QRErrorCorrectLevel.M:k=p[g][1];break;case t.QRErrorCorrectLevel.Q:k=p[g][2];break;case t.QRErrorCorrectLevel.H:k=p[g][3];break}if(w<=k)break;m++}if(m>p.length)throw new Error("Too long data");return m}function r(f){var h=encodeURI(f).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return h.length+(h.length!=Number(f)?3:0)}var s=function(){function f(h){this.mode=o.MODE_8BIT_BYTE,this.parsedData=[],this.data=h;for(var m=[],w=0,g=this.data.length;w<g;w++){var v=[],k=this.data.charCodeAt(w);k>65536?(v[0]=240|(k&1835008)>>>18,v[1]=128|(k&258048)>>>12,v[2]=128|(k&4032)>>>6,v[3]=128|k&63):k>2048?(v[0]=224|(k&61440)>>>12,v[1]=128|(k&4032)>>>6,v[2]=128|k&63):k>128?(v[0]=192|(k&1984)>>>6,v[1]=128|k&63):v[0]=k,m.push(v)}this.parsedData=Array.prototype.concat.apply([],m),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return f.prototype.getLength=function(){return this.parsedData.length},f.prototype.write=function(h){for(var m=0,w=this.parsedData.length;m<w;m++)h.put(this.parsedData[m],8)},f}(),i=function(){function f(h,m){h===void 0&&(h=-1),m===void 0&&(m=t.QRErrorCorrectLevel.L),this.moduleCount=0,this.dataList=[],this.typeNumber=h,this.errorCorrectLevel=m,this.moduleCount=0,this.dataList=[]}return f.prototype.addData=function(h){if(this.typeNumber<=0)this.typeNumber=n(h,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error("Invalid QR version: "+this.typeNumber);if(!e(this.typeNumber,h,this.errorCorrectLevel))throw new Error("Data is too long for QR version: "+this.typeNumber)}var m=new s(h);this.dataList.push(m),this.dataCache=void 0},f.prototype.isDark=function(h,m){if(h<0||this.moduleCount<=h||m<0||this.moduleCount<=m)throw new Error(h+","+m);return this.modules[h][m]},f.prototype.getModuleCount=function(){return this.moduleCount},f.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},f.prototype.makeImpl=function(h,m){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var w=0;w<this.moduleCount;w++){this.modules[w]=new Array(this.moduleCount);for(var g=0;g<this.moduleCount;g++)this.modules[w][g]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(h,m),this.typeNumber>=7&&this.setupTypeNumber(h),this.dataCache==null&&(this.dataCache=f.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,m)},f.prototype.setupPositionProbePattern=function(h,m){for(var w=-1;w<=7;w++)if(!(h+w<=-1||this.moduleCount<=h+w))for(var g=-1;g<=7;g++)m+g<=-1||this.moduleCount<=m+g||(0<=w&&w<=6&&(g==0||g==6)||0<=g&&g<=6&&(w==0||w==6)||2<=w&&w<=4&&2<=g&&g<=4?this.modules[h+w][m+g]=!0:this.modules[h+w][m+g]=!1)},f.prototype.getBestMaskPattern=function(){if(Number.isInteger(this.maskPattern)&&Object.values(t.QRMaskPattern).includes(this.maskPattern))return this.maskPattern;for(var h=0,m=0,w=0;w<8;w++){this.makeImpl(!0,w);var g=a.getLostPoint(this);(w==0||h>g)&&(h=g,m=w)}return m},f.prototype.setupTimingPattern=function(){for(var h=8;h<this.moduleCount-8;h++)this.modules[h][6]==null&&(this.modules[h][6]=h%2==0);for(var m=8;m<this.moduleCount-8;m++)this.modules[6][m]==null&&(this.modules[6][m]=m%2==0)},f.prototype.setupPositionAdjustPattern=function(){for(var h=a.getPatternPosition(this.typeNumber),m=0;m<h.length;m++)for(var w=0;w<h.length;w++){var g=h[m],v=h[w];if(this.modules[g][v]==null)for(var k=-2;k<=2;k++)for(var _=-2;_<=2;_++)k==-2||k==2||_==-2||_==2||k==0&&_==0?this.modules[g+k][v+_]=!0:this.modules[g+k][v+_]=!1}},f.prototype.setupTypeNumber=function(h){for(var m=a.getBCHTypeNumber(this.typeNumber),w=0;w<18;w++){var g=!h&&(m>>w&1)==1;this.modules[Math.floor(w/3)][w%3+this.moduleCount-8-3]=g}for(var w=0;w<18;w++){var g=!h&&(m>>w&1)==1;this.modules[w%3+this.moduleCount-8-3][Math.floor(w/3)]=g}},f.prototype.setupTypeInfo=function(h,m){for(var w=this.errorCorrectLevel<<3|m,g=a.getBCHTypeInfo(w),v=0;v<15;v++){var k=!h&&(g>>v&1)==1;v<6?this.modules[v][8]=k:v<8?this.modules[v+1][8]=k:this.modules[this.moduleCount-15+v][8]=k}for(var v=0;v<15;v++){var k=!h&&(g>>v&1)==1;v<8?this.modules[8][this.moduleCount-v-1]=k:v<9?this.modules[8][15-v-1+1]=k:this.modules[8][15-v-1]=k}this.modules[this.moduleCount-8][8]=!h},f.prototype.mapData=function(h,m){for(var w=-1,g=this.moduleCount-1,v=7,k=0,_=this.moduleCount-1;_>0;_-=2)for(_==6&&_--;;){for(var y=0;y<2;y++)if(this.modules[g][_-y]==null){var b=!1;k<h.length&&(b=(h[k]>>>v&1)==1);var C=a.getMask(m,g,_-y);C&&(b=!b),this.modules[g][_-y]=b,v--,v==-1&&(k++,v=7)}if(g+=w,g<0||this.moduleCount<=g){g-=w,w=-w;break}}},f.createData=function(h,m,w){for(var g=u.getRSBlocks(h,m),v=new d,k=0;k<w.length;k++){var _=w[k];v.put(_.mode,4),v.put(_.getLength(),a.getLengthInBits(_.mode,h)),_.write(v)}for(var y=0,k=0;k<g.length;k++)y+=g[k].dataCount;if(v.getLengthInBits()>y*8)throw new Error("code length overflow. ("+v.getLengthInBits()+">"+y*8+")");for(v.getLengthInBits()+4<=y*8&&v.put(0,4);v.getLengthInBits()%8!=0;)v.putBit(!1);for(;!(v.getLengthInBits()>=y*8||(v.put(f.PAD0,8),v.getLengthInBits()>=y*8));)v.put(f.PAD1,8);return f.createBytes(v,g)},f.createBytes=function(h,m){for(var w=0,g=0,v=0,k=new Array(m.length),_=new Array(m.length),y=0;y<m.length;y++){var b=m[y].dataCount,C=m[y].totalCount-b;g=Math.max(g,b),v=Math.max(v,C),k[y]=new Array(b);for(var E=0;E<k[y].length;E++)k[y][E]=255&h.buffer[E+w];w+=b;var D=a.getErrorCorrectPolynomial(C),L=new c(k[y],D.getLength()-1),A=L.mod(D);_[y]=new Array(D.getLength()-1);for(var E=0;E<_[y].length;E++){var U=E+A.getLength()-_[y].length;_[y][E]=U>=0?A.get(U):0}}for(var M=0,E=0;E<m.length;E++)M+=m[E].totalCount;for(var B=new Array(M),R=0,E=0;E<g;E++)for(var y=0;y<m.length;y++)E<k[y].length&&(B[R++]=k[y][E]);for(var E=0;E<v;E++)for(var y=0;y<m.length;y++)E<_[y].length&&(B[R++]=_[y][E]);return B},f.PAD0=236,f.PAD1=17,f}();t.QRCodeModel=i,t.QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var o={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};t.QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var a=function(){function f(){}return f.getBCHTypeInfo=function(h){for(var m=h<<10;f.getBCHDigit(m)-f.getBCHDigit(f.G15)>=0;)m^=f.G15<<f.getBCHDigit(m)-f.getBCHDigit(f.G15);return(h<<10|m)^f.G15_MASK},f.getBCHTypeNumber=function(h){for(var m=h<<12;f.getBCHDigit(m)-f.getBCHDigit(f.G18)>=0;)m^=f.G18<<f.getBCHDigit(m)-f.getBCHDigit(f.G18);return h<<12|m},f.getBCHDigit=function(h){for(var m=0;h!=0;)m++,h>>>=1;return m},f.getPatternPosition=function(h){return f.PATTERN_POSITION_TABLE[h-1]},f.getMask=function(h,m,w){switch(h){case t.QRMaskPattern.PATTERN000:return(m+w)%2==0;case t.QRMaskPattern.PATTERN001:return m%2==0;case t.QRMaskPattern.PATTERN010:return w%3==0;case t.QRMaskPattern.PATTERN011:return(m+w)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(m/2)+Math.floor(w/3))%2==0;case t.QRMaskPattern.PATTERN101:return m*w%2+m*w%3==0;case t.QRMaskPattern.PATTERN110:return(m*w%2+m*w%3)%2==0;case t.QRMaskPattern.PATTERN111:return(m*w%3+(m+w)%2)%2==0;default:throw new Error("bad maskPattern:"+h)}},f.getErrorCorrectPolynomial=function(h){for(var m=new c([1],0),w=0;w<h;w++)m=m.multiply(new c([1,l.gexp(w)],0));return m},f.getLengthInBits=function(h,m){if(1<=m&&m<10)switch(h){case o.MODE_NUMBER:return 10;case o.MODE_ALPHA_NUM:return 9;case o.MODE_8BIT_BYTE:return 8;case o.MODE_KANJI:return 8;default:throw new Error("mode:"+h)}else if(m<27)switch(h){case o.MODE_NUMBER:return 12;case o.MODE_ALPHA_NUM:return 11;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 10;default:throw new Error("mode:"+h)}else if(m<41)switch(h){case o.MODE_NUMBER:return 14;case o.MODE_ALPHA_NUM:return 13;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 12;default:throw new Error("mode:"+h)}else throw new Error("type:"+m)},f.getLostPoint=function(h){for(var m=h.getModuleCount(),w=0,g=0;g<m;g++)for(var v=0;v<m;v++){for(var k=0,_=h.isDark(g,v),y=-1;y<=1;y++)if(!(g+y<0||m<=g+y))for(var b=-1;b<=1;b++)v+b<0||m<=v+b||y==0&&b==0||_==h.isDark(g+y,v+b)&&k++;k>5&&(w+=3+k-5)}for(var g=0;g<m-1;g++)for(var v=0;v<m-1;v++){var C=0;h.isDark(g,v)&&C++,h.isDark(g+1,v)&&C++,h.isDark(g,v+1)&&C++,h.isDark(g+1,v+1)&&C++,(C==0||C==4)&&(w+=3)}for(var g=0;g<m;g++)for(var v=0;v<m-6;v++)h.isDark(g,v)&&!h.isDark(g,v+1)&&h.isDark(g,v+2)&&h.isDark(g,v+3)&&h.isDark(g,v+4)&&!h.isDark(g,v+5)&&h.isDark(g,v+6)&&(w+=40);for(var v=0;v<m;v++)for(var g=0;g<m-6;g++)h.isDark(g,v)&&!h.isDark(g+1,v)&&h.isDark(g+2,v)&&h.isDark(g+3,v)&&h.isDark(g+4,v)&&!h.isDark(g+5,v)&&h.isDark(g+6,v)&&(w+=40);for(var E=0,v=0;v<m;v++)for(var g=0;g<m;g++)h.isDark(g,v)&&E++;var D=Math.abs(100*E/m/m-50)/5;return w+=D*10,w},f.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],f.G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,f.G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,f.G15_MASK=1<<14|1<<12|1<<10|1<<4|1<<1,f}();t.QRUtil=a;var l=function(){function f(){}return f.glog=function(h){if(h<1)throw new Error("glog("+h+")");return f.LOG_TABLE[h]},f.gexp=function(h){for(;h<0;)h+=255;for(;h>=256;)h-=255;return f.EXP_TABLE[h]},f.EXP_TABLE=new Array(256),f.LOG_TABLE=new Array(256),f._constructor=function(){for(var h=0;h<8;h++)f.EXP_TABLE[h]=1<<h;for(var h=8;h<256;h++)f.EXP_TABLE[h]=f.EXP_TABLE[h-4]^f.EXP_TABLE[h-5]^f.EXP_TABLE[h-6]^f.EXP_TABLE[h-8];for(var h=0;h<255;h++)f.LOG_TABLE[f.EXP_TABLE[h]]=h}(),f}();t.QRMath=l;var c=function(){function f(h,m){if(h.length==null)throw new Error(h.length+"/"+m);for(var w=0;w<h.length&&h[w]==0;)w++;this.num=new Array(h.length-w+m);for(var g=0;g<h.length-w;g++)this.num[g]=h[g+w]}return f.prototype.get=function(h){return this.num[h]},f.prototype.getLength=function(){return this.num.length},f.prototype.multiply=function(h){for(var m=new Array(this.getLength()+h.getLength()-1),w=0;w<this.getLength();w++)for(var g=0;g<h.getLength();g++)m[w+g]^=l.gexp(l.glog(this.get(w))+l.glog(h.get(g)));return new f(m,0)},f.prototype.mod=function(h){if(this.getLength()-h.getLength()<0)return this;for(var m=l.glog(this.get(0))-l.glog(h.get(0)),w=new Array(this.getLength()),g=0;g<this.getLength();g++)w[g]=this.get(g);for(var g=0;g<h.getLength();g++)w[g]^=l.gexp(l.glog(h.get(g))+m);return new f(w,0).mod(h)},f}(),u=function(){function f(h,m){this.totalCount=h,this.dataCount=m}return f.getRSBlocks=function(h,m){var w=f.getRsBlockTable(h,m);if(w==null)throw new Error("bad rs block @ typeNumber:"+h+"/errorCorrectLevel:"+m);for(var g=w.length/3,v=[],k=0;k<g;k++)for(var _=w[k*3+0],y=w[k*3+1],b=w[k*3+2],C=0;C<_;C++)v.push(new f(y,b));return v},f.getRsBlockTable=function(h,m){switch(m){case t.QRErrorCorrectLevel.L:return f.RS_BLOCK_TABLE[(h-1)*4+0];case t.QRErrorCorrectLevel.M:return f.RS_BLOCK_TABLE[(h-1)*4+1];case t.QRErrorCorrectLevel.Q:return f.RS_BLOCK_TABLE[(h-1)*4+2];case t.QRErrorCorrectLevel.H:return f.RS_BLOCK_TABLE[(h-1)*4+3];default:return}},f.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],f}(),d=function(){function f(){this.buffer=[],this.length=0}return f.prototype.get=function(h){var m=Math.floor(h/8);return(this.buffer[m]>>>7-h%8&1)==1},f.prototype.put=function(h,m){for(var w=0;w<m;w++)this.putBit((h>>>m-w-1&1)==1)},f.prototype.getLengthInBits=function(){return this.length},f.prototype.putBit=function(h){var m=Math.floor(this.length/8);this.buffer.length<=m&&this.buffer.push(0),h&&(this.buffer[m]|=128>>>this.length%8),this.length++},f}(),p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]]})(tl);var xi={},ts={};const Eb="bold|bolder|lighter|[1-9]00",kb="italic|oblique",Tb="small-caps",Ib="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",Cb="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",Jc=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,Sb=new RegExp(`(${Eb}) +`,"i"),Ab=new RegExp(`(${kb}) +`,"i"),Db=new RegExp(`(${Tb}) +`,"i"),Rb=new RegExp(`(${Ib}) +`,"i"),Nb=new RegExp(`([\\d\\.]+)(${Cb}) *((?:${Jc})( *, *(?:${Jc}))*)`),ho={},xb=16;var Mb=t=>{if(ho[t])return ho[t];const e=Nb.exec(t);if(!e)return;const n={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(e[1]),unit:e[2],family:e[3].replace(/["']/g,"").replace(/ *, */g,",")};let r,s,i,o;const a=t.substring(0,e.index);switch((r=Sb.exec(a))&&(n.weight=r[1]),(s=Ab.exec(a))&&(n.style=s[1]),(i=Db.exec(a))&&(n.variant=i[1]),(o=Rb.exec(a))&&(n.stretch=o[1]),n.unit){case"pt":n.size/=.75;break;case"pc":n.size*=16;break;case"in":n.size*=96;break;case"cm":n.size*=96/2.54;break;case"mm":n.size*=96/25.4;break;case"%":break;case"em":case"rem":n.size*=xb/.75;break;case"q":n.size*=96/25.4/4;break}return ho[t]=n};const Lb=Mb;ts.parseFont=Lb;ts.createCanvas=function(t,e){return Object.assign(document.createElement("canvas"),{width:t,height:e})};ts.createImageData=function(t,e,n){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(t);case 2:return new ImageData(t,e);default:return new ImageData(t,e,n)}};ts.loadImage=function(t,e){return new Promise(function(n,r){const s=Object.assign(document.createElement("img"),e);function i(){s.onload=null,s.onerror=null}s.onload=function(){i(),n(s)},s.onerror=function(){i(),r(new Error('Failed to load the image "'+t+'"'))},s.src=t})};var Jd={},Zd={},At={};Object.defineProperty(At,"__esModule",{value:!0});At.loop=At.conditional=At.parse=void 0;var Ob=function t(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;if(Array.isArray(n))n.forEach(function(o){return t(e,o,r,s)});else if(typeof n=="function")n(e,r,s,t);else{var i=Object.keys(n)[0];Array.isArray(n[i])?(s[i]={},t(e,n[i],r,s[i])):s[i]=n[i](e,r,s,t)}return r};At.parse=Ob;var Pb=function(e,n){return function(r,s,i,o){n(r,s,i)&&o(r,e,s,i)}};At.conditional=Pb;var Fb=function(e,n){return function(r,s,i,o){for(var a=[],l=r.pos;n(r,s,i);){var c={};if(o(r,e,s,c),r.pos===l)break;l=r.pos,a.push(c)}return a}};At.loop=Fb;var me={};Object.defineProperty(me,"__esModule",{value:!0});me.readBits=me.readArray=me.readUnsigned=me.readString=me.peekBytes=me.readBytes=me.peekByte=me.readByte=me.buildStream=void 0;var Bb=function(e){return{data:e,pos:0}};me.buildStream=Bb;var ep=function(){return function(e){return e.data[e.pos++]}};me.readByte=ep;var jb=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(n){return n.data[n.pos+e]}};me.peekByte=jb;var Mi=function(e){return function(n){return n.data.subarray(n.pos,n.pos+=e)}};me.readBytes=Mi;var Vb=function(e){return function(n){return n.data.subarray(n.pos,n.pos+e)}};me.peekBytes=Vb;var Ub=function(e){return function(n){return Array.from(Mi(e)(n)).map(function(r){return String.fromCharCode(r)}).join("")}};me.readString=Ub;var $b=function(e){return function(n){var r=Mi(2)(n);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}};me.readUnsigned=$b;var qb=function(e,n){return function(r,s,i){for(var o=typeof n=="function"?n(r,s,i):n,a=Mi(e),l=new Array(o),c=0;c<o;c++)l[c]=a(r);return l}};me.readArray=qb;var zb=function(e,n,r){for(var s=0,i=0;i<r;i++)s+=e[n+i]&&Math.pow(2,r-i-1);return s},Hb=function(e){return function(n){for(var r=ep()(n),s=new Array(8),i=0;i<8;i++)s[7-i]=!!(r&1<<i);return Object.keys(e).reduce(function(o,a){var l=e[a];return l.length?o[a]=zb(s,l.index,l.length):o[a]=s[l.index],o},{})}};me.readBits=Hb;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=At,n=me,r={blocks:function(p){for(var f=0,h=[],m=p.data.length,w=0,g=(0,n.readByte)()(p);g!==f&&g;g=(0,n.readByte)()(p)){if(p.pos+g>=m){var v=m-p.pos;h.push((0,n.readBytes)(v)(p)),w+=v;break}h.push((0,n.readBytes)(g)(p)),w+=g}for(var k=new Uint8Array(w),_=0,y=0;y<h.length;y++)k.set(h[y],_),_+=h[y].length;return k}},s=(0,e.conditional)({gce:[{codes:(0,n.readBytes)(2)},{byteSize:(0,n.readByte)()},{extras:(0,n.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,n.readUnsigned)(!0)},{transparentColorIndex:(0,n.readByte)()},{terminator:(0,n.readByte)()}]},function(d){var p=(0,n.peekBytes)(2)(d);return p[0]===33&&p[1]===249}),i=(0,e.conditional)({image:[{code:(0,n.readByte)()},{descriptor:[{left:(0,n.readUnsigned)(!0)},{top:(0,n.readUnsigned)(!0)},{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{lct:(0,n.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,e.conditional)({lct:(0,n.readArray)(3,function(d,p,f){return Math.pow(2,f.descriptor.lct.size+1)})},function(d,p,f){return f.descriptor.lct.exists}),{data:[{minCodeSize:(0,n.readByte)()},r]}]},function(d){return(0,n.peekByte)()(d)===44}),o=(0,e.conditional)({text:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{preData:function(p,f,h){return(0,n.readBytes)(h.text.blockSize)(p)}},r]},function(d){var p=(0,n.peekBytes)(2)(d);return p[0]===33&&p[1]===1}),a=(0,e.conditional)({application:[{codes:(0,n.readBytes)(2)},{blockSize:(0,n.readByte)()},{id:function(p,f,h){return(0,n.readString)(h.blockSize)(p)}},r]},function(d){var p=(0,n.peekBytes)(2)(d);return p[0]===33&&p[1]===255}),l=(0,e.conditional)({comment:[{codes:(0,n.readBytes)(2)},r]},function(d){var p=(0,n.peekBytes)(2)(d);return p[0]===33&&p[1]===254}),c=[{header:[{signature:(0,n.readString)(3)},{version:(0,n.readString)(3)}]},{lsd:[{width:(0,n.readUnsigned)(!0)},{height:(0,n.readUnsigned)(!0)},{gct:(0,n.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,n.readByte)()},{pixelAspectRatio:(0,n.readByte)()}]},(0,e.conditional)({gct:(0,n.readArray)(3,function(d,p){return Math.pow(2,p.lsd.gct.size+1)})},function(d,p){return p.lsd.gct.exists}),{frames:(0,e.loop)([s,a,l,i,o],function(d){var p=(0,n.peekByte)()(d);return p===33||p===44})}],u=c;t.default=u})(Zd);var Li={};Object.defineProperty(Li,"__esModule",{value:!0});Li.deinterlace=void 0;Li.deinterlace=function(t,e){for(var n=new Array(t.length),r=t.length/e,s=function(u,d){var p=t.slice(d*e,(d+1)*e);n.splice.apply(n,[u*e,e].concat(p))},i=[0,4,2,1],o=[8,8,4,2],a=0,l=0;l<4;l++)for(var c=i[l];c<r;c+=o[l])s(c,a),a++;return n};var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.lzw=void 0;Oi.lzw=function(t,e,n){var r=4096,s=-1,i=n,o,a,l,c,u,d,p,y,f,h,_,m,b,C,D,E,w=new Array(n),g=new Array(r),v=new Array(r),k=new Array(r+1);for(m=t,a=1<<m,u=a+1,o=a+2,p=s,c=m+1,l=(1<<c)-1,f=0;f<a;f++)g[f]=0,v[f]=f;var _,y,b,C,E,D;for(_=y=b=C=E=D=0,h=0;h<i;){if(C===0){if(y<c){_+=e[D]<<y,y+=8,D++;continue}if(f=_&l,_>>=c,y-=c,f>o||f==u)break;if(f==a){c=m+1,l=(1<<c)-1,o=a+2,p=s;continue}if(p==s){k[C++]=v[f],p=f,b=f;continue}for(d=f,f==o&&(k[C++]=b,f=p);f>a;)k[C++]=v[f],f=g[f];b=v[f]&255,k[C++]=b,o<r&&(g[o]=p,v[o]=b,o++,(o&l)===0&&o<r&&(c++,l+=o)),p=d}C--,w[E++]=k[C],h++}for(h=E;h<i;h++)w[h]=0;return w};(function(t){var e=xe&&xe.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(t,"__esModule",{value:!0}),t.decompressFrames=t.decompressFrame=t.parseGIF=void 0;var n=e(Zd),r=At,s=me,i=Li,o=Oi;t.parseGIF=function(l){var c=new Uint8Array(l);return r.parse(s.buildStream(c),n.default)};var a=function(l){for(var c=l.pixels.length,u=new Uint8ClampedArray(c*4),d=0;d<c;d++){var p=d*4,f=l.pixels[d],h=l.colorTable[f];u[p]=h[0],u[p+1]=h[1],u[p+2]=h[2],u[p+3]=f!==l.transparentIndex?255:0}return u};t.decompressFrame=function(l,c,u){if(!l.image){console.warn("gif frame does not have associated image.");return}var d=l.image,p=d.descriptor.width*d.descriptor.height,f=o.lzw(d.data.minCodeSize,d.data.blocks,p);d.descriptor.lct.interlaced&&(f=i.deinterlace(f,d.descriptor.width));var h={pixels:f,dims:{top:l.image.descriptor.top,left:l.image.descriptor.left,width:l.image.descriptor.width,height:l.image.descriptor.height}};return d.descriptor.lct&&d.descriptor.lct.exists?h.colorTable=d.lct:h.colorTable=c,l.gce&&(h.delay=(l.gce.delay||10)*10,h.disposalType=l.gce.extras.disposal,l.gce.extras.transparentColorGiven&&(h.transparentIndex=l.gce.transparentColorIndex)),u&&(h.patch=a(h)),h},t.decompressFrames=function(l,c){return l.frames.filter(function(u){return u.image}).map(function(u){return t.decompressFrame(u,l.gct,c)})}})(Jd);var Gb=100,Re=256,Zc=Re-1,Ft=4,tp=16,nl=1<<tp,np=10,rl=10,Kb=nl>>rl,Qb=nl<<np-rl,Wb=Re>>3,qo=6,Xb=1<<qo,Yb=Wb*Xb,Jb=30,rp=10,vs=1<<rp,sp=8,eu=1<<sp,Zb=rp+sp,Dn=1<<Zb,tu=499,nu=491,ru=487,ip=503,e_=3*ip;function t_(t,e){var n,r,s,i,o;function a(){n=[],r=new Int32Array(256),s=new Int32Array(Re),i=new Int32Array(Re),o=new Int32Array(Re>>3);var g,v;for(g=0;g<Re;g++)v=(g<<Ft+8)/Re,n[g]=new Float64Array([v,v,v,0]),i[g]=nl/Re,s[g]=0}function l(){for(var g=0;g<Re;g++)n[g][0]>>=Ft,n[g][1]>>=Ft,n[g][2]>>=Ft,n[g][3]=g}function c(g,v,k,_,y){n[v][0]-=g*(n[v][0]-k)/vs,n[v][1]-=g*(n[v][1]-_)/vs,n[v][2]-=g*(n[v][2]-y)/vs}function u(g,v,k,_,y){for(var b=Math.abs(v-g),C=Math.min(v+g,Re),E=v+1,D=v-1,L=1,A,U;E<C||D>b;)U=o[L++],E<C&&(A=n[E++],A[0]-=U*(A[0]-k)/Dn,A[1]-=U*(A[1]-_)/Dn,A[2]-=U*(A[2]-y)/Dn),D>b&&(A=n[D--],A[0]-=U*(A[0]-k)/Dn,A[1]-=U*(A[1]-_)/Dn,A[2]-=U*(A[2]-y)/Dn)}function d(g,v,k){var _=2147483647,y=_,b=-1,C=b,E,D,L,A,U;for(E=0;E<Re;E++)D=n[E],L=Math.abs(D[0]-g)+Math.abs(D[1]-v)+Math.abs(D[2]-k),L<_&&(_=L,b=E),A=L-(s[E]>>tp-Ft),A<y&&(y=A,C=E),U=i[E]>>rl,i[E]-=U,s[E]+=U<<np;return i[b]+=Kb,s[b]-=Qb,C}function p(){var g,v,k,_,y,b,C=0,E=0;for(g=0;g<Re;g++){for(k=n[g],y=g,b=k[1],v=g+1;v<Re;v++)_=n[v],_[1]<b&&(y=v,b=_[1]);if(_=n[y],g!=y&&(v=_[0],_[0]=k[0],k[0]=v,v=_[1],_[1]=k[1],k[1]=v,v=_[2],_[2]=k[2],k[2]=v,v=_[3],_[3]=k[3],k[3]=v),b!=C){for(r[C]=E+g>>1,v=C+1;v<b;v++)r[v]=g;C=b,E=g}}for(r[C]=E+Zc>>1,v=C+1;v<256;v++)r[v]=Zc}function f(g,v,k){for(var _,y,b,C=1e3,E=-1,D=r[v],L=D-1;D<Re||L>=0;)D<Re&&(y=n[D],b=y[1]-v,b>=C?D=Re:(D++,b<0&&(b=-b),_=y[0]-g,_<0&&(_=-_),b+=_,b<C&&(_=y[2]-k,_<0&&(_=-_),b+=_,b<C&&(C=b,E=y[3])))),L>=0&&(y=n[L],b=v-y[1],b>=C?L=-1:(L--,b<0&&(b=-b),_=y[0]-g,_<0&&(_=-_),b+=_,b<C&&(_=y[2]-k,_<0&&(_=-_),b+=_,b<C&&(C=b,E=y[3]))));return E}function h(){var g,v=t.length,k=30+(e-1)/3,_=v/(3*e),y=~~(_/Gb),b=vs,C=Yb,E=C>>qo;for(E<=1&&(E=0),g=0;g<E;g++)o[g]=b*((E*E-g*g)*eu/(E*E));var D;v<e_?(e=1,D=3):v%tu!==0?D=3*tu:v%nu!==0?D=3*nu:v%ru!==0?D=3*ru:D=3*ip;var L,A,U,M,B=0;for(g=0;g<_;)if(L=(t[B]&255)<<Ft,A=(t[B+1]&255)<<Ft,U=(t[B+2]&255)<<Ft,M=d(L,A,U),c(b,M,L,A,U),E!==0&&u(E,M,L,A,U),B+=D,B>=v&&(B-=v),g++,y===0&&(y=1),g%y===0)for(b-=b/k,C-=C/Jb,E=C>>qo,E<=1&&(E=0),M=0;M<E;M++)o[M]=b*((E*E-M*M)*eu/(E*E))}function m(){a(),h(),l(),p()}this.buildColormap=m;function w(){for(var g=[],v=[],k=0;k<Re;k++)v[n[k][3]]=k;for(var _=0,y=0;y<Re;y++){var b=v[y];g[_++]=n[b][0],g[_++]=n[b][1],g[_++]=n[b][2]}return g}this.getColormap=w,this.lookupRGB=f}var n_=t_,su=-1,ws=12,hr=5003,r_=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function s_(t,e,n,r){var s=Math.max(2,r),i=new Uint8Array(256),o=new Int32Array(hr),a=new Int32Array(hr),l,c=0,u,d=0,p,f=!1,h,m,w,g,v,k;function _(M,B){i[u++]=M,u>=254&&D(B)}function y(M){b(hr),d=m+2,f=!0,U(m,M)}function b(M){for(var B=0;B<M;++B)o[B]=-1}function C(M,B){var R,F,z,Te,se,he,le;for(h=M,f=!1,k=h,p=L(k),m=1<<M-1,w=m+1,d=m+2,u=0,Te=A(),le=0,R=hr;R<65536;R*=2)++le;le=8-le,he=hr,b(he),U(m,B);e:for(;(F=A())!=su;){if(R=(F<<ws)+Te,z=F<<le^Te,o[z]===R){Te=a[z];continue}else if(o[z]>=0){se=he-z,z===0&&(se=1);do if((z-=se)<0&&(z+=he),o[z]===R){Te=a[z];continue e}while(o[z]>=0)}U(Te,B),Te=F,d<1<<ws?(a[z]=d++,o[z]=R):y(B)}U(Te,B),U(w,B)}function E(M){M.writeByte(s),g=t*e,v=0,C(s+1,M),M.writeByte(0)}function D(M){u>0&&(M.writeByte(u),M.writeBytes(i,0,u),u=0)}function L(M){return(1<<M)-1}function A(){if(g===0)return su;--g;var M=n[v++];return M&255}function U(M,B){for(l&=r_[c],c>0?l|=M<<c:l=M,c+=k;c>=8;)_(l&255,B),l>>=8,c-=8;if((d>p||f)&&(f?(p=L(k=h),f=!1):(++k,k==ws?p=1<<ws:p=L(k))),M==w){for(;c>0;)_(l&255,B),l>>=8,c-=8;D(B)}}this.encode=E}var i_=s_,o_=n_,a_=i_;function nt(){this.page=-1,this.pages=[],this.newPage()}nt.pageSize=4096;nt.charMap={};for(var bs=0;bs<256;bs++)nt.charMap[bs]=String.fromCharCode(bs);nt.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(nt.pageSize),this.cursor=0};nt.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var n=0;n<nt.pageSize;n++)t+=nt.charMap[this.pages[e][n]];return t};nt.prototype.toFlattenUint8Array=function(){for(var t=[],e=0;e<this.pages.length;e++)if(e===this.pages.length-1){var n=Uint8Array.from(this.pages[e].slice(0,this.cursor));t.push(n)}else t.push(this.pages[e]);var r=new Uint8Array(t.reduce(function(s,i){return s+i.length},0));return t.reduce(function(s,i){return r.set(i,s),s+i.length},0),r};nt.prototype.writeByte=function(t){this.cursor>=nt.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t};nt.prototype.writeUTFBytes=function(t){for(var e=t.length,n=0;n<e;n++)this.writeByte(t.charCodeAt(n))};nt.prototype.writeBytes=function(t,e,n){for(var r=n||t.length,s=e||0;s<r;s++)this.writeByte(t[s])};function ue(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new nt}ue.prototype.setDelay=function(t){this.delay=Math.round(t/10)};ue.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)};ue.prototype.setDispose=function(t){t>=0&&(this.dispose=t)};ue.prototype.setRepeat=function(t){this.repeat=t};ue.prototype.setTransparent=function(t){this.transparent=t};ue.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};ue.prototype.finish=function(){this.out.writeByte(59)};ue.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t};ue.prototype.setDither=function(t){t===!0&&(t="FloydSteinberg"),this.dither=t};ue.prototype.setGlobalPalette=function(t){this.globalPalette=t};ue.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};ue.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};ue.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new o_(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};ue.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var n=0,r=0;r<e;r++){var s=this.findClosestRGB(this.pixels[n++]&255,this.pixels[n++]&255,this.pixels[n++]&255);this.usedEntry[s]=!0,this.indexedPixels[r]=s}};ue.prototype.ditherPixels=function(t,e){var n={FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],Stucki:[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]};if(!t||!n[t])throw"Unknown dithering kernel: "+t;var r=n[t],s=0,i=this.height,o=this.width,a=this.pixels,l=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var c=0;c<i;c++){e&&(l=l*-1);for(var u=l==1?0:o-1,d=l==1?o:0;u!==d;u+=l){s=c*o+u;var p=s*3,f=a[p],h=a[p+1],m=a[p+2];p=this.findClosestRGB(f,h,m),this.usedEntry[p]=!0,this.indexedPixels[s]=p,p*=3;for(var w=this.colorTab[p],g=this.colorTab[p+1],v=this.colorTab[p+2],k=f-w,_=h-g,y=m-v,b=l==1?0:r.length-1,C=l==1?r.length:0;b!==C;b+=l){var E=r[b][1],D=r[b][2];if(E+u>=0&&E+u<o&&D+c>=0&&D+c<i){var L=r[b][0];p=s+E+D*o,p*=3,a[p]=Math.max(0,Math.min(255,a[p]+k*L)),a[p+1]=Math.max(0,Math.min(255,a[p+1]+_*L)),a[p+2]=Math.max(0,Math.min(255,a[p+2]+y*L))}}}}};ue.prototype.findClosest=function(t,e){return this.findClosestRGB((t&16711680)>>16,(t&65280)>>8,t&255,e)};ue.prototype.findClosestRGB=function(t,e,n,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,n);for(var s=0,i=256*256*256,o=this.colorTab.length,a=0,l=0;a<o;l++){var c=t-(this.colorTab[a++]&255),u=e-(this.colorTab[a++]&255),d=n-(this.colorTab[a++]&255),p=c*c+u*u+d*d;(!r||this.usedEntry[l])&&p<i&&(i=p,s=l)}return s};ue.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var n=this.image,r=0,s=0,i=0;i<e;i++)for(var o=0;o<t;o++)this.pixels[s++]=n[r++],this.pixels[s++]=n[r++],this.pixels[s++]=n[r++],r++};ue.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var t,e;this.transparent===null?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=this.dispose&7),e<<=2,this.out.writeByte(0|e|0|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};ue.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)};ue.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};ue.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};ue.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=3*256-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)};ue.prototype.writeShort=function(t){this.out.writeByte(t&255),this.out.writeByte(t>>8&255)};ue.prototype.writePixels=function(){var t=new a_(this.width,this.height,this.indexedPixels,this.colorDepth);t.encode(this.out)};ue.prototype.stream=function(){return this.out};var l_=ue,Ys=xe&&xe.__assign||function(){return Ys=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Ys.apply(this,arguments)},c_=xe&&xe.__awaiter||function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(d){o(d)}}function l(u){try{c(r.throw(u))}catch(d){o(d)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})},u_=xe&&xe.__generator||function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,s=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){n.label=c[1];break}if(c[0]===6&&n.label<i[1]){n.label=i[1],i=c;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(c);break}i[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(u){c=[6,u],s=0}finally{r=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},h_=xe&&xe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xi,"__esModule",{value:!0});xi.AwesomeQR=void 0;var pt=ts,iu=Jd,_s=tl,f_=h_(l_),Es=.4,d_=function(){function t(e){var n=Object.assign({},e);if(Object.keys(t.defaultOptions).forEach(function(r){r in n||Object.defineProperty(n,r,{value:t.defaultOptions[r],enumerable:!0,writable:!0})}),n.components?typeof n.components=="object"&&Object.keys(t.defaultComponentOptions).forEach(function(r){r in n.components?Object.defineProperty(n.components,r,{value:Ys(Ys({},t.defaultComponentOptions[r]),n.components[r]),enumerable:!0,writable:!0}):Object.defineProperty(n.components,r,{value:t.defaultComponentOptions[r],enumerable:!0,writable:!0})}):n.components=t.defaultComponentOptions,n.dotScale!==null&&n.dotScale!==void 0){if(n.dotScale<=0||n.dotScale>1)throw new Error("dotScale should be in range (0, 1].");n.components.data.scale=n.dotScale,n.components.timing.scale=n.dotScale,n.components.alignment.scale=n.dotScale}this.options=n,this.canvas=pt.createCanvas(e.size,e.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new _s.QRCodeModel(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}return t.prototype.draw=function(){var e=this;return new Promise(function(n){return e._draw().then(n)})},t.prototype._clear=function(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},t._prepareRoundedCornerClip=function(e,n,r,s,i,o){e.beginPath(),e.moveTo(n,r),e.arcTo(n+s,r,n+s,r+i,o),e.arcTo(n+s,r+i,n,r+i,o),e.arcTo(n,r+i,n,r,o),e.arcTo(n,r,n+s,r,o),e.closePath()},t._getAverageRGB=function(e){var n=5,r={r:0,g:0,b:0},s,i,o=-4,a={r:0,g:0,b:0},l=0;i=e.naturalHeight||e.height,s=e.naturalWidth||e.width;var c=pt.createCanvas(s,i),u=c.getContext("2d");if(!u)return r;u.drawImage(e,0,0);var d;try{d=u.getImageData(0,0,s,i)}catch{return r}for(;(o+=n*4)<d.data.length;)d.data[o]>200||d.data[o+1]>200||d.data[o+2]>200||(++l,a.r+=d.data[o],a.g+=d.data[o+1],a.b+=d.data[o+2]);return a.r=~~(a.r/l),a.g=~~(a.g/l),a.b=~~(a.b/l),a},t._drawDot=function(e,n,r,s,i,o){i===void 0&&(i=0),o===void 0&&(o=1),e.fillRect((n+i)*s,(r+i)*s,o*s,o*s)},t._drawAlignProtector=function(e,n,r,s){e.clearRect((n-2)*s,(r-2)*s,5*s,5*s),e.fillRect((n-2)*s,(r-2)*s,5*s,5*s)},t._drawAlign=function(e,n,r,s,i,o,a,l){i===void 0&&(i=0),o===void 0&&(o=1);var c=e.fillStyle;e.fillStyle=a,new Array(4).fill(0).map(function(u,d){t._drawDot(e,n-2+d,r-2,s,i,o),t._drawDot(e,n+2,r-2+d,s,i,o),t._drawDot(e,n+2-d,r+2,s,i,o),t._drawDot(e,n-2,r+2-d,s,i,o)}),t._drawDot(e,n,r,s,i,o),l||(e.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map(function(u,d){t._drawDot(e,n-1+d,r-1,s,i,o),t._drawDot(e,n+1,r-1+d,s,i,o),t._drawDot(e,n+1-d,r+1,s,i,o),t._drawDot(e,n-1,r+1-d,s,i,o)})),e.fillStyle=c},t.prototype._draw=function(){var e,n,r,s,i,o,a,l,c,u,d,p,f,h,m,w,g,v,k;return c_(this,void 0,void 0,function(){var _,y,b,C,E,D,L,A,U,M,B,R,F,z,Te,se,he,le,Xe,Lt,yt,ae,ye,Et,Wt,ne,kt,ct,De,K,ve,vt,Tn,dt,ae,Pi,Fi,ol,st,al,ae,Tt,it,ot,ns,Bi,ae,ji,ll,Vi,cl,ae,Tt,it,ot,ul,sr,Ot,ir,Pt,or,rs,hl,It,In,ar,Cn,Ui,ss,fl,dl,$i,pl;return u_(this,function(lr){switch(lr.label){case 0:if(_=(e=this.qrCode)===null||e===void 0?void 0:e.moduleCount,y=this.options.size,b=this.options.margin,(b<0||b*2>=y)&&(b=0),C=Math.ceil(b),E=y-2*b,D=this.options.whiteMargin,L=this.options.backgroundDimming,A=Math.ceil(E/_),U=A*_,M=U+2*C,B=pt.createCanvas(M,M),R=B.getContext("2d"),this._clear(),R.save(),R.translate(C,C),F=pt.createCanvas(M,M),z=F.getContext("2d"),Te=null,se=[],!this.options.gifBackground)return[3,1];if(he=iu.parseGIF(this.options.gifBackground),Te=he,se=iu.decompressFrames(he,!0),this.options.autoColor){for(le=0,Xe=0,Lt=0,yt=0,ae=0;ae<se[0].colorTable.length;ae++)ye=se[0].colorTable[ae],!(ye[0]>200||ye[1]>200||ye[2]>200)&&(ye[0]===0&&ye[1]===0&&ye[2]===0||(yt++,le+=ye[0],Xe+=ye[1],Lt+=ye[2]));le=~~(le/yt),Xe=~~(Xe/yt),Lt=~~(Lt/yt),this.options.colorDark="rgb("+le+","+Xe+","+Lt+")"}return[3,4];case 1:return this.options.backgroundImage?[4,pt.loadImage(this.options.backgroundImage)]:[3,3];case 2:return Et=lr.sent(),this.options.autoColor&&(Wt=t._getAverageRGB(Et),this.options.colorDark="rgb("+Wt.r+","+Wt.g+","+Wt.b+")"),z.drawImage(Et,0,0,Et.width,Et.height,0,0,M,M),z.rect(0,0,M,M),z.fillStyle=L,z.fill(),[3,4];case 3:z.rect(0,0,M,M),z.fillStyle=this.options.colorLight,z.fill(),lr.label=4;case 4:for(ne=_s.QRUtil.getPatternPosition(this.qrCode.typeNumber),kt=((r=(n=this.options.components)===null||n===void 0?void 0:n.data)===null||r===void 0?void 0:r.scale)||Es,ct=(1-kt)*.5,De=0;De<_;De++)for(K=0;K<_;K++){for(ve=this.qrCode.isDark(De,K),vt=K<8&&(De<8||De>=_-8)||K>=_-8&&De<8,Tn=De==6&&K>=8&&K<=_-8||K==6&&De>=8&&De<=_-8,dt=vt||Tn,ae=1;ae<ne.length-1;ae++)dt=dt||De>=ne[ae]-2&&De<=ne[ae]+2&&K>=ne[ae]-2&&K<=ne[ae]+2;Pi=K*A+(dt?0:ct*A),Fi=De*A+(dt?0:ct*A),R.strokeStyle=ve?this.options.colorDark:this.options.colorLight,R.lineWidth=.5,R.fillStyle=ve?this.options.colorDark:"rgba(255, 255, 255, 0.6)",ne.length===0?dt||R.fillRect(Pi,Fi,(dt?1:kt)*A,(dt?1:kt)*A):(ol=K<_-4&&K>=_-4-5&&De<_-4&&De>=_-4-5,!dt&&!ol&&R.fillRect(Pi,Fi,(dt?1:kt)*A,(dt?1:kt)*A))}if(st=ne[ne.length-1],al="rgba(255, 255, 255, 0.6)",R.fillStyle=al,R.fillRect(0,0,8*A,8*A),R.fillRect(0,(_-8)*A,8*A,8*A),R.fillRect((_-8)*A,0,8*A,8*A),!((i=(s=this.options.components)===null||s===void 0?void 0:s.timing)===null||i===void 0)&&i.protectors&&(R.fillRect(8*A,6*A,(_-8-8)*A,A),R.fillRect(6*A,8*A,A,(_-8-8)*A)),!((a=(o=this.options.components)===null||o===void 0?void 0:o.cornerAlignment)===null||a===void 0)&&a.protectors&&t._drawAlignProtector(R,st,st,A),!((c=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||c===void 0)&&c.protectors){for(ae=0;ae<ne.length;ae++)for(Tt=0;Tt<ne.length;Tt++)if(it=ne[Tt],ot=ne[ae],!(it===6&&(ot===6||ot===st))){if(ot===6&&(it===6||it===st))continue;if(it===st&&ot===st)continue;t._drawAlignProtector(R,it,ot,A)}}for(R.fillStyle=this.options.colorDark,R.fillRect(0,0,7*A,A),R.fillRect((_-7)*A,0,7*A,A),R.fillRect(0,6*A,7*A,A),R.fillRect((_-7)*A,6*A,7*A,A),R.fillRect(0,(_-7)*A,7*A,A),R.fillRect(0,(_-7+6)*A,7*A,A),R.fillRect(0,0,A,7*A),R.fillRect(6*A,0,A,7*A),R.fillRect((_-7)*A,0,A,7*A),R.fillRect((_-7+6)*A,0,A,7*A),R.fillRect(0,(_-7)*A,A,7*A),R.fillRect(6*A,(_-7)*A,A,7*A),R.fillRect(2*A,2*A,3*A,3*A),R.fillRect((_-7+2)*A,2*A,3*A,3*A),R.fillRect(2*A,(_-7+2)*A,3*A,3*A),ns=((d=(u=this.options.components)===null||u===void 0?void 0:u.timing)===null||d===void 0?void 0:d.scale)||Es,Bi=(1-ns)*.5,ae=0;ae<_-8;ae+=2)t._drawDot(R,8+ae,6,A,Bi,ns),t._drawDot(R,6,8+ae,A,Bi,ns);for(ji=((f=(p=this.options.components)===null||p===void 0?void 0:p.cornerAlignment)===null||f===void 0?void 0:f.scale)||Es,ll=(1-ji)*.5,t._drawAlign(R,st,st,A,ll,ji,this.options.colorDark,((m=(h=this.options.components)===null||h===void 0?void 0:h.cornerAlignment)===null||m===void 0?void 0:m.protectors)||!1),Vi=((g=(w=this.options.components)===null||w===void 0?void 0:w.alignment)===null||g===void 0?void 0:g.scale)||Es,cl=(1-Vi)*.5,ae=0;ae<ne.length;ae++)for(Tt=0;Tt<ne.length;Tt++)if(it=ne[Tt],ot=ne[ae],!(it===6&&(ot===6||ot===st))){if(ot===6&&(it===6||it===st))continue;if(it===st&&ot===st)continue;t._drawAlign(R,it,ot,A,cl,Vi,this.options.colorDark,((k=(v=this.options.components)===null||v===void 0?void 0:v.alignment)===null||k===void 0?void 0:k.protectors)||!1)}return D&&(R.fillStyle="#FFFFFF",R.fillRect(-C,-C,M,C),R.fillRect(-C,U,M,C),R.fillRect(U,-C,C,M),R.fillRect(-C,-C,C,M)),this.options.logoImage?[4,pt.loadImage(this.options.logoImage)]:[3,6];case 5:ul=lr.sent(),sr=this.options.logoScale,Ot=this.options.logoMargin,ir=this.options.logoCornerRadius,(sr<=0||sr>=1)&&(sr=.2),Ot<0&&(Ot=0),ir<0&&(ir=0),Pt=U*sr,or=.5*(M-Pt),rs=or,R.restore(),R.fillStyle="#FFFFFF",R.save(),t._prepareRoundedCornerClip(R,or-Ot,rs-Ot,Pt+2*Ot,Pt+2*Ot,ir+Ot),R.clip(),hl=R.globalCompositeOperation,R.globalCompositeOperation="destination-out",R.fill(),R.globalCompositeOperation=hl,R.restore(),R.save(),t._prepareRoundedCornerClip(R,or,rs,Pt,Pt,ir),R.clip(),R.drawImage(ul,or,rs,Pt,Pt),R.restore(),R.save(),R.translate(C,C),lr.label=6;case 6:if(Te){if(se.forEach(function(Xt){It||(It=new f_.default(y,y),It.setDelay(Xt.delay),It.setRepeat(0));var is=Xt.dims,os=is.width,as=is.height;In||(In=pt.createCanvas(os,as),ar=In.getContext("2d"),ar.rect(0,0,In.width,In.height),ar.fillStyle="#ffffff",ar.fill()),(!Cn||!ss||os!==Cn.width||as!==Cn.height)&&(Cn=pt.createCanvas(os,as),Ui=Cn.getContext("2d"),ss=Ui.createImageData(os,as)),ss.data.set(Xt.patch),Ui.putImageData(ss,0,0),ar.drawImage(Cn,Xt.dims.left,Xt.dims.top);var gl=pt.createCanvas(M,M),cr=gl.getContext("2d");cr.drawImage(In,0,0,M,M),cr.rect(0,0,M,M),cr.fillStyle=L,cr.fill(),cr.drawImage(B,0,0,M,M);var qi=pt.createCanvas(y,y),ml=qi.getContext("2d");ml.drawImage(gl,0,0,y,y),It.addFrame(ml.getImageData(0,0,qi.width,qi.height).data)}),!It)throw new Error("No frames.");return It.finish(),ou(this.canvas)?(fl=It.stream().toFlattenUint8Array(),dl=fl.reduce(function(Xt,is){return Xt+String.fromCharCode(is)},""),[2,Promise.resolve("data:image/gif;base64,"+window.btoa(dl))]):[2,Promise.resolve(Buffer.from(It.stream().toFlattenUint8Array()))]}else return z.drawImage(B,0,0,M,M),R.drawImage(F,-C,-C,M,M),$i=pt.createCanvas(y,y),pl=$i.getContext("2d"),pl.drawImage(B,0,0,y,y),this.canvas=$i,ou(this.canvas)?[2,Promise.resolve(this.canvas.toDataURL())]:[2,Promise.resolve(this.canvas.toBuffer())]}})})},t.CorrectLevel=_s.QRErrorCorrectLevel,t.defaultComponentOptions={data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}},t.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"#ffffff",correctLevel:_s.QRErrorCorrectLevel.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:t.defaultComponentOptions,autoColor:!0},t}();xi.AwesomeQR=d_;function ou(t){try{return t instanceof HTMLElement}catch{return typeof t=="object"&&t.nodeType===1&&typeof t.style=="object"&&typeof t.ownerDocument=="object"}}(function(t){var e=xe&&xe.__createBinding||(Object.create?function(s,i,o,a){a===void 0&&(a=o),Object.defineProperty(s,a,{enumerable:!0,get:function(){return i[o]}})}:function(s,i,o,a){a===void 0&&(a=o),s[a]=i[o]}),n=xe&&xe.__exportStar||function(s,i){for(var o in s)o!=="default"&&!i.hasOwnProperty(o)&&e(i,s,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(tl,t);var r=xi;Object.defineProperty(t,"AwesomeQR",{enumerable:!0,get:function(){return r.AwesomeQR}})})(Yd);const au=async(t,e=300)=>await new Yd.AwesomeQR({text:t,size:e}).draw(),sl={password:{}},p_=(t,e,n)=>{sl[t][e]=n},g_=(t,e)=>{delete sl[t][e]},m_=t=>{const e=sl[t];for(const n of Object.values(e))n()};function lu(t){let e,n=t[8]=="link"&&cu(t);return{c(){e=S("div"),n&&n.c(),I(e,"class","block border-b border-black bg-yellow-200 relative")},m(r,s){H(r,e,s),n&&n.m(e,null)},p(r,s){r[8]=="link"?n?n.p(r,s):(n=cu(r),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(r){r&&q(e),n&&n.d()}}}function cu(t){let e,n,r,s,i,o,a,l,c,u,d=t[12]?"Copied":"Copy",p,f,h,m;return{c(){e=S("div"),n=S("img"),s=P(),i=S("div"),o=S("div"),a=S("div"),l=S("input"),c=P(),u=S("button"),p=ce(d),I(n,"alt","qrcode"),vl(n.src,r=t[11])||I(n,"src",r),I(l,"class","bg-white w-full text-ellipsis inline-block flex-1 px-2"),I(l,"type","text"),l.readOnly=!0,I(l,"title",t[9]),l.value=t[9],I(u,"class",f=`${t[12]?"hover:bg-green-500":"hover:bg-nl"} float-right border-t border-black bg-gray-50 hover:text-white px-2 h-7`),I(a,"class","flex-1 border-black border-t border-b flex flex-col"),I(o,"class","flex items-center flex-1 min-w-[20rem]"),I(i,"class","flex flex-1 border-l border-black flex-col"),I(e,"class","flex flex-row flex-wrap-reverse justify-center")},m(w,g){H(w,e,g),T(e,n),T(e,s),T(e,i),T(i,o),T(o,a),T(a,l),T(a,c),T(a,u),T(u,p),h||(m=te(u,"click",t[23]),h=!0)},p(w,g){g&2048&&!vl(n.src,r=w[11])&&I(n,"src",r),g&512&&I(l,"title",w[9]),g&512&&l.value!==w[9]&&(l.value=w[9]),g&4096&&d!==(d=w[12]?"Copied":"Copy")&&ge(p,d),g&4096&&f!==(f=`${w[12]?"hover:bg-green-500":"hover:bg-nl"} float-right border-t border-black bg-gray-50 hover:text-white px-2 h-7`)&&I(u,"class",f)},d(w){w&&q(e),h=!1,m()}}}function y_(t){var s;let e,n=((s=t[2])==null?void 0:s.name)+"",r;return{c(){e=S("h2"),r=ce(n),I(e,"class","font-semibold leading-tight text-3xl")},m(i,o){H(i,e,o),T(e,r)},p(i,o){var a;o&4&&n!==(n=((a=i[2])==null?void 0:a.name)+"")&&ge(r,n)},d(i){i&&q(e)}}}function v_(t){let e,n,r,s,i,o,a,l,c,u,d,p,f,h,m,w,g,v,k,_,y,b,C,E,D,L,A,U,M=t[6]&&uu(t);return{c(){e=S("form"),n=S("label"),r=S("span"),r.textContent="Room Name",s=P(),i=S("input"),a=P(),l=S("label"),c=S("span"),c.textContent="Nick",u=P(),d=S("input"),f=P(),h=S("button"),h.textContent="Generate",m=P(),w=S("hr"),g=P(),v=S("label"),k=S("span"),k.textContent="Passcode",_=P(),y=S("input"),C=P(),E=S("div"),D=S("button"),D.textContent="Save",L=P(),M&&M.c(),I(r,"class","text-sm font-bold mb-2"),I(i,"type","text"),I(i,"name","roomName"),I(i,"placeholder","Enter a room name"),I(i,"autocomplete","off"),i.value=o=t[13].roomName,i.required=!0,I(i,"class","mb-4 form-input"),I(n,"class","inline-block w-full"),I(c,"class","text-sm font-bold mb-2"),I(d,"type","text"),I(d,"name","nick"),I(d,"placeholder","Marcus Antonius"),I(d,"autocomplete","off"),d.value=p=t[13].nick,d.required=!0,I(d,"class","mb-4 form-input float-right"),I(h,"type","button"),I(h,"class","underline hover:bg-nl hover:text-white"),I(l,"class","inline-block w-full"),I(w,"class","block py-1 px-2"),I(k,"class","text-sm font-bold mb-2"),I(y,"type","text"),I(y,"name","passCode"),I(y,"autocomplete","off"),y.value=b=t[13].passCode,I(y,"placeholder","Optional passcode to join room"),I(y,"class","mb-4 form-input"),I(v,"class","inline-block w-full"),I(D,"type","submit"),D.value="save",I(D,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(E,"class","flex gap-2 justify-between")},m(B,R){H(B,e,R),T(e,n),T(n,r),T(n,s),T(n,i),T(e,a),T(e,l),T(l,c),T(l,u),T(l,d),t[24](d),T(l,f),T(l,h),T(e,m),T(e,w),T(e,g),T(e,v),T(v,k),T(v,_),T(v,y),T(e,C),T(e,E),T(E,D),T(E,L),M&&M.m(E,null),t[26](e),A||(U=[te(h,"click",t[25]),te(e,"submit",vn(Wn(t[16])))],A=!0)},p(B,R){R&8192&&o!==(o=B[13].roomName)&&i.value!==o&&(i.value=o),R&8192&&p!==(p=B[13].nick)&&d.value!==p&&(d.value=p),R&8192&&b!==(b=B[13].passCode)&&y.value!==b&&(y.value=b),B[6]?M?M.p(B,R):(M=uu(B),M.c(),M.m(E,null)):M&&(M.d(1),M=null)},d(B){B&&q(e),t[24](null),M&&M.d(),t[26](null),A=!1,rt(U)}}}function uu(t){let e,n;return{c(){e=S("span"),n=ce(t[6]),I(e,"class","flex-1 bg-red-500 text-white block px-2 leading-loose")},m(r,s){H(r,e,s),T(e,n)},p(r,s){s&64&&ge(n,r[6])},d(r){r&&q(e)}}}function w_(t){let e,n,r,s,i,o,a,l,c=t[3]?"Cancel":"Edit",u,d,p,f=t[10]=="Invite Link"?"Close Invite Link":"Invite Link",h,m,w,g,v,k,_,y=t[7]&&lu(t);function b(D,L){return D[3]?v_:y_}let C=b(t),E=C(t);return{c(){e=S("div"),n=S("div"),r=S("div"),s=S("span"),i=ce(t[1]),o=P(),a=S("div"),l=S("button"),u=ce(c),d=P(),p=S("button"),h=ce(f),m=P(),y&&y.c(),w=P(),g=S("div"),E.c(),I(s,"class","px-2 h-7"),I(l,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7"),I(p,"class","float-right border-l border-black hover:bg-nl hover:text-white px-2 h-7"),I(n,"class","flex justify-between w-full border-b border-black"),I(g,"class","p-2"),I(e,"class",v=`${t[0]}`)},m(D,L){H(D,e,L),T(e,n),T(n,r),T(r,s),T(s,i),T(n,o),T(n,a),T(a,l),T(l,u),T(a,d),T(a,p),T(p,h),T(e,m),y&&y.m(e,null),T(e,w),T(e,g),E.m(g,null),k||(_=[te(l,"click",t[21]),te(p,"click",t[22])],k=!0)},p(D,[L]){L&2&&ge(i,D[1]),L&8&&c!==(c=D[3]?"Cancel":"Edit")&&ge(u,c),L&1024&&f!==(f=D[10]=="Invite Link"?"Close Invite Link":"Invite Link")&&ge(h,f),D[7]?y?y.p(D,L):(y=lu(D),y.c(),y.m(e,w)):y&&(y.d(1),y=null),C===(C=b(D))&&E?E.p(D,L):(E.d(1),E=C(D),E&&(E.c(),E.m(g,null))),L&1&&v!==(v=`${D[0]}`)&&I(e,"class",v)},i:Y,o:Y,d(D){D&&q(e),y&&y.d(),E.d(),k=!1,rt(_)}}}function b_(t,e,n){let{class:r=""}=e,{id:s=""}=e,{nick:i=""}=e,{nickID:o=""}=e,{info:a=null}=e,l=!1,c,u,d="",p=!1,f="",h="",m="",w="",g=!1;const v=()=>{n(7,p=!1),n(8,f=""),n(9,h=""),n(10,m=""),n(11,w="")},k={roomName:"",nick:"",passCode:"",leaderCode:""},_=async()=>{n(13,k.roomName=a.name,k),n(13,k.nick=i,k);const R=et(tt,"room",s),F=await $c(R);n(13,k.passCode=F.passCode,k)},y=async()=>{n(6,d="");const R=new FormData(c),F={},z=["roomName","nick","passCode"];for(const se of z)F[se]=R.get(se);const Te={};for(const[se,he]of Object.entries(F))k[se]!==he&&(Te[se]=he);if(Object.keys(Te).length>0){const se={};for(const[le,Xe]of Object.entries(Te))switch(le){case"roomName":se.info={name:Xe};break;case"nick":se.people={[o]:{nick:Xe}};break;case"passCode":se.password={...se.password,passCode:Xe};break}const he=et(tt,"room",s);try{await sn(he,se,{merge:!0}),n(3,l=!1)}catch(le){n(6,d=le)}}},b=async()=>{const R=await $c(et(tt,"room",s)),F=R==null?void 0:R.passCode;let z=`${window.location.origin}/#/room/${s}`;return F&&(z+=`?password=${F}`),z},C=R=>{navigator.clipboard.writeText(R).then(()=>{n(12,g=!0),setTimeout(()=>n(12,g=!1),500)},()=>{console.error("clipboard write failed")})},E=async()=>{m=="Invite Link"&&(n(9,h=await b()),n(11,w=await au(h)))};wn(()=>{p_("password","settings",E)}),bn(()=>{g_("password","settings")});const D=()=>{n(3,l=!l),l&&_()},L=async()=>{if(m=="Invite Link"){v();return}n(9,h=await b()),n(10,m="Invite Link"),n(8,f="link"),n(11,w=await au(h)),n(7,p=!0)},A=()=>{C(h)};function U(R){Pn[R?"unshift":"push"](()=>{u=R,n(5,u)})}const M=()=>n(5,u.value=Xs(),u);function B(R){Pn[R?"unshift":"push"](()=>{c=R,n(4,c)})}return t.$$set=R=>{"class"in R&&n(0,r=R.class),"id"in R&&n(19,s=R.id),"nick"in R&&n(1,i=R.nick),"nickID"in R&&n(20,o=R.nickID),"info"in R&&n(2,a=R.info)},[r,i,a,l,c,u,d,p,f,h,m,w,g,k,v,_,y,b,C,s,o,D,L,A,U,M,B]}class __ extends He{constructor(e){super(),ze(this,e,b_,w_,Ve,{class:0,id:19,nick:1,nickID:20,info:2})}}var E_=typeof xe=="object"&&xe&&xe.Object===Object&&xe,k_=E_,T_=k_,I_=typeof self=="object"&&self&&self.Object===Object&&self,C_=T_||I_||Function("return this")(),op=C_,S_=/\s/;function A_(t){for(var e=t.length;e--&&S_.test(t.charAt(e)););return e}var D_=A_,R_=D_,N_=/^\s+/;function x_(t){return t&&t.slice(0,R_(t)+1).replace(N_,"")}var M_=x_;function L_(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var O_=L_,P_=op,F_=P_.Symbol,il=F_,hu=il,ap=Object.prototype,B_=ap.hasOwnProperty,j_=ap.toString,fr=hu?hu.toStringTag:void 0;function V_(t){var e=B_.call(t,fr),n=t[fr];try{t[fr]=void 0;var r=!0}catch{}var s=j_.call(t);return r&&(e?t[fr]=n:delete t[fr]),s}var U_=V_,$_=Object.prototype,q_=$_.toString;function z_(t){return q_.call(t)}var H_=z_,fu=il,G_=U_,K_=H_,Q_="[object Null]",W_="[object Undefined]",du=fu?fu.toStringTag:void 0;function X_(t){return t==null?t===void 0?W_:Q_:du&&du in Object(t)?G_(t):K_(t)}var Y_=X_;function J_(t){return t!=null&&typeof t=="object"}var Z_=J_,eE=Y_,tE=Z_,nE="[object Symbol]";function rE(t){return typeof t=="symbol"||tE(t)&&eE(t)==nE}var lp=rE,sE=M_,pu=O_,iE=lp,gu=0/0,oE=/^[-+]0x[0-9a-f]+$/i,aE=/^0b[01]+$/i,lE=/^0o[0-7]+$/i,cE=parseInt;function uE(t){if(typeof t=="number")return t;if(iE(t))return gu;if(pu(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=pu(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=sE(t);var n=aE.test(t);return n||lE.test(t)?cE(t.slice(2),n?2:8):oE.test(t)?gu:+t}var cp=uE,hE=cp,mu=1/0,fE=17976931348623157e292;function dE(t){if(!t)return t===0?t:0;if(t=hE(t),t===mu||t===-mu){var e=t<0?-1:1;return e*fE}return t===t?t:0}var pE=dE,gE=pE;function mE(t){var e=gE(t),n=e%1;return e===e?n?e-n:e:0}var yE=mE;function vE(t,e){for(var n=-1,r=t==null?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s}var wE=vE,bE=Array.isArray,_E=bE,yu=il,EE=wE,kE=_E,TE=lp,IE=1/0,vu=yu?yu.prototype:void 0,wu=vu?vu.toString:void 0;function up(t){if(typeof t=="string")return t;if(kE(t))return EE(t,up)+"";if(TE(t))return wu?wu.call(t):"";var e=t+"";return e=="0"&&1/t==-IE?"-0":e}var CE=up,SE=CE;function AE(t){return t==null?"":SE(t)}var DE=AE,RE=op,NE=yE,xE=cp,bu=DE,ME=RE.isFinite,LE=Math.min;function OE(t){var e=Math[t];return function(n,r){if(n=xE(n),r=r==null?0:LE(NE(r),292),r&&ME(n)){var s=(bu(n)+"e").split("e"),i=e(s[0]+"e"+(+s[1]+r));return s=(bu(i)+"e").split("e"),+(s[0]+"e"+(+s[1]-r))}return e(n)}}var PE=OE,FE=PE,BE=FE("round"),jE=BE;function _u(t,e,n){const r=t.slice();return r[19]=e[n],r}function Eu(t){let e,n,r;return{c(){e=S("input"),I(e,"class","bg-gray-200 flex-1 px-2 min-w-[2rem]"),I(e,"type","text")},m(s,i){H(s,e,i),Ln(e,t[1]),n||(r=te(e,"input",t[14]),n=!0)},p(s,i){i&2&&e.value!==s[1]&&Ln(e,s[1])},d(s){s&&q(e),n=!1,r()}}}function ku(t){let e,n,r;return{c(){e=S("button"),e.textContent="Save",I(e,"class","px-2 h-7 border-l border-black self-end hover:bg-green-500 hover:text-white")},m(s,i){H(s,e,i),n||(r=te(e,"click",t[8]),n=!0)},p:Y,d(s){s&&q(e),n=!1,r()}}}function Tu(t){let e,n,r,s,i,o,a,l,c,u,d,p,f=Object.keys(t[0]).length+"",h,m,w,g=[],v=new Map,k,_,y=t[7]&&Iu(t),b=Object.keys(t[0]).sort(t[16]);const C=E=>E[19];for(let E=0;E<b.length;E+=1){let D=_u(t,b,E),L=C(D);v.set(L,g[E]=Su(L,D))}return{c(){e=S("div"),n=S("div"),r=S("button"),r.textContent="Clear Votes",s=P(),i=S("button"),i.textContent="Show Results",o=P(),y&&y.c(),a=P(),l=S("span"),c=S("span"),u=ce(t[6]),p=ce("/"),h=ce(f),m=P(),w=S("table");for(let E=0;E<g.length;E+=1)g[E].c();I(r,"class","px-2 h-7 border border-black hover:bg-nl hover:text-white"),I(i,"class","px-2 h-7 border border-black hover:bg-nl hover:text-white"),I(c,"class",d=`${t[6]!=Object.keys(t[0]).length?"text-red-500":""}`),I(l,"class","text-xl font-bold"),I(e,"class","flex items-center justify-between mb-4"),I(w,"class","w-full")},m(E,D){H(E,e,D),T(e,n),T(n,r),T(n,s),T(n,i),T(e,o),y&&y.m(e,null),T(e,a),T(e,l),T(l,c),T(c,u),T(l,p),T(l,h),H(E,m,D),H(E,w,D);for(let L=0;L<g.length;L+=1)g[L].m(w,null);k||(_=[te(r,"click",t[11]),te(i,"click",t[12])],k=!0)},p(E,D){E[7]?y?y.p(E,D):(y=Iu(E),y.c(),y.m(e,a)):y&&(y.d(1),y=null),D&64&&ge(u,E[6]),D&65&&d!==(d=`${E[6]!=Object.keys(E[0]).length?"text-red-500":""}`)&&I(c,"class",d),D&1&&f!==(f=Object.keys(E[0]).length+"")&&ge(h,f),D&1689&&(b=Object.keys(E[0]).sort(E[16]),g=Zs(g,D,C,1,E,b,v,w,ju,Su,null,_u))},d(E){E&&q(e),y&&y.d(),E&&q(m),E&&q(w);for(let D=0;D<g.length;D+=1)g[D].d();k=!1,rt(_)}}}function Iu(t){let e,n;return{c(){e=S("span"),n=ce(t[5]),I(e,"class","text-xl font-bold")},m(r,s){H(r,e,s),T(e,n)},p(r,s){s&32&&ge(n,r[5])},d(r){r&&q(e)}}}function Cu(t){let e,n,r;function s(){return t[17](t[19])}return{c(){e=S("button"),e.textContent="X",I(e,"class","bg-white border-l border-r border-black hover:bg-red-500 absolute top-0 right-0 h-full text-2xl px-2")},m(i,o){H(i,e,o),n||(r=te(e,"click",s),n=!0)},p(i,o){t=i},d(i){i&&q(e),n=!1,r()}}}function Su(t,e){var m,w,g,v;let n,r,s=((m=e[0][e[19]])==null?void 0:m.nick)+"",i,o,a,l=(e[7]?(v=(g=(w=e[0][e[19]])==null?void 0:w.card)==null?void 0:g.text)!=null?v:"-":"\u{1F7E7}")+"",c,u,d,p,f,h=e[3]&&Cu(e);return{key:t,first:null,c(){var k,_,y,b;n=S("tr"),r=S("td"),i=ce(s),o=P(),a=S("td"),c=ce(l),u=P(),h&&h.c(),p=P(),I(r,"class","text-left w-1/2 text-2xl"),I(a,"class",d=`${((_=(k=e[0][e[19]])==null?void 0:k.card)==null?void 0:_.emoji)||!e[7]?"font-emoji":""} text-center text-4xl py-1 border border-r-0 border-black relative`),I(n,"class",f=`odd:bg-gray-100 border-b border-black first:border-t ${(b=(y=e[0][e[19]])==null?void 0:y.card)!=null&&b.text?"":"!bg-yellow-100"} ${e[4][e[19]]?"stripe-gray":""}`),this.first=n},m(k,_){H(k,n,_),T(n,r),T(r,i),T(n,o),T(n,a),T(a,c),T(a,u),h&&h.m(a,null),T(n,p)},p(k,_){var y,b,C,E,D,L,A,U;e=k,_&1&&s!==(s=((y=e[0][e[19]])==null?void 0:y.nick)+"")&&ge(i,s),_&129&&l!==(l=(e[7]?(E=(C=(b=e[0][e[19]])==null?void 0:b.card)==null?void 0:C.text)!=null?E:"-":"\u{1F7E7}")+"")&&ge(c,l),e[3]?h?h.p(e,_):(h=Cu(e),h.c(),h.m(a,null)):h&&(h.d(1),h=null),_&129&&d!==(d=`${((L=(D=e[0][e[19]])==null?void 0:D.card)==null?void 0:L.emoji)||!e[7]?"font-emoji":""} text-center text-4xl py-1 border border-r-0 border-black relative`)&&I(a,"class",d),_&17&&f!==(f=`odd:bg-gray-100 border-b border-black first:border-t ${(U=(A=e[0][e[19]])==null?void 0:A.card)!=null&&U.text?"":"!bg-yellow-100"} ${e[4][e[19]]?"stripe-gray":""}`)&&I(n,"class",f)},d(k){k&&q(n),h&&h.d()}}}function VE(t){let e,n,r,s,i,o=(t[3]?"":t[1]?t[1]:"Topic Name")+"",a,l,c,u,d,p,f=t[3]?"Cancel":"Edit topic & users",h,m,w,g,v,k,_,y=t[3]&&Eu(t),b=t[3]&&ku(t),C=t[0]&&Tu(t);return{c(){e=S("div"),n=S("div"),r=S("span"),s=ce(`Voting -
      `),i=S("i"),a=ce(o),l=P(),y&&y.c(),c=P(),u=S("div"),b&&b.c(),d=P(),p=S("button"),h=ce(f),w=P(),g=S("div"),C&&C.c(),I(r,"class","px-2"),I(p,"class",m=`float-right px-2 h-7 border-l border-black self-end hover:text-white ${t[3]?"hover:bg-red-500":"hover:bg-nl"}`),I(n,"class","border-b border-black h-7 flex flex-wrap justify-between box-content"),I(g,"class","p-2"),I(e,"class",v=`${t[2]} relative`)},m(E,D){H(E,e,D),T(e,n),T(n,r),T(r,s),T(r,i),T(i,a),T(n,l),y&&y.m(n,null),T(n,c),T(n,u),b&&b.m(u,null),T(u,d),T(u,p),T(p,h),T(e,w),T(e,g),C&&C.m(g,null),k||(_=te(p,"click",t[15]),k=!0)},p(E,[D]){D&10&&o!==(o=(E[3]?"":E[1]?E[1]:"Topic Name")+"")&&ge(a,o),E[3]?y?y.p(E,D):(y=Eu(E),y.c(),y.m(n,c)):y&&(y.d(1),y=null),E[3]?b?b.p(E,D):(b=ku(E),b.c(),b.m(u,d)):b&&(b.d(1),b=null),D&8&&f!==(f=E[3]?"Cancel":"Edit topic & users")&&ge(h,f),D&8&&m!==(m=`float-right px-2 h-7 border-l border-black self-end hover:text-white ${E[3]?"hover:bg-red-500":"hover:bg-nl"}`)&&I(p,"class",m),E[0]?C?C.p(E,D):(C=Tu(E),C.c(),C.m(g,null)):C&&(C.d(1),C=null),D&4&&v!==(v=`${E[2]} relative`)&&I(e,"class",v)},i:Y,o:Y,d(E){E&&q(e),y&&y.d(),b&&b.d(),C&&C.d(),k=!1,_()}}}function UE(t,e,n){let r,s,i;Qn(t,on,b=>n(7,i=b));let{class:o=""}=e,{id:a=""}=e,{description:l=""}=e,{people:c=null}=e,u=!1;const d=()=>{const b=et(tt,"room",a);sn(b,{info:{description:l}},{merge:!0});const C={};Object.keys(c).forEach(E=>{f[E]||(C[E]=c[E])}),$o(b,{people:C}),n(3,u=!1),n(4,f={})},p=b=>{let C=0;const E=Object.keys(b).reduce((D,L)=>{var B;const A=(B=b[L].card)==null?void 0:B.text;if(A=="")return D;let U=0;const M=Number(A);return isNaN(M)||(C++,U=M),D+U},0);return jE(E/C,2)};let f={};const h=b=>{n(4,f[b]=!0,f)},m=b=>{delete f[b],n(4,f={...f})},w=()=>{if(c){Object.keys(c).forEach(C=>{c[C].card&&(n(0,c[C].card.text=null,c),n(0,c[C].card.emoji=!1,c))});const b=et(tt,"room",a);sn(b,{people:c,show:!1},{merge:!0}),on.set(!1)}else{const b=et(tt,"room",a);sn(b,{show:!1},{merge:!0}),on.set(!1)}},g=()=>{const b=et(tt,"room",a);sn(b,{show:!0},{merge:!0}),on.set(!0)};function v(){l=this.value,n(1,l)}const k=()=>{n(3,u=!u),n(4,f={})},_=(b,C)=>Xd(c[b].nick,c[C].nick),y=b=>f[b]?m(b):h(b);return t.$$set=b=>{"class"in b&&n(2,o=b.class),"id"in b&&n(13,a=b.id),"description"in b&&n(1,l=b.description),"people"in b&&n(0,c=b.people)},t.$$.update=()=>{t.$$.dirty&1&&n(6,r=c?Object.keys(c).reduce((b,C)=>{var D;const E=(D=c[C].card)!=null&&D.text?1:0;return b+E},0):0),t.$$.dirty&1&&n(5,s=c?p(c):0)},[c,l,o,u,f,s,r,i,d,h,m,w,g,a,v,k,_,y]}class $E extends He{constructor(e){super(),ze(this,e,UE,VE,Ve,{class:2,id:13,description:1,people:0})}}function qE(t){var c,u;let e,n,r,s,i,o,a,l;return n=new $E({props:{id:t[0],description:(u=(c=t[1])==null?void 0:c.description)!=null?u:"",people:t[3],class:"flex-1 bg-white border-black border-t border-b sm:border"}}),i=new __({props:{id:t[0],info:t[1],nick:t[2],nickID:t[5],class:"bg-white border-black border-t border-b sm:border h-fit"}}),a=new _b({props:{id:t[0],nickID:t[5],cardDeck:t[4],class:"flex-1 bg-white border-black border-t border-b sm:border h-fit"}}),{c(){e=S("div"),Ie(n.$$.fragment),r=P(),s=S("div"),Ie(i.$$.fragment),o=P(),Ie(a.$$.fragment),I(s,"class","flex flex-1 flex-col gap-2"),I(e,"class","flex flex-col xl:flex-row gap-2")},m(d,p){H(d,e,p),_e(n,e,null),T(e,r),T(e,s),_e(i,s,null),T(s,o),_e(a,s,null),l=!0},p(d,[p]){var w,g;const f={};p&1&&(f.id=d[0]),p&2&&(f.description=(g=(w=d[1])==null?void 0:w.description)!=null?g:""),p&8&&(f.people=d[3]),n.$set(f);const h={};p&1&&(h.id=d[0]),p&2&&(h.info=d[1]),p&4&&(h.nick=d[2]),i.$set(h);const m={};p&1&&(m.id=d[0]),p&16&&(m.cardDeck=d[4]),a.$set(m)},i(d){l||(ee(n.$$.fragment,d),ee(i.$$.fragment,d),ee(a.$$.fragment,d),l=!0)},o(d){re(n.$$.fragment,d),re(i.$$.fragment,d),re(a.$$.fragment,d),l=!1},d(d){d&&q(e),Ee(n),Ee(i),Ee(a)}}}function zE(t,e,n){var d;let{id:r=""}=e,{password:s=""}=e,i=null,{id:o,nick:a}=(d=Hd())!=null?d:Gd(Xs()),l=null,c=[],u=null;return wn(async()=>{window.addEventListener("keydown",zc),window.addEventListener("keyup",Hc);const p=et(tt,"room",r);let f=qw(r);await sn(p,{people:{[o]:{nick:a,points:""}}},{merge:!0}),u=Sw(tt,r,h=>{var v,k,_;n(1,i=h.get("info")),n(3,l=h.get("people"));const m=h.get("password"),w=h.get("cards");if(n(4,c=(v=w==null?void 0:w.sort((y,b)=>y.text.localeCompare(b.text)))!=null?v:[]),on.set(h.get("show")),!l[o]){Go("/?msg=You%20have%20been%20kicked!!");return}((k=l[o])==null?void 0:k.nick)!=a&&(n(2,a=(_=l[o])==null?void 0:_.nick),a&&Kd(o,a));const g={};(i==null?void 0:i.name)!=f&&(f=i==null?void 0:i.name,g.name=f),m.passCode!=s&&(n(6,s=m.passCode),g.password=s,m_("password")),Object.keys(g).length&&Uw(r,{...g,id:r}),Object.keys(l).every(y=>{var b;return(b=l[y].card)==null?void 0:b.text})&&on.set(!0)})}),bn(()=>{window.removeEventListener("keydown",zc),window.removeEventListener("keyup",Hc),u!=null&&u()}),t.$$set=p=>{"id"in p&&n(0,r=p.id),"password"in p&&n(6,s=p.password)},[r,i,a,l,c,o,s]}class HE extends He{constructor(e){super(),ze(this,e,zE,qE,Ve,{id:0,password:6})}}function Au(t){let e,n,r,s;const i=[KE,GE],o=[];function a(l,c){return l[3]?1:0}return e=a(t),n=o[e]=i[e](t),{c(){n.c(),r=yn()},m(l,c){o[e].m(l,c),H(l,r,c),s=!0},p(l,c){let u=e;e=a(l),e===u?o[e].p(l,c):(xt(),re(o[u],1,1,()=>{o[u]=null}),Mt(),n=o[e],n?n.p(l,c):(n=o[e]=i[e](l),n.c()),ee(n,1),n.m(r.parentNode,r))},i(l){s||(ee(n),s=!0)},o(l){re(n),s=!1},d(l){o[e].d(l),l&&q(r)}}}function GE(t){let e,n;return e=new HE({props:{id:t[0].id,password:t[1]}}),{c(){Ie(e.$$.fragment)},m(r,s){_e(e,r,s),n=!0},p(r,s){const i={};s&1&&(i.id=r[0].id),s&2&&(i.password=r[1]),e.$set(i)},i(r){n||(ee(e.$$.fragment,r),n=!0)},o(r){re(e.$$.fragment,r),n=!1},d(r){Ee(e,r)}}}function KE(t){let e,n,r,s,i,o,a,l,c,u,d,p,f=t[2]&&Du();return{c(){e=S("div"),n=S("div"),r=S("span"),r.textContent="password not correct!",s=P(),i=S("form"),o=S("label"),o.innerHTML=`<span class="text-sm font-bold block mb-2">Passcode</span> 
            <input type="text" name="passCode" autocomplete="off" placeholder="Password to join room" class="mb-4 form-input"/>`,a=P(),l=S("div"),c=S("button"),c.textContent="Login",u=P(),f&&f.c(),I(r,"class","block mb-4 text-xl font-bold bg-black text-white px-2 py-1"),I(c,"type","submit"),c.value="create",I(c,"class","block border border-black bg-white text-black hover:bg-nl hover:text-white font-bold py-1 px-3 rounded"),I(l,"class","flex gap-2 justify-between"),I(n,"class","p-6 bg-white border border-black"),I(e,"class","flex items-center justify-center")},m(h,m){H(h,e,m),T(e,n),T(n,r),T(n,s),T(n,i),T(i,o),T(i,a),T(i,l),T(l,c),T(l,u),f&&f.m(l,null),d||(p=te(i,"submit",vn(Wn(t[5]))),d=!0)},p(h,m){h[2]?f||(f=Du(),f.c(),f.m(l,null)):f&&(f.d(1),f=null)},i:Y,o:Y,d(h){h&&q(e),f&&f.d(),d=!1,p()}}}function Du(t){let e;return{c(){e=S("span"),e.textContent="Wrong!",I(e,"class","flex-1 bg-red-500 text-white block px-2 leading-loose")},m(n,r){H(n,e,r)},d(n){n&&q(e)}}}function QE(t){let e,n,r=t[4]&&Au(t);return{c(){r&&r.c(),e=yn()},m(s,i){r&&r.m(s,i),H(s,e,i),n=!0},p(s,[i]){s[4]?r?(r.p(s,i),i&16&&ee(r,1)):(r=Au(s),r.c(),ee(r,1),r.m(e.parentNode,e)):r&&(xt(),re(r,1,1,()=>{r=null}),Mt())},i(s){n||(ee(r),n=!0)},o(s){re(r),n=!1},d(s){r&&r.d(s),s&&q(e)}}}function WE(t,e,n){let r;Qn(t,Hu,p=>n(6,r=p));let{params:s={}}=e,i="",o=!1,a=!1,l=!1;const c=(p,f=!1)=>{var m;if(!f&&!l||(p=p.replace(" ",""),p==""))return;const h=new URLSearchParams(p);return n(1,i=(m=h.get("password"))!=null?m:""),window.history.replaceState({},"",window.location.pathname+window.location.hash.replace("?"+p,"")),i},u=async(p,f,h=!1)=>{if(!h&&!l)return;n(2,o=!1);const m=et(tt,"room",p),w=$w(p);let g=await Uc(m,w),v=w;if(g||(g=await Uc(m,f),v=f),!g){n(2,o=!0);return}n(1,i=v),n(3,a=!0)},d=p=>{const m=p.currentTarget.elements.namedItem("passCode").value;u(s.id,m)};return wn(async()=>{const p=c(r,!0);await u(s.id,p,!0),n(4,l=!0)}),t.$$set=p=>{"params"in p&&n(0,s=p.params)},t.$$.update=()=>{t.$$.dirty&64&&c(r),t.$$.dirty&3&&u(s.id,i)},[s,i,o,a,l,d,r]}class XE extends He{constructor(e){super(),ze(this,e,WE,QE,Ve,{params:0})}}function YE(t){let e,n,r,s,i,o;return r=new Dp({props:{class:"px-2 border-nl border-b-2 mb-3"}}),i=new Cp({props:{routes:t[0]}}),{c(){e=S("div"),n=S("div"),Ie(r.$$.fragment),s=P(),Ie(i.$$.fragment),I(n,"class","container mx-auto border-black"),I(e,"class","bg-gray-100 h-full")},m(a,l){H(a,e,l),T(e,n),_e(r,n,null),T(n,s),_e(i,n,null),o=!0},p:Y,i(a){o||(ee(r.$$.fragment,a),ee(i.$$.fragment,a),o=!0)},o(a){re(r.$$.fragment,a),re(i.$$.fragment,a),o=!1},d(a){a&&q(e),Ee(r),Ee(i)}}}function JE(t){return[{"/":hb,"/room/:id":XE,"*":db}]}class ZE extends He{constructor(e){super(),ze(this,e,JE,YE,Ve,{})}}new ZE({target:document.body});
